!function (t) { var e = window.webpackJsonp; window.webpackJsonp = function (i, s, o) { for (var a, h, u, l = 0, c = []; l < i.length; l++)h = i[l], r[h] && c.push(r[h][0]), r[h] = 0; for (a in s) Object.prototype.hasOwnProperty.call(s, a) && (t[a] = s[a]); for (e && e(i, s, o); c.length;)c.shift()(); if (o) for (l = 0; l < o.length; l++)u = n(n.s = o[l]); return u }; var i = {}, r = { 18: 0 }; function n(e) { if (i[e]) return i[e].exports; var r = i[e] = { i: e, l: !1, exports: {} }; return t[e].call(r.exports, r, r.exports, n), r.l = !0, r.exports } n.e = function (t) { var e = r[t]; if (0 === e) return new Promise(function (t) { t() }); if (e) return e[2]; var i = new Promise(function (i, n) { e = r[t] = [i, n] }); e[2] = i; var s = document.getElementsByTagName("head")[0], o = document.createElement("script"); o.type = "text/javascript", o.charset = "utf-8", o.async = !0, o.timeout = 12e4, n.nc && o.setAttribute("nonce", n.nc), o.src = n.p + "" + t + ".bundle.js"; var a = setTimeout(h, 12e4); function h() { o.onerror = o.onload = null, clearTimeout(a); var e = r[t]; 0 !== e && (e && e[1](new Error("Loading chunk " + t + " failed.")), r[t] = void 0) } return o.onerror = o.onload = h, s.appendChild(o), i }, n.m = t, n.c = i, n.d = function (t, e, i) { n.o(t, e) || Object.defineProperty(t, e, { configurable: !1, enumerable: !0, get: i }) }, n.n = function (t) { var e = t && t.__esModule ? function () { return t.default } : function () { return t }; return n.d(e, "a", e), e }, n.o = function (t, e) { return Object.prototype.hasOwnProperty.call(t, e) }, n.p = "", n.oe = function (t) { throw console.error(t), t } }({ "+2+s": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("49qz")(!0); r(r.P, "String", { at: function (t) { return n(this, t) } }) }, "+CM9": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("ot5s")(!1), s = [].indexOf, o = !!s && 1 / [1].indexOf(1, -0) < 0; r(r.P + r.F * (o || !i("NNrz")(s)), "Array", { indexOf: function (t) { return o ? s.apply(this, arguments) || 0 : n(this, t, arguments[1]) } }) }, "+Mt+": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("7gX0"), s = i("OzIq"), o = i("7O1s"), a = i("nphH"); r(r.P + r.R, "Promise", { finally: function (t) { var e = o(this, n.Promise || s.Promise), i = "function" == typeof t; return this.then(i ? function (i) { return a(e, t()).then(function () { return i }) } : t, i ? function (i) { return a(e, t()).then(function () { throw i }) } : t) } }) }, "+vXH": function (t, e, i) { "use strict"; i("77Ug")("Float64", 8, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, "+yjc": function (t, e, i) { "use strict"; var r = i("UKM+"); i("3i66")("isSealed", function (t) { return function (e) { return !r(e) || !!t && t(e) } }) }, "/whu": function (t, e, i) { "use strict"; t.exports = function (t) { if (void 0 == t) throw TypeError("Can't call method on  " + t); return t } }, "07k+": function (t, e, i) { "use strict"; for (var r, n = i("OzIq"), s = i("2p1q"), o = i("ulTY"), a = o("typed_array"), h = o("view"), u = !(!n.ArrayBuffer || !n.DataView), l = u, c = 0, d = "Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(","); c < 9;)(r = n[d[c++]]) ? (s(r.prototype, a, !0), s(r.prototype, h, !0)) : l = !1; t.exports = { ABV: u, CONSTR: l, TYPED: a, VIEW: h } }, "0Rih": function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("Ds5P"), s = i("R3AP"), o = i("A16L"), a = i("1aA0"), h = i("vmSO"), u = i("9GpA"), l = i("UKM+"), c = i("zgIt"), d = i("qkyc"), p = i("yYvK"), f = i("kic5"); t.exports = function (t, e, i, g, m, v) { var y = r[t], x = y, _ = m ? "set" : "add", b = x && x.prototype, T = {}, w = function (t) { var e = b[t]; s(b, t, "delete" == t ? function (t) { return !(v && !l(t)) && e.call(this, 0 === t ? 0 : t) } : "has" == t ? function (t) { return !(v && !l(t)) && e.call(this, 0 === t ? 0 : t) } : "get" == t ? function (t) { return v && !l(t) ? void 0 : e.call(this, 0 === t ? 0 : t) } : "add" == t ? function (t) { return e.call(this, 0 === t ? 0 : t), this } : function (t, i) { return e.call(this, 0 === t ? 0 : t, i), this }) }; if ("function" == typeof x && (v || b.forEach && !c(function () { (new x).entries().next() }))) { var S = new x, C = S[_](v ? {} : -0, 1) != S, P = c(function () { S.has(1) }), E = d(function (t) { new x(t) }), A = !v && c(function () { for (var t = new x, e = 5; e--;)t[_](e, e); return !t.has(-0) }); E || ((x = e(function (e, i) { u(e, x, t); var r = f(new y, e, x); return void 0 != i && h(i, m, r[_], r), r })).prototype = b, b.constructor = x), (P || A) && (w("delete"), w("has"), m && w("get")), (A || C) && w(_), v && b.clear && delete b.clear } else x = g.getConstructor(e, t, m, _), o(x.prototype, i), a.NEED = !0; return p(x, t), T[t] = x, n(n.G + n.W + n.F * (x != y), T), v || g.setStrong(x, t, m), x } }, "0j1G": function (t, e, i) { "use strict"; var r = i("Ds5P"); t.exports = function (t) { r(r.S, t, { of: function () { for (var t = arguments.length, e = new Array(t); t--;)e[t] = arguments[t]; return new this(e) } }) } }, "0pGU": function (t, e, i) { "use strict"; var r = i("DIVP"); t.exports = function () { var t = r(this), e = ""; return t.global && (e += "g"), t.ignoreCase && (e += "i"), t.multiline && (e += "m"), t.unicode && (e += "u"), t.sticky && (e += "y"), e } }, "1A13": function (t, e, i) { "use strict"; var r = i("49qz")(!0); i("uc2A")(String, "String", function (t) { this._t = String(t), this._i = 0 }, function () { var t, e = this._t, i = this._i; return i >= e.length ? { value: void 0, done: !0 } : (t = r(e, i), this._i += t.length, { value: t, done: !1 }) }) }, "1ETD": function (t, e, i) { "use strict"; var r = i("kkCw")("match"); t.exports = function (t) { var e = /./; try { "/./"[t](e) } catch (i) { try { return e[r] = !1, !"/./"[t](e) } catch (t) { } } return !0 } }, "1aA0": function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, n = i("ulTY")("meta"), s = i("UKM+"), o = i("WBcL"), a = i("lDLk").f, h = 0, u = Object.isExtensible || function () { return !0 }, l = !i("zgIt")(function () { return u(Object.preventExtensions({})) }), c = function (t) { a(t, n, { value: { i: "O" + ++h, w: {} } }) }, d = t.exports = { KEY: n, NEED: !1, fastKey: function (t, e) { if (!s(t)) return "symbol" == (void 0 === t ? "undefined" : r(t)) ? t : ("string" == typeof t ? "S" : "P") + t; if (!o(t, n)) { if (!u(t)) return "F"; if (!e) return "E"; c(t) } return t[n].i }, getWeak: function (t, e) { if (!o(t, n)) { if (!u(t)) return !0; if (!e) return !1; c(t) } return t[n].w }, onFreeze: function (t) { return l && d.NEED && u(t) && !o(t, n) && c(t), t } } }, "1ip3": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { log10: function (t) { return Math.log(t) * Math.LOG10E } }) }, "1uLP": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.G + r.W + r.F * !i("07k+").ABV, { DataView: i("LrcN").DataView }) }, "2VSL": function (t, e, i) { "use strict"; var r = i("BbyF"), n = i("xAdt"), s = i("/whu"); t.exports = function (t, e, i, o) { var a = String(s(t)), h = a.length, u = void 0 === i ? " " : String(i), l = r(e); if (l <= h || "" == u) return a; var c = l - h, d = n.call(u, Math.ceil(c / u.length)); return d.length > c && (d = d.slice(0, c)), o ? d + a : a + d } }, "2p1q": function (t, e, i) { "use strict"; var r = i("lDLk"), n = i("fU25"); t.exports = i("bUqO") ? function (t, e, i) { return r.f(t, e, n(1, i)) } : function (t, e, i) { return t[e] = i, t } }, "32VL": function (t, e, i) { "use strict"; var r, n, s = i("0pGU"), o = RegExp.prototype.exec, a = String.prototype.replace, h = o, u = (r = /a/, n = /b*/g, o.call(r, "a"), o.call(n, "a"), 0 !== r.lastIndex || 0 !== n.lastIndex), l = void 0 !== /()??/.exec("")[1]; (u || l) && (h = function (t) { var e, i, r, n, h = this; return l && (i = new RegExp("^" + h.source + "$(?!\\s)", s.call(h))), u && (e = h.lastIndex), r = o.call(h, t), u && r && (h.lastIndex = h.global ? r.index + r[0].length : e), l && r && r.length > 1 && a.call(r[0], i, function () { for (n = 1; n < arguments.length - 2; n++)void 0 === arguments[n] && (r[n] = void 0) }), r }), t.exports = h }, "3IRH": function (t, e, i) { "use strict"; t.exports = function (t) { return t.webpackPolyfill || (t.deprecate = function () { }, t.paths = [], t.children || (t.children = []), Object.defineProperty(t, "loaded", { enumerable: !0, get: function () { return t.l } }), Object.defineProperty(t, "id", { enumerable: !0, get: function () { return t.i } }), t.webpackPolyfill = 1), t } }, "3QrE": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.P, "Function", { bind: i("ZtwE") }) }, "3g/S": function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("7gX0"), s = i("V3l/"), o = i("M8WE"), a = i("lDLk").f; t.exports = function (t) { var e = n.Symbol || (n.Symbol = s ? {} : r.Symbol || {}); "_" == t.charAt(0) || t in e || a(e, t, { value: o.f(t) }) } }, "3i66": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("7gX0"), s = i("zgIt"); t.exports = function (t, e) { var i = (n.Object || {})[t] || Object[t], o = {}; o[t] = e(i), r(r.S + r.F * s(function () { i(1) }), "Object", o) } }, "3q4u": function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = r.key, o = r.map, a = r.store; r.exp({ deleteMetadata: function (t, e) { var i = arguments.length < 3 ? void 0 : s(arguments[2]), r = o(n(e), i, !1); if (void 0 === r || !r.delete(t)) return !1; if (r.size) return !0; var h = a.get(e); return h.delete(i), !!h.size || a.delete(e) } }) }, "3s83": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { RAD_PER_DEG: 180 / Math.PI }) }, "41xE": function (t, e, i) { "use strict"; var r = i("OzIq").navigator; t.exports = r && r.userAgent || "" }, "49qz": function (t, e, i) { "use strict"; var r = i("oeih"), n = i("/whu"); t.exports = function (t) { return function (e, i) { var s, o, a = String(n(e)), h = r(i), u = a.length; return h < 0 || h >= u ? t ? "" : void 0 : (s = a.charCodeAt(h)) < 55296 || s > 56319 || h + 1 === u || (o = a.charCodeAt(h + 1)) < 56320 || o > 57343 ? t ? a.charAt(h) : s : t ? a.slice(h, h + 2) : o - 56320 + (s - 55296 << 10) + 65536 } } }, "4IZP": function (t, e, i) { "use strict"; t.exports = Object.is || function (t, e) { return t === e ? 0 !== t || 1 / t == 1 / e : t != t && e != e } }, "4M2W": function (t, e, i) { "use strict"; i("A0n/"), i("i68Q"), i("QzLV"), i("Hhm4"), i("C+4B"), i("W4Z6"), i("tJwI"), i("eC2H"), i("VTn2"), i("W/IU"), i("Y5ex"), i("WpPb"), i("+yjc"), i("gPva"), i("n12u"), i("nRs1"), i("jrHM"), i("gYYG"), i("3QrE"), i("EuXz"), i("PbPd"), i("S+E/"), i("EvFb"), i("QBuC"), i("QWLi"), i("ZRJK"), i("Stuz"), i("yuXV"), i("XtiL"), i("LG56"), i("A1ng"), i("WiIn"), i("aJ2J"), i("altv"), i("dULJ"), i("v2lb"), i("7Jvp"), i("lyhN"), i("kBOG"), i("xONB"), i("LlNE"), i("9xIj"), i("m6Yj"), i("wrs0"), i("Lqg1"), i("1ip3"), i("pWGb"), i("N4KQ"), i("Hl+4"), i("MjHD"), i("SRCy"), i("H0mh"), i("bqOW"), i("F3sI"), i("mhn7"), i("1A13"), i("Racj"), i("Y1S0"), i("Gh7F"), i("tqSY"), i("CvWX"), i("8Np7"), i("R4pa"), i("4RlI"), i("iM2X"), i("J+j9"), i("82of"), i("X/Hz"), i("eVIH"), i("UJiG"), i("SU+a"), i("5iw+"), i("EWrS"), i("J2ob"), i("QaEu"), i("8fhx"), i("UbXY"), i("Rk41"), i("4Q0w"), i("IMUI"), i("beEN"), i("xMpm"), i("j42X"), i("81dZ"), i("uDYd"), i("CEO+"), i("w6W7"), i("fOdq"), i("wVdn"), i("Nkrw"), i("wnRD"), i("lkT3"), i("+CM9"), i("oHKp"), i("9vc3"), i("No4x"), i("WpTh"), i("U6qc"), i("Q/CP"), i("WgSQ"), i("lnZN"), i("Jbuy"), i("FaZr"), i("pd+2"), i("MfeA"), i("VjuZ"), i("qwQ3"), i("mJx5"), i("y9m4"), i("MsuQ"), i("dSUw"), i("ZDXm"), i("V/H1"), i("9mmO"), i("1uLP"), i("52Wt"), i("TFWu"), i("MyjO"), i("qtRy"), i("THnP"), i("K0JP"), i("NfZy"), i("dTzs"), i("+vXH"), i("CVR+"), i("vmSu"), i("4ZU1"), i("yx1U"), i("X7aK"), i("SPtU"), i("A52B"), i("PuTd"), i("dm+7"), i("JG34"), i("Rw4K"), i("9mGU"), i("bUY0"), i("mTp7"), i("gbyG"), i("oF0V"), i("v90c"), i("+2+s"), i("smQ+"), i("m8F4"), i("xn9I"), i("LRL/"), i("sc7i"), i("9Yib"), i("vu/c"), i("zmx7"), i("YVn/"), i("FKfb"), i("oYp4"), i("dxQb"), i("xCpI"), i("AkTE"), i("h7Xi"), i("arGp"), i("JJ3w"), i("qZb+"), i("La7N"), i("BOYP"), i("4rmF"), i("Ygg6"), i("6Xxs"), i("qdHU"), i("DQfQ"), i("j/Lv"), i("U+VG"), i("X6NR"), i("W0pi"), i("taNN"), i("vnWP"), i("R3KI"), i("6iMJ"), i("B3Xn"), i("3s83"), i("F1ui"), i("uEEG"), i("i039"), i("H7zx"), i("+Mt+"), i("QcWB"), i("yJ2x"), i("3q4u"), i("NHaJ"), i("v3hU"), i("zZHq"), i("vsh6"), i("8WbS"), i("yOtE"), i("EZ+5"), i("aM0T"), i("nh2o"), i("v8VU"), i("dich"), i("fx22"), t.exports = i("7gX0") }, "4Q0w": function (t, e, i) { "use strict"; var r = i("kkCw")("toPrimitive"), n = Date.prototype; r in n || i("2p1q")(n, r, i("jB26")) }, "4RlI": function (t, e, i) { "use strict"; i("y325")("blink", function (t) { return function () { return t(this, "blink", "", "") } }) }, "4ZU1": function (t, e, i) { "use strict"; var r = i("lDLk"), n = i("Ds5P"), s = i("DIVP"), o = i("s4j0"); n(n.S + n.F * i("zgIt")(function () { Reflect.defineProperty(r.f({}, 1, { value: 1 }), 1, { value: 2 }) }), "Reflect", { defineProperty: function (t, e, i) { s(t), e = o(e, !0), s(i); try { return r.f(t, e, i), !0 } catch (t) { return !1 } } }) }, "4rmF": function (t, e, i) { "use strict"; i("iKpr")("Map") }, "52Wt": function (t, e, i) { "use strict"; i("77Ug")("Int8", 1, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, "5iw+": function (t, e, i) { "use strict"; i("y325")("strike", function (t) { return function () { return t(this, "strike", "", "") } }) }, "6Xxs": function (t, e, i) { "use strict"; i("iKpr")("WeakMap") }, "6iMJ": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { isubh: function (t, e, i, r) { var n = t >>> 0, s = i >>> 0; return (e >>> 0) - (r >>> 0) - ((~n & s | ~(n ^ s) & n - s >>> 0) >>> 31) | 0 } }) }, "73qY": function (t, e, i) { "use strict"; t.exports = i("VWgF")("native-function-to-string", Function.toString) }, "77Ug": function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; if (i("bUqO")) { var n = i("V3l/"), s = i("OzIq"), o = i("zgIt"), a = i("Ds5P"), h = i("07k+"), u = i("LrcN"), l = i("rFzY"), c = i("9GpA"), d = i("fU25"), p = i("2p1q"), f = i("A16L"), g = i("oeih"), m = i("BbyF"), v = i("8D8H"), y = i("zo/l"), x = i("s4j0"), _ = i("WBcL"), b = i("wC1N"), T = i("UKM+"), w = i("FryR"), S = i("9vb1"), C = i("7ylX"), P = i("KOrd"), E = i("WcO1").f, A = i("SHe9"), R = i("ulTY"), M = i("kkCw"), L = i("LhTa"), I = i("ot5s"), O = i("7O1s"), D = i("WgSQ"), F = i("bN1p"), k = i("qkyc"), B = i("CEne"), U = i("zCYm"), G = i("DPsE"), N = i("lDLk"), X = i("x9zv"), W = N.f, j = X.f, z = s.RangeError, V = s.TypeError, H = s.Uint8Array, Y = Array.prototype, K = u.ArrayBuffer, q = u.DataView, J = L(0), Q = L(2), Z = L(3), $ = L(4), tt = L(5), et = L(6), it = I(!0), rt = I(!1), nt = D.values, st = D.keys, ot = D.entries, at = Y.lastIndexOf, ht = Y.reduce, ut = Y.reduceRight, lt = Y.join, ct = Y.sort, dt = Y.slice, pt = Y.toString, ft = Y.toLocaleString, gt = M("iterator"), mt = M("toStringTag"), vt = R("typed_constructor"), yt = R("def_constructor"), xt = h.CONSTR, _t = h.TYPED, bt = h.VIEW, Tt = L(1, function (t, e) { return Et(O(t, t[yt]), e) }), wt = o(function () { return 1 === new H(new Uint16Array([1]).buffer)[0] }), St = !!H && !!H.prototype.set && o(function () { new H(1).set({}) }), Ct = function (t, e) { var i = g(t); if (i < 0 || i % e) throw z("Wrong offset!"); return i }, Pt = function (t) { if (T(t) && _t in t) return t; throw V(t + " is not a typed array!") }, Et = function (t, e) { if (!(T(t) && vt in t)) throw V("It is not a typed array constructor!"); return new t(e) }, At = function (t, e) { return Rt(O(t, t[yt]), e) }, Rt = function (t, e) { for (var i = 0, r = e.length, n = Et(t, r); r > i;)n[i] = e[i++]; return n }, Mt = function (t, e, i) { W(t, e, { get: function () { return this._d[i] } }) }, Lt = function (t) { var e, i, r, n, s, o, a = w(t), h = arguments.length, u = h > 1 ? arguments[1] : void 0, c = void 0 !== u, d = A(a); if (void 0 != d && !S(d)) { for (o = d.call(a), r = [], e = 0; !(s = o.next()).done; e++)r.push(s.value); a = r } for (c && h > 2 && (u = l(u, arguments[2], 2)), e = 0, i = m(a.length), n = Et(this, i); i > e; e++)n[e] = c ? u(a[e], e) : a[e]; return n }, It = function () { for (var t = 0, e = arguments.length, i = Et(this, e); e > t;)i[t] = arguments[t++]; return i }, Ot = !!H && o(function () { ft.call(new H(1)) }), Dt = function () { return ft.apply(Ot ? dt.call(Pt(this)) : Pt(this), arguments) }, Ft = { copyWithin: function (t, e) { return G.call(Pt(this), t, e, arguments.length > 2 ? arguments[2] : void 0) }, every: function (t) { return $(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, fill: function (t) { return U.apply(Pt(this), arguments) }, filter: function (t) { return At(this, Q(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0)) }, find: function (t) { return tt(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, findIndex: function (t) { return et(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, forEach: function (t) { J(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, indexOf: function (t) { return rt(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, includes: function (t) { return it(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, join: function (t) { return lt.apply(Pt(this), arguments) }, lastIndexOf: function (t) { return at.apply(Pt(this), arguments) }, map: function (t) { return Tt(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, reduce: function (t) { return ht.apply(Pt(this), arguments) }, reduceRight: function (t) { return ut.apply(Pt(this), arguments) }, reverse: function () { for (var t, e = Pt(this).length, i = Math.floor(e / 2), r = 0; r < i;)t = this[r], this[r++] = this[--e], this[e] = t; return this }, some: function (t) { return Z(Pt(this), t, arguments.length > 1 ? arguments[1] : void 0) }, sort: function (t) { return ct.call(Pt(this), t) }, subarray: function (t, e) { var i = Pt(this), r = i.length, n = y(t, r); return new (O(i, i[yt]))(i.buffer, i.byteOffset + n * i.BYTES_PER_ELEMENT, m((void 0 === e ? r : y(e, r)) - n)) } }, kt = function (t, e) { return At(this, dt.call(Pt(this), t, e)) }, Bt = function (t) { Pt(this); var e = Ct(arguments[1], 1), i = this.length, r = w(t), n = m(r.length), s = 0; if (n + e > i) throw z("Wrong length!"); for (; s < n;)this[e + s] = r[s++] }, Ut = { entries: function () { return ot.call(Pt(this)) }, keys: function () { return st.call(Pt(this)) }, values: function () { return nt.call(Pt(this)) } }, Gt = function (t, e) { return T(t) && t[_t] && "symbol" != (void 0 === e ? "undefined" : r(e)) && e in t && String(+e) == String(e) }, Nt = function (t, e) { return Gt(t, e = x(e, !0)) ? d(2, t[e]) : j(t, e) }, Xt = function (t, e, i) { return !(Gt(t, e = x(e, !0)) && T(i) && _(i, "value")) || _(i, "get") || _(i, "set") || i.configurable || _(i, "writable") && !i.writable || _(i, "enumerable") && !i.enumerable ? W(t, e, i) : (t[e] = i.value, t) }; xt || (X.f = Nt, N.f = Xt), a(a.S + a.F * !xt, "Object", { getOwnPropertyDescriptor: Nt, defineProperty: Xt }), o(function () { pt.call({}) }) && (pt = ft = function () { return lt.call(this) }); var Wt = f({}, Ft); f(Wt, Ut), p(Wt, gt, Ut.values), f(Wt, { slice: kt, set: Bt, constructor: function () { }, toString: pt, toLocaleString: Dt }), Mt(Wt, "buffer", "b"), Mt(Wt, "byteOffset", "o"), Mt(Wt, "byteLength", "l"), Mt(Wt, "length", "e"), W(Wt, mt, { get: function () { return this[_t] } }), t.exports = function (t, e, i, r) { var u = t + ((r = !!r) ? "Clamped" : "") + "Array", l = "get" + t, d = "set" + t, f = s[u], g = f || {}, y = f && P(f), x = !f || !h.ABV, _ = {}, w = f && f.prototype, S = function (t, i) { W(t, i, { get: function () { return function (t, i) { var r = t._d; return r.v[l](i * e + r.o, wt) }(this, i) }, set: function (t) { return function (t, i, n) { var s = t._d; r && (n = (n = Math.round(n)) < 0 ? 0 : n > 255 ? 255 : 255 & n), s.v[d](i * e + s.o, n, wt) }(this, i, t) }, enumerable: !0 }) }; x ? (f = i(function (t, i, r, n) { c(t, f, u, "_d"); var s, o, a, h, l = 0, d = 0; if (T(i)) { if (!(i instanceof K || "ArrayBuffer" == (h = b(i)) || "SharedArrayBuffer" == h)) return _t in i ? Rt(f, i) : Lt.call(f, i); s = i, d = Ct(r, e); var g = i.byteLength; if (void 0 === n) { if (g % e) throw z("Wrong length!"); if ((o = g - d) < 0) throw z("Wrong length!") } else if ((o = m(n) * e) + d > g) throw z("Wrong length!"); a = o / e } else a = v(i), s = new K(o = a * e); for (p(t, "_d", { b: s, o: d, l: o, e: a, v: new q(s) }); l < a;)S(t, l++) }), w = f.prototype = C(Wt), p(w, "constructor", f)) : o(function () { f(1) }) && o(function () { new f(-1) }) && k(function (t) { new f, new f(null), new f(1.5), new f(t) }, !0) || (f = i(function (t, i, r, n) { var s; return c(t, f, u), T(i) ? i instanceof K || "ArrayBuffer" == (s = b(i)) || "SharedArrayBuffer" == s ? void 0 !== n ? new g(i, Ct(r, e), n) : void 0 !== r ? new g(i, Ct(r, e)) : new g(i) : _t in i ? Rt(f, i) : Lt.call(f, i) : new g(v(i)) }), J(y !== Function.prototype ? E(g).concat(E(y)) : E(g), function (t) { t in f || p(f, t, g[t]) }), f.prototype = w, n || (w.constructor = f)); var A = w[gt], R = !!A && ("values" == A.name || void 0 == A.name), M = Ut.values; p(f, vt, !0), p(w, _t, u), p(w, bt, !0), p(w, yt, f), (r ? new f(1)[mt] == u : mt in w) || W(w, mt, { get: function () { return u } }), _[u] = f, a(a.G + a.W + a.F * (f != g), _), a(a.S, u, { BYTES_PER_ELEMENT: e }), a(a.S + a.F * o(function () { g.of.call(f, 1) }), u, { from: Lt, of: It }), "BYTES_PER_ELEMENT" in w || p(w, "BYTES_PER_ELEMENT", e), a(a.P, u, Ft), B(u), a(a.P + a.F * St, u, { set: Bt }), a(a.P + a.F * !R, u, Ut), n || w.toString == pt || (w.toString = pt), a(a.P + a.F * o(function () { new f(1).slice() }), u, { slice: kt }), a(a.P + a.F * (o(function () { return [1, 2].toLocaleString() != new f([1, 2]).toLocaleString() }) || !o(function () { w.toLocaleString.call([1, 2]) })), u, { toLocaleString: Dt }), F[u] = R ? A : M, n || R || p(w, gt, M) } } else t.exports = function () { } }, "7Jvp": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = Math.asinh; r(r.S + r.F * !(n && 1 / n(0) > 0), "Math", { asinh: function t(e) { return isFinite(e = +e) && 0 != e ? e < 0 ? -t(-e) : Math.log(e + Math.sqrt(e * e + 1)) : e } }) }, "7O1s": function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("XSOZ"), s = i("kkCw")("species"); t.exports = function (t, e) { var i, o = r(t).constructor; return void 0 === o || void 0 == (i = r(o)[s]) ? e : n(i) } }, "7gX0": function (t, e, i) { "use strict"; var r = t.exports = { version: "2.6.9" }; "number" == typeof __e && (__e = r) }, "7ylX": function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("twxM"), s = i("QKXm"), o = i("mZON")("IE_PROTO"), a = function () { }, h = function () { var t, e = i("jhxf")("iframe"), r = s.length; for (e.style.display = "none", i("d075").appendChild(e), e.src = "javascript:", (t = e.contentWindow.document).open(), t.write("<script>document.F=Object<\/script>"), t.close(), h = t.F; r--;)delete h.prototype[s[r]]; return h() }; t.exports = Object.create || function (t, e) { var i; return null !== t ? (a.prototype = r(t), i = new a, a.prototype = null, i[o] = t) : i = h(), void 0 === e ? i : n(i, e) } }, "81dZ": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("d075"), s = i("ydD5"), o = i("zo/l"), a = i("BbyF"), h = [].slice; r(r.P + r.F * i("zgIt")(function () { n && h.call(n) }), "Array", { slice: function (t, e) { var i = a(this.length), r = s(this); if (e = void 0 === e ? i : e, "Array" == r) return h.call(this, t, e); for (var n = o(t, i), u = o(e, i), l = a(u - n), c = new Array(l), d = 0; d < l; d++)c[d] = "String" == r ? this.charAt(n + d) : this[n + d]; return c } }) }, "82of": function (t, e, i) { "use strict"; i("y325")("fontcolor", function (t) { return function (e) { return t(this, "font", "color", e) } }) }, "8D8H": function (t, e, i) { "use strict"; var r = i("oeih"), n = i("BbyF"); t.exports = function (t) { if (void 0 === t) return 0; var e = r(t), i = n(e); if (e !== i) throw RangeError("Wrong length!"); return i } }, "8Np7": function (t, e, i) { "use strict"; i("y325")("anchor", function (t) { return function (e) { return t(this, "a", "name", e) } }) }, "8WbS": function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = i("KOrd"), o = r.has, a = r.key; r.exp({ hasMetadata: function (t, e) { return function t(e, i, r) { if (o(e, i, r)) return !0; var n = s(i); return null !== n && t(e, n, r) }(t, n(e), arguments.length < 3 ? void 0 : a(arguments[2])) } }) }, "8fhx": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FryR"), s = i("s4j0"); r(r.P + r.F * i("zgIt")(function () { return null !== new Date(NaN).toJSON() || 1 !== Date.prototype.toJSON.call({ toISOString: function () { return 1 } }) }), "Date", { toJSON: function (t) { var e = n(this), i = s(e); return "number" != typeof i || isFinite(i) ? e.toISOString() : null } }) }, "8t38": function (t, e, i) { "use strict"; var r = i("OzIq").parseFloat, n = i("Ymdd").trim; t.exports = 1 / r(i("Xduv") + "-0") != -1 / 0 ? function (t) { var e = n(String(t), 3), i = r(e); return 0 === i && "-" == e.charAt(0) ? -0 : i } : r }, "9Dx1": function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, n = i("wC1N"), s = RegExp.prototype.exec; t.exports = function (t, e) { var i = t.exec; if ("function" == typeof i) { var o = i.call(t, e); if ("object" !== (void 0 === o ? "undefined" : r(o))) throw new TypeError("RegExp exec method returned something other than an Object or null"); return o } if ("RegExp" !== n(t)) throw new TypeError("RegExp#exec called on incompatible receiver"); return s.call(t, e) } }, "9GpA": function (t, e, i) { "use strict"; t.exports = function (t, e, i, r) { if (!(t instanceof e) || void 0 !== r && r in t) throw TypeError(i + ": incorrect invocation!"); return t } }, "9Yib": function (t, e, i) { "use strict"; i("3g/S")("asyncIterator") }, "9mGU": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("DIVP"), s = Object.preventExtensions; r(r.S, "Reflect", { preventExtensions: function (t) { n(t); try { return s && s(t), !0 } catch (t) { return !1 } } }) }, "9mmO": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("07k+"), s = i("LrcN"), o = i("DIVP"), a = i("zo/l"), h = i("BbyF"), u = i("UKM+"), l = i("OzIq").ArrayBuffer, c = i("7O1s"), d = s.ArrayBuffer, p = s.DataView, f = n.ABV && l.isView, g = d.prototype.slice, m = n.VIEW; r(r.G + r.W + r.F * (l !== d), { ArrayBuffer: d }), r(r.S + r.F * !n.CONSTR, "ArrayBuffer", { isView: function (t) { return f && f(t) || u(t) && m in t } }), r(r.P + r.U + r.F * i("zgIt")(function () { return !new d(2).slice(1, void 0).byteLength }), "ArrayBuffer", { slice: function (t, e) { if (void 0 !== g && void 0 === e) return g.call(o(this), t); for (var i = o(this).byteLength, r = a(t, i), n = a(void 0 === e ? i : e, i), s = new (c(this, d))(h(n - r)), u = new p(this), l = new p(s), f = 0; r < n;)l.setUint8(f++, u.getUint8(r++)); return s } }), i("CEne")("ArrayBuffer") }, "9vb1": function (t, e, i) { "use strict"; var r = i("bN1p"), n = i("kkCw")("iterator"), s = Array.prototype; t.exports = function (t) { return void 0 !== t && (r.Array === t || s[n] === t) } }, "9vc3": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.P, "Array", { copyWithin: i("DPsE") }), i("RhFG")("copyWithin") }, "9xIj": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("x78i"); r(r.S + r.F * (n != Math.expm1), "Math", { expm1: n }) }, "A0n/": function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, n = i("OzIq"), s = i("WBcL"), o = i("bUqO"), a = i("Ds5P"), h = i("R3AP"), u = i("1aA0").KEY, l = i("zgIt"), c = i("VWgF"), d = i("yYvK"), p = i("ulTY"), f = i("kkCw"), g = i("M8WE"), m = i("3g/S"), v = i("C+Ps"), y = i("XO1R"), x = i("DIVP"), _ = i("UKM+"), b = i("FryR"), T = i("PHqh"), w = i("s4j0"), S = i("fU25"), C = i("7ylX"), P = i("bG/2"), E = i("x9zv"), A = i("Y1N3"), R = i("lDLk"), M = i("Qh14"), L = E.f, I = R.f, O = P.f, D = n.Symbol, F = n.JSON, k = F && F.stringify, B = f("_hidden"), U = f("toPrimitive"), G = {}.propertyIsEnumerable, N = c("symbol-registry"), X = c("symbols"), W = c("op-symbols"), j = Object.prototype, z = "function" == typeof D && !!A.f, V = n.QObject, H = !V || !V.prototype || !V.prototype.findChild, Y = o && l(function () { return 7 != C(I({}, "a", { get: function () { return I(this, "a", { value: 7 }).a } })).a }) ? function (t, e, i) { var r = L(j, e); r && delete j[e], I(t, e, i), r && t !== j && I(j, e, r) } : I, K = function (t) { var e = X[t] = C(D.prototype); return e._k = t, e }, q = z && "symbol" == r(D.iterator) ? function (t) { return "symbol" == (void 0 === t ? "undefined" : r(t)) } : function (t) { return t instanceof D }, J = function (t, e, i) { return t === j && J(W, e, i), x(t), e = w(e, !0), x(i), s(X, e) ? (i.enumerable ? (s(t, B) && t[B][e] && (t[B][e] = !1), i = C(i, { enumerable: S(0, !1) })) : (s(t, B) || I(t, B, S(1, {})), t[B][e] = !0), Y(t, e, i)) : I(t, e, i) }, Q = function (t, e) { x(t); for (var i, r = v(e = T(e)), n = 0, s = r.length; s > n;)J(t, i = r[n++], e[i]); return t }, Z = function (t) { var e = G.call(this, t = w(t, !0)); return !(this === j && s(X, t) && !s(W, t)) && (!(e || !s(this, t) || !s(X, t) || s(this, B) && this[B][t]) || e) }, $ = function (t, e) { if (t = T(t), e = w(e, !0), t !== j || !s(X, e) || s(W, e)) { var i = L(t, e); return !i || !s(X, e) || s(t, B) && t[B][e] || (i.enumerable = !0), i } }, tt = function (t) { for (var e, i = O(T(t)), r = [], n = 0; i.length > n;)s(X, e = i[n++]) || e == B || e == u || r.push(e); return r }, et = function (t) { for (var e, i = t === j, r = O(i ? W : T(t)), n = [], o = 0; r.length > o;)!s(X, e = r[o++]) || i && !s(j, e) || n.push(X[e]); return n }; z || (h((D = function () { if (this instanceof D) throw TypeError("Symbol is not a constructor!"); var t = p(arguments.length > 0 ? arguments[0] : void 0); return o && H && Y(j, t, { configurable: !0, set: function e(i) { this === j && e.call(W, i), s(this, B) && s(this[B], t) && (this[B][t] = !1), Y(this, t, S(1, i)) } }), K(t) }).prototype, "toString", function () { return this._k }), E.f = $, R.f = J, i("WcO1").f = P.f = tt, i("Y1aA").f = Z, A.f = et, o && !i("V3l/") && h(j, "propertyIsEnumerable", Z, !0), g.f = function (t) { return K(f(t)) }), a(a.G + a.W + a.F * !z, { Symbol: D }); for (var it = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), rt = 0; it.length > rt;)f(it[rt++]); for (var nt = M(f.store), st = 0; nt.length > st;)m(nt[st++]); a(a.S + a.F * !z, "Symbol", { for: function (t) { return s(N, t += "") ? N[t] : N[t] = D(t) }, keyFor: function (t) { if (!q(t)) throw TypeError(t + " is not a symbol!"); for (var e in N) if (N[e] === t) return e }, useSetter: function () { H = !0 }, useSimple: function () { H = !1 } }), a(a.S + a.F * !z, "Object", { create: function (t, e) { return void 0 === e ? C(t) : Q(C(t), e) }, defineProperty: J, defineProperties: Q, getOwnPropertyDescriptor: $, getOwnPropertyNames: tt, getOwnPropertySymbols: et }); var ot = l(function () { A.f(1) }); a(a.S + a.F * ot, "Object", { getOwnPropertySymbols: function (t) { return A.f(b(t)) } }), F && a(a.S + a.F * (!z || l(function () { var t = D(); return "[null]" != k([t]) || "{}" != k({ a: t }) || "{}" != k(Object(t)) })), "JSON", { stringify: function (t) { for (var e, i, r = [t], n = 1; arguments.length > n;)r.push(arguments[n++]); if (i = e = r[1], (_(e) || void 0 !== t) && !q(t)) return y(e) || (e = function (t, e) { if ("function" == typeof i && (e = i.call(this, t, e)), !q(e)) return e }), r[1] = e, k.apply(F, r) } }), D.prototype[U] || i("2p1q")(D.prototype, U, D.prototype.valueOf), d(D, "Symbol"), d(Math, "Math", !0), d(n.JSON, "JSON", !0) }, A16L: function (t, e, i) { "use strict"; var r = i("R3AP"); t.exports = function (t, e, i) { for (var n in e) r(t, n, e[n], i); return t } }, A1ng: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("n982"), s = Math.abs; r(r.S, "Number", { isSafeInteger: function (t) { return n(t) && s(t) <= 9007199254740991 } }) }, A52B: function (t, e, i) { "use strict"; var r = i("x9zv"), n = i("Ds5P"), s = i("DIVP"); n(n.S, "Reflect", { getOwnPropertyDescriptor: function (t, e) { return r.f(s(t), e) } }) }, AkTE: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FryR"), s = i("s4j0"), o = i("KOrd"), a = i("x9zv").f; i("bUqO") && r(r.P + i("dm6P"), "Object", { __lookupSetter__: function (t) { var e, i = n(this), r = s(t, !0); do { if (e = a(i, r)) return e.set } while (i = o(i)) } }) }, B3Xn: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { imulh: function (t, e) { var i = +t, r = +e, n = 65535 & i, s = 65535 & r, o = i >> 16, a = r >> 16, h = (o * s >>> 0) + (n * s >>> 16); return o * a + (h >> 16) + ((n * a >>> 0) + (65535 & h) >> 16) } }) }, BOYP: function (t, e, i) { "use strict"; i("0j1G")("WeakSet") }, BbyF: function (t, e, i) { "use strict"; var r = i("oeih"), n = Math.min; t.exports = function (t) { return t > 0 ? n(r(t), 9007199254740991) : 0 } }, "C+4B": function (t, e, i) { "use strict"; var r = i("PHqh"), n = i("x9zv").f; i("3i66")("getOwnPropertyDescriptor", function () { return function (t, e) { return n(r(t), e) } }) }, "C+Ps": function (t, e, i) { "use strict"; var r = i("Qh14"), n = i("Y1N3"), s = i("Y1aA"); t.exports = function (t) { var e = r(t), i = n.f; if (i) for (var o, a = i(t), h = s.f, u = 0; a.length > u;)h.call(t, o = a[u++]) && e.push(o); return e } }, C6IM: function (t, e, i) { "use strict"; (function () { var i = i || {}; i.DisplayObject = function () { this.position = new i.Point(0, 0), this.scale = new i.Point(1, 1), this.pivot = new i.Point(0, 0), this.rotation = 0, this.alpha = 1, this.visible = !0, this.hitArea = null, this.renderable = !1, this.parent = null, this.worldAlpha = 1, this.worldTransform = new Phaser.Matrix, this.worldPosition = new i.Point(0, 0), this.worldScale = new i.Point(1, 1), this.worldRotation = 0, this.filterArea = null, this._sr = 0, this._cr = 1, this._bounds = new i.Rectangle(0, 0, 0, 0), this._currentBounds = null, this._mask = null, this._cacheAsBitmap = !1, this._cacheIsDirty = !1 }, i.DisplayObject.prototype = { constructor: i.DisplayObject, destroy: function () { if (this.children) { for (var t = this.children.length; t--;)this.children[t].destroy(); this.children = [] } this.hitArea = null, this.parent = null, this.worldTransform = null, this.filterArea = null, this.renderable = !1, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite() }, updateTransform: function (t) { if (!t && !this.parent && !this.game) return this; var e = this.parent; t ? e = t : this.parent || (e = this.game.world); var i, r, n, s, o, a, h = e.worldTransform, u = this.worldTransform; this.rotation % Phaser.Math.PI2 ? (this.rotation !== this.rotationCache && (this.rotationCache = this.rotation, this._sr = Math.sin(this.rotation), this._cr = Math.cos(this.rotation)), i = this._cr * this.scale.x, r = this._sr * this.scale.x, n = -this._sr * this.scale.y, s = this._cr * this.scale.y, o = this.position.x, a = this.position.y, (this.pivot.x || this.pivot.y) && (o -= this.pivot.x * i + this.pivot.y * n, a -= this.pivot.x * r + this.pivot.y * s), u.a = i * h.a + r * h.c, u.b = i * h.b + r * h.d, u.c = n * h.a + s * h.c, u.d = n * h.b + s * h.d, u.tx = o * h.a + a * h.c + h.tx, u.ty = o * h.b + a * h.d + h.ty) : (i = this.scale.x, r = 0, n = 0, s = this.scale.y, o = this.position.x - this.pivot.x * i, a = this.position.y - this.pivot.y * s, u.a = i * h.a, u.b = i * h.b, u.c = s * h.c, u.d = s * h.d, u.tx = o * h.a + a * h.c + h.tx, u.ty = o * h.b + a * h.d + h.ty), i = u.a, r = u.b, n = u.c; var l = i * (s = u.d) - r * n; if (i || r) { var c = Math.sqrt(i * i + r * r); this.worldRotation = r > 0 ? Math.acos(i / c) : -Math.acos(i / c), this.worldScale.x = c, this.worldScale.y = l / c } else if (n || s) { var d = Math.sqrt(n * n + s * s); this.worldRotation = Phaser.Math.HALF_PI - (s > 0 ? Math.acos(-n / d) : -Math.acos(n / d)), this.worldScale.x = l / d, this.worldScale.y = d } else this.worldScale.x = 0, this.worldScale.y = 0; return this.worldAlpha = this.alpha * e.worldAlpha, this.worldPosition.x = u.tx, this.worldPosition.y = u.ty, this._currentBounds = null, this.transformCallback && this.transformCallback.call(this.transformCallbackContext, u, h), this }, preUpdate: function () { }, generateTexture: function (t, e, r) { var n = this.getLocalBounds(), s = new Phaser.RenderTexture(this.game, 0 | n.width, 0 | n.height, r, e, t); return i.DisplayObject._tempMatrix.tx = -n.x, i.DisplayObject._tempMatrix.ty = -n.y, s.render(this, i.DisplayObject._tempMatrix), s }, updateCache: function () { return this._generateCachedSprite(), this }, toGlobal: function (t) { return this.updateTransform(), this.worldTransform.apply(t) }, toLocal: function (t, e) { return e && (t = e.toGlobal(t)), this.updateTransform(), this.worldTransform.applyInverse(t) }, _renderCachedSprite: function (t) { this._cachedSprite.worldAlpha = this.worldAlpha, t.gl ? i.Sprite.prototype._renderWebGL.call(this._cachedSprite, t) : i.Sprite.prototype._renderCanvas.call(this._cachedSprite, t) }, _generateCachedSprite: function () { this._cacheAsBitmap = !1; var t = this.getLocalBounds(); if (t.width = Math.max(1, Math.ceil(t.width)), t.height = Math.max(1, Math.ceil(t.height)), this.updateTransform(), this._cachedSprite) this._cachedSprite.texture.resize(t.width, t.height); else { var e = 0; this.texture && this.texture.baseTexture && i._enableMultiTextureToggle && (e = this.texture.baseTexture.textureIndex); var r = new Phaser.RenderTexture(this.game, t.width, t.height, void 0, void 0, void 0, void 0, e); this._cachedSprite = new i.Sprite(r), this._cachedSprite.worldTransform = this.worldTransform } var n = this._filters; this._filters = null, this._cachedSprite.filters = n, i.DisplayObject._tempMatrix.tx = -t.x, i.DisplayObject._tempMatrix.ty = -t.y, this._cachedSprite.texture.render(this, i.DisplayObject._tempMatrix, !0), this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, this._filters = n, this._cacheAsBitmap = !0 }, _destroyCachedSprite: function () { this._cachedSprite && (this._cachedSprite.texture.destroy(!0), this._cachedSprite = null) } }, i.DisplayObject.prototype.displayObjectUpdateTransform = i.DisplayObject.prototype.updateTransform, Object.defineProperties(i.DisplayObject.prototype, { x: { get: function () { return this.position.x }, set: function (t) { this.position.x = t } }, y: { get: function () { return this.position.y }, set: function (t) { this.position.y = t } }, worldVisible: { get: function () { if (this.visible) { var t = this.parent; if (!t) return this.visible; do { if (!t.visible) return !1; t = t.parent } while (t); return !0 } return !1 } }, mask: { get: function () { return this._mask }, set: function (t) { this._mask && (this._mask.isMask = !1), this._mask = t, t && (this._mask.isMask = !0) } }, filters: { get: function () { return this._filters }, set: function (t) { if (Array.isArray(t)) { for (var e = [], r = 0; r < t.length; r++)for (var n = t[r].passes, s = 0; s < n.length; s++)e.push(n[s]); this._filterBlock = { target: this, filterPasses: e } } this._filters = t, this.blendMode && this.blendMode === i.blendModes.MULTIPLY && (this.blendMode = i.blendModes.NORMAL) } }, cacheAsBitmap: { get: function () { return this._cacheAsBitmap }, set: function (t) { this._cacheAsBitmap !== t && (t ? this._generateCachedSprite() : this._destroyCachedSprite(), this._cacheAsBitmap = t) } } }), i.DisplayObjectContainer = function () { i.DisplayObject.call(this), this.children = [], this.ignoreChildInput = !1 }, i.DisplayObjectContainer.prototype = Object.create(i.DisplayObject.prototype), i.DisplayObjectContainer.prototype.constructor = i.DisplayObjectContainer, i.DisplayObjectContainer.prototype.addChild = function (t) { return this.addChildAt(t, this.children.length) }, i.DisplayObjectContainer.prototype.addChildAt = function (t, e) { if (e >= 0 && e <= this.children.length) return t.parent && t.parent.removeChild(t), t.parent = this, this.children.splice(e, 0, t), t; throw new Error(t + "addChildAt: The index " + e + " supplied is out of bounds " + this.children.length) }, i.DisplayObjectContainer.prototype.swapChildren = function (t, e) { if (t !== e) { var i = this.getChildIndex(t), r = this.getChildIndex(e); if (i < 0 || r < 0) throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller."); this.children[i] = e, this.children[r] = t } }, i.DisplayObjectContainer.prototype.getChildIndex = function (t) { var e = this.children.indexOf(t); if (-1 === e) throw new Error("The supplied DisplayObject must be a child of the caller"); return e }, i.DisplayObjectContainer.prototype.setChildIndex = function (t, e) { if (e < 0 || e >= this.children.length) throw new Error("The supplied index is out of bounds"); var i = this.getChildIndex(t); this.children.splice(i, 1), this.children.splice(e, 0, t) }, i.DisplayObjectContainer.prototype.getChildAt = function (t) { if (t < 0 || t >= this.children.length) throw new Error("getChildAt: Supplied index " + t + " does not exist in the child list, or the supplied DisplayObject must be a child of the caller"); return this.children[t] }, i.DisplayObjectContainer.prototype.removeChild = function (t) { var e = this.children.indexOf(t); if (-1 !== e) return this.removeChildAt(e) }, i.DisplayObjectContainer.prototype.removeChildAt = function (t) { var e = this.getChildAt(t); return e && (e.parent = void 0, this.children.splice(t, 1)), e }, i.DisplayObjectContainer.prototype.removeChildren = function (t, e) { void 0 === t && (t = 0), void 0 === e && (e = this.children.length); var i = e - t; if (i > 0 && i <= e) { for (var r = this.children.splice(t, i), n = 0; n < r.length; n++) { r[n].parent = void 0 } return r } if (0 === i && 0 === this.children.length) return []; throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range") }, i.DisplayObjectContainer.prototype.updateTransform = function () { if (this.visible && (this.displayObjectUpdateTransform(), !this._cacheAsBitmap)) for (var t = 0; t < this.children.length; t++)this.children[t].updateTransform() }, i.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform = i.DisplayObjectContainer.prototype.updateTransform, i.DisplayObjectContainer.prototype.getBounds = function (t) { var e, r = t && t instanceof i.DisplayObject, n = !0; if (r ? n = t instanceof i.DisplayObjectContainer && t.contains(this) : t = this, r) { var s = t.worldTransform; for (t.worldTransform = Phaser.identityMatrix, e = 0; e < t.children.length; e++)t.children[e].updateTransform() } var o, a, h, u = 1 / 0, l = 1 / 0, c = -1 / 0, d = -1 / 0, p = !1; for (e = 0; e < this.children.length; e++) { this.children[e].visible && (p = !0, u = u < (o = this.children[e].getBounds()).x ? u : o.x, l = l < o.y ? l : o.y, a = o.width + o.x, h = o.height + o.y, c = c > a ? c : a, d = d > h ? d : h) } var f = this._bounds; if (!p) { var g = (f = new i.Rectangle).x, m = f.width + f.x, v = f.y, y = f.height + f.y, x = this.worldTransform, _ = x.a, b = x.b, T = x.c, w = x.d, S = x.tx, C = x.ty, P = _ * m + T * y + S, E = w * y + b * m + C, A = _ * g + T * y + S, R = w * y + b * g + C, M = _ * g + T * v + S, L = w * v + b * g + C, I = _ * m + T * v + S, O = w * v + b * m + C; c = P, d = E, l = E, u = I < (u = M < (u = A < (u = P) ? A : u) ? M : u) ? I : u, l = O < (l = L < (l = R < l ? R : l) ? L : l) ? O : l, c = I > (c = M > (c = A > c ? A : c) ? M : c) ? I : c, d = O > (d = L > (d = R > d ? R : d) ? L : d) ? O : d } if (f.x = u, f.y = l, f.width = c - u, f.height = d - l, r) for (t.worldTransform = s, e = 0; e < t.children.length; e++)t.children[e].updateTransform(); if (!n) { var D = t.getBounds(); f.x -= D.x, f.y -= D.y } return f }, i.DisplayObjectContainer.prototype.getLocalBounds = function () { return this.getBounds(this) }, i.DisplayObjectContainer.prototype.contains = function (t) { return !!t && (t === this || this.contains(t.parent)) }, i.DisplayObjectContainer.prototype._renderWebGL = function (t) { var e; if (this.visible && !(this.alpha <= 0)) if (this._cacheAsBitmap) this._renderCachedSprite(t); else if (this._mask || this._filters) { for (this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(t); t.spriteBatch.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), t.spriteBatch.start() } else for (e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(t) }, i.DisplayObjectContainer.prototype._renderCanvas = function (t) { if (!1 !== this.visible && 0 !== this.alpha) if (this._cacheAsBitmap) this._renderCachedSprite(t); else { this._mask && t.maskManager.pushMask(this._mask, t); for (var e = 0; e < this.children.length; e++)this.children[e]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } }, Object.defineProperty(i.DisplayObjectContainer.prototype, "width", { get: function () { return this.getLocalBounds().width * this.scale.x }, set: function (t) { var e = this.getLocalBounds().width; this.scale.x = 0 !== e ? t / e : 1, this._width = t } }), Object.defineProperty(i.DisplayObjectContainer.prototype, "height", { get: function () { return this.getLocalBounds().height * this.scale.y }, set: function (t) { var e = this.getLocalBounds().height; this.scale.y = 0 !== e ? t / e : 1, this._height = t } }), i.Sprite = function (t) { i.DisplayObjectContainer.call(this), this.anchor = new i.Point(i.Sprite.defaultAnchor.x, i.Sprite.defaultAnchor.y), this.texture = t || i.Texture.emptyTexture, this._width = 0, this._height = 0, this.tint = 16777215, this.cachedTint = -1, this.tintedTexture = null, this.blendMode = i.blendModes.NORMAL, this.shader = null, this.exists = !0, this.texture.baseTexture.hasLoaded && this.onTextureUpdate(), this.renderable = !0 }, i.Sprite.defaultAnchor = { x: 0, y: 0 }, i.Sprite.prototype = Object.create(i.DisplayObjectContainer.prototype), i.Sprite.prototype.constructor = i.Sprite, Object.defineProperty(i.Sprite.prototype, "width", { get: function () { return this.scale.x * this.texture.frame.width }, set: function (t) { this.scale.x = t / this.texture.frame.width, this._width = t } }), Object.defineProperty(i.Sprite.prototype, "height", { get: function () { return this.scale.y * this.texture.frame.height }, set: function (t) { this.scale.y = t / this.texture.frame.height, this._height = t } }), i.Sprite.prototype.setTexture = function (t, e) { e && this.texture.baseTexture.destroy(), this.texture.baseTexture.skipRender = !1, this.texture = t, this.texture.valid = !0, this.cachedTint = -1 }, i.Sprite.prototype.onTextureUpdate = function () { this._width && (this.scale.x = this._width / this.texture.frame.width), this._height && (this.scale.y = this._height / this.texture.frame.height) }, i.Sprite.prototype.getBounds = function (t) { var e = this.texture.frame.width, i = this.texture.frame.height, r = e * (1 - this.anchor.x), n = e * -this.anchor.x, s = i * (1 - this.anchor.y), o = i * -this.anchor.y, a = t || this.worldTransform, h = a.a, u = a.b, l = a.c, c = a.d, d = a.tx, p = a.ty, f = -1 / 0, g = -1 / 0, m = 1 / 0, v = 1 / 0; if (0 === u && 0 === l) { if (h < 0) { h *= -1; var y = r; r = -n, n = -y } if (c < 0) { c *= -1; y = s; s = -o, o = -y } m = h * n + d, f = h * r + d, v = c * o + p, g = c * s + p } else { var x = h * n + l * o + d, _ = c * o + u * n + p, b = h * r + l * o + d, T = c * o + u * r + p, w = h * r + l * s + d, S = c * s + u * r + p, C = h * n + l * s + d, P = c * s + u * n + p; m = C < (m = w < (m = b < (m = x < m ? x : m) ? b : m) ? w : m) ? C : m, v = P < (v = S < (v = T < (v = _ < v ? _ : v) ? T : v) ? S : v) ? P : v, f = C > (f = w > (f = b > (f = x > f ? x : f) ? b : f) ? w : f) ? C : f, g = P > (g = S > (g = T > (g = _ > g ? _ : g) ? T : g) ? S : g) ? P : g } var E = this._bounds; return E.x = m, E.width = f - m, E.y = v, E.height = g - v, this._currentBounds = E, E }, i.Sprite.prototype.getLocalBounds = function () { var t = this.worldTransform; this.worldTransform = Phaser.identityMatrix; for (var e = 0; e < this.children.length; e++)this.children[e].updateTransform(); var i = this.getBounds(); for (this.worldTransform = t, e = 0; e < this.children.length; e++)this.children[e].updateTransform(); return i }, i.Sprite.prototype._renderWebGL = function (t, e) { if (this.visible && !(this.alpha <= 0) && this.renderable) { var i = this.worldTransform; if (e && (i = e), this._mask || this._filters) { var r = t.spriteBatch; this._filters && (r.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (r.stop(), t.maskManager.pushMask(this.mask, t), r.start()), r.render(this); for (var n = 0; n < this.children.length; n++)this.children[n]._renderWebGL(t); r.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), r.start() } else { t.spriteBatch.render(this); for (n = 0; n < this.children.length; n++)this.children[n]._renderWebGL(t, i) } } }, i.Sprite.prototype._renderCanvas = function (t, e) { if (!(!this.visible || 0 === this.alpha || !this.renderable || this.texture.crop.width <= 0 || this.texture.crop.height <= 0)) { var r = this.worldTransform; if (e && (r = e), this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, t.context.globalCompositeOperation = i.blendModesCanvas[t.currentBlendMode]), this._mask && t.maskManager.pushMask(this._mask, t), this.texture.valid) { var n = this.texture.baseTexture.resolution / t.resolution; t.context.globalAlpha = this.worldAlpha, t.smoothProperty && t.scaleMode !== this.texture.baseTexture.scaleMode && (t.scaleMode = this.texture.baseTexture.scaleMode, t.context[t.smoothProperty] = t.scaleMode === i.scaleModes.LINEAR); var s = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width, o = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height, a = r.tx * t.resolution + t.shakeX, h = r.ty * t.resolution + t.shakeY, u = this.texture.crop.width, l = this.texture.crop.height; if (this.texture.rotated) { var c = r.a, d = r.b, p = r.c, f = r.d, g = u; a = r.c * l + a, h = r.d * l + h, r.a = 6.123233995736766e-17 * c - p, r.b = 6.123233995736766e-17 * d - f, r.c = c + 6.123233995736766e-17 * p, r.d = d + 6.123233995736766e-17 * f, u = l, l = g } if (t.roundPixels ? (t.context.setTransform(r.a, r.b, r.c, r.d, 0 | a, 0 | h), s |= 0, o |= 0) : t.context.setTransform(r.a, r.b, r.c, r.d, a, h), s /= n, o /= n, 16777215 !== this.tint) (this.texture.requiresReTint || this.cachedTint !== this.tint) && (this.tintedTexture = i.CanvasTinter.getTintedTexture(this, this.tint), this.cachedTint = this.tint, this.texture.requiresReTint = !1), t.context.drawImage(this.tintedTexture, 0, 0, u, l, s, o, u / n, l / n); else { var m = this.texture.crop.x, v = this.texture.crop.y; u = Math.floor(u), l = Math.floor(l), t.context.drawImage(this.texture.baseTexture.source, m, v, u, l, s, o, u / n, l / n) } for (y = 0; y < this.children.length; y++)this.children[y]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } else { for (var y = 0; y < this.children.length; y++)this.children[y]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } } }, i.initDefaultShaders = function () { }, i.CompileVertexShader = function (t, e) { return i._CompileShader(t, e, t.VERTEX_SHADER) }, i.CompileFragmentShader = function (t, e) { return i._CompileShader(t, e, t.FRAGMENT_SHADER) }, i._CompileShader = function (t, e, i) { var r = e; Array.isArray(e) && (r = e.join("\n")); var n = t.createShader(i); return t.shaderSource(n, r), t.compileShader(n), t.getShaderParameter(n, t.COMPILE_STATUS) ? n : (window.console.log(t.getShaderInfoLog(n)), null) }, i.compileProgram = function (t, e, r) { var n = i.CompileFragmentShader(t, r), s = i.CompileVertexShader(t, e), o = t.createProgram(); return t.attachShader(o, s), t.attachShader(o, n), t.linkProgram(o), t.getProgramParameter(o, t.LINK_STATUS) || (window.console.log(t.getProgramInfoLog(o)), window.console.log("Could not initialise shaders")), o }, i.PixiShader = function (t) { this._UID = Phaser._UID++ , this.gl = t, this.program = null, this.fragmentSrc = null, this.textureCount = 0, this.firstRun = !0, this.dirty = !0, this.attributes = [], this.init() }, i.PixiShader.prototype.constructor = i.PixiShader, i.PixiShader.prototype.initMultitexShader = function () { var t = this.gl; this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS); for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) {gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) * vColor;return;}\n"; this.fragmentSrc = ["// PixiShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) { gl_FragColor = RED;return;}", "}"]; var n = i.compileProgram(t, this.vertexSrc || i.PixiShader.defaultVertexSrc, this.fragmentSrc); t.useProgram(n), this.uSamplerArray = t.getUniformLocation(n, "uSamplerArray[0]"), this.projectionVector = t.getUniformLocation(n, "projectionVector"), this.offsetVector = t.getUniformLocation(n, "offsetVector"), this.dimensions = t.getUniformLocation(n, "dimensions"), this.aVertexPosition = t.getAttribLocation(n, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(n, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(n, "aColor"), this.aTextureIndex = t.getAttribLocation(n, "aTextureIndex"); var s = [], o = t.createTexture(); t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, o), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null); for (var a = 0; a < this.MAX_TEXTURES; ++a)t.activeTexture(t.TEXTURE0 + a), t.bindTexture(t.TEXTURE_2D, o), s.push(a); for (var h in t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSamplerArray, s), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.uniforms) this.uniforms[h].uniformLocation = t.getUniformLocation(n, h); this.initUniforms(), this.program = n }, i.PixiShader.prototype.initDefaultShader = function () { null === this.fragmentSrc && (this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"]); var t = this.gl, e = i.compileProgram(t, this.vertexSrc || i.PixiShader.defaultVertexSrc, this.fragmentSrc); for (var r in t.useProgram(e), this.uSampler = t.getUniformLocation(e, "uSampler"), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.dimensions = t.getUniformLocation(e, "dimensions"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.uniforms) this.uniforms[r].uniformLocation = t.getUniformLocation(e, r); this.initUniforms(), this.program = e }, i.PixiShader.prototype.init = function (t) { i._enableMultiTextureToggle && !t ? this.initMultitexShader() : this.initDefaultShader() }, i.PixiShader.prototype.initUniforms = function () { this.textureCount = 1; var t, e = this.gl; for (var i in this.uniforms) { var r = (t = this.uniforms[i]).type; "sampler2D" === r ? (t._init = !1, null !== t.value && this.initSampler2D(t)) : "mat2" === r || "mat3" === r || "mat4" === r ? (t.glMatrix = !0, t.glValueLength = 1, "mat2" === r ? t.glFunc = e.uniformMatrix2fv : "mat3" === r ? t.glFunc = e.uniformMatrix3fv : "mat4" === r && (t.glFunc = e.uniformMatrix4fv)) : (t.glFunc = e["uniform" + r], t.glValueLength = "2f" === r || "2i" === r ? 2 : "3f" === r || "3i" === r ? 3 : "4f" === r || "4i" === r ? 4 : 1) } }, i.PixiShader.prototype.initSampler2D = function (t) { if (t.value && t.value.baseTexture && t.value.baseTexture.hasLoaded) { var e = this.gl; if (e.activeTexture(e.TEXTURE0 + this.textureCount), e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), t.textureData) { var i = t.textureData, r = i.magFilter ? i.magFilter : e.LINEAR, n = i.minFilter ? i.minFilter : e.LINEAR, s = i.wrapS ? i.wrapS : e.CLAMP_TO_EDGE, o = i.wrapT ? i.wrapT : e.CLAMP_TO_EDGE, a = i.luminance ? e.LUMINANCE : e.RGBA; if (i.repeat && (s = e.REPEAT, o = e.REPEAT), e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !!i.flipY), i.width) { var h = i.width ? i.width : 512, u = i.height ? i.height : 2, l = i.border ? i.border : 0; e.texImage2D(e.TEXTURE_2D, 0, a, h, u, l, a, e.UNSIGNED_BYTE, null) } else e.texImage2D(e.TEXTURE_2D, 0, a, e.RGBA, e.UNSIGNED_BYTE, t.value.baseTexture.source); e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, r), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, n), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, s), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, o) } e.uniform1i(t.uniformLocation, this.textureCount), t._init = !0, this.textureCount++ } }, i.PixiShader.prototype.syncUniforms = function () { var t; this.textureCount = 1; var e = this.gl; for (var r in this.uniforms) 1 === (t = this.uniforms[r]).glValueLength ? !0 === t.glMatrix ? t.glFunc.call(e, t.uniformLocation, t.transpose, t.value) : t.glFunc.call(e, t.uniformLocation, t.value) : 2 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y) : 3 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z) : 4 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z, t.value.w) : "sampler2D" === t.type && (t._init ? (e.activeTexture(e["TEXTURE" + this.textureCount]), t.value.baseTexture._dirty[e.id] ? i.instances[e.id].updateTexture(t.value.baseTexture) : e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), e.uniform1i(t.uniformLocation, this.textureCount), this.textureCount++) : this.initSampler2D(t)) }, i.PixiShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null }, i.PixiShader.defaultVertexSrc = ["// PixiShader Vertex Shader", "// With multi-texture rendering", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec4 aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   if (aTextureIndex > 0.0) gl_Position = vec4(0.0);", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = vec4(aColor.rgb * aColor.a, aColor.a);", "   vTextureIndex = aTextureIndex;", "}"], i.PixiFastShader = function (t) { if (this._UID = Phaser._UID++ , this.gl = t, this.program = null, i._enableMultiTextureToggle) { t = this.gl; this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS); for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) { gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) * vColor;return;}\n"; this.fragmentSrc = ["// PixiFastShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}", "}"] } else this.fragmentSrc = ["// PixiFastShader Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}"]; this.vertexSrc = ["// PixiFastShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "   vColor = aColor;", "}"], this.textureCount = 0, this.init() }, i.PixiFastShader.prototype.constructor = i.PixiFastShader, i.PixiFastShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); if (t.useProgram(e), this.uSampler = i._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), i._enableMultiTextureToggle) { var r = [], n = t.createTexture(); t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null); for (var s = 0; s < this.MAX_TEXTURES; ++s)t.activeTexture(t.TEXTURE0 + s), t.bindTexture(t.TEXTURE_2D, n), r.push(s); t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, r) } this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.dimensions = t.getUniformLocation(e, "dimensions"), this.uMatrix = t.getUniformLocation(e, "uMatrix"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aPositionCoord = t.getAttribLocation(e, "aPositionCoord"), this.aScale = t.getAttribLocation(e, "aScale"), this.aRotation = t.getAttribLocation(e, "aRotation"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.program = e }, i.PixiFastShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null }, i.StripShader = function (t) { if (this._UID = Phaser._UID++ , this.gl = t, this.program = null, i._enableMultiTextureToggle) { t = this.gl; this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS); for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord);return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) { gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) ;return;}\n"; this.fragmentSrc = ["//StripShader Fragment Shader.", "precision mediump float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}", "}"] } else this.fragmentSrc = ["//StripShader Fragment Shader.", "precision mediump float;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "}"]; this.vertexSrc = ["//StripShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute float aTextureIndex;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "}"], this.init() }, i.StripShader.prototype.constructor = i.StripShader, i.StripShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); if (t.useProgram(e), this.uSampler = i._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), i._enableMultiTextureToggle) { var r = [], n = t.createTexture(); t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null); for (var s = 0; s < this.MAX_TEXTURES; ++s)t.activeTexture(t.TEXTURE0 + s), t.bindTexture(t.TEXTURE_2D, n), r.push(s); t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, r) } this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.aTextureIndex], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e }, i.StripShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null }, i.PrimitiveShader = function (t) { this._UID = Phaser._UID++ , this.gl = t, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform float flipY;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}"], this.init() }, i.PrimitiveShader.prototype.constructor = i.PrimitiveShader, i.PrimitiveShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e }, i.PrimitiveShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null }, i.ComplexPrimitiveShader = function (t) { this._UID = Phaser._UID++ , this.gl = t, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "uniform float flipY;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}"], this.init() }, i.ComplexPrimitiveShader.prototype.constructor = i.ComplexPrimitiveShader, i.ComplexPrimitiveShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), this.color = t.getUniformLocation(e, "color"), this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e }, i.ComplexPrimitiveShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null }, i.glContexts = [], i.instances = [], i._enableMultiTextureToggle = !1, i.WebGLRenderer = function (t, e) { this.game = t, i.defaultRenderer || (i.defaultRenderer = this), this.extensions = {}, this.type = Phaser.WEBGL, this.resolution = t.resolution, this.transparent = t.transparent, this.autoResize = !1, this.preserveDrawingBuffer = t.preserveDrawingBuffer, this.clearBeforeRender = t.clearBeforeRender, this.width = t.width, this.height = t.height, this.view = t.canvas, this._contextOptions = { alpha: this.transparent, antialias: t.antialias, failIfMajorPerformanceCaveat: e.failIfMajorPerformanceCaveat, premultipliedAlpha: this.transparent && "notMultiplied" !== this.transparent, stencil: !0, preserveDrawingBuffer: this.preserveDrawingBuffer }, this.projection = new i.Point, this.offset = new i.Point, this.shaderManager = new i.WebGLShaderManager, this.spriteBatch = new i.WebGLSpriteBatch(t), this.maskManager = new i.WebGLMaskManager, this.filterManager = new i.WebGLFilterManager, this.stencilManager = new i.WebGLStencilManager, this.blendModeManager = new i.WebGLBlendModeManager, this.renderSession = {}, this.currentBatchedTextures = [], this.renderSession.game = this.game, this.renderSession.gl = this.gl, this.renderSession.drawCount = 0, this.renderSession.shaderManager = this.shaderManager, this.renderSession.maskManager = this.maskManager, this.renderSession.filterManager = this.filterManager, this.renderSession.blendModeManager = this.blendModeManager, this.renderSession.spriteBatch = this.spriteBatch, this.renderSession.stencilManager = this.stencilManager, this.renderSession.renderer = this, this.renderSession.resolution = this.resolution, this.renderSession.roundPixels = e.roundPixels || !1, this.renderSession.maxTextureAvailableSpace = null, this.initContext(), this.mapBlendModes() }, i.WebGLRenderer.prototype.constructor = i.WebGLRenderer, i.WebGLRenderer.prototype.initContext = function () { var t = this.view.getContext("webgl", this._contextOptions) || this.view.getContext("experimental-webgl", this._contextOptions); if (this.gl = t, !t) throw new Error("This browser does not support webGL. Try using the canvas renderer"); this.maxTextures = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.maxTextureSize = this.gl.getParameter(t.MAX_TEXTURE_SIZE), this.glContextId = t.id = i.WebGLRenderer.glContextId++ , i.glContexts[this.glContextId] = t, i.instances[this.glContextId] = this, t.disable(t.DEPTH_TEST), t.disable(t.CULL_FACE), t.enable(t.BLEND), this.shaderManager.setContext(t), this.spriteBatch.setContext(t), this.maskManager.setContext(t), this.filterManager.setContext(t), this.blendModeManager.setContext(t), this.stencilManager.setContext(t), this.renderSession.gl = this.gl, this.resize(this.width, this.height), this.extensions.compression = {}; var e = t.getExtension("WEBGL_compressed_texture_etc1") || t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"), r = t.getExtension("WEBGL_compressed_texture_pvrtc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"), n = t.getExtension("WEBGL_compressed_texture_s3tc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"); e && (this.extensions.compression.ETC1 = e), r && (this.extensions.compression.PVRTC = r), n && (this.extensions.compression.S3TC = n) }, i.WebGLRenderer.prototype.setTexturePriority = function (t) { if (i._enableMultiTextureToggle) { for (var e = function (t) { return --t, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, t |= t >> 16, ++t }, r = this.gl, n = r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS), s = r.getParameter(r.MAX_TEXTURE_SIZE), o = this.game.cache._cache.image, a = null, h = 0; h < this.currentBatchedTextures.length; h++)(a = this.currentBatchedTextures[h]) in o ? o[a].base.textureIndex = 0 : console.warn('setTexturePriority: There is no image "%s" in the image cache.', a); var u = s - e(Math.max(this.width, this.height)); this.currentBatchedTextures.length = 0; for (var l = 0; l < t.length; ++l)if ((a = t[l]) in o) { var c = o[a].base; (u -= e(Math.max(c.width, c.height))) <= 0 ? (c.textureIndex = 0, console.warn('setTexturePriority: Image "%s" was given textureIndex=0 because there is no available texture space (%s).', a, u)) : c.textureIndex = 1 + l % (n - 1), this.currentBatchedTextures.push(a) } else console.warn('setTexturePriority: There is no image "%s" in the image cache.', a); return this.renderSession.maxTextureAvailableSpace = u, this.currentBatchedTextures } console.warn("setTexturePriority error: Multi Texture support hasn't been enabled in the Phaser Game Config.") }, i.WebGLRenderer.prototype.render = function (t) { if (!this.contextLost) { var e = this.gl; e.viewport(0, 0, this.width, this.height), e.bindFramebuffer(e.FRAMEBUFFER, null), this.game.clearBeforeRender && (e.clearColor(t._bgColor.r, t._bgColor.g, t._bgColor.b, t._bgColor.a), e.clear(e.COLOR_BUFFER_BIT)), this.offset.x = this.game.camera._shake.x, this.offset.y = this.game.camera._shake.y, this.renderDisplayObject(t, this.projection) } }, i.WebGLRenderer.prototype.renderDisplayObject = function (t, e, r, n) { this.renderSession.blendModeManager.setBlendMode(i.blendModes.NORMAL), this.renderSession.drawCount = 0, this.renderSession.flipY = r ? -1 : 1, this.renderSession.projection = e, this.renderSession.offset = this.offset, this.spriteBatch.begin(this.renderSession), this.filterManager.begin(this.renderSession, r), t._renderWebGL(this.renderSession, n), this.spriteBatch.end() }, i.WebGLRenderer.prototype.resize = function (t, e) { this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.gl.viewport(0, 0, this.width, this.height), this.projection.x = this.width / 2 / this.resolution, this.projection.y = -this.height / 2 / this.resolution }, i.WebGLRenderer.prototype.updateCompressedTexture = function (t) { if (!t.hasLoaded) return !1; var e = this.gl, r = t.source; return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.compressedTexImage2D(e.TEXTURE_2D, 0, r.glExtensionFormat, r.width, r.height, 0, r.textureData), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), t._dirty[e.id] = !1, !0 }, i.WebGLRenderer.prototype.updateTexture = function (t) { if (!t.hasLoaded) return !1; if (t.source.compressionAlgorithm) return this.updateCompressedTexture(t); var e = this.gl; return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t.premultipliedAlpha), e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, t.source), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), t._dirty[e.id] = !1, !0 }, i.WebGLRenderer.prototype.destroy = function () { i.glContexts[this.glContextId] = null, this.projection = null, this.offset = null, this.shaderManager.destroy(), this.spriteBatch.destroy(), this.maskManager.destroy(), this.filterManager.destroy(), this.shaderManager = null, this.spriteBatch = null, this.maskManager = null, this.filterManager = null, this.gl = null, this.renderSession = null, Phaser.CanvasPool.remove(this), i.instances[this.glContextId] = null, i.WebGLRenderer.glContextId-- }, i.WebGLRenderer.prototype.mapBlendModes = function () { var t = this.gl; if (!i.blendModesWebGL) { var e = [], r = i.blendModes; e[r.NORMAL] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.ADD] = [t.SRC_ALPHA, t.DST_ALPHA], e[r.MULTIPLY] = [t.DST_COLOR, t.ONE_MINUS_SRC_ALPHA], e[r.SCREEN] = [t.SRC_ALPHA, t.ONE], e[r.OVERLAY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.DARKEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.LIGHTEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.COLOR_DODGE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.COLOR_BURN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.HARD_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.SOFT_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.DIFFERENCE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.EXCLUSION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.HUE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.SATURATION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.COLOR] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.LUMINOSITY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], i.blendModesWebGL = e } }, i.WebGLRenderer.prototype.getMaxTextureUnit = function () { var t = this.gl; return t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS) }, i.enableMultiTexture = function () { i._enableMultiTextureToggle = !0 }, i.WebGLRenderer.glContextId = 0, i.WebGLRenderer.textureArray = [], i.WebGLBlendModeManager = function () { this.currentBlendMode = 99999 }, i.WebGLBlendModeManager.prototype.constructor = i.WebGLBlendModeManager, i.WebGLBlendModeManager.prototype.setContext = function (t) { this.gl = t }, i.WebGLBlendModeManager.prototype.setBlendMode = function (t) { if (this.currentBlendMode === t) return !1; this.currentBlendMode = t; var e = i.blendModesWebGL[this.currentBlendMode]; return e && this.gl.blendFunc(e[0], e[1]), !0 }, i.WebGLBlendModeManager.prototype.destroy = function () { this.gl = null }, i.WebGLMaskManager = function () { }, i.WebGLMaskManager.prototype.constructor = i.WebGLMaskManager, i.WebGLMaskManager.prototype.setContext = function (t) { this.gl = t }, i.WebGLMaskManager.prototype.pushMask = function (t, e) { var r = e.gl; t.dirty && i.WebGLGraphics.updateGraphics(t, r), void 0 !== t._webGL[r.id] && void 0 !== t._webGL[r.id].data && 0 !== t._webGL[r.id].data.length && e.stencilManager.pushStencil(t, t._webGL[r.id].data[0], e) }, i.WebGLMaskManager.prototype.popMask = function (t, e) { var i = this.gl; void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.popStencil(t, t._webGL[i.id].data[0], e) }, i.WebGLMaskManager.prototype.destroy = function () { this.gl = null }, i.WebGLStencilManager = function () { this.stencilStack = [], this.reverse = !0, this.count = 0 }, i.WebGLStencilManager.prototype.setContext = function (t) { this.gl = t }, i.WebGLStencilManager.prototype.pushStencil = function (t, e, i) { var r = this.gl; this.bindGraphics(t, e, i), 0 === this.stencilStack.length && (r.enable(r.STENCIL_TEST), r.clear(r.STENCIL_BUFFER_BIT), this.reverse = !0, this.count = 0), this.stencilStack.push(e); var n = this.count; r.colorMask(!1, !1, !1, !1), r.stencilFunc(r.ALWAYS, 0, 255), r.stencilOp(r.KEEP, r.KEEP, r.INVERT), 1 === e.mode ? (r.drawElements(r.TRIANGLE_FAN, e.indices.length - 4, r.UNSIGNED_SHORT, 0), this.reverse ? (r.stencilFunc(r.EQUAL, 255 - n, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)) : (r.stencilFunc(r.EQUAL, n, 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)), r.drawElements(r.TRIANGLE_FAN, 4, r.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), this.reverse ? r.stencilFunc(r.EQUAL, 255 - (n + 1), 255) : r.stencilFunc(r.EQUAL, n + 1, 255), this.reverse = !this.reverse) : (this.reverse ? (r.stencilFunc(r.EQUAL, n, 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)) : (r.stencilFunc(r.EQUAL, 255 - n, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)), r.drawElements(r.TRIANGLE_STRIP, e.indices.length, r.UNSIGNED_SHORT, 0), this.reverse ? r.stencilFunc(r.EQUAL, n + 1, 255) : r.stencilFunc(r.EQUAL, 255 - (n + 1), 255)), r.colorMask(!0, !0, !0, !0), r.stencilOp(r.KEEP, r.KEEP, r.KEEP), this.count++ }, i.WebGLStencilManager.prototype.bindGraphics = function (t, e, i) { this._currentGraphics = t; var r, n = this.gl, s = i.projection, o = i.offset; 1 === e.mode ? (r = i.shaderManager.complexPrimitiveShader, i.shaderManager.setShader(r), n.uniform1f(r.flipY, i.flipY), n.uniformMatrix3fv(r.translationMatrix, !1, t.worldTransform.toArray(!0)), n.uniform2f(r.projectionVector, s.x, -s.y), n.uniform2f(r.offsetVector, -o.x, -o.y), n.uniform3fv(r.tintColor, Phaser.Color.hexToRGBArray(t.tint)), n.uniform3fv(r.color, e.color), n.uniform1f(r.alpha, t.worldAlpha * e.alpha), n.bindBuffer(n.ARRAY_BUFFER, e.buffer), n.vertexAttribPointer(r.aVertexPosition, 2, n.FLOAT, !1, 8, 0), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer)) : (r = i.shaderManager.primitiveShader, i.shaderManager.setShader(r), n.uniformMatrix3fv(r.translationMatrix, !1, t.worldTransform.toArray(!0)), n.uniform1f(r.flipY, i.flipY), n.uniform2f(r.projectionVector, s.x, -s.y), n.uniform2f(r.offsetVector, -o.x, -o.y), n.uniform3fv(r.tintColor, Phaser.Color.hexToRGBArray(t.tint)), n.uniform1f(r.alpha, t.worldAlpha), n.bindBuffer(n.ARRAY_BUFFER, e.buffer), n.vertexAttribPointer(r.aVertexPosition, 2, n.FLOAT, !1, 24, 0), n.vertexAttribPointer(r.colorAttribute, 4, n.FLOAT, !1, 24, 8), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer)) }, i.WebGLStencilManager.prototype.popStencil = function (t, e, i) { var r = this.gl; if (this.stencilStack.pop(), this.count-- , 0 === this.stencilStack.length) r.disable(r.STENCIL_TEST); else { var n = this.count; this.bindGraphics(t, e, i), r.colorMask(!1, !1, !1, !1), 1 === e.mode ? (this.reverse = !this.reverse, this.reverse ? (r.stencilFunc(r.EQUAL, 255 - (n + 1), 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)) : (r.stencilFunc(r.EQUAL, n + 1, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)), r.drawElements(r.TRIANGLE_FAN, 4, r.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), r.stencilFunc(r.ALWAYS, 0, 255), r.stencilOp(r.KEEP, r.KEEP, r.INVERT), r.drawElements(r.TRIANGLE_FAN, e.indices.length - 4, r.UNSIGNED_SHORT, 0), this.reverse ? r.stencilFunc(r.EQUAL, n, 255) : r.stencilFunc(r.EQUAL, 255 - n, 255)) : (this.reverse ? (r.stencilFunc(r.EQUAL, n + 1, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)) : (r.stencilFunc(r.EQUAL, 255 - (n + 1), 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)), r.drawElements(r.TRIANGLE_STRIP, e.indices.length, r.UNSIGNED_SHORT, 0), this.reverse ? r.stencilFunc(r.EQUAL, n, 255) : r.stencilFunc(r.EQUAL, 255 - n, 255)), r.colorMask(!0, !0, !0, !0), r.stencilOp(r.KEEP, r.KEEP, r.KEEP) } }, i.WebGLStencilManager.prototype.destroy = function () { this.stencilStack = null, this.gl = null }, i.WebGLShaderManager = function () { this.maxAttibs = 10, this.attribState = [], this.tempAttribState = []; for (var t = 0; t < this.maxAttibs; t++)this.attribState[t] = !1; this.stack = [] }, i.WebGLShaderManager.prototype.constructor = i.WebGLShaderManager, i.WebGLShaderManager.prototype.setContext = function (t) { this.gl = t, this.primitiveShader = new i.PrimitiveShader(t), this.complexPrimitiveShader = new i.ComplexPrimitiveShader(t), this.defaultShader = new i.PixiShader(t), this.fastShader = new i.PixiFastShader(t), this.stripShader = new i.StripShader(t), this.creatureShader = i.CreatureShader ? new i.CreatureShader(t) : null, this.setShader(this.defaultShader) }, i.WebGLShaderManager.prototype.setAttribs = function (t) { var e; for (e = 0; e < this.tempAttribState.length; e++)this.tempAttribState[e] = !1; for (e = 0; e < t.length; e++) { var i = t[e]; this.tempAttribState[i] = !0 } var r = this.gl; for (e = 0; e < this.attribState.length; e++)this.attribState[e] !== this.tempAttribState[e] && (this.attribState[e] = this.tempAttribState[e], this.tempAttribState[e] ? r.enableVertexAttribArray(e) : r.disableVertexAttribArray(e)) }, i.WebGLShaderManager.prototype.setShader = function (t) { return this._currentId !== t._UID && (this._currentId = t._UID, this.currentShader = t, this.gl.useProgram(t.program), this.setAttribs(t.attributes), !0) }, i.WebGLShaderManager.prototype.destroy = function () { this.attribState = null, this.tempAttribState = null, this.primitiveShader.destroy(), this.complexPrimitiveShader.destroy(), this.defaultShader.destroy(), this.fastShader.destroy(), this.stripShader.destroy(), this.creatureShader && this.creatureShader.destroy(), this.gl = null }, i.WebGLSpriteBatch = function (t) { this.game = t, this.vertSize = 5, this.size = 2e3, this.vertexSize = 24; var e = this.vertexSize * this.size * 4, i = 6 * this.size; this.vertices = new ArrayBuffer(e), this.positions = new Float32Array(this.vertices), this.colors = new Uint32Array(this.vertices), this.indices = new Uint16Array(i), this.lastIndexCount = 0; for (var r = 0, n = 0; r < i; r += 6, n += 4)this.indices[r + 0] = n + 0, this.indices[r + 1] = n + 1, this.indices[r + 2] = n + 2, this.indices[r + 3] = n + 0, this.indices[r + 4] = n + 2, this.indices[r + 5] = n + 3; this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.dirty = !0, this.textures = [], this.blendModes = [], this.shaders = [], this.sprites = [], this.defaultShader = null }, i.WebGLSpriteBatch.prototype.setContext = function (t) { if (this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.gl = t, i._enableMultiTextureToggle) { for (var e = "\tif (vTextureIndex == 0.0) {gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) {gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) * vColor;return;}\n"; this.defaultShader = new Phaser.Filter(this.game, void 0, ["//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "void main(void) {", e, "\tgl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;", "}"]) } else this.defaultShader = new Phaser.Filter(this.game, void 0, ["//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}"]); this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW), this.currentBlendMode = 99999; var n = new i.PixiShader(t); n.fragmentSrc = this.defaultShader.fragmentSrc, n.uniforms = {}, n.init(), this.defaultShader.shaders[t.id] = n }, i.WebGLSpriteBatch.prototype.begin = function (t) { this.renderSession = t, this.shader = this.renderSession.shaderManager.defaultShader, this.start() }, i.WebGLSpriteBatch.prototype.end = function () { this.flush() }, i.WebGLSpriteBatch.prototype.render = function (t, e) { var r = t.texture, n = r.baseTexture, s = this.gl; i.WebGLRenderer.textureArray[n.textureIndex] != n && (this.flush(), s.activeTexture(s.TEXTURE0 + n.textureIndex), s.bindTexture(s.TEXTURE_2D, n._glTextures[s.id]), i.WebGLRenderer.textureArray[n.textureIndex] = n); var o = t.worldTransform; e && (o = e), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = r.baseTexture); var a = r._uvs; if (a) { var h, u, l, c, d = t.anchor.x, p = t.anchor.y; if (r.trim) { var f = r.trim; h = (u = f.x - d * f.width) + r.crop.width, l = (c = f.y - p * f.height) + r.crop.height } else h = r.frame.width * (1 - d), u = r.frame.width * -d, l = r.frame.height * (1 - p), c = r.frame.height * -p; var g = this.currentBatchSize * this.vertexSize, m = (this.currentBatchSize, r.baseTexture.resolution), v = r.baseTexture.textureIndex, y = o.a / m, x = o.b / m, _ = o.c / m, b = o.d / m, T = o.tx, w = o.ty, S = (r.crop.width, r.crop.height); if (r.rotated) { var C = o.a, P = o.b, E = o.c, A = o.d, R = u, M = h; T = o.c * S + T, w = o.d * S + w, y = 6.123233995736766e-17 * C - E, x = 6.123233995736766e-17 * P - A, _ = C + 6.123233995736766e-17 * E, b = P + 6.123233995736766e-17 * A, r._updateUvsInverted(), h = l, u = c, l = M, c = R } var L = this.colors, I = this.positions, O = t.tint, D = (O >> 16) + (65280 & O) + ((255 & O) << 16) + (255 * t.worldAlpha << 24); this.renderSession.roundPixels ? (I[g++] = y * u + _ * c + T | 0, I[g++] = b * c + x * u + w | 0, I[g++] = a.x0, I[g++] = a.y0, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * c + T | 0, I[g++] = b * c + x * h + w | 0, I[g++] = a.x1, I[g++] = a.y1, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * l + T | 0, I[g++] = b * l + x * h + w | 0, I[g++] = a.x2, I[g++] = a.y2, L[g++] = D, I[g++] = v, I[g++] = y * u + _ * l + T | 0, I[g++] = b * l + x * u + w | 0, I[g++] = a.x3, I[g++] = a.y3, L[g++] = D, I[g++] = v) : (I[g++] = y * u + _ * c + T, I[g++] = b * c + x * u + w, I[g++] = a.x0, I[g++] = a.y0, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * c + T, I[g++] = b * c + x * h + w, I[g++] = a.x1, I[g++] = a.y1, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * l + T, I[g++] = b * l + x * h + w, I[g++] = a.x2, I[g++] = a.y2, L[g++] = D, I[g++] = v, I[g++] = y * u + _ * l + T, I[g++] = b * l + x * u + w, I[g++] = a.x3, I[g++] = a.y3, L[g++] = D, I[g++] = v), this.sprites[this.currentBatchSize++] = t } }, i.WebGLSpriteBatch.prototype.renderTilingSprite = function (t) { var e = t.tilingTexture, r = e.baseTexture, n = this.gl, s = t.texture.baseTexture.textureIndex; i.WebGLRenderer.textureArray[s] != r && (this.flush(), n.activeTexture(n.TEXTURE0 + s), n.bindTexture(n.TEXTURE_2D, r._glTextures[n.id]), i.WebGLRenderer.textureArray[s] = r), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = e.baseTexture), t._uvs || (t._uvs = new i.TextureUvs); var o = t._uvs, a = e.baseTexture.width, h = e.baseTexture.height; t.tilePosition.x %= a * t.tileScaleOffset.x, t.tilePosition.y %= h * t.tileScaleOffset.y; var u = t.tilePosition.x / (a * t.tileScaleOffset.x), l = t.tilePosition.y / (h * t.tileScaleOffset.y), c = t.width / a / (t.tileScale.x * t.tileScaleOffset.x), d = t.height / h / (t.tileScale.y * t.tileScaleOffset.y); o.x0 = 0 - u, o.y0 = 0 - l, o.x1 = 1 * c - u, o.y1 = 0 - l, o.x2 = 1 * c - u, o.y2 = 1 * d - l, o.x3 = 0 - u, o.y3 = 1 * d - l; var p = t.tint, f = (p >> 16) + (65280 & p) + ((255 & p) << 16) + (255 * t.worldAlpha << 24), g = this.positions, m = this.colors, v = t.width, y = t.height, x = t.anchor.x, _ = t.anchor.y, b = v * (1 - x), T = v * -x, w = y * (1 - _), S = y * -_, C = this.currentBatchSize * this.vertexSize, P = e.baseTexture.resolution, E = t.worldTransform, A = E.a / P, R = E.b / P, M = E.c / P, L = E.d / P, I = E.tx, O = E.ty; g[C++] = A * T + M * S + I, g[C++] = L * S + R * T + O, g[C++] = o.x0, g[C++] = o.y0, m[C++] = f, g[C++] = s, g[C++] = A * b + M * S + I, g[C++] = L * S + R * b + O, g[C++] = o.x1, g[C++] = o.y1, m[C++] = f, g[C++] = s, g[C++] = A * b + M * w + I, g[C++] = L * w + R * b + O, g[C++] = o.x2, g[C++] = o.y2, m[C++] = f, g[C++] = s, g[C++] = A * T + M * w + I, g[C++] = L * w + R * T + O, g[C++] = o.x3, g[C++] = o.y3, m[C++] = f, g[C++] = s, this.sprites[this.currentBatchSize++] = t }, i.WebGLSpriteBatch.prototype.flush = function () { if (0 !== this.currentBatchSize) { var t, e, r, n, s = this.gl; if (this.dirty) { this.dirty = !1, t = this.defaultShader.shaders[s.id], s.activeTexture(s.TEXTURE0), s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, this.indexBuffer); var o = this.vertexSize; s.vertexAttribPointer(t.aVertexPosition, 2, s.FLOAT, !1, o, 0), s.vertexAttribPointer(t.aTextureCoord, 2, s.FLOAT, !1, o, 8), s.vertexAttribPointer(t.colorAttribute, 4, s.UNSIGNED_BYTE, !0, o, 16), s.vertexAttribPointer(t.aTextureIndex, 1, s.FLOAT, !1, o, 20) } if (this.currentBatchSize > .5 * this.size) s.bufferSubData(s.ARRAY_BUFFER, 0, this.vertices); else { s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer); var a = this.positions.subarray(0, this.currentBatchSize * this.vertexSize); s.bufferSubData(s.ARRAY_BUFFER, 0, a) } for (var h, u = 0, l = 0, c = null, d = this.renderSession.blendModeManager.currentBlendMode, p = null, f = !1, g = !1, m = 0, v = this.currentBatchSize; m < v; m++) { e = (h = this.sprites[m]).tilingTexture ? h.tilingTexture.baseTexture : h.texture.baseTexture, f = d !== (r = h.blendMode), g = p !== (n = h.shader || this.defaultShader); var y = e.skipRender; if (y && h.children.length > 0 && (y = !1), (f || g) && (this.renderBatch(c, u, l), l = m, u = 0, c = e, f && (d = r, this.renderSession.blendModeManager.setBlendMode(d)), g)) { (t = (p = n).shaders[s.id]) || ((t = new i.PixiShader(s)).fragmentSrc = p.fragmentSrc, t.uniforms = p.uniforms, t.init(), p.shaders[s.id] = t), this.renderSession.shaderManager.setShader(t), t.dirty && t.syncUniforms(); var x = this.renderSession.projection; s.uniform2f(t.projectionVector, x.x, x.y); var _ = this.renderSession.offset; s.uniform2f(t.offsetVector, _.x, _.y) } u++ } this.renderBatch(c, u, l), this.currentBatchSize = 0 } }, i.WebGLSpriteBatch.prototype.renderBatch = function (t, e, i) { if (0 !== e) { var r = this.gl; if (t._dirty[r.id]) { if (!this.renderSession.renderer.updateTexture(t)) return } else r.bindTexture(r.TEXTURE_2D, t._glTextures[r.id]); r.drawElements(r.TRIANGLES, 6 * e, r.UNSIGNED_SHORT, 6 * i * 2), this.renderSession.drawCount++ } }, i.WebGLSpriteBatch.prototype.stop = function () { this.flush(), this.dirty = !0 }, i.WebGLSpriteBatch.prototype.start = function () { this.dirty = !0 }, i.WebGLSpriteBatch.prototype.destroy = function () { this.vertices = null, this.indices = null, this.gl.deleteBuffer(this.vertexBuffer), this.gl.deleteBuffer(this.indexBuffer), this.currentBaseTexture = null, this.gl = null }, i.WebGLFastSpriteBatch = function (t) { this.vertSize = 11, this.maxSize = 6e3, this.size = this.maxSize; var e = 4 * this.size * this.vertSize, i = 6 * this.maxSize; this.vertices = new Float32Array(e), this.indices = new Uint16Array(i), this.vertexBuffer = null, this.indexBuffer = null, this.lastIndexCount = 0; for (var r = 0, n = 0; r < i; r += 6, n += 4)this.indices[r + 0] = n + 0, this.indices[r + 1] = n + 1, this.indices[r + 2] = n + 2, this.indices[r + 3] = n + 0, this.indices[r + 4] = n + 2, this.indices[r + 5] = n + 3; this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.currentBlendMode = 0, this.renderSession = null, this.shader = null, this.matrix = null, this.setContext(t) }, i.WebGLFastSpriteBatch.prototype.constructor = i.WebGLFastSpriteBatch, i.WebGLFastSpriteBatch.prototype.setContext = function (t) { this.gl = t, this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW) }, i.WebGLFastSpriteBatch.prototype.begin = function (t, e) { this.renderSession = e, this.shader = this.renderSession.shaderManager.fastShader, this.matrix = t.worldTransform.toArray(!0), this.start() }, i.WebGLFastSpriteBatch.prototype.end = function () { this.flush() }, i.WebGLFastSpriteBatch.prototype.render = function (t) { var e = t.children, i = e[0]; if (i.texture._uvs) { this.currentBaseTexture = i.texture.baseTexture, i.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(), this.renderSession.blendModeManager.setBlendMode(i.blendMode)); for (var r = 0, n = e.length; r < n; r++)this.renderSprite(e[r]); this.flush() } }, i.WebGLFastSpriteBatch.prototype.renderSprite = function (t) { var e = t.texture.baseTexture, r = this.gl, n = t.texture.baseTexture.textureIndex; if ((i.WebGLRenderer.textureArray[n] == e || !e._glTextures[r.id] || t.texture.baseTexture.skipRender || (this.flush(), r.activeTexture(r.TEXTURE0 + n), r.bindTexture(r.TEXTURE_2D, e._glTextures[r.id]), i.WebGLRenderer.textureArray[n] = e, t.texture._uvs)) && t.visible) { var s, o, a, h, u, l, c = this.vertices; if (s = t.texture._uvs, t.texture.frame.width, t.texture.frame.height, t.texture.trim) { var d = t.texture.trim; o = (a = d.x - t.anchor.x * d.width) + t.texture.crop.width, h = (u = d.y - t.anchor.y * d.height) + t.texture.crop.height } else o = t.texture.frame.width * (1 - t.anchor.x), a = t.texture.frame.width * -t.anchor.x, h = t.texture.frame.height * (1 - t.anchor.y), u = t.texture.frame.height * -t.anchor.y; l = 4 * this.currentBatchSize * this.vertSize, c[l++] = a, c[l++] = u, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x0, c[l++] = s.y1, c[l++] = t.alpha, c[l++] = n, c[l++] = o, c[l++] = u, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x1, c[l++] = s.y1, c[l++] = t.alpha, c[l++] = n, c[l++] = o, c[l++] = h, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x2, c[l++] = s.y2, c[l++] = t.alpha, c[l++] = n, c[l++] = a, c[l++] = h, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x3, c[l++] = s.y3, c[l++] = t.alpha, c[l++] = n, this.currentBatchSize++ , this.currentBatchSize >= this.size && this.flush() } }, i.WebGLFastSpriteBatch.prototype.flush = function () { if (0 !== this.currentBatchSize) { var t = this.gl; if (this.currentBaseTexture._glTextures[t.id]) { if (this.currentBatchSize > .5 * this.size) t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertices); else { var e = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize); t.bufferSubData(t.ARRAY_BUFFER, 0, e) } t.drawElements(t.TRIANGLES, 6 * this.currentBatchSize, t.UNSIGNED_SHORT, 0), this.currentBatchSize = 0, this.renderSession.drawCount++ } else this.renderSession.renderer.updateTexture(this.currentBaseTexture, t) } }, i.WebGLFastSpriteBatch.prototype.stop = function () { this.flush() }, i.WebGLFastSpriteBatch.prototype.start = function () { var t = this.gl; t.activeTexture(t.TEXTURE0), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer); var e = this.renderSession.projection; t.uniform2f(this.shader.projectionVector, e.x, e.y), t.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix); var i = 4 * this.vertSize; t.vertexAttribPointer(this.shader.aVertexPosition, 2, t.FLOAT, !1, i, 0), t.vertexAttribPointer(this.shader.aPositionCoord, 2, t.FLOAT, !1, i, 8), t.vertexAttribPointer(this.shader.aScale, 2, t.FLOAT, !1, i, 16), t.vertexAttribPointer(this.shader.aRotation, 1, t.FLOAT, !1, i, 24), t.vertexAttribPointer(this.shader.aTextureCoord, 2, t.FLOAT, !1, i, 28), t.vertexAttribPointer(this.shader.colorAttribute, 1, t.FLOAT, !1, i, 36), t.vertexAttribPointer(this.shader.aTextureIndex, 1, t.FLOAT, !1, i, 40) }, i.WebGLFilterManager = function () { this.filterStack = [], this.offsetX = 0, this.offsetY = 0 }, i.WebGLFilterManager.prototype.constructor = i.WebGLFilterManager, i.WebGLFilterManager.prototype.setContext = function (t) { this.gl = t, this.texturePool = [], this.initShaderBuffers() }, i.WebGLFilterManager.prototype.begin = function (t, e) { this.renderSession = t, this.defaultShader = t.shaderManager.defaultShader; var i = this.renderSession.projection; this.width = 2 * i.x, this.height = 2 * -i.y, this.buffer = e }, i.WebGLFilterManager.prototype.pushFilter = function (t) { var e = this.gl, r = this.renderSession.projection, n = this.renderSession.offset; t._filterArea = t.target.filterArea || t.target.getBounds(), t._previous_stencil_mgr = this.renderSession.stencilManager, this.renderSession.stencilManager = new i.WebGLStencilManager, this.renderSession.stencilManager.setContext(e), e.disable(e.STENCIL_TEST), this.filterStack.push(t); var s = t.filterPasses[0]; this.offsetX += t._filterArea.x, this.offsetY += t._filterArea.y; var o = this.texturePool.pop(); o ? o.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution) : o = new i.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), e.bindTexture(e.TEXTURE_2D, o.texture); var a = t._filterArea, h = s.padding; a.x -= h, a.y -= h, a.width += 2 * h, a.height += 2 * h, a.x < 0 && (a.x = 0), a.width > this.width && (a.width = this.width), a.y < 0 && (a.y = 0), a.height > this.height && (a.height = this.height), e.bindFramebuffer(e.FRAMEBUFFER, o.frameBuffer), e.viewport(0, 0, a.width * this.renderSession.resolution, a.height * this.renderSession.resolution), r.x = a.width / 2, r.y = -a.height / 2, n.x = -a.x, n.y = -a.y, e.colorMask(!0, !0, !0, !0), e.clearColor(0, 0, 0, 0), e.clear(e.COLOR_BUFFER_BIT), t._glFilterTexture = o }, i.WebGLFilterManager.prototype.popFilter = function () { var t = this.gl, e = this.filterStack.pop(), r = e._filterArea, n = e._glFilterTexture, s = this.renderSession.projection, o = this.renderSession.offset; if (e.filterPasses.length > 1) { t.viewport(0, 0, r.width * this.renderSession.resolution, r.height * this.renderSession.resolution), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = 0, this.vertexArray[1] = r.height, this.vertexArray[2] = r.width, this.vertexArray[3] = r.height, this.vertexArray[4] = 0, this.vertexArray[5] = 0, this.vertexArray[6] = r.width, this.vertexArray[7] = 0, t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = r.width / this.width, this.uvArray[5] = r.height / this.height, this.uvArray[6] = r.width / this.width, this.uvArray[7] = r.height / this.height, t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray); var a = n, h = this.texturePool.pop(); h || (h = new i.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution)), h.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), t.bindFramebuffer(t.FRAMEBUFFER, h.frameBuffer), t.clear(t.COLOR_BUFFER_BIT), t.disable(t.BLEND); for (var u = 0; u < e.filterPasses.length - 1; u++) { var l = e.filterPasses[u]; t.bindFramebuffer(t.FRAMEBUFFER, h.frameBuffer), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, a.texture), this.applyFilterPass(l, r, r.width, r.height); var c = a; a = h, h = c } t.enable(t.BLEND), n = a, this.texturePool.push(h) } var d = e.filterPasses[e.filterPasses.length - 1]; this.offsetX -= r.x, this.offsetY -= r.y; var p = this.width, f = this.height, g = 0, m = 0, v = this.buffer; if (0 === this.filterStack.length) t.colorMask(!0, !0, !0, !0); else { var y = this.filterStack[this.filterStack.length - 1]; p = (r = y._filterArea).width, f = r.height, g = r.x, m = r.y, v = y._glFilterTexture.frameBuffer } s.x = p / 2, s.y = -f / 2, o.x = g, o.y = m; var x = (r = e._filterArea).x - g, _ = r.y - m; t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = x, this.vertexArray[1] = _ + r.height, this.vertexArray[2] = x + r.width, this.vertexArray[3] = _ + r.height, this.vertexArray[4] = x, this.vertexArray[5] = _, this.vertexArray[6] = x + r.width, this.vertexArray[7] = _, t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = r.width / this.width, this.uvArray[5] = r.height / this.height, this.uvArray[6] = r.width / this.width, this.uvArray[7] = r.height / this.height, t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray), t.viewport(0, 0, p * this.renderSession.resolution, f * this.renderSession.resolution), t.bindFramebuffer(t.FRAMEBUFFER, v), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n.texture), this.renderSession.stencilManager && this.renderSession.stencilManager.destroy(), this.renderSession.stencilManager = e._previous_stencil_mgr, e._previous_stencil_mgr = null, this.renderSession.stencilManager.count > 0 ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST), this.applyFilterPass(d, r, p, f), this.texturePool.push(n), e._glFilterTexture = null }, i.WebGLFilterManager.prototype.applyFilterPass = function (t, e, r, n) { var s = this.gl, o = t.shaders[s.id]; o || ((o = new i.PixiShader(s)).fragmentSrc = t.fragmentSrc, o.uniforms = t.uniforms, o.init(!0), t.shaders[s.id] = o), this.renderSession.shaderManager.setShader(o), s.uniform2f(o.projectionVector, r / 2, -n / 2), s.uniform2f(o.offsetVector, 0, 0), t.uniforms.dimensions && (t.uniforms.dimensions.value[0] = this.width, t.uniforms.dimensions.value[1] = this.height, t.uniforms.dimensions.value[2] = this.vertexArray[0], t.uniforms.dimensions.value[3] = this.vertexArray[5]), o.syncUniforms(), s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer), s.vertexAttribPointer(o.aVertexPosition, 2, s.FLOAT, !1, 0, 0), s.bindBuffer(s.ARRAY_BUFFER, this.uvBuffer), s.vertexAttribPointer(o.aTextureCoord, 2, s.FLOAT, !1, 0, 0), s.bindBuffer(s.ARRAY_BUFFER, this.colorBuffer), s.vertexAttribPointer(o.colorAttribute, 2, s.FLOAT, !1, 0, 0), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, this.indexBuffer), s.drawElements(s.TRIANGLES, 6, s.UNSIGNED_SHORT, 0), this.renderSession.drawCount++ }, i.WebGLFilterManager.prototype.initShaderBuffers = function () { var t = this.gl; this.vertexBuffer = t.createBuffer(), this.uvBuffer = t.createBuffer(), this.colorBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), this.vertexArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertexArray, t.STATIC_DRAW), this.uvArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), t.bufferData(t.ARRAY_BUFFER, this.uvArray, t.STATIC_DRAW), this.colorArray = new Float32Array([1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215]), t.bindBuffer(t.ARRAY_BUFFER, this.colorBuffer), t.bufferData(t.ARRAY_BUFFER, this.colorArray, t.STATIC_DRAW), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 1, 3, 2]), t.STATIC_DRAW) }, i.WebGLFilterManager.prototype.destroy = function () { var t = this.gl; this.filterStack = null, this.offsetX = 0, this.offsetY = 0; for (var e = 0; e < this.texturePool.length; e++)this.texturePool[e].destroy(); this.texturePool = null, t.deleteBuffer(this.vertexBuffer), t.deleteBuffer(this.uvBuffer), t.deleteBuffer(this.colorBuffer), t.deleteBuffer(this.indexBuffer) }; var r = { 36054: "Incomplete attachment", 36055: "Missing attachment", 36057: "Incomplete dimensions", 36061: "Framebuffer unsupported" }; function n(t, e, n, s, o) { var a, h, u = t.createFramebuffer(), l = t.createRenderbuffer(); return t.activeTexture(t.TEXTURE0 + o), t.bindFramebuffer(t.FRAMEBUFFER, u), t.bindRenderbuffer(t.RENDERBUFFER, l), t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.RENDERBUFFER, this.renderBuffer), a = function (t, e, r, n) { var s = t.createTexture(); return t.bindTexture(t.TEXTURE_2D, s), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, n === i.scaleModes.LINEAR ? t.LINEAR : t.NEAREST), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, n === i.scaleModes.LINEAR ? t.LINEAR : t.NEAREST), t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, e, r, 0, t.RGBA, t.UNSIGNED_BYTE, null), s }(t, e, n, s), t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, a, 0), (h = t.checkFramebufferStatus(t.FRAMEBUFFER)) !== t.FRAMEBUFFER_COMPLETE && console.error("Incomplete GL framebuffer. ", r[h]), u.width = e, u.height = n, u.targetTexture = a, u.renderBuffer = l, u } return i.FilterTexture = function (t, e, r, s, o) { o = "number" == typeof o ? o : 0, this.gl = t, this.frameBuffer = n(t, e, r, s || i.scaleModes.DEFAULT, o), this.texture = this.frameBuffer.targetTexture, this.width = e, this.height = r, this.renderBuffer = this.frameBuffer.renderBuffer }, i.FilterTexture.prototype.constructor = i.FilterTexture, i.FilterTexture.prototype.clear = function () { var t = this.gl; t.clearColor(0, 0, 0, 0), t.clear(t.COLOR_BUFFER_BIT) }, i.FilterTexture.prototype.resize = function (t, e) { if (this.width !== t || this.height !== e) { this.width = t, this.height = e; var i = this.gl; i.bindTexture(i.TEXTURE_2D, this.texture), i.texImage2D(i.TEXTURE_2D, 0, i.RGBA, t, e, 0, i.RGBA, i.UNSIGNED_BYTE, null), i.bindRenderbuffer(i.RENDERBUFFER, this.renderBuffer), i.renderbufferStorage(i.RENDERBUFFER, i.DEPTH_STENCIL, t, e) } }, i.FilterTexture.prototype.destroy = function () { var t = this.gl; t.deleteFramebuffer(this.frameBuffer), t.deleteTexture(this.texture), this.frameBuffer = null, this.texture = null }, i.CanvasBuffer = function (t, e) { this.width = t, this.height = e, this.canvas = Phaser.CanvasPool.create(this, this.width, this.height), this.context = this.canvas.getContext("2d"), this.canvas.width = t, this.canvas.height = e }, i.CanvasBuffer.prototype.constructor = i.CanvasBuffer, i.CanvasBuffer.prototype.clear = function () { this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.clearRect(0, 0, this.width, this.height) }, i.CanvasBuffer.prototype.resize = function (t, e) { this.width = this.canvas.width = t, this.height = this.canvas.height = e }, i.CanvasBuffer.prototype.destroy = function () { Phaser.CanvasPool.remove(this) }, i.CanvasMaskManager = function () { }, i.CanvasMaskManager.prototype.constructor = i.CanvasMaskManager, i.CanvasMaskManager.prototype.pushMask = function (t, e) { var r = e.context; r.save(); var n = t.alpha, s = t.worldTransform, o = e.resolution; r.setTransform(s.a * o, s.b * o, s.c * o, s.d * o, s.tx * o, s.ty * o), i.CanvasGraphics.renderGraphicsMask(t, r), r.clip(), t.worldAlpha = n }, i.CanvasMaskManager.prototype.popMask = function (t) { t.context.restore() }, i.CanvasTinter = function () { }, i.CanvasTinter.getTintedTexture = function (t, e) { var r = t.tintedTexture || Phaser.CanvasPool.create(this); return i.CanvasTinter.tintMethod(t.texture, e, r), r }, i.CanvasTinter.tintWithMultiply = function (t, e, i) { var r = i.getContext("2d"), n = t.crop, s = n.width, o = n.height; t.rotated && (s = o, o = n.width), i.width === s && i.height === o || (i.width = s, i.height = o), r.clearRect(0, 0, s, o), r.fillStyle = "#" + ("00000" + (0 | e).toString(16)).substr(-6), r.fillRect(0, 0, s, o), r.globalCompositeOperation = "multiply", r.drawImage(t.baseTexture.source, n.x, n.y, s, o, 0, 0, s, o), r.globalCompositeOperation = "destination-atop", r.drawImage(t.baseTexture.source, n.x, n.y, s, o, 0, 0, s, o) }, i.CanvasTinter.tintWithPerPixel = function (t, e, r) { var n = r.getContext("2d"), s = t.crop, o = s.width, a = s.height; t.rotated && (o = a, a = s.width), r.width === o && r.height === a || (r.width = o, r.height = a), n.globalCompositeOperation = "copy", n.drawImage(t.baseTexture.source, s.x, s.y, o, a, 0, 0, o, a); for (var h = Phaser.Color.hexToRGBArray(e), u = h[0], l = h[1], c = h[2], d = n.getImageData(0, 0, o, a), p = d.data, f = 0; f < p.length; f += 4)if (p[f + 0] *= u, p[f + 1] *= l, p[f + 2] *= c, !i.CanvasTinter.canHandleAlpha) { var g = p[f + 3]; p[f + 0] /= 255 / g, p[f + 1] /= 255 / g, p[f + 2] /= 255 / g } n.putImageData(d, 0, 0) }, i.CanvasRenderer = function (t, e) { this.game = t, i.defaultRenderer || (i.defaultRenderer = this), this.type = Phaser.CANVAS, this.resolution = t.resolution, this.clearBeforeRender = t.clearBeforeRender, this.transparent = t.transparent, this.autoResize = !1, this.width = t.width * this.resolution, this.height = t.height * this.resolution, this.view = t.canvas, this.context = this.view.getContext("2d", { alpha: this.transparent }), this.refresh = !0, this.count = 0, this.maskManager = new i.CanvasMaskManager, this.renderSession = { context: this.context, maskManager: this.maskManager, scaleMode: null, smoothProperty: Phaser.Canvas.getSmoothingPrefix(this.context), roundPixels: e.roundPixels || !1 }, this.mapBlendModes(), this.resize(this.width, this.height) }, i.CanvasRenderer.prototype.constructor = i.CanvasRenderer, i.CanvasRenderer.prototype.render = function (t) { this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.globalAlpha = 1, this.renderSession.currentBlendMode = 0, this.renderSession.shakeX = this.game.camera._shake.x, this.renderSession.shakeY = this.game.camera._shake.y, this.context.globalCompositeOperation = "source-over", navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black", this.context.clear()), this.clearBeforeRender && (this.transparent ? this.context.clearRect(0, 0, this.width, this.height) : t._bgColor && (this.context.fillStyle = t._bgColor.rgba, this.context.fillRect(0, 0, this.width, this.height))), this.renderDisplayObject(t) }, i.CanvasRenderer.prototype.setTexturePriority = function (t) { }, i.CanvasRenderer.prototype.destroy = function (t) { void 0 === t && (t = !0), t && this.view.parent && this.view.parent.removeChild(this.view), this.view = null, this.context = null, this.maskManager = null, this.renderSession = null }, i.CanvasRenderer.prototype.resize = function (t, e) { this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.renderSession.smoothProperty && (this.context[this.renderSession.smoothProperty] = this.renderSession.scaleMode === i.scaleModes.LINEAR) }, i.CanvasRenderer.prototype.renderDisplayObject = function (t, e, i) { this.renderSession.context = e || this.context, this.renderSession.resolution = this.resolution, t._renderCanvas(this.renderSession, i) }, i.CanvasRenderer.prototype.mapBlendModes = function () { if (!i.blendModesCanvas) { var t = [], e = i.blendModes, r = this.game.device.canUseMultiply; t[e.NORMAL] = "source-over", t[e.ADD] = "lighter", t[e.MULTIPLY] = r ? "multiply" : "source-over", t[e.SCREEN] = r ? "screen" : "source-over", t[e.OVERLAY] = r ? "overlay" : "source-over", t[e.DARKEN] = r ? "darken" : "source-over", t[e.LIGHTEN] = r ? "lighten" : "source-over", t[e.COLOR_DODGE] = r ? "color-dodge" : "source-over", t[e.COLOR_BURN] = r ? "color-burn" : "source-over", t[e.HARD_LIGHT] = r ? "hard-light" : "source-over", t[e.SOFT_LIGHT] = r ? "soft-light" : "source-over", t[e.DIFFERENCE] = r ? "difference" : "source-over", t[e.EXCLUSION] = r ? "exclusion" : "source-over", t[e.HUE] = r ? "hue" : "source-over", t[e.SATURATION] = r ? "saturation" : "source-over", t[e.COLOR] = r ? "color" : "source-over", t[e.LUMINOSITY] = r ? "luminosity" : "source-over", i.blendModesCanvas = t } }, i.BaseTexture = function (t, e, r) { this.resolution = r || 1, this.width = 100, this.height = 100, this.scaleMode = e || i.scaleModes.DEFAULT, this.hasLoaded = !1, this.source = t, this.premultipliedAlpha = !0, this._glTextures = [], this.mipmap = !1, this.textureIndex = 0, this._dirty = [!0, !0, !0, !0], t && ((this.source.complete || this.source.getContext) && this.source.width && this.source.height && (this.hasLoaded = !0, this.width = this.source.naturalWidth || this.source.width, this.height = this.source.naturalHeight || this.source.height, this.dirty()), this.skipRender = !1, this._powerOf2 = !1) }, i.BaseTexture.prototype.constructor = i.BaseTexture, i.BaseTexture.prototype.forceLoaded = function (t, e) { this.hasLoaded = !0, this.width = t, this.height = e, this.dirty() }, i.BaseTexture.prototype.destroy = function () { this.source && Phaser.CanvasPool.removeByCanvas(this.source), this.source = null, this.unloadFromGPU() }, i.BaseTexture.prototype.dirty = function () { for (var t = 0; t < this._glTextures.length; t++)this._dirty[t] = !0 }, i.BaseTexture.prototype.unloadFromGPU = function () { this.dirty(); for (var t = this._glTextures.length - 1; t >= 0; t--) { var e = this._glTextures[t], r = i.glContexts[t]; r && e && r.deleteTexture(e) } this._glTextures.length = 0, this.dirty() }, i.BaseTexture.fromCanvas = function (t, e, r) { return 0 === t.width && (t.width = 1), 0 === t.height && (t.height = 1), r = r || 1, new i.BaseTexture(t, e, r) }, i.TextureSilentFail = !1, i.Texture = function (t, e, r, n) { this.noFrame = !1, e || (this.noFrame = !0, e = new i.Rectangle(0, 0, 1, 1)), t instanceof i.Texture && (t = t.baseTexture), this.baseTexture = t, this.frame = e, this.trim = n, this.valid = !1, this.isTiling = !1, this.requiresUpdate = !1, this.requiresReTint = !1, this._uvs = null, this.width = 0, this.height = 0, this.crop = r || new i.Rectangle(0, 0, 1, 1), this.rotated = !1, t.hasLoaded && (this.noFrame && (e = new i.Rectangle(0, 0, t.width, t.height)), this.setFrame(e)) }, i.Texture.prototype.constructor = i.Texture, i.Texture.prototype.onBaseTextureLoaded = function () { var t = this.baseTexture; this.noFrame && (this.frame = new i.Rectangle(0, 0, t.width, t.height)), this.setFrame(this.frame) }, i.Texture.prototype.destroy = function (t) { t && this.baseTexture.destroy(), this.valid = !1 }, i.Texture.prototype.setFrame = function (t) { if (this.noFrame = !1, this.frame = t, this.width = t.width, this.height = t.height, this.crop.x = t.x, this.crop.y = t.y, this.crop.width = t.width, this.crop.height = t.height, this.trim || !(t.x + t.width > this.baseTexture.width || t.y + t.height > this.baseTexture.height)) this.valid = t && t.width && t.height && this.baseTexture.source && this.baseTexture.hasLoaded, this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, this.frame.height = this.trim.height), this.valid && this._updateUvs(); else { if (!i.TextureSilentFail) throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this); this.valid = !1 } }, i.Texture.prototype._updateUvs = function () { this._uvs || (this._uvs = new i.TextureUvs); var t = this.crop, e = this.baseTexture.width, r = this.baseTexture.height; this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / r, this._uvs.x1 = (t.x + t.width) / e, this._uvs.y1 = t.y / r, this._uvs.x2 = (t.x + t.width) / e, this._uvs.y2 = (t.y + t.height) / r, this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.height) / r }, i.Texture.prototype._updateUvsInverted = function () { this._uvs || (this._uvs = new i.TextureUvs); var t = this.crop, e = this.baseTexture.width, r = this.baseTexture.height; this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / r, this._uvs.x1 = (t.x + t.height) / e, this._uvs.y1 = t.y / r, this._uvs.x2 = (t.x + t.height) / e, this._uvs.y2 = (t.y + t.width) / r, this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.width) / r }, i.Texture.fromCanvas = function (t, e) { var r = i.BaseTexture.fromCanvas(t, e); return new i.Texture(r) }, i.TextureUvs = function () { this.x0 = 0, this.y0 = 0, this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.x3 = 0, this.y3 = 0 }, void 0 !== t && t.exports && (e = t.exports = i), e.PIXI = i, i }).call(void 0) }, "CEO+": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(0), s = i("NNrz")([].forEach, !0); r(r.P + r.F * !s, "Array", { forEach: function (t) { return n(this, t, arguments[1]) } }) }, CEne: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("lDLk"), s = i("bUqO"), o = i("kkCw")("species"); t.exports = function (t) { var e = r[t]; s && e && !e[o] && n.f(e, o, { configurable: !0, get: function () { return this } }) } }, "CVR+": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("XSOZ"), s = i("DIVP"), o = (i("OzIq").Reflect || {}).apply, a = Function.apply; r(r.S + r.F * !i("zgIt")(function () { o(function () { }) }), "Reflect", { apply: function (t, e, i) { var r = n(t), h = s(i); return o ? o(r, e, h) : a.call(r, e, h) } }) }, CvWX: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("BbyF"), s = i("kqpo"), o = "".startsWith; r(r.P + r.F * i("1ETD")("startsWith"), "String", { startsWith: function (t) { var e = s(this, t, "startsWith"), i = n(Math.min(arguments.length > 1 ? arguments[1] : void 0, e.length)), r = String(t); return o ? o.call(e, r, i) : e.slice(i, i + r.length) === r } }) }, DIVP: function (t, e, i) { "use strict"; var r = i("UKM+"); t.exports = function (t) { if (!r(t)) throw TypeError(t + " is not an object!"); return t } }, DPsE: function (t, e, i) { "use strict"; var r = i("FryR"), n = i("zo/l"), s = i("BbyF"); t.exports = [].copyWithin || function (t, e) { var i = r(this), o = s(i.length), a = n(t, o), h = n(e, o), u = arguments.length > 2 ? arguments[2] : void 0, l = Math.min((void 0 === u ? o : n(u, o)) - h, o - a), c = 1; for (h < a && a < h + l && (c = -1, h += l - 1, a += l - 1); l-- > 0;)h in i ? i[a] = i[h] : delete i[a], a += c, h += c; return i } }, DQfQ: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.G, { global: i("OzIq") }) }, Dgii: function (t, e, i) { "use strict"; var r = i("lDLk").f, n = i("7ylX"), s = i("A16L"), o = i("rFzY"), a = i("9GpA"), h = i("vmSO"), u = i("uc2A"), l = i("KB1o"), c = i("CEne"), d = i("bUqO"), p = i("1aA0").fastKey, f = i("zq/X"), g = d ? "_s" : "size", m = function (t, e) { var i, r = p(e); if ("F" !== r) return t._i[r]; for (i = t._f; i; i = i.n)if (i.k == e) return i }; t.exports = { getConstructor: function (t, e, i, u) { var l = t(function (t, r) { a(t, l, e, "_i"), t._t = e, t._i = n(null), t._f = void 0, t._l = void 0, t[g] = 0, void 0 != r && h(r, i, t[u], t) }); return s(l.prototype, { clear: function () { for (var t = f(this, e), i = t._i, r = t._f; r; r = r.n)r.r = !0, r.p && (r.p = r.p.n = void 0), delete i[r.i]; t._f = t._l = void 0, t[g] = 0 }, delete: function (t) { var i = f(this, e), r = m(i, t); if (r) { var n = r.n, s = r.p; delete i._i[r.i], r.r = !0, s && (s.n = n), n && (n.p = s), i._f == r && (i._f = n), i._l == r && (i._l = s), i[g]-- } return !!r }, forEach: function (t) { f(this, e); for (var i, r = o(t, arguments.length > 1 ? arguments[1] : void 0, 3); i = i ? i.n : this._f;)for (r(i.v, i.k, this); i && i.r;)i = i.p }, has: function (t) { return !!m(f(this, e), t) } }), d && r(l.prototype, "size", { get: function () { return f(this, e)[g] } }), l }, def: function (t, e, i) { var r, n, s = m(t, e); return s ? s.v = i : (t._l = s = { i: n = p(e, !0), k: e, v: i, p: r = t._l, n: void 0, r: !1 }, t._f || (t._f = s), r && (r.n = s), t[g]++ , "F" !== n && (t._i[n] = s)), t }, getEntry: m, setStrong: function (t, e, i) { u(t, e, function (t, i) { this._t = f(t, e), this._k = i, this._l = void 0 }, function () { for (var t = this._k, e = this._l; e && e.r;)e = e.p; return this._t && (this._l = e = e ? e.n : this._t._f) ? l(0, "keys" == t ? e.k : "values" == t ? e.v : [e.k, e.v]) : (this._t = void 0, l(1)) }, i ? "entries" : "values", !i, !0), c(e) } } }, Ds5P: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("7gX0"), s = i("2p1q"), o = i("R3AP"), a = i("rFzY"), h = function t(e, i, h) { var u, l, c, d, p = e & t.F, f = e & t.G, g = e & t.P, m = e & t.B, v = f ? r : e & t.S ? r[i] || (r[i] = {}) : (r[i] || {}).prototype, y = f ? n : n[i] || (n[i] = {}), x = y.prototype || (y.prototype = {}); for (u in f && (h = i), h) c = ((l = !p && v && void 0 !== v[u]) ? v : h)[u], d = m && l ? a(c, r) : g && "function" == typeof c ? a(Function.call, c) : c, v && o(v, u, c, e & t.U), y[u] != c && s(y, u, d), g && x[u] != c && (x[u] = c) }; r.core = n, h.F = 1, h.G = 2, h.S = 4, h.P = 8, h.B = 16, h.W = 32, h.U = 64, h.R = 128, t.exports = h }, DuR2: function (t, e, i) { "use strict"; var r, n = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; r = function () { return this }(); try { r = r || Function("return this")() || (0, eval)("this") } catch (t) { "object" === ("undefined" == typeof window ? "undefined" : n(window)) && (r = window) } t.exports = r }, EWrS: function (t, e, i) { "use strict"; i("y325")("sub", function (t) { return function () { return t(this, "sub", "", "") } }) }, "EZ+5": function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = i("XSOZ"), o = r.key, a = r.set; r.exp({ metadata: function (t, e) { return function (i, r) { a(t, e, (void 0 !== r ? n : s)(i), o(r)) } } }) }, EuXz: function (t, e, i) { "use strict"; var r = i("lDLk").f, n = Function.prototype, s = /^\s*function ([^ (]*)/; "name" in n || i("bUqO") && r(n, "name", { configurable: !0, get: function () { try { return ("" + this).match(s)[1] } catch (t) { return "" } } }) }, EvFb: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("8t38"); r(r.G + r.F * (parseFloat != n), { parseFloat: n }) }, F1ui: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = Math.PI / 180; r(r.S, "Math", { radians: function (t) { return t * n } }) }, F3sI: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("PHqh"), s = i("BbyF"); r(r.S, "String", { raw: function (t) { for (var e = n(t.raw), i = s(e.length), r = arguments.length, o = [], a = 0; i > a;)o.push(String(e[a++])), a < r && o.push(String(arguments[a])); return o.join("") } }) }, FKfb: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("lKE8")(!0); r(r.S, "Object", { entries: function (t) { return n(t) } }) }, FaZr: function (t, e, i) { "use strict"; i("pd+2"); var r = i("DIVP"), n = i("0pGU"), s = i("bUqO"), o = /./.toString, a = function (t) { i("R3AP")(RegExp.prototype, "toString", t, !0) }; i("zgIt")(function () { return "/a/b" != o.call({ source: "a", flags: "b" }) }) ? a(function () { var t = r(this); return "/".concat(t.source, "/", "flags" in t ? t.flags : !s && t instanceof RegExp ? n.call(t) : void 0) }) : "toString" != o.name && a(function () { return o.call(this) }) }, FkIZ: function (t, e, i) { "use strict"; var r = i("XSOZ"), n = i("FryR"), s = i("Q6Nf"), o = i("BbyF"); t.exports = function (t, e, i, a, h) { r(e); var u = n(t), l = s(u), c = o(u.length), d = h ? c - 1 : 0, p = h ? -1 : 1; if (i < 2) for (; ;) { if (d in l) { a = l[d], d += p; break } if (d += p, h ? d < 0 : c <= d) throw TypeError("Reduce of empty array with no initial value") } for (; h ? d >= 0 : c > d; d += p)d in l && (a = e(a, l[d], d, u)); return a } }, FryR: function (t, e, i) { "use strict"; var r = i("/whu"); t.exports = function (t) { return Object(r(t)) } }, Gh7F: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("kqpo"); r(r.P + r.F * i("1ETD")("includes"), "String", { includes: function (t) { return !!~n(this, t, "includes").indexOf(t, arguments.length > 1 ? arguments[1] : void 0) } }) }, H0mh: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { trunc: function (t) { return (t > 0 ? Math.floor : Math.ceil)(t) } }) }, H7zx: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { signbit: function (t) { return (t = +t) != t ? t : 0 == t ? 1 / t == 1 / 0 : t > 0 } }) }, Hhm4: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S + r.F * !i("bUqO"), "Object", { defineProperties: i("twxM") }) }, "Hl+4": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { sign: i("cwmK") }) }, IFpc: function (t, e, i) { "use strict"; var r = i("XO1R"), n = i("UKM+"), s = i("BbyF"), o = i("rFzY"), a = i("kkCw")("isConcatSpreadable"); t.exports = function t(e, i, h, u, l, c, d, p) { for (var f, g, m = l, v = 0, y = !!d && o(d, p, 3); v < u;) { if (v in h) { if (f = y ? y(h[v], v, i) : h[v], g = !1, n(f) && (g = void 0 !== (g = f[a]) ? !!g : r(f)), g && c > 0) m = t(e, i, f, s(f.length), m, c - 1) - 1; else { if (m >= 9007199254740991) throw TypeError(); e[m] = f } m++ } v++ } return m } }, IMUI: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Array", { isArray: i("XO1R") }) }, IRJ3: function (t, e, i) { "use strict"; var r = i("7ylX"), n = i("fU25"), s = i("yYvK"), o = {}; i("2p1q")(o, i("kkCw")("iterator"), function () { return this }), t.exports = function (t, e, i) { t.prototype = r(o, { next: n(1, i) }), s(t, e + " Iterator") } }, "J+j9": function (t, e, i) { "use strict"; i("y325")("fixed", function (t) { return function () { return t(this, "tt", "", "") } }) }, J2ob: function (t, e, i) { "use strict"; i("y325")("sup", function (t) { return function () { return t(this, "sup", "", "") } }) }, JG34: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("DIVP"), s = Object.isExtensible; r(r.S, "Reflect", { isExtensible: function (t) { return n(t), !s || s(t) } }) }, JJ3w: function (t, e, i) { "use strict"; i("0j1G")("Map") }, Jbuy: function (t, e, i) { "use strict"; var r = i("32VL"); i("Ds5P")({ target: "RegExp", proto: !0, forced: r !== /./.exec }, { exec: r }) }, K0JP: function (t, e, i) { "use strict"; i("77Ug")("Int32", 4, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, KB1o: function (t, e, i) { "use strict"; t.exports = function (t, e) { return { value: e, done: !!t } } }, KOrd: function (t, e, i) { "use strict"; var r = i("WBcL"), n = i("FryR"), s = i("mZON")("IE_PROTO"), o = Object.prototype; t.exports = Object.getPrototypeOf || function (t) { return t = n(t), r(t, s) ? t[s] : "function" == typeof t.constructor && t instanceof t.constructor ? t.constructor.prototype : t instanceof Object ? o : null } }, LG56: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Number", { isNaN: function (t) { return t != t } }) }, "LRL/": function (t, e, i) { "use strict"; i("Ymdd")("trimRight", function (t) { return function () { return t(this, 2) } }, "trimEnd") }, La7N: function (t, e, i) { "use strict"; i("0j1G")("WeakMap") }, LhTa: function (t, e, i) { "use strict"; var r = i("rFzY"), n = i("Q6Nf"), s = i("FryR"), o = i("BbyF"), a = i("plSV"); t.exports = function (t, e) { var i = 1 == t, h = 2 == t, u = 3 == t, l = 4 == t, c = 6 == t, d = 5 == t || c, p = e || a; return function (e, a, f) { for (var g, m, v = s(e), y = n(v), x = r(a, f, 3), _ = o(y.length), b = 0, T = i ? p(e, _) : h ? p(e, 0) : void 0; _ > b; b++)if ((d || b in y) && (m = x(g = y[b], b, v), t)) if (i) T[b] = m; else if (m) switch (t) { case 3: return !0; case 5: return g; case 6: return b; case 2: T.push(g) } else if (l) return !1; return c ? -1 : u || l ? l : T } } }, LlNE: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = Math.exp; r(r.S, "Math", { cosh: function (t) { return (n(t = +t) + n(-t)) / 2 } }) }, Lqg1: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = Math.imul; r(r.S + r.F * i("zgIt")(function () { return -5 != n(4294967295, 5) || 2 != n.length }), "Math", { imul: function (t, e) { var i = +t, r = +e, n = 65535 & i, s = 65535 & r; return 0 | n * s + ((65535 & i >>> 16) * s + n * (65535 & r >>> 16) << 16 >>> 0) } }) }, LrcN: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("bUqO"), s = i("V3l/"), o = i("07k+"), a = i("2p1q"), h = i("A16L"), u = i("zgIt"), l = i("9GpA"), c = i("oeih"), d = i("BbyF"), p = i("8D8H"), f = i("WcO1").f, g = i("lDLk").f, m = i("zCYm"), v = i("yYvK"), y = "prototype", x = "Wrong index!", _ = r.ArrayBuffer, b = r.DataView, T = r.Math, w = r.RangeError, S = r.Infinity, C = _, P = T.abs, E = T.pow, A = T.floor, R = T.log, M = T.LN2, L = n ? "_b" : "buffer", I = n ? "_l" : "byteLength", O = n ? "_o" : "byteOffset"; function D(t, e, i) { var r, n, s, o = new Array(i), a = 8 * i - e - 1, h = (1 << a) - 1, u = h >> 1, l = 23 === e ? E(2, -24) - E(2, -77) : 0, c = 0, d = t < 0 || 0 === t && 1 / t < 0 ? 1 : 0; for ((t = P(t)) != t || t === S ? (n = t != t ? 1 : 0, r = h) : (r = A(R(t) / M), t * (s = E(2, -r)) < 1 && (r-- , s *= 2), (t += r + u >= 1 ? l / s : l * E(2, 1 - u)) * s >= 2 && (r++ , s /= 2), r + u >= h ? (n = 0, r = h) : r + u >= 1 ? (n = (t * s - 1) * E(2, e), r += u) : (n = t * E(2, u - 1) * E(2, e), r = 0)); e >= 8; o[c++] = 255 & n, n /= 256, e -= 8); for (r = r << e | n, a += e; a > 0; o[c++] = 255 & r, r /= 256, a -= 8); return o[--c] |= 128 * d, o } function F(t, e, i) { var r, n = 8 * i - e - 1, s = (1 << n) - 1, o = s >> 1, a = n - 7, h = i - 1, u = t[h--], l = 127 & u; for (u >>= 7; a > 0; l = 256 * l + t[h], h-- , a -= 8); for (r = l & (1 << -a) - 1, l >>= -a, a += e; a > 0; r = 256 * r + t[h], h-- , a -= 8); if (0 === l) l = 1 - o; else { if (l === s) return r ? NaN : u ? -S : S; r += E(2, e), l -= o } return (u ? -1 : 1) * r * E(2, l - e) } function k(t) { return t[3] << 24 | t[2] << 16 | t[1] << 8 | t[0] } function B(t) { return [255 & t] } function U(t) { return [255 & t, t >> 8 & 255] } function G(t) { return [255 & t, t >> 8 & 255, t >> 16 & 255, t >> 24 & 255] } function N(t) { return D(t, 52, 8) } function X(t) { return D(t, 23, 4) } function W(t, e, i) { g(t[y], e, { get: function () { return this[i] } }) } function j(t, e, i, r) { var n = p(+i); if (n + e > t[I]) throw w(x); var s = t[L]._b, o = n + t[O], a = s.slice(o, o + e); return r ? a : a.reverse() } function z(t, e, i, r, n, s) { var o = p(+i); if (o + e > t[I]) throw w(x); for (var a = t[L]._b, h = o + t[O], u = r(+n), l = 0; l < e; l++)a[h + l] = u[s ? l : e - l - 1] } if (o.ABV) { if (!u(function () { _(1) }) || !u(function () { new _(-1) }) || u(function () { return new _, new _(1.5), new _(NaN), "ArrayBuffer" != _.name })) { for (var V, H = (_ = function (t) { return l(this, _), new C(p(t)) })[y] = C[y], Y = f(C), K = 0; Y.length > K;)(V = Y[K++]) in _ || a(_, V, C[V]); s || (H.constructor = _) } var q = new b(new _(2)), J = b[y].setInt8; q.setInt8(0, 2147483648), q.setInt8(1, 2147483649), !q.getInt8(0) && q.getInt8(1) || h(b[y], { setInt8: function (t, e) { J.call(this, t, e << 24 >> 24) }, setUint8: function (t, e) { J.call(this, t, e << 24 >> 24) } }, !0) } else _ = function (t) { l(this, _, "ArrayBuffer"); var e = p(t); this._b = m.call(new Array(e), 0), this[I] = e }, b = function (t, e, i) { l(this, b, "DataView"), l(t, _, "DataView"); var r = t[I], n = c(e); if (n < 0 || n > r) throw w("Wrong offset!"); if (n + (i = void 0 === i ? r - n : d(i)) > r) throw w("Wrong length!"); this[L] = t, this[O] = n, this[I] = i }, n && (W(_, "byteLength", "_l"), W(b, "buffer", "_b"), W(b, "byteLength", "_l"), W(b, "byteOffset", "_o")), h(b[y], { getInt8: function (t) { return j(this, 1, t)[0] << 24 >> 24 }, getUint8: function (t) { return j(this, 1, t)[0] }, getInt16: function (t) { var e = j(this, 2, t, arguments[1]); return (e[1] << 8 | e[0]) << 16 >> 16 }, getUint16: function (t) { var e = j(this, 2, t, arguments[1]); return e[1] << 8 | e[0] }, getInt32: function (t) { return k(j(this, 4, t, arguments[1])) }, getUint32: function (t) { return k(j(this, 4, t, arguments[1])) >>> 0 }, getFloat32: function (t) { return F(j(this, 4, t, arguments[1]), 23, 4) }, getFloat64: function (t) { return F(j(this, 8, t, arguments[1]), 52, 8) }, setInt8: function (t, e) { z(this, 1, t, B, e) }, setUint8: function (t, e) { z(this, 1, t, B, e) }, setInt16: function (t, e) { z(this, 2, t, U, e, arguments[2]) }, setUint16: function (t, e) { z(this, 2, t, U, e, arguments[2]) }, setInt32: function (t, e) { z(this, 4, t, G, e, arguments[2]) }, setUint32: function (t, e) { z(this, 4, t, G, e, arguments[2]) }, setFloat32: function (t, e) { z(this, 4, t, X, e, arguments[2]) }, setFloat64: function (t, e) { z(this, 8, t, N, e, arguments[2]) } }); v(_, "ArrayBuffer"), v(b, "DataView"), a(b[y], o.VIEW, !0), e.ArrayBuffer = _, e.DataView = b }, M8WE: function (t, e, i) { "use strict"; e.f = i("kkCw") }, MfeA: function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("BbyF"), s = i("TwzQ"), o = i("9Dx1"); i("Vg1y")("match", 1, function (t, e, i, a) { return [function (i) { var r = t(this), n = void 0 == i ? void 0 : i[e]; return void 0 !== n ? n.call(i, r) : new RegExp(i)[e](String(r)) }, function (t) { var e = a(i, t, this); if (e.done) return e.value; var h = r(t), u = String(this); if (!h.global) return o(h, u); var l = h.unicode; h.lastIndex = 0; for (var c, d = [], p = 0; null !== (c = o(h, u));) { var f = String(c[0]); d[p] = f, "" === f && (h.lastIndex = s(u, n(h.lastIndex), l)), p++ } return 0 === p ? null : d }] }) }, MjHD: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("x78i"), s = Math.exp; r(r.S + r.F * i("zgIt")(function () { return -2e-17 != !Math.sinh(-2e-17) }), "Math", { sinh: function (t) { return Math.abs(t = +t) < 1 ? (n(t) - n(-t)) / 2 : (s(t - 1) - s(-t - 1)) * (Math.E / 2) } }) }, MsuQ: function (t, e, i) { "use strict"; var r = i("Dgii"), n = i("zq/X"); t.exports = i("0Rih")("Map", function (t) { return function () { return t(this, arguments.length > 0 ? arguments[0] : void 0) } }, { get: function (t) { var e = r.getEntry(n(this, "Map"), t); return e && e.v }, set: function (t, e) { return r.def(n(this, "Map"), 0 === t ? 0 : t, e) } }, r, !0) }, MyjO: function (t, e, i) { "use strict"; i("77Ug")("Uint8", 1, function (t) { return function (e, i, r) { return t(this, e, i, r) } }, !0) }, N4KQ: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { log2: function (t) { return Math.log(t) / Math.LN2 } }) }, NHaJ: function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = i("KOrd"), o = r.has, a = r.get, h = r.key; r.exp({ getMetadata: function (t, e) { return function t(e, i, r) { if (o(e, i, r)) return a(e, i, r); var n = s(i); return null !== n ? t(e, n, r) : void 0 }(t, n(e), arguments.length < 3 ? void 0 : h(arguments[2])) } }) }, NNrz: function (t, e, i) { "use strict"; var r = i("zgIt"); t.exports = function (t, e) { return !!t && r(function () { e ? t.call(null, function () { }, 1) : t.call(null) }) } }, NfZy: function (t, e, i) { "use strict"; i("77Ug")("Uint32", 4, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, Nkrw: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(4); r(r.P + r.F * !i("NNrz")([].every, !0), "Array", { every: function (t) { return n(this, t, arguments[1]) } }) }, No4x: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.P, "Array", { fill: i("zCYm") }), i("RhFG")("fill") }, OgTs: function (t, e, i) { "use strict"; var r = i("OzIq").parseInt, n = i("Ymdd").trim, s = i("Xduv"), o = /^[-+]?0[xX]/; t.exports = 8 !== r(s + "08") || 22 !== r(s + "0x16") ? function (t, e) { var i = n(String(t), 3); return r(i, e >>> 0 || (o.test(i) ? 16 : 10)) } : r }, OzIq: function (t, e, i) { "use strict"; var r = t.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "number" == typeof __g && (__g = r) }, PHCx: function (t, e, i) { "use strict"; t.exports = function (t, e, i) { var r = void 0 === i; switch (e.length) { case 0: return r ? t() : t.call(i); case 1: return r ? t(e[0]) : t.call(i, e[0]); case 2: return r ? t(e[0], e[1]) : t.call(i, e[0], e[1]); case 3: return r ? t(e[0], e[1], e[2]) : t.call(i, e[0], e[1], e[2]); case 4: return r ? t(e[0], e[1], e[2], e[3]) : t.call(i, e[0], e[1], e[2], e[3]) }return t.apply(i, e) } }, PHqh: function (t, e, i) { "use strict"; var r = i("Q6Nf"), n = i("/whu"); t.exports = function (t) { return r(n(t)) } }, PbPd: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("KOrd"), s = i("kkCw")("hasInstance"), o = Function.prototype; s in o || i("lDLk").f(o, s, { value: function (t) { if ("function" != typeof this || !r(t)) return !1; if (!r(this.prototype)) return t instanceof this; for (; t = n(t);)if (this.prototype === t) return !0; return !1 } }) }, PuTd: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("KOrd"), s = i("DIVP"); r(r.S, "Reflect", { getPrototypeOf: function (t) { return n(s(t)) } }) }, "Q/CP": function (t, e, i) { "use strict"; i("CEne")("Array") }, Q6Nf: function (t, e, i) { "use strict"; var r = i("ydD5"); t.exports = Object("z").propertyIsEnumerable(0) ? Object : function (t) { return "String" == r(t) ? t.split("") : Object(t) } }, QBuC: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("WBcL"), s = i("ydD5"), o = i("kic5"), a = i("s4j0"), h = i("zgIt"), u = i("WcO1").f, l = i("x9zv").f, c = i("lDLk").f, d = i("Ymdd").trim, p = r.Number, f = p, g = p.prototype, m = "Number" == s(i("7ylX")(g)), v = "trim" in String.prototype, y = function (t) { var e = a(t, !1); if ("string" == typeof e && e.length > 2) { var i, r, n, s = (e = v ? e.trim() : d(e, 3)).charCodeAt(0); if (43 === s || 45 === s) { if (88 === (i = e.charCodeAt(2)) || 120 === i) return NaN } else if (48 === s) { switch (e.charCodeAt(1)) { case 66: case 98: r = 2, n = 49; break; case 79: case 111: r = 8, n = 55; break; default: return +e }for (var o, h = e.slice(2), u = 0, l = h.length; u < l; u++)if ((o = h.charCodeAt(u)) < 48 || o > n) return NaN; return parseInt(h, r) } } return +e }; if (!p(" 0o1") || !p("0b1") || p("+0x1")) { p = function (t) { var e = arguments.length < 1 ? 0 : t, i = this; return i instanceof p && (m ? h(function () { g.valueOf.call(i) }) : "Number" != s(i)) ? o(new f(y(e)), i, p) : y(e) }; for (var x, _ = i("bUqO") ? u(f) : "MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","), b = 0; _.length > b; b++)n(f, x = _[b]) && !n(p, x) && c(p, x, l(f, x)); p.prototype = g, g.constructor = p, i("R3AP")(r, "Number", p) } }, QG7u: function (t, e, i) { "use strict"; var r = i("vmSO"); t.exports = function (t, e) { var i = []; return r(t, !1, i.push, i, e), i } }, QKXm: function (t, e, i) { "use strict"; t.exports = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",") }, QWLi: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("oeih"), s = i("fS0v"), o = i("xAdt"), a = 1..toFixed, h = Math.floor, u = [0, 0, 0, 0, 0, 0], l = "Number.toFixed: incorrect invocation!", c = function (t, e) { for (var i = -1, r = e; ++i < 6;)r += t * u[i], u[i] = r % 1e7, r = h(r / 1e7) }, d = function (t) { for (var e = 6, i = 0; --e >= 0;)i += u[e], u[e] = h(i / t), i = i % t * 1e7 }, p = function () { for (var t = 6, e = ""; --t >= 0;)if ("" !== e || 0 === t || 0 !== u[t]) { var i = String(u[t]); e = "" === e ? i : e + o.call("0", 7 - i.length) + i } return e }, f = function t(e, i, r) { return 0 === i ? r : i % 2 == 1 ? t(e, i - 1, r * e) : t(e * e, i / 2, r) }; r(r.P + r.F * (!!a && ("0.000" !== 8e-5.toFixed(3) || "1" !== .9.toFixed(0) || "1.25" !== 1.255.toFixed(2) || "1000000000000000128" !== (0xde0b6b3a7640080).toFixed(0)) || !i("zgIt")(function () { a.call({}) })), "Number", { toFixed: function (t) { var e, i, r, a, h = s(this, l), u = n(t), g = "", m = "0"; if (u < 0 || u > 20) throw RangeError(l); if (h != h) return "NaN"; if (h <= -1e21 || h >= 1e21) return String(h); if (h < 0 && (g = "-", h = -h), h > 1e-21) if (i = (e = function (t) { for (var e = 0, i = t; i >= 4096;)e += 12, i /= 4096; for (; i >= 2;)e += 1, i /= 2; return e }(h * f(2, 69, 1)) - 69) < 0 ? h * f(2, -e, 1) : h / f(2, e, 1), i *= 4503599627370496, (e = 52 - e) > 0) { for (c(0, i), r = u; r >= 7;)c(1e7, 0), r -= 7; for (c(f(10, r, 1), 0), r = e - 1; r >= 23;)d(1 << 23), r -= 23; d(1 << r), c(1, 1), d(2), m = p() } else c(0, i), c(1 << -e, 0), m = p() + o.call("0", u); return m = u > 0 ? g + ((a = m.length) <= u ? "0." + o.call("0", u - a) + m : m.slice(0, a - u) + "." + m.slice(a - u)) : g + m } }) }, QaEu: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Date", { now: function () { return (new Date).getTime() } }) }, QcWB: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("w6Dh"), s = i("SDXa"); r(r.S, "Promise", { try: function (t) { var e = n.f(this), i = s(t); return (i.e ? e.reject : e.resolve)(i.v), e.promise } }) }, Qh14: function (t, e, i) { "use strict"; var r = i("ReGu"), n = i("QKXm"); t.exports = Object.keys || function (t) { return r(t, n) } }, QzLV: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S + r.F * !i("bUqO"), "Object", { defineProperty: i("lDLk").f }) }, R3AP: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("2p1q"), s = i("WBcL"), o = i("ulTY")("src"), a = i("73qY"), h = ("" + a).split("toString"); i("7gX0").inspectSource = function (t) { return a.call(t) }, (t.exports = function (t, e, i, a) { var u = "function" == typeof i; u && (s(i, "name") || n(i, "name", e)), t[e] !== i && (u && (s(i, o) || n(i, o, t[e] ? "" + t[e] : h.join(String(e)))), t === r ? t[e] = i : a ? t[e] ? t[e] = i : n(t, e, i) : (delete t[e], n(t, e, i))) })(Function.prototype, "toString", function () { return "function" == typeof this && this[o] || a.call(this) }) }, R3KI: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { iaddh: function (t, e, i, r) { var n = t >>> 0, s = i >>> 0; return (e >>> 0) + (r >>> 0) + ((n & s | (n | s) & ~(n + s >>> 0)) >>> 31) | 0 } }) }, R4pa: function (t, e, i) { "use strict"; i("y325")("big", function (t) { return function () { return t(this, "big", "", "") } }) }, Racj: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("49qz")(!1); r(r.P, "String", { codePointAt: function (t) { return n(this, t) } }) }, ReGu: function (t, e, i) { "use strict"; var r = i("WBcL"), n = i("PHqh"), s = i("ot5s")(!1), o = i("mZON")("IE_PROTO"); t.exports = function (t, e) { var i, a = n(t), h = 0, u = []; for (i in a) i != o && r(a, i) && u.push(i); for (; e.length > h;)r(a, i = e[h++]) && (~s(u, i) || u.push(i)); return u } }, RhFG: function (t, e, i) { "use strict"; var r = i("kkCw")("unscopables"), n = Array.prototype; void 0 == n[r] && i("2p1q")(n, r, {}), t.exports = function (t) { n[r][t] = !0 } }, Rk41: function (t, e, i) { "use strict"; var r = Date.prototype, n = r.toString, s = r.getTime; new Date(NaN) + "" != "Invalid Date" && i("R3AP")(r, "toString", function () { var t = s.call(this); return t == t ? n.call(this) : "Invalid Date" }) }, Rw4K: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Reflect", { ownKeys: i("YUr7") }) }, Rz2z: function (t, e, i) { "use strict"; t.exports = Math.log1p || function (t) { return (t = +t) > -1e-8 && t < 1e-8 ? t - t * t / 2 : Math.log(1 + t) } }, "S+E/": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("OgTs"); r(r.G + r.F * (parseInt != n), { parseInt: n }) }, SDXa: function (t, e, i) { "use strict"; t.exports = function (t) { try { return { e: !1, v: t() } } catch (t) { return { e: !0, v: t } } } }, SHe9: function (t, e, i) { "use strict"; var r = i("wC1N"), n = i("kkCw")("iterator"), s = i("bN1p"); t.exports = i("7gX0").getIteratorMethod = function (t) { if (void 0 != t) return t[n] || t["@@iterator"] || s[r(t)] } }, SPtU: function (t, e, i) { "use strict"; var r = i("x9zv"), n = i("KOrd"), s = i("WBcL"), o = i("Ds5P"), a = i("UKM+"), h = i("DIVP"); o(o.S, "Reflect", { get: function t(e, i) { var o, u, l = arguments.length < 3 ? e : arguments[2]; return h(e) === l ? e[i] : (o = r.f(e, i)) ? s(o, "value") ? o.value : void 0 !== o.get ? o.get.call(l) : void 0 : a(u = n(e)) ? t(u, i, l) : void 0 } }) }, SRCy: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("x78i"), s = Math.exp; r(r.S, "Math", { tanh: function (t) { var e = n(t = +t), i = n(-t); return e == 1 / 0 ? 1 : i == 1 / 0 ? -1 : (e - i) / (s(t) + s(-t)) } }) }, "SU+a": function (t, e, i) { "use strict"; i("y325")("small", function (t) { return function () { return t(this, "small", "", "") } }) }, Sejc: function (t, e, i) { "use strict"; var r, n, s, o = i("rFzY"), a = i("PHCx"), h = i("d075"), u = i("jhxf"), l = i("OzIq"), c = l.process, d = l.setImmediate, p = l.clearImmediate, f = l.MessageChannel, g = l.Dispatch, m = 0, v = {}, y = function () { var t = +this; if (v.hasOwnProperty(t)) { var e = v[t]; delete v[t], e() } }, x = function (t) { y.call(t.data) }; d && p || (d = function (t) { for (var e = [], i = 1; arguments.length > i;)e.push(arguments[i++]); return v[++m] = function () { a("function" == typeof t ? t : Function(t), e) }, r(m), m }, p = function (t) { delete v[t] }, "process" == i("ydD5")(c) ? r = function (t) { c.nextTick(o(y, t, 1)) } : g && g.now ? r = function (t) { g.now(o(y, t, 1)) } : f ? (s = (n = new f).port2, n.port1.onmessage = x, r = o(s.postMessage, s, 1)) : l.addEventListener && "function" == typeof postMessage && !l.importScripts ? (r = function (t) { l.postMessage(t + "", "*") }, l.addEventListener("message", x, !1)) : r = "onreadystatechange" in u("script") ? function (t) { h.appendChild(u("script")).onreadystatechange = function () { h.removeChild(this), y.call(t) } } : function (t) { setTimeout(o(y, t, 1), 0) }), t.exports = { set: d, clear: p } }, Stuz: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Number", { EPSILON: Math.pow(2, -52) }) }, TFWu: function (t, e, i) { "use strict"; i("77Ug")("Uint8", 1, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, THnP: function (t, e, i) { "use strict"; i("77Ug")("Uint16", 2, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, TwzQ: function (t, e, i) { "use strict"; var r = i("49qz")(!0); t.exports = function (t, e, i) { return e + (i ? r(t, e).length : 1) } }, "U+VG": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("ydD5"); r(r.S, "Error", { isError: function (t) { return "Error" === n(t) } }) }, U6qc: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(6), s = "findIndex", o = !0; s in [] && Array(1)[s](function () { o = !1 }), r(r.P + r.F * o, "Array", { findIndex: function (t) { return n(this, t, arguments.length > 1 ? arguments[1] : void 0) } }), i("RhFG")(s) }, UJiG: function (t, e, i) { "use strict"; i("y325")("link", function (t) { return function (e) { return t(this, "a", "href", e) } }) }, "UKM+": function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; t.exports = function (t) { return "object" === (void 0 === t ? "undefined" : r(t)) ? null !== t : "function" == typeof t } }, UbXY: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("Y7Tz"); r(r.P + r.F * (Date.prototype.toISOString !== n), "Date", { toISOString: n }) }, "V/H1": function (t, e, i) { "use strict"; var r = i("fJSx"), n = i("zq/X"); i("0Rih")("WeakSet", function (t) { return function () { return t(this, arguments.length > 0 ? arguments[0] : void 0) } }, { add: function (t) { return r.def(n(this, "WeakSet"), t, !0) } }, r, !1, !0) }, "V3l/": function (t, e, i) { "use strict"; t.exports = !1 }, VTn2: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("1aA0").onFreeze; i("3i66")("freeze", function (t) { return function (e) { return t && r(e) ? t(n(e)) : e } }) }, VWgF: function (t, e, i) { "use strict"; var r = i("7gX0"), n = i("OzIq"), s = n["__core-js_shared__"] || (n["__core-js_shared__"] = {}); (t.exports = function (t, e) { return s[t] || (s[t] = void 0 !== e ? e : {}) })("versions", []).push({ version: r.version, mode: i("V3l/") ? "pure" : "global", copyright: " 2019 Denis Pushkarev (zloirock.ru)" }) }, Vg1y: function (t, e, i) { "use strict"; i("Jbuy"); var r = i("R3AP"), n = i("2p1q"), s = i("zgIt"), o = i("/whu"), a = i("kkCw"), h = i("32VL"), u = a("species"), l = !s(function () { var t = /./; return t.exec = function () { var t = []; return t.groups = { a: "7" }, t }, "7" !== "".replace(t, "$<a>") }), c = function () { var t = /(?:)/, e = t.exec; t.exec = function () { return e.apply(this, arguments) }; var i = "ab".split(t); return 2 === i.length && "a" === i[0] && "b" === i[1] }(); t.exports = function (t, e, i) { var d = a(t), p = !s(function () { var e = {}; return e[d] = function () { return 7 }, 7 != ""[t](e) }), f = p ? !s(function () { var e = !1, i = /a/; return i.exec = function () { return e = !0, null }, "split" === t && (i.constructor = {}, i.constructor[u] = function () { return i }), i[d](""), !e }) : void 0; if (!p || !f || "replace" === t && !l || "split" === t && !c) { var g = /./[d], m = i(o, d, ""[t], function (t, e, i, r, n) { return e.exec === h ? p && !n ? { done: !0, value: g.call(e, i, r) } : { done: !0, value: t.call(i, e, r) } : { done: !1 } }), v = m[0], y = m[1]; r(String.prototype, t, v), n(RegExp.prototype, d, 2 == e ? function (t, e) { return y.call(t, this, e) } : function (t) { return y.call(t, this) }) } } }, VjuZ: function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("FryR"), s = i("BbyF"), o = i("oeih"), a = i("TwzQ"), h = i("9Dx1"), u = Math.max, l = Math.min, c = Math.floor, d = /\$([$&`']|\d\d?|<[^>]*>)/g, p = /\$([$&`']|\d\d?)/g; i("Vg1y")("replace", 2, function (t, e, i, f) { return [function (r, n) { var s = t(this), o = void 0 == r ? void 0 : r[e]; return void 0 !== o ? o.call(r, s, n) : i.call(String(s), r, n) }, function (t, e) { var n = f(i, t, this, e); if (n.done) return n.value; var c = r(t), d = String(this), p = "function" == typeof e; p || (e = String(e)); var m = c.global; if (m) { var v = c.unicode; c.lastIndex = 0 } for (var y = []; ;) { var x = h(c, d); if (null === x) break; if (y.push(x), !m) break; "" === String(x[0]) && (c.lastIndex = a(d, s(c.lastIndex), v)) } for (var _, b = "", T = 0, w = 0; w < y.length; w++) { x = y[w]; for (var S = String(x[0]), C = u(l(o(x.index), d.length), 0), P = [], E = 1; E < x.length; E++)P.push(void 0 === (_ = x[E]) ? _ : String(_)); var A = x.groups; if (p) { var R = [S].concat(P, C, d); void 0 !== A && R.push(A); var M = String(e.apply(void 0, R)) } else M = g(S, d, C, P, A, e); C >= T && (b += d.slice(T, C) + M, T = C + S.length) } return b + d.slice(T) }]; function g(t, e, r, s, o, a) { var h = r + t.length, u = s.length, l = p; return void 0 !== o && (o = n(o), l = d), i.call(a, l, function (i, n) { var a; switch (n.charAt(0)) { case "$": return "$"; case "&": return t; case "`": return e.slice(0, r); case "'": return e.slice(h); case "<": a = o[n.slice(1, -1)]; break; default: var l = +n; if (0 === l) return i; if (l > u) { var d = c(l / 10); return 0 === d ? i : d <= u ? void 0 === s[d - 1] ? n.charAt(1) : s[d - 1] + n.charAt(1) : i } a = s[l - 1] }return void 0 === a ? "" : a }) } }) }, "W/IU": function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("1aA0").onFreeze; i("3i66")("seal", function (t) { return function (e) { return t && r(e) ? t(n(e)) : e } }) }, W0pi: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { DEG_PER_RAD: Math.PI / 180 }) }, W2nU: function (t, e, i) { "use strict"; var r, n, s = t.exports = {}; function o() { throw new Error("setTimeout has not been defined") } function a() { throw new Error("clearTimeout has not been defined") } function h(t) { if (r === setTimeout) return setTimeout(t, 0); if ((r === o || !r) && setTimeout) return r = setTimeout, setTimeout(t, 0); try { return r(t, 0) } catch (e) { try { return r.call(null, t, 0) } catch (e) { return r.call(this, t, 0) } } } !function () { try { r = "function" == typeof setTimeout ? setTimeout : o } catch (t) { r = o } try { n = "function" == typeof clearTimeout ? clearTimeout : a } catch (t) { n = a } }(); var u, l = [], c = !1, d = -1; function p() { c && u && (c = !1, u.length ? l = u.concat(l) : d = -1, l.length && f()) } function f() { if (!c) { var t = h(p); c = !0; for (var e = l.length; e;) { for (u = l, l = []; ++d < e;)u && u[d].run(); d = -1, e = l.length } u = null, c = !1, function (t) { if (n === clearTimeout) return clearTimeout(t); if ((n === a || !n) && clearTimeout) return n = clearTimeout, clearTimeout(t); try { n(t) } catch (e) { try { return n.call(null, t) } catch (e) { return n.call(this, t) } } }(t) } } function g(t, e) { this.fun = t, this.array = e } function m() { } s.nextTick = function (t) { var e = new Array(arguments.length - 1); if (arguments.length > 1) for (var i = 1; i < arguments.length; i++)e[i - 1] = arguments[i]; l.push(new g(t, e)), 1 !== l.length || c || h(f) }, g.prototype.run = function () { this.fun.apply(null, this.array) }, s.title = "browser", s.browser = !0, s.env = {}, s.argv = [], s.version = "", s.versions = {}, s.on = m, s.addListener = m, s.once = m, s.off = m, s.removeListener = m, s.removeAllListeners = m, s.emit = m, s.prependListener = m, s.prependOnceListener = m, s.listeners = function (t) { return [] }, s.binding = function (t) { throw new Error("process.binding is not supported") }, s.cwd = function () { return "/" }, s.chdir = function (t) { throw new Error("process.chdir is not supported") }, s.umask = function () { return 0 } }, W4Z6: function (t, e, i) { "use strict"; var r = i("FryR"), n = i("KOrd"); i("3i66")("getPrototypeOf", function () { return function (t) { return n(r(t)) } }) }, WBcL: function (t, e, i) { "use strict"; var r = {}.hasOwnProperty; t.exports = function (t, e) { return r.call(t, e) } }, WY8G: function (t, e, i) { "use strict"; t.exports = Math.scale || function (t, e, i, r, n) { return 0 === arguments.length || t != t || e != e || i != i || r != r || n != n ? NaN : t === 1 / 0 || t === -1 / 0 ? t : (t - e) * (n - r) / (i - e) + r } }, WcO1: function (t, e, i) { "use strict"; var r = i("ReGu"), n = i("QKXm").concat("length", "prototype"); e.f = Object.getOwnPropertyNames || function (t) { return r(t, n) } }, WgSQ: function (t, e, i) { "use strict"; var r = i("RhFG"), n = i("KB1o"), s = i("bN1p"), o = i("PHqh"); t.exports = i("uc2A")(Array, "Array", function (t, e) { this._t = o(t), this._i = 0, this._k = e }, function () { var t = this._t, e = this._k, i = this._i++; return !t || i >= t.length ? (this._t = void 0, n(1)) : n(0, "keys" == e ? i : "values" == e ? t[i] : [i, t[i]]) }, "values"), s.Arguments = s.Array, r("keys"), r("values"), r("entries") }, WiIn: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Number", { MAX_SAFE_INTEGER: 9007199254740991 }) }, WpPb: function (t, e, i) { "use strict"; var r = i("UKM+"); i("3i66")("isFrozen", function (t) { return function (e) { return !r(e) || !!t && t(e) } }) }, WpTh: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(5), s = !0; "find" in [] && Array(1).find(function () { s = !1 }), r(r.P + r.F * s, "Array", { find: function (t) { return n(this, t, arguments.length > 1 ? arguments[1] : void 0) } }), i("RhFG")("find") }, Wwne: function (t, e, i) { "use strict"; i("r2E/"), t.exports = i("7gX0").RegExp.escape }, "X/Hz": function (t, e, i) { "use strict"; i("y325")("fontsize", function (t) { return function (e) { return t(this, "font", "size", e) } }) }, X6NR: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { clamp: function (t, e, i) { return Math.min(i, Math.max(e, t)) } }) }, X7aK: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("DIVP"), s = function (t) { this._t = n(t), this._i = 0; var e, i = this._k = []; for (e in t) i.push(e) }; i("IRJ3")(s, "Object", function () { var t, e = this._k; do { if (this._i >= e.length) return { value: void 0, done: !0 } } while (!((t = e[this._i++]) in this._t)); return { value: t, done: !1 } }), r(r.S, "Reflect", { enumerate: function (t) { return new s(t) } }) }, XO1R: function (t, e, i) { "use strict"; var r = i("ydD5"); t.exports = Array.isArray || function (t) { return "Array" == r(t) } }, XSOZ: function (t, e, i) { "use strict"; t.exports = function (t) { if ("function" != typeof t) throw TypeError(t + " is not a function!"); return t } }, XXBo: function (t, e, i) { "use strict"; var r = i("wC1N"), n = i("QG7u"); t.exports = function (t) { return function () { if (r(this) != t) throw TypeError(t + "#toJSON isn't generic"); return n(this) } } }, Xduv: function (t, e, i) { "use strict"; t.exports = "\t\n\v\f\r \u2028\u2029\ufeff" }, XtiL: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Number", { isInteger: i("n982") }) }, XvUs: function (t, e, i) { "use strict"; var r = i("DIVP"); t.exports = function (t, e, i, n) { try { return n ? e(r(i)[0], i[1]) : e(i) } catch (e) { var s = t.return; throw void 0 !== s && r(s.call(t)), e } } }, Y1N3: function (t, e, i) { "use strict"; e.f = Object.getOwnPropertySymbols }, Y1S0: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("BbyF"), s = i("kqpo"), o = "".endsWith; r(r.P + r.F * i("1ETD")("endsWith"), "String", { endsWith: function (t) { var e = s(this, t, "endsWith"), i = arguments.length > 1 ? arguments[1] : void 0, r = n(e.length), a = void 0 === i ? r : Math.min(n(i), r), h = String(t); return o ? o.call(e, h, a) : e.slice(a - h.length, a) === h } }) }, Y1aA: function (t, e, i) { "use strict"; e.f = {}.propertyIsEnumerable }, Y5ex: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("1aA0").onFreeze; i("3i66")("preventExtensions", function (t) { return function (e) { return t && r(e) ? t(n(e)) : e } }) }, Y7Tz: function (t, e, i) { "use strict"; var r = i("zgIt"), n = Date.prototype.getTime, s = Date.prototype.toISOString, o = function (t) { return t > 9 ? t : "0" + t }; t.exports = r(function () { return "0385-07-25T07:06:39.999Z" != s.call(new Date(-5e13 - 1)) }) || !r(function () { s.call(new Date(NaN)) }) ? function () { if (!isFinite(n.call(this))) throw RangeError("Invalid time value"); var t = this, e = t.getUTCFullYear(), i = t.getUTCMilliseconds(), r = e < 0 ? "-" : e > 9999 ? "+" : ""; return r + ("00000" + Math.abs(e)).slice(r ? -6 : -4) + "-" + o(t.getUTCMonth() + 1) + "-" + o(t.getUTCDate()) + "T" + o(t.getUTCHours()) + ":" + o(t.getUTCMinutes()) + ":" + o(t.getUTCSeconds()) + "." + (i > 99 ? i : "0" + o(i)) + "Z" } : s }, YUr7: function (t, e, i) { "use strict"; var r = i("WcO1"), n = i("Y1N3"), s = i("DIVP"), o = i("OzIq").Reflect; t.exports = o && o.ownKeys || function (t) { var e = r.f(s(t)), i = n.f; return i ? e.concat(i(t)) : e } }, "YVn/": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("lKE8")(!1); r(r.S, "Object", { values: function (t) { return n(t) } }) }, Ygg6: function (t, e, i) { "use strict"; i("iKpr")("Set") }, Ymdd: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("/whu"), s = i("zgIt"), o = i("Xduv"), a = "[" + o + "]", h = RegExp("^" + a + a + "*"), u = RegExp(a + a + "*$"), l = function (t, e, i) { var n = {}, a = s(function () { return !!o[t]() || "" != ""[t]() }), h = n[t] = a ? e(c) : o[t]; i && (n[i] = h), r(r.P + r.F * a, "String", n) }, c = l.trim = function (t, e) { return t = String(n(t)), 1 & e && (t = t.replace(h, "")), 2 & e && (t = t.replace(u, "")), t }; t.exports = l }, ZDXm: function (t, e, i) { "use strict"; var r, n = i("OzIq"), s = i("LhTa")(0), o = i("R3AP"), a = i("1aA0"), h = i("oYd7"), u = i("fJSx"), l = i("UKM+"), c = i("zq/X"), d = i("zq/X"), p = !n.ActiveXObject && "ActiveXObject" in n, f = a.getWeak, g = Object.isExtensible, m = u.ufstore, v = function (t) { return function () { return t(this, arguments.length > 0 ? arguments[0] : void 0) } }, y = { get: function (t) { if (l(t)) { var e = f(t); return !0 === e ? m(c(this, "WeakMap")).get(t) : e ? e[this._i] : void 0 } }, set: function (t, e) { return u.def(c(this, "WeakMap"), t, e) } }, x = t.exports = i("0Rih")("WeakMap", v, y, u, !0, !0); d && p && (h((r = u.getConstructor(v, "WeakMap")).prototype, y), a.NEED = !0, s(["delete", "has", "get", "set"], function (t) { var e = x.prototype, i = e[t]; o(e, t, function (e, n) { if (l(e) && !g(e)) { this._f || (this._f = new r); var s = this._f[t](e, n); return "set" == t ? this : s } return i.call(this, e, n) }) })) }, ZRJK: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("zgIt"), s = i("fS0v"), o = 1..toPrecision; r(r.P + r.F * (n(function () { return "1" !== o.call(1, void 0) }) || !n(function () { o.call({}) })), "Number", { toPrecision: function (t) { var e = s(this, "Number#toPrecision: incorrect invocation!"); return void 0 === t ? o.call(e) : o.call(e, t) } }) }, ZtwE: function (t, e, i) { "use strict"; var r = i("XSOZ"), n = i("UKM+"), s = i("PHCx"), o = [].slice, a = {}; t.exports = Function.bind || function (t) { var e = r(this), i = o.call(arguments, 1), h = function r() { var n = i.concat(o.call(arguments)); return this instanceof r ? function (t, e, i) { if (!(e in a)) { for (var r = [], n = 0; n < e; n++)r[n] = "a[" + n + "]"; a[e] = Function("F,a", "return new F(" + r.join(",") + ")") } return a[e](t, i) }(e, n.length, n) : s(e, n, t) }; return n(e.prototype) && (h.prototype = e.prototype), h } }, aJ2J: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Number", { MIN_SAFE_INTEGER: -9007199254740991 }) }, aM0T: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("g36u")(), s = i("OzIq").process, o = "process" == i("ydD5")(s); r(r.G, { asap: function (t) { var e = o && s.domain; n(e ? e.bind(t) : t) } }) }, altv: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("8t38"); r(r.S + r.F * (Number.parseFloat != n), "Number", { parseFloat: n }) }, arGp: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.P + r.R, "Set", { toJSON: i("XXBo")("Set") }) }, "bG/2": function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, n = i("PHqh"), s = i("WcO1").f, o = {}.toString, a = "object" == ("undefined" == typeof window ? "undefined" : r(window)) && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : []; t.exports.f = function (t) { return a && "[object Window]" == o.call(t) ? function (t) { try { return s(t) } catch (t) { return a.slice() } }(t) : s(n(t)) } }, bN1p: function (t, e, i) { "use strict"; t.exports = {} }, bSML: function (t, e, i) { "use strict"; var r = i("lDLk"), n = i("fU25"); t.exports = function (t, e, i) { e in t ? r.f(t, e, n(0, i)) : t[e] = i } }, bUY0: function (t, e, i) { "use strict"; var r = i("lDLk"), n = i("x9zv"), s = i("KOrd"), o = i("WBcL"), a = i("Ds5P"), h = i("fU25"), u = i("DIVP"), l = i("UKM+"); a(a.S, "Reflect", { set: function t(e, i, a) { var c, d, p = arguments.length < 4 ? e : arguments[3], f = n.f(u(e), i); if (!f) { if (l(d = s(e))) return t(d, i, a, p); f = h(0) } if (o(f, "value")) { if (!1 === f.writable || !l(p)) return !1; if (c = n.f(p, i)) { if (c.get || c.set || !1 === c.writable) return !1; c.value = a, r.f(p, i, c) } else r.f(p, i, h(0, a)); return !0 } return void 0 !== f.set && (f.set.call(p, a), !0) } }) }, bUqO: function (t, e, i) { "use strict"; t.exports = !i("zgIt")(function () { return 7 != Object.defineProperty({}, "a", { get: function () { return 7 } }).a }) }, beEN: function (t, e, i) { "use strict"; var r = i("rFzY"), n = i("Ds5P"), s = i("FryR"), o = i("XvUs"), a = i("9vb1"), h = i("BbyF"), u = i("bSML"), l = i("SHe9"); n(n.S + n.F * !i("qkyc")(function (t) { Array.from(t) }), "Array", { from: function (t) { var e, i, n, c, d = s(t), p = "function" == typeof this ? this : Array, f = arguments.length, g = f > 1 ? arguments[1] : void 0, m = void 0 !== g, v = 0, y = l(d); if (m && (g = r(g, f > 2 ? arguments[2] : void 0, 2)), void 0 == y || p == Array && a(y)) for (i = new p(e = h(d.length)); e > v; v++)u(i, v, m ? g(d[v], v) : d[v]); else for (c = y.call(d), i = new p; !(n = c.next()).done; v++)u(i, v, m ? o(c, g, [n.value, v], !0) : n.value); return i.length = v, i } }) }, boo2: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("XO1R"), s = i("kkCw")("species"); t.exports = function (t) { var e; return n(t) && ("function" != typeof (e = t.constructor) || e !== Array && !n(e.prototype) || (e = void 0), r(e) && null === (e = e[s]) && (e = void 0)), void 0 === e ? Array : e } }, bqOW: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("zo/l"), s = String.fromCharCode, o = String.fromCodePoint; r(r.S + r.F * (!!o && 1 != o.length), "String", { fromCodePoint: function (t) { for (var e, i = [], r = arguments.length, o = 0; r > o;) { if (e = +arguments[o++], n(e, 1114111) !== e) throw RangeError(e + " is not a valid code point"); i.push(e < 65536 ? s(e) : s(55296 + ((e -= 65536) >> 10), e % 1024 + 56320)) } return i.join("") } }) }, cwmK: function (t, e, i) { "use strict"; t.exports = Math.sign || function (t) { return 0 == (t = +t) || t != t ? t : t < 0 ? -1 : 1 } }, d075: function (t, e, i) { "use strict"; var r = i("OzIq").document; t.exports = r && r.documentElement }, dSUw: function (t, e, i) { "use strict"; var r = i("Dgii"), n = i("zq/X"); t.exports = i("0Rih")("Set", function (t) { return function () { return t(this, arguments.length > 0 ? arguments[0] : void 0) } }, { add: function (t) { return r.def(n(this, "Set"), t = 0 === t ? 0 : t, t) } }, r) }, dTzs: function (t, e, i) { "use strict"; i("77Ug")("Float32", 4, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, dULJ: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("OgTs"); r(r.S + r.F * (Number.parseInt != n), "Number", { parseInt: n }) }, dich: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("Sejc"); r(r.G + r.B, { setImmediate: n.set, clearImmediate: n.clear }) }, "dm+7": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Reflect", { has: function (t, e) { return e in t } }) }, dm6P: function (t, e, i) { "use strict"; t.exports = i("V3l/") || !i("zgIt")(function () { var t = Math.random(); __defineSetter__.call(null, t, function () { }), delete i("OzIq")[t] }) }, dxQb: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FryR"), s = i("XSOZ"), o = i("lDLk"); i("bUqO") && r(r.P + i("dm6P"), "Object", { __defineSetter__: function (t, e) { o.f(n(this), t, { set: s(e), enumerable: !0, configurable: !0 }) } }) }, eC2H: function (t, e, i) { "use strict"; i("3i66")("getOwnPropertyNames", function () { return i("bG/2").f }) }, eVIH: function (t, e, i) { "use strict"; i("y325")("italics", function (t) { return function () { return t(this, "i", "", "") } }) }, fJSx: function (t, e, i) { "use strict"; var r = i("A16L"), n = i("1aA0").getWeak, s = i("DIVP"), o = i("UKM+"), a = i("9GpA"), h = i("vmSO"), u = i("LhTa"), l = i("WBcL"), c = i("zq/X"), d = u(5), p = u(6), f = 0, g = function (t) { return t._l || (t._l = new m) }, m = function () { this.a = [] }, v = function (t, e) { return d(t.a, function (t) { return t[0] === e }) }; m.prototype = { get: function (t) { var e = v(this, t); if (e) return e[1] }, has: function (t) { return !!v(this, t) }, set: function (t, e) { var i = v(this, t); i ? i[1] = e : this.a.push([t, e]) }, delete: function (t) { var e = p(this.a, function (e) { return e[0] === t }); return ~e && this.a.splice(e, 1), !!~e } }, t.exports = { getConstructor: function (t, e, i, s) { var u = t(function (t, r) { a(t, u, e, "_i"), t._t = e, t._i = f++ , t._l = void 0, void 0 != r && h(r, i, t[s], t) }); return r(u.prototype, { delete: function (t) { if (!o(t)) return !1; var i = n(t); return !0 === i ? g(c(this, e)).delete(t) : i && l(i, this._i) && delete i[this._i] }, has: function (t) { if (!o(t)) return !1; var i = n(t); return !0 === i ? g(c(this, e)).has(t) : i && l(i, this._i) } }), u }, def: function (t, e, i) { var r = n(s(e), !0); return !0 === r ? g(t).set(e, i) : r[t._i] = i, t }, ufstore: g } }, fOdq: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(2); r(r.P + r.F * !i("NNrz")([].filter, !0), "Array", { filter: function (t) { return n(this, t, arguments[1]) } }) }, fS0v: function (t, e, i) { "use strict"; var r = i("ydD5"); t.exports = function (t, e) { if ("number" != typeof t && "Number" != r(t)) throw TypeError(e); return +t } }, fU25: function (t, e, i) { "use strict"; t.exports = function (t, e) { return { enumerable: !(1 & t), configurable: !(2 & t), writable: !(4 & t), value: e } } }, fx22: function (t, e, i) { "use strict"; for (var r = i("WgSQ"), n = i("Qh14"), s = i("R3AP"), o = i("OzIq"), a = i("2p1q"), h = i("bN1p"), u = i("kkCw"), l = u("iterator"), c = u("toStringTag"), d = h.Array, p = { CSSRuleList: !0, CSSStyleDeclaration: !1, CSSValueList: !1, ClientRectList: !1, DOMRectList: !1, DOMStringList: !1, DOMTokenList: !0, DataTransferItemList: !1, FileList: !1, HTMLAllCollection: !1, HTMLCollection: !1, HTMLFormElement: !1, HTMLSelectElement: !1, MediaList: !0, MimeTypeArray: !1, NamedNodeMap: !1, NodeList: !0, PaintRequestList: !1, Plugin: !1, PluginArray: !1, SVGLengthList: !1, SVGNumberList: !1, SVGPathSegList: !1, SVGPointList: !1, SVGStringList: !1, SVGTransformList: !1, SourceBufferList: !1, StyleSheetList: !0, TextTrackCueList: !1, TextTrackList: !1, TouchList: !1 }, f = n(p), g = 0; g < f.length; g++) { var m, v = f[g], y = p[v], x = o[v], _ = x && x.prototype; if (_ && (_[l] || a(_, l, d), _[c] || a(_, c, v), h[v] = d, y)) for (m in r) _[m] || s(_, m, r[m], !0) } }, "g/m8": function (t, e, i) { "use strict"; var r = i("cwmK"), n = Math.pow, s = n(2, -52), o = n(2, -23), a = n(2, 127) * (2 - o), h = n(2, -126); t.exports = Math.fround || function (t) { var e, i, n = Math.abs(t), u = r(t); return n < h ? u * (n / h / o + 1 / s - 1 / s) * h * o : (i = (e = (1 + o / s) * n) - (e - n)) > a || i != i ? u * (1 / 0) : u * i } }, g36u: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("Sejc").set, s = r.MutationObserver || r.WebKitMutationObserver, o = r.process, a = r.Promise, h = "process" == i("ydD5")(o); t.exports = function () { var t, e, i, u = function () { var r, n; for (h && (r = o.domain) && r.exit(); t;) { n = t.fn, t = t.next; try { n() } catch (r) { throw t ? i() : e = void 0, r } } e = void 0, r && r.enter() }; if (h) i = function () { o.nextTick(u) }; else if (!s || r.navigator && r.navigator.standalone) if (a && a.resolve) { var l = a.resolve(void 0); i = function () { l.then(u) } } else i = function () { n.call(r, u) }; else { var c = !0, d = document.createTextNode(""); new s(u).observe(d, { characterData: !0 }), i = function () { d.data = c = !c } } return function (r) { var n = { fn: r, next: void 0 }; e && (e.next = n), t || (t = n, i()), e = n } } }, gPva: function (t, e, i) { "use strict"; var r = i("UKM+"); i("3i66")("isExtensible", function (t) { return function (e) { return !!r(e) && (!t || t(e)) } }) }, gYYG: function (t, e, i) { "use strict"; var r = i("wC1N"), n = {}; n[i("kkCw")("toStringTag")] = "z", n + "" != "[object z]" && i("R3AP")(Object.prototype, "toString", function () { return "[object " + r(this) + "]" }, !0) }, gbyG: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("ot5s")(!0); r(r.P, "Array", { includes: function (t) { return n(this, t, arguments.length > 1 ? arguments[1] : void 0) } }), i("RhFG")("includes") }, gvDt: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("DIVP"), s = function (t, e) { if (n(t), !r(e) && null !== e) throw TypeError(e + ": can't set as prototype!") }; t.exports = { set: Object.setPrototypeOf || ("__proto__" in {} ? function (t, e, r) { try { (r = i("rFzY")(Function.call, i("x9zv").f(Object.prototype, "__proto__").set, 2))(t, []), e = !(t instanceof Array) } catch (t) { e = !0 } return function (t, i) { return s(t, i), e ? t.__proto__ = i : r(t, i), t } }({}, !1) : void 0), check: s } }, h7Xi: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.P + r.R, "Map", { toJSON: i("XXBo")("Map") }) }, i039: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { umulh: function (t, e) { var i = +t, r = +e, n = 65535 & i, s = 65535 & r, o = i >>> 16, a = r >>> 16, h = (o * s >>> 0) + (n * s >>> 16); return o * a + (h >>> 16) + ((n * a >>> 0) + (65535 & h) >>> 16) } }) }, i68Q: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Object", { create: i("7ylX") }) }, iKpr: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("XSOZ"), s = i("rFzY"), o = i("vmSO"); t.exports = function (t) { r(r.S, t, { from: function (t) { var e, i, r, a, h = arguments[1]; return n(this), (e = void 0 !== h) && n(h), void 0 == t ? new this : (i = [], e ? (r = 0, a = s(h, arguments[2], 2), o(t, !1, function (t) { i.push(a(t, r++)) })) : o(t, !1, i.push, i), new this(i)) } }) } }, iM2X: function (t, e, i) { "use strict"; i("y325")("bold", function (t) { return function () { return t(this, "b", "", "") } }) }, "j/Lv": function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "System", { global: i("OzIq") }) }, j1ja: function (t, e, i) { "use strict"; (function (t) { if (i("4M2W"), i("zkX4"), i("Wwne"), t._babelPolyfill) throw new Error("only one instance of babel-polyfill is allowed"); t._babelPolyfill = !0; var e = "defineProperty"; function r(t, i, r) { t[i] || Object[e](t, i, { writable: !0, configurable: !0, value: r }) } r(String.prototype, "padLeft", "".padStart), r(String.prototype, "padRight", "".padEnd), "pop,reverse,shift,keys,values,entries,indexOf,every,some,forEach,map,filter,find,findIndex,includes,join,slice,concat,push,splice,unshift,sort,lastIndexOf,reduce,reduceRight,copyWithin,fill".split(",").forEach(function (t) { [][t] && r(Array, t, Function.call.bind([][t])) }) }).call(e, i("DuR2")) }, j42X: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("PHqh"), s = [].join; r(r.P + r.F * (i("Q6Nf") != Object || !i("NNrz")(s)), "Array", { join: function (t) { return s.call(n(this), void 0 === t ? "," : t) } }) }, jB26: function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("s4j0"); t.exports = function (t) { if ("string" !== t && "number" !== t && "default" !== t) throw TypeError("Incorrect hint"); return n(r(this), "number" != t) } }, jhxf: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("OzIq").document, s = r(n) && r(n.createElement); t.exports = function (t) { return s ? n.createElement(t) : {} } }, jrHM: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Object", { setPrototypeOf: i("gvDt").set }) }, kBOG: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("cwmK"); r(r.S, "Math", { cbrt: function (t) { return n(t = +t) * Math.pow(Math.abs(t), 1 / 3) } }) }, kic5: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("gvDt").set; t.exports = function (t, e, i) { var s, o = e.constructor; return o !== i && "function" == typeof o && (s = o.prototype) !== i.prototype && r(s) && n && n(t, s), t } }, kkCw: function (t, e, i) { "use strict"; var r = i("VWgF")("wks"), n = i("ulTY"), s = i("OzIq").Symbol, o = "function" == typeof s; (t.exports = function (t) { return r[t] || (r[t] = o && s[t] || (o ? s : n)("Symbol." + t)) }).store = r }, kqpo: function (t, e, i) { "use strict"; var r = i("u0PK"), n = i("/whu"); t.exports = function (t, e, i) { if (r(e)) throw TypeError("String#" + i + " doesn't accept regex!"); return String(n(t)) } }, lDLk: function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("xZa+"), s = i("s4j0"), o = Object.defineProperty; e.f = i("bUqO") ? Object.defineProperty : function (t, e, i) { if (r(t), e = s(e, !0), r(i), n) try { return o(t, e, i) } catch (t) { } if ("get" in i || "set" in i) throw TypeError("Accessors not supported!"); return "value" in i && (t[e] = i.value), t } }, lKE8: function (t, e, i) { "use strict"; var r = i("bUqO"), n = i("Qh14"), s = i("PHqh"), o = i("Y1aA").f; t.exports = function (t) { return function (e) { for (var i, a = s(e), h = n(a), u = h.length, l = 0, c = []; u > l;)i = h[l++], r && !o.call(a, i) || c.push(t ? [i, a[i]] : a[i]); return c } } }, lkT3: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FkIZ"); r(r.P + r.F * !i("NNrz")([].reduceRight, !0), "Array", { reduceRight: function (t) { return n(this, t, arguments.length, arguments[1], !0) } }) }, lnZN: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("kic5"), s = i("lDLk").f, o = i("WcO1").f, a = i("u0PK"), h = i("0pGU"), u = r.RegExp, l = u, c = u.prototype, d = /a/g, p = /a/g, f = new u(d) !== d; if (i("bUqO") && (!f || i("zgIt")(function () { return p[i("kkCw")("match")] = !1, u(d) != d || u(p) == p || "/a/i" != u(d, "i") }))) { u = function (t, e) { var i = this instanceof u, r = a(t), s = void 0 === e; return !i && r && t.constructor === u && s ? t : n(f ? new l(r && !s ? t.source : t, e) : l((r = t instanceof u) ? t.source : t, r && s ? h.call(t) : e), i ? this : c, u) }; for (var g = function (t) { t in u || s(u, t, { configurable: !0, get: function () { return l[t] }, set: function (e) { l[t] = e } }) }, m = o(l), v = 0; m.length > v;)g(m[v++]); c.constructor = u, u.prototype = c, i("R3AP")(r, "RegExp", u) } i("CEne")("RegExp") }, lyhN: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = Math.atanh; r(r.S + r.F * !(n && 1 / n(-0) < 0), "Math", { atanh: function (t) { return 0 == (t = +t) ? t : Math.log((1 + t) / (1 - t)) / 2 } }) }, m6Yj: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { fround: i("g/m8") }) }, m8F4: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("2VSL"), s = i("41xE"), o = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(s); r(r.P + r.F * o, "String", { padEnd: function (t) { return n(this, t, arguments.length > 1 ? arguments[1] : void 0, !1) } }) }, mJx5: function (t, e, i) { "use strict"; var r = i("u0PK"), n = i("DIVP"), s = i("7O1s"), o = i("TwzQ"), a = i("BbyF"), h = i("9Dx1"), u = i("32VL"), l = i("zgIt"), c = Math.min, d = [].push, p = !l(function () { RegExp(4294967295, "y") }); i("Vg1y")("split", 2, function (t, e, i, l) { var f; return f = "c" == "abbc".split(/(b)*/)[1] || 4 != "test".split(/(?:)/, -1).length || 2 != "ab".split(/(?:ab)*/).length || 4 != ".".split(/(.?)(.?)/).length || ".".split(/()()/).length > 1 || "".split(/.?/).length ? function (t, e) { var n = String(this); if (void 0 === t && 0 === e) return []; if (!r(t)) return i.call(n, t, e); for (var s, o, a, h = [], l = (t.ignoreCase ? "i" : "") + (t.multiline ? "m" : "") + (t.unicode ? "u" : "") + (t.sticky ? "y" : ""), c = 0, p = void 0 === e ? 4294967295 : e >>> 0, f = new RegExp(t.source, l + "g"); (s = u.call(f, n)) && !((o = f.lastIndex) > c && (h.push(n.slice(c, s.index)), s.length > 1 && s.index < n.length && d.apply(h, s.slice(1)), a = s[0].length, c = o, h.length >= p));)f.lastIndex === s.index && f.lastIndex++; return c === n.length ? !a && f.test("") || h.push("") : h.push(n.slice(c)), h.length > p ? h.slice(0, p) : h } : "0".split(void 0, 0).length ? function (t, e) { return void 0 === t && 0 === e ? [] : i.call(this, t, e) } : i, [function (i, r) { var n = t(this), s = void 0 == i ? void 0 : i[e]; return void 0 !== s ? s.call(i, n, r) : f.call(String(n), i, r) }, function (t, e) { var r = l(f, t, this, e, f !== i); if (r.done) return r.value; var u = n(t), d = String(this), g = s(u, RegExp), m = u.unicode, v = (u.ignoreCase ? "i" : "") + (u.multiline ? "m" : "") + (u.unicode ? "u" : "") + (p ? "y" : "g"), y = new g(p ? u : "^(?:" + u.source + ")", v), x = void 0 === e ? 4294967295 : e >>> 0; if (0 === x) return []; if (0 === d.length) return null === h(y, d) ? [d] : []; for (var _ = 0, b = 0, T = []; b < d.length;) { y.lastIndex = p ? b : 0; var w, S = h(y, p ? d : d.slice(b)); if (null === S || (w = c(a(y.lastIndex + (p ? 0 : b)), d.length)) === _) b = o(d, b, m); else { if (T.push(d.slice(_, b)), T.length === x) return T; for (var C = 1; C <= S.length - 1; C++)if (T.push(S[C]), T.length === x) return T; b = _ = w } } return T.push(d.slice(_)), T }] }) }, mTp7: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("gvDt"); n && r(r.S, "Reflect", { setPrototypeOf: function (t, e) { n.check(t, e); try { return n.set(t, e), !0 } catch (t) { return !1 } } }) }, mZON: function (t, e, i) { "use strict"; var r = i("VWgF")("keys"), n = i("ulTY"); t.exports = function (t) { return r[t] || (r[t] = n(t)) } }, mhn7: function (t, e, i) { "use strict"; i("Ymdd")("trim", function (t) { return function () { return t(this, 3) } }) }, n12u: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S + r.F, "Object", { assign: i("oYd7") }) }, n982: function (t, e, i) { "use strict"; var r = i("UKM+"), n = Math.floor; t.exports = function (t) { return !r(t) && isFinite(t) && n(t) === t } }, nRs1: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Object", { is: i("4IZP") }) }, nh2o: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("OzIq"), s = i("7gX0"), o = i("g36u")(), a = i("kkCw")("observable"), h = i("XSOZ"), u = i("DIVP"), l = i("9GpA"), c = i("A16L"), d = i("2p1q"), p = i("vmSO"), f = p.RETURN, g = function (t) { return null == t ? void 0 : h(t) }, m = function (t) { var e = t._c; e && (t._c = void 0, e()) }, v = function (t) { return void 0 === t._o }, y = function (t) { v(t) || (t._o = void 0, m(t)) }, x = function (t, e) { u(t), this._c = void 0, this._o = t, t = new _(this); try { var i = e(t), r = i; null != i && ("function" == typeof i.unsubscribe ? i = function () { r.unsubscribe() } : h(i), this._c = i) } catch (e) { return void t.error(e) } v(this) && m(this) }; x.prototype = c({}, { unsubscribe: function () { y(this) } }); var _ = function (t) { this._s = t }; _.prototype = c({}, { next: function (t) { var e = this._s; if (!v(e)) { var i = e._o; try { var r = g(i.next); if (r) return r.call(i, t) } catch (t) { try { y(e) } finally { throw t } } } }, error: function (t) { var e = this._s; if (v(e)) throw t; var i = e._o; e._o = void 0; try { var r = g(i.error); if (!r) throw t; t = r.call(i, t) } catch (t) { try { m(e) } finally { throw t } } return m(e), t }, complete: function (t) { var e = this._s; if (!v(e)) { var i = e._o; e._o = void 0; try { var r = g(i.complete); t = r ? r.call(i, t) : void 0 } catch (t) { try { m(e) } finally { throw t } } return m(e), t } } }); var b = function (t) { l(this, b, "Observable", "_f")._f = h(t) }; c(b.prototype, { subscribe: function (t) { return new x(t, this._f) }, forEach: function (t) { var e = this; return new (s.Promise || n.Promise)(function (i, r) { h(t); var n = e.subscribe({ next: function (e) { try { return t(e) } catch (t) { r(t), n.unsubscribe() } }, error: r, complete: i }) }) } }), c(b, { from: function (t) { var e = "function" == typeof this ? this : b, i = g(u(t)[a]); if (i) { var r = u(i.call(t)); return r.constructor === e ? r : new e(function (t) { return r.subscribe(t) }) } return new e(function (e) { var i = !1; return o(function () { if (!i) { try { if (p(t, !1, function (t) { if (e.next(t), i) return f }) === f) return } catch (t) { if (i) throw t; return void e.error(t) } e.complete() } }), function () { i = !0 } }) }, of: function () { for (var t = 0, e = arguments.length, i = new Array(e); t < e;)i[t] = arguments[t++]; return new ("function" == typeof this ? this : b)(function (t) { var e = !1; return o(function () { if (!e) { for (var r = 0; r < i.length; ++r)if (t.next(i[r]), e) return; t.complete() } }), function () { e = !0 } }) } }), d(b.prototype, a, function () { return this }), r(r.G, { Observable: b }), i("CEne")("Observable") }, nphH: function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("UKM+"), s = i("w6Dh"); t.exports = function (t, e) { if (r(t), n(e) && e.constructor === t) return e; var i = s.f(t); return (0, i.resolve)(e), i.promise } }, nqOf: function (t, e, i) { "use strict"; t.exports = function (t, e) { var i = e === Object(e) ? function (t) { return e[t] } : e; return function (e) { return String(e).replace(t, i) } } }, oF0V: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("IFpc"), s = i("FryR"), o = i("BbyF"), a = i("XSOZ"), h = i("plSV"); r(r.P, "Array", { flatMap: function (t) { var e, i, r = s(this); return a(t), e = o(r.length), i = h(r, 0), n(i, r, r, e, 0, 1, t, arguments[1]), i } }), i("RhFG")("flatMap") }, oHKp: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("PHqh"), s = i("oeih"), o = i("BbyF"), a = [].lastIndexOf, h = !!a && 1 / [1].lastIndexOf(1, -0) < 0; r(r.P + r.F * (h || !i("NNrz")(a)), "Array", { lastIndexOf: function (t) { if (h) return a.apply(this, arguments) || 0; var e = n(this), i = o(e.length), r = i - 1; for (arguments.length > 1 && (r = Math.min(r, s(arguments[1]))), r < 0 && (r = i + r); r >= 0; r--)if (r in e && e[r] === t) return r || 0; return -1 } }) }, oYd7: function (t, e, i) { "use strict"; var r = i("bUqO"), n = i("Qh14"), s = i("Y1N3"), o = i("Y1aA"), a = i("FryR"), h = i("Q6Nf"), u = Object.assign; t.exports = !u || i("zgIt")(function () { var t = {}, e = {}, i = Symbol(), r = "abcdefghijklmnopqrst"; return t[i] = 7, r.split("").forEach(function (t) { e[t] = t }), 7 != u({}, t)[i] || Object.keys(u({}, e)).join("") != r }) ? function (t, e) { for (var i = a(t), u = arguments.length, l = 1, c = s.f, d = o.f; u > l;)for (var p, f = h(arguments[l++]), g = c ? n(f).concat(c(f)) : n(f), m = g.length, v = 0; m > v;)p = g[v++], r && !d.call(f, p) || (i[p] = f[p]); return i } : u }, oYp4: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FryR"), s = i("XSOZ"), o = i("lDLk"); i("bUqO") && r(r.P + i("dm6P"), "Object", { __defineGetter__: function (t, e) { o.f(n(this), t, { get: s(e), enumerable: !0, configurable: !0 }) } }) }, oeih: function (t, e, i) { "use strict"; var r = Math.ceil, n = Math.floor; t.exports = function (t) { return isNaN(t = +t) ? 0 : (t > 0 ? n : r)(t) } }, ot5s: function (t, e, i) { "use strict"; var r = i("PHqh"), n = i("BbyF"), s = i("zo/l"); t.exports = function (t) { return function (e, i, o) { var a, h = r(e), u = n(h.length), l = s(o, u); if (t && i != i) { for (; u > l;)if ((a = h[l++]) != a) return !0 } else for (; u > l; l++)if ((t || l in h) && h[l] === i) return t || l || 0; return !t && -1 } } }, pWGb: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { log1p: i("Rz2z") }) }, "pd+2": function (t, e, i) { "use strict"; i("bUqO") && "g" != /./g.flags && i("lDLk").f(RegExp.prototype, "flags", { configurable: !0, get: i("0pGU") }) }, plSV: function (t, e, i) { "use strict"; var r = i("boo2"); t.exports = function (t, e) { return new (r(t))(e) } }, "qZb+": function (t, e, i) { "use strict"; i("0j1G")("Set") }, qdHU: function (t, e, i) { "use strict"; i("iKpr")("WeakSet") }, qhzm: function (t, e, i) { (function (e) { t.exports = e.Phaser = i("sq6g") }).call(e, i("DuR2")) }, qkyc: function (t, e, i) { "use strict"; var r = i("kkCw")("iterator"), n = !1; try { var s = [7][r](); s.return = function () { n = !0 }, Array.from(s, function () { throw 2 }) } catch (t) { } t.exports = function (t, e) { if (!e && !n) return !1; var i = !1; try { var s = [7], o = s[r](); o.next = function () { return { done: i = !0 } }, s[r] = function () { return o }, t(s) } catch (t) { } return i } }, qtRy: function (t, e, i) { "use strict"; i("77Ug")("Int16", 2, function (t) { return function (e, i, r) { return t(this, e, i, r) } }) }, qwQ3: function (t, e, i) { "use strict"; var r = i("DIVP"), n = i("4IZP"), s = i("9Dx1"); i("Vg1y")("search", 1, function (t, e, i, o) { return [function (i) { var r = t(this), n = void 0 == i ? void 0 : i[e]; return void 0 !== n ? n.call(i, r) : new RegExp(i)[e](String(r)) }, function (t) { var e = o(i, t, this); if (e.done) return e.value; var a = r(t), h = String(this), u = a.lastIndex; n(u, 0) || (a.lastIndex = 0); var l = s(a, h); return n(a.lastIndex, u) || (a.lastIndex = u), null === l ? -1 : l.index }] }) }, "r2E/": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("nqOf")(/[\\^$*+?.()|[\]{}]/g, "\\$&"); r(r.S, "RegExp", { escape: function (t) { return n(t) } }) }, rFzY: function (t, e, i) { "use strict"; var r = i("XSOZ"); t.exports = function (t, e, i) { if (r(t), void 0 === e) return t; switch (i) { case 1: return function (i) { return t.call(e, i) }; case 2: return function (i, r) { return t.call(e, i, r) }; case 3: return function (i, r, n) { return t.call(e, i, r, n) } }return function () { return t.apply(e, arguments) } } }, s4j0: function (t, e, i) { "use strict"; var r = i("UKM+"); t.exports = function (t, e) { if (!r(t)) return t; var i, n; if (e && "function" == typeof (i = t.toString) && !r(n = i.call(t))) return n; if ("function" == typeof (i = t.valueOf) && !r(n = i.call(t))) return n; if (!e && "function" == typeof (i = t.toString) && !r(n = i.call(t))) return n; throw TypeError("Can't convert object to primitive value") } }, sc7i: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("/whu"), s = i("BbyF"), o = i("u0PK"), a = i("0pGU"), h = RegExp.prototype, u = function (t, e) { this._r = t, this._s = e }; i("IRJ3")(u, "RegExp String", function () { var t = this._r.exec(this._s); return { value: t, done: null === t } }), r(r.P, "String", { matchAll: function (t) { if (n(this), !o(t)) throw TypeError(t + " is not a regexp!"); var e = String(this), i = "flags" in h ? String(t.flags) : a.call(t), r = new RegExp(t.source, ~i.indexOf("g") ? i : "g" + i); return r.lastIndex = s(t.lastIndex), new u(r, e) } }) }, "smQ+": function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("2VSL"), s = i("41xE"), o = /Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(s); r(r.P + r.F * o, "String", { padStart: function (t) { return n(this, t, arguments.length > 1 ? arguments[1] : void 0, !0) } }) }, sq6g: function (t, e, i) { "use strict"; (function (i) { var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; (function () { var i = i || {}; i.DisplayObject = function () { this.position = new i.Point(0, 0), this.scale = new i.Point(1, 1), this.pivot = new i.Point(0, 0), this.rotation = 0, this.alpha = 1, this.visible = !0, this.hitArea = null, this.renderable = !1, this.parent = null, this.worldAlpha = 1, this.worldTransform = new Phaser.Matrix, this.worldPosition = new i.Point(0, 0), this.worldScale = new i.Point(1, 1), this.worldRotation = 0, this.filterArea = null, this._sr = 0, this._cr = 1, this._bounds = new i.Rectangle(0, 0, 0, 0), this._currentBounds = null, this._mask = null, this._cacheAsBitmap = !1, this._cacheIsDirty = !1 }, i.DisplayObject.prototype = { constructor: i.DisplayObject, destroy: function () { if (this.children) { for (var t = this.children.length; t--;)this.children[t].destroy(); this.children = [] } this.hitArea = null, this.parent = null, this.worldTransform = null, this.filterArea = null, this.renderable = !1, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite() }, updateTransform: function (t) { if (!t && !this.parent && !this.game) return this; var e = this.parent; t ? e = t : this.parent || (e = this.game.world); var i, r, n, s, o, a, h = e.worldTransform, u = this.worldTransform; this.rotation % Phaser.Math.PI2 ? (this.rotation !== this.rotationCache && (this.rotationCache = this.rotation, this._sr = Math.sin(this.rotation), this._cr = Math.cos(this.rotation)), i = this._cr * this.scale.x, r = this._sr * this.scale.x, n = -this._sr * this.scale.y, s = this._cr * this.scale.y, o = this.position.x, a = this.position.y, (this.pivot.x || this.pivot.y) && (o -= this.pivot.x * i + this.pivot.y * n, a -= this.pivot.x * r + this.pivot.y * s), u.a = i * h.a + r * h.c, u.b = i * h.b + r * h.d, u.c = n * h.a + s * h.c, u.d = n * h.b + s * h.d, u.tx = o * h.a + a * h.c + h.tx, u.ty = o * h.b + a * h.d + h.ty) : (i = this.scale.x, r = 0, n = 0, s = this.scale.y, o = this.position.x - this.pivot.x * i, a = this.position.y - this.pivot.y * s, u.a = i * h.a, u.b = i * h.b, u.c = s * h.c, u.d = s * h.d, u.tx = o * h.a + a * h.c + h.tx, u.ty = o * h.b + a * h.d + h.ty), i = u.a, r = u.b, n = u.c; var l = i * (s = u.d) - r * n; if (i || r) { var c = Math.sqrt(i * i + r * r); this.worldRotation = r > 0 ? Math.acos(i / c) : -Math.acos(i / c), this.worldScale.x = c, this.worldScale.y = l / c } else if (n || s) { var d = Math.sqrt(n * n + s * s); this.worldRotation = Phaser.Math.HALF_PI - (s > 0 ? Math.acos(-n / d) : -Math.acos(n / d)), this.worldScale.x = l / d, this.worldScale.y = d } else this.worldScale.x = 0, this.worldScale.y = 0; return this.worldAlpha = this.alpha * e.worldAlpha, this.worldPosition.x = u.tx, this.worldPosition.y = u.ty, this._currentBounds = null, this.transformCallback && this.transformCallback.call(this.transformCallbackContext, u, h), this }, preUpdate: function () { }, generateTexture: function (t, e, r) { var n = this.getLocalBounds(), s = new Phaser.RenderTexture(this.game, 0 | n.width, 0 | n.height, r, e, t); return i.DisplayObject._tempMatrix.tx = -n.x, i.DisplayObject._tempMatrix.ty = -n.y, s.render(this, i.DisplayObject._tempMatrix), s }, updateCache: function () { return this._generateCachedSprite(), this }, toGlobal: function (t) { return this.updateTransform(), this.worldTransform.apply(t) }, toLocal: function (t, e) { return e && (t = e.toGlobal(t)), this.updateTransform(), this.worldTransform.applyInverse(t) }, _renderCachedSprite: function (t) { this._cachedSprite.worldAlpha = this.worldAlpha, t.gl ? i.Sprite.prototype._renderWebGL.call(this._cachedSprite, t) : i.Sprite.prototype._renderCanvas.call(this._cachedSprite, t) }, _generateCachedSprite: function () { this._cacheAsBitmap = !1; var t = this.getLocalBounds(); if (t.width = Math.max(1, Math.ceil(t.width)), t.height = Math.max(1, Math.ceil(t.height)), this.updateTransform(), this._cachedSprite) this._cachedSprite.texture.resize(t.width, t.height); else { var e = 0; this.texture && this.texture.baseTexture && i._enableMultiTextureToggle && (e = this.texture.baseTexture.textureIndex); var r = new Phaser.RenderTexture(this.game, t.width, t.height, void 0, void 0, void 0, void 0, e); this._cachedSprite = new i.Sprite(r), this._cachedSprite.worldTransform = this.worldTransform } var n = this._filters; this._filters = null, this._cachedSprite.filters = n, i.DisplayObject._tempMatrix.tx = -t.x, i.DisplayObject._tempMatrix.ty = -t.y, this._cachedSprite.texture.render(this, i.DisplayObject._tempMatrix, !0), this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, this._filters = n, this._cacheAsBitmap = !0 }, _destroyCachedSprite: function () { this._cachedSprite && (this._cachedSprite.texture.destroy(!0), this._cachedSprite = null) } }, i.DisplayObject.prototype.displayObjectUpdateTransform = i.DisplayObject.prototype.updateTransform, Object.defineProperties(i.DisplayObject.prototype, { x: { get: function () { return this.position.x }, set: function (t) { this.position.x = t } }, y: { get: function () { return this.position.y }, set: function (t) { this.position.y = t } }, worldVisible: { get: function () { if (this.visible) { var t = this.parent; if (!t) return this.visible; do { if (!t.visible) return !1; t = t.parent } while (t); return !0 } return !1 } }, mask: { get: function () { return this._mask }, set: function (t) { this._mask && (this._mask.isMask = !1), this._mask = t, t && (this._mask.isMask = !0) } }, filters: { get: function () { return this._filters }, set: function (t) { if (Array.isArray(t)) { for (var e = [], r = 0; r < t.length; r++)for (var n = t[r].passes, s = 0; s < n.length; s++)e.push(n[s]); this._filterBlock = { target: this, filterPasses: e } } this._filters = t, this.blendMode && this.blendMode === i.blendModes.MULTIPLY && (this.blendMode = i.blendModes.NORMAL) } }, cacheAsBitmap: { get: function () { return this._cacheAsBitmap }, set: function (t) { this._cacheAsBitmap !== t && (t ? this._generateCachedSprite() : this._destroyCachedSprite(), this._cacheAsBitmap = t) } } }), i.DisplayObjectContainer = function () { i.DisplayObject.call(this), this.children = [], this.ignoreChildInput = !1 }, i.DisplayObjectContainer.prototype = Object.create(i.DisplayObject.prototype), i.DisplayObjectContainer.prototype.constructor = i.DisplayObjectContainer, i.DisplayObjectContainer.prototype.addChild = function (t) { return this.addChildAt(t, this.children.length) }, i.DisplayObjectContainer.prototype.addChildAt = function (t, e) { if (e >= 0 && e <= this.children.length) return t.parent && t.parent.removeChild(t), t.parent = this, this.children.splice(e, 0, t), t; throw new Error(t + "addChildAt: The index " + e + " supplied is out of bounds " + this.children.length) }, i.DisplayObjectContainer.prototype.swapChildren = function (t, e) { if (t !== e) { var i = this.getChildIndex(t), r = this.getChildIndex(e); if (i < 0 || r < 0) throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller."); this.children[i] = e, this.children[r] = t } }, i.DisplayObjectContainer.prototype.getChildIndex = function (t) { var e = this.children.indexOf(t); if (-1 === e) throw new Error("The supplied DisplayObject must be a child of the caller"); return e }, i.DisplayObjectContainer.prototype.setChildIndex = function (t, e) { if (e < 0 || e >= this.children.length) throw new Error("The supplied index is out of bounds"); var i = this.getChildIndex(t); this.children.splice(i, 1), this.children.splice(e, 0, t) }, i.DisplayObjectContainer.prototype.getChildAt = function (t) { if (t < 0 || t >= this.children.length) throw new Error("getChildAt: Supplied index " + t + " does not exist in the child list, or the supplied DisplayObject must be a child of the caller"); return this.children[t] }, i.DisplayObjectContainer.prototype.removeChild = function (t) { var e = this.children.indexOf(t); if (-1 !== e) return this.removeChildAt(e) }, i.DisplayObjectContainer.prototype.removeChildAt = function (t) { var e = this.getChildAt(t); return e && (e.parent = void 0, this.children.splice(t, 1)), e }, i.DisplayObjectContainer.prototype.removeChildren = function (t, e) { void 0 === t && (t = 0), void 0 === e && (e = this.children.length); var i = e - t; if (i > 0 && i <= e) { for (var r = this.children.splice(t, i), n = 0; n < r.length; n++) { r[n].parent = void 0 } return r } if (0 === i && 0 === this.children.length) return []; throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range") }, i.DisplayObjectContainer.prototype.updateTransform = function () { if (this.visible && (this.displayObjectUpdateTransform(), !this._cacheAsBitmap)) for (var t = 0; t < this.children.length; t++)this.children[t].updateTransform() }, i.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform = i.DisplayObjectContainer.prototype.updateTransform, i.DisplayObjectContainer.prototype.getBounds = function (t) { var e, r = t && t instanceof i.DisplayObject, n = !0; if (r ? n = t instanceof i.DisplayObjectContainer && t.contains(this) : t = this, r) { var s = t.worldTransform; for (t.worldTransform = Phaser.identityMatrix, e = 0; e < t.children.length; e++)t.children[e].updateTransform() } var o, a, h, u = 1 / 0, l = 1 / 0, c = -1 / 0, d = -1 / 0, p = !1; for (e = 0; e < this.children.length; e++) { this.children[e].visible && (p = !0, u = u < (o = this.children[e].getBounds()).x ? u : o.x, l = l < o.y ? l : o.y, a = o.width + o.x, h = o.height + o.y, c = c > a ? c : a, d = d > h ? d : h) } var f = this._bounds; if (!p) { var g = (f = new i.Rectangle).x, m = f.width + f.x, v = f.y, y = f.height + f.y, x = this.worldTransform, _ = x.a, b = x.b, T = x.c, w = x.d, S = x.tx, C = x.ty, P = _ * m + T * y + S, E = w * y + b * m + C, A = _ * g + T * y + S, R = w * y + b * g + C, M = _ * g + T * v + S, L = w * v + b * g + C, I = _ * m + T * v + S, O = w * v + b * m + C; c = P, d = E, l = E, u = I < (u = M < (u = A < (u = P) ? A : u) ? M : u) ? I : u, l = O < (l = L < (l = R < l ? R : l) ? L : l) ? O : l, c = I > (c = M > (c = A > c ? A : c) ? M : c) ? I : c, d = O > (d = L > (d = R > d ? R : d) ? L : d) ? O : d } if (f.x = u, f.y = l, f.width = c - u, f.height = d - l, r) for (t.worldTransform = s, e = 0; e < t.children.length; e++)t.children[e].updateTransform(); if (!n) { var D = t.getBounds(); f.x -= D.x, f.y -= D.y } return f }, i.DisplayObjectContainer.prototype.getLocalBounds = function () { return this.getBounds(this) }, i.DisplayObjectContainer.prototype.contains = function (t) { return !!t && (t === this || this.contains(t.parent)) }, i.DisplayObjectContainer.prototype._renderWebGL = function (t) { var e; if (this.visible && !(this.alpha <= 0)) if (this._cacheAsBitmap) this._renderCachedSprite(t); else if (this._mask || this._filters) { for (this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(t); t.spriteBatch.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), t.spriteBatch.start() } else for (e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(t) }, i.DisplayObjectContainer.prototype._renderCanvas = function (t) { if (!1 !== this.visible && 0 !== this.alpha) if (this._cacheAsBitmap) this._renderCachedSprite(t); else { this._mask && t.maskManager.pushMask(this._mask, t); for (var e = 0; e < this.children.length; e++)this.children[e]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } }, Object.defineProperty(i.DisplayObjectContainer.prototype, "width", { get: function () { return this.getLocalBounds().width * this.scale.x }, set: function (t) { var e = this.getLocalBounds().width; this.scale.x = 0 !== e ? t / e : 1, this._width = t } }), Object.defineProperty(i.DisplayObjectContainer.prototype, "height", { get: function () { return this.getLocalBounds().height * this.scale.y }, set: function (t) { var e = this.getLocalBounds().height; this.scale.y = 0 !== e ? t / e : 1, this._height = t } }), i.Sprite = function (t) { i.DisplayObjectContainer.call(this), this.anchor = new i.Point(i.Sprite.defaultAnchor.x, i.Sprite.defaultAnchor.y), this.texture = t || i.Texture.emptyTexture, this._width = 0, this._height = 0, this.tint = 16777215, this.cachedTint = -1, this.tintedTexture = null, this.blendMode = i.blendModes.NORMAL, this.shader = null, this.exists = !0, this.texture.baseTexture.hasLoaded && this.onTextureUpdate(), this.renderable = !0 }, i.Sprite.defaultAnchor = { x: 0, y: 0 }, i.Sprite.prototype = Object.create(i.DisplayObjectContainer.prototype), i.Sprite.prototype.constructor = i.Sprite, Object.defineProperty(i.Sprite.prototype, "width", { get: function () { return this.scale.x * this.texture.frame.width }, set: function (t) { this.scale.x = t / this.texture.frame.width, this._width = t } }), Object.defineProperty(i.Sprite.prototype, "height", { get: function () { return this.scale.y * this.texture.frame.height }, set: function (t) { this.scale.y = t / this.texture.frame.height, this._height = t } }), i.Sprite.prototype.setTexture = function (t, e) { e && this.texture.baseTexture.destroy(), this.texture.baseTexture.skipRender = !1, this.texture = t, this.texture.valid = !0, this.cachedTint = -1 }, i.Sprite.prototype.onTextureUpdate = function () { this._width && (this.scale.x = this._width / this.texture.frame.width), this._height && (this.scale.y = this._height / this.texture.frame.height) }, i.Sprite.prototype.getBounds = function (t) { var e = this.texture.frame.width, i = this.texture.frame.height, r = e * (1 - this.anchor.x), n = e * -this.anchor.x, s = i * (1 - this.anchor.y), o = i * -this.anchor.y, a = t || this.worldTransform, h = a.a, u = a.b, l = a.c, c = a.d, d = a.tx, p = a.ty, f = -1 / 0, g = -1 / 0, m = 1 / 0, v = 1 / 0; if (0 === u && 0 === l) { if (h < 0) { h *= -1; var y = r; r = -n, n = -y } if (c < 0) { c *= -1; y = s; s = -o, o = -y } m = h * n + d, f = h * r + d, v = c * o + p, g = c * s + p } else { var x = h * n + l * o + d, _ = c * o + u * n + p, b = h * r + l * o + d, T = c * o + u * r + p, w = h * r + l * s + d, S = c * s + u * r + p, C = h * n + l * s + d, P = c * s + u * n + p; m = C < (m = w < (m = b < (m = x < m ? x : m) ? b : m) ? w : m) ? C : m, v = P < (v = S < (v = T < (v = _ < v ? _ : v) ? T : v) ? S : v) ? P : v, f = C > (f = w > (f = b > (f = x > f ? x : f) ? b : f) ? w : f) ? C : f, g = P > (g = S > (g = T > (g = _ > g ? _ : g) ? T : g) ? S : g) ? P : g } var E = this._bounds; return E.x = m, E.width = f - m, E.y = v, E.height = g - v, this._currentBounds = E, E }, i.Sprite.prototype.getLocalBounds = function () { var t = this.worldTransform; this.worldTransform = Phaser.identityMatrix; for (var e = 0; e < this.children.length; e++)this.children[e].updateTransform(); var i = this.getBounds(); for (this.worldTransform = t, e = 0; e < this.children.length; e++)this.children[e].updateTransform(); return i }, i.Sprite.prototype._renderWebGL = function (t, e) { if (this.visible && !(this.alpha <= 0) && this.renderable) { var i = this.worldTransform; if (e && (i = e), this._mask || this._filters) { var r = t.spriteBatch; this._filters && (r.flush(), t.filterManager.pushFilter(this._filterBlock)), this._mask && (r.stop(), t.maskManager.pushMask(this.mask, t), r.start()), r.render(this); for (var n = 0; n < this.children.length; n++)this.children[n]._renderWebGL(t); r.stop(), this._mask && t.maskManager.popMask(this._mask, t), this._filters && t.filterManager.popFilter(), r.start() } else { t.spriteBatch.render(this); for (n = 0; n < this.children.length; n++)this.children[n]._renderWebGL(t, i) } } }, i.Sprite.prototype._renderCanvas = function (t, e) { if (!(!this.visible || 0 === this.alpha || !this.renderable || this.texture.crop.width <= 0 || this.texture.crop.height <= 0)) { var r = this.worldTransform; if (e && (r = e), this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, t.context.globalCompositeOperation = i.blendModesCanvas[t.currentBlendMode]), this._mask && t.maskManager.pushMask(this._mask, t), this.texture.valid) { var n = this.texture.baseTexture.resolution / t.resolution; t.context.globalAlpha = this.worldAlpha, t.smoothProperty && t.scaleMode !== this.texture.baseTexture.scaleMode && (t.scaleMode = this.texture.baseTexture.scaleMode, t.context[t.smoothProperty] = t.scaleMode === i.scaleModes.LINEAR); var s = this.texture.trim ? this.texture.trim.x - this.anchor.x * this.texture.trim.width : this.anchor.x * -this.texture.frame.width, o = this.texture.trim ? this.texture.trim.y - this.anchor.y * this.texture.trim.height : this.anchor.y * -this.texture.frame.height, a = r.tx * t.resolution + t.shakeX, h = r.ty * t.resolution + t.shakeY, u = this.texture.crop.width, l = this.texture.crop.height; if (this.texture.rotated) { var c = r.a, d = r.b, p = r.c, f = r.d, g = u; a = r.c * l + a, h = r.d * l + h, r.a = 6.123233995736766e-17 * c - p, r.b = 6.123233995736766e-17 * d - f, r.c = c + 6.123233995736766e-17 * p, r.d = d + 6.123233995736766e-17 * f, u = l, l = g } if (t.roundPixels ? (t.context.setTransform(r.a, r.b, r.c, r.d, 0 | a, 0 | h), s |= 0, o |= 0) : t.context.setTransform(r.a, r.b, r.c, r.d, a, h), s /= n, o /= n, 16777215 !== this.tint) (this.texture.requiresReTint || this.cachedTint !== this.tint) && (this.tintedTexture = i.CanvasTinter.getTintedTexture(this, this.tint), this.cachedTint = this.tint, this.texture.requiresReTint = !1), t.context.drawImage(this.tintedTexture, 0, 0, u, l, s, o, u / n, l / n); else { var m = this.texture.crop.x, v = this.texture.crop.y; u = Math.floor(u), l = Math.floor(l), t.context.drawImage(this.texture.baseTexture.source, m, v, u, l, s, o, u / n, l / n) } for (y = 0; y < this.children.length; y++)this.children[y]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } else { for (var y = 0; y < this.children.length; y++)this.children[y]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } } }, i.initDefaultShaders = function () { }, i.CompileVertexShader = function (t, e) { return i._CompileShader(t, e, t.VERTEX_SHADER) }, i.CompileFragmentShader = function (t, e) { return i._CompileShader(t, e, t.FRAGMENT_SHADER) }, i._CompileShader = function (t, e, i) { var r = e; Array.isArray(e) && (r = e.join("\n")); var n = t.createShader(i); return t.shaderSource(n, r), t.compileShader(n), t.getShaderParameter(n, t.COMPILE_STATUS) ? n : (window.console.log(t.getShaderInfoLog(n)), null) }, i.compileProgram = function (t, e, r) { var n = i.CompileFragmentShader(t, r), s = i.CompileVertexShader(t, e), o = t.createProgram(); return t.attachShader(o, s), t.attachShader(o, n), t.linkProgram(o), t.getProgramParameter(o, t.LINK_STATUS) || (window.console.log(t.getProgramInfoLog(o)), window.console.log("Could not initialise shaders")), o }, i.PixiShader = function (t) { this._UID = Phaser._UID++ , this.gl = t, this.program = null, this.fragmentSrc = null, this.textureCount = 0, this.firstRun = !0, this.dirty = !0, this.attributes = [], this.init() }, i.PixiShader.prototype.constructor = i.PixiShader, i.PixiShader.prototype.initMultitexShader = function () { var t = this.gl; this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS); for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) {gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) * vColor;return;}\n"; this.fragmentSrc = ["// PixiShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) { gl_FragColor = RED;return;}", "}"]; var n = i.compileProgram(t, this.vertexSrc || i.PixiShader.defaultVertexSrc, this.fragmentSrc); t.useProgram(n), this.uSamplerArray = t.getUniformLocation(n, "uSamplerArray[0]"), this.projectionVector = t.getUniformLocation(n, "projectionVector"), this.offsetVector = t.getUniformLocation(n, "offsetVector"), this.dimensions = t.getUniformLocation(n, "dimensions"), this.aVertexPosition = t.getAttribLocation(n, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(n, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(n, "aColor"), this.aTextureIndex = t.getAttribLocation(n, "aTextureIndex"); var s = [], o = t.createTexture(); t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, o), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null); for (var a = 0; a < this.MAX_TEXTURES; ++a)t.activeTexture(t.TEXTURE0 + a), t.bindTexture(t.TEXTURE_2D, o), s.push(a); for (var h in t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSamplerArray, s), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.uniforms) this.uniforms[h].uniformLocation = t.getUniformLocation(n, h); this.initUniforms(), this.program = n }, i.PixiShader.prototype.initDefaultShader = function () { null === this.fragmentSrc && (this.fragmentSrc = ["precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;", "}"]); var t = this.gl, e = i.compileProgram(t, this.vertexSrc || i.PixiShader.defaultVertexSrc, this.fragmentSrc); for (var r in t.useProgram(e), this.uSampler = t.getUniformLocation(e, "uSampler"), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.dimensions = t.getUniformLocation(e, "dimensions"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.uniforms) this.uniforms[r].uniformLocation = t.getUniformLocation(e, r); this.initUniforms(), this.program = e }, i.PixiShader.prototype.init = function (t) { i._enableMultiTextureToggle && !t ? this.initMultitexShader() : this.initDefaultShader() }, i.PixiShader.prototype.initUniforms = function () { this.textureCount = 1; var t, e = this.gl; for (var i in this.uniforms) { var r = (t = this.uniforms[i]).type; "sampler2D" === r ? (t._init = !1, null !== t.value && this.initSampler2D(t)) : "mat2" === r || "mat3" === r || "mat4" === r ? (t.glMatrix = !0, t.glValueLength = 1, "mat2" === r ? t.glFunc = e.uniformMatrix2fv : "mat3" === r ? t.glFunc = e.uniformMatrix3fv : "mat4" === r && (t.glFunc = e.uniformMatrix4fv)) : (t.glFunc = e["uniform" + r], t.glValueLength = "2f" === r || "2i" === r ? 2 : "3f" === r || "3i" === r ? 3 : "4f" === r || "4i" === r ? 4 : 1) } }, i.PixiShader.prototype.initSampler2D = function (t) { if (t.value && t.value.baseTexture && t.value.baseTexture.hasLoaded) { var e = this.gl; if (e.activeTexture(e.TEXTURE0 + this.textureCount), e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), t.textureData) { var i = t.textureData, r = i.magFilter ? i.magFilter : e.LINEAR, n = i.minFilter ? i.minFilter : e.LINEAR, s = i.wrapS ? i.wrapS : e.CLAMP_TO_EDGE, o = i.wrapT ? i.wrapT : e.CLAMP_TO_EDGE, a = i.luminance ? e.LUMINANCE : e.RGBA; if (i.repeat && (s = e.REPEAT, o = e.REPEAT), e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL, !!i.flipY), i.width) { var h = i.width ? i.width : 512, u = i.height ? i.height : 2, l = i.border ? i.border : 0; e.texImage2D(e.TEXTURE_2D, 0, a, h, u, l, a, e.UNSIGNED_BYTE, null) } else e.texImage2D(e.TEXTURE_2D, 0, a, e.RGBA, e.UNSIGNED_BYTE, t.value.baseTexture.source); e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, r), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, n), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, s), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, o) } e.uniform1i(t.uniformLocation, this.textureCount), t._init = !0, this.textureCount++ } }, i.PixiShader.prototype.syncUniforms = function () { var t; this.textureCount = 1; var e = this.gl; for (var r in this.uniforms) 1 === (t = this.uniforms[r]).glValueLength ? !0 === t.glMatrix ? t.glFunc.call(e, t.uniformLocation, t.transpose, t.value) : t.glFunc.call(e, t.uniformLocation, t.value) : 2 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y) : 3 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z) : 4 === t.glValueLength ? t.glFunc.call(e, t.uniformLocation, t.value.x, t.value.y, t.value.z, t.value.w) : "sampler2D" === t.type && (t._init ? (e.activeTexture(e["TEXTURE" + this.textureCount]), t.value.baseTexture._dirty[e.id] ? i.instances[e.id].updateTexture(t.value.baseTexture) : e.bindTexture(e.TEXTURE_2D, t.value.baseTexture._glTextures[e.id]), e.uniform1i(t.uniformLocation, this.textureCount), this.textureCount++) : this.initSampler2D(t)) }, i.PixiShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null }, i.PixiShader.defaultVertexSrc = ["// PixiShader Vertex Shader", "// With multi-texture rendering", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute vec4 aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   if (aTextureIndex > 0.0) gl_Position = vec4(0.0);", "   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vColor = vec4(aColor.rgb * aColor.a, aColor.a);", "   vTextureIndex = aTextureIndex;", "}"], i.PixiFastShader = function (t) { if (this._UID = Phaser._UID++ , this.gl = t, this.program = null, i._enableMultiTextureToggle) { t = this.gl; this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS); for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) { gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) * vColor;return;}\n"; this.fragmentSrc = ["// PixiFastShader Fragment Shader.", "precision lowp float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}", "}"] } else this.fragmentSrc = ["// PixiFastShader Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}"]; this.vertexSrc = ["// PixiFastShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aPositionCoord;", "attribute vec2 aScale;", "attribute float aRotation;", "attribute vec2 aTextureCoord;", "attribute float aColor;", "attribute float aTextureIndex;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform mat3 uMatrix;", "varying vec2 vTextureCoord;", "varying float vColor;", "varying float vTextureIndex;", "const vec2 center = vec2(-1.0, 1.0);", "void main(void) {", "   vec2 v;", "   vec2 sv = aVertexPosition * aScale;", "   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);", "   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);", "   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;", "   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "   vColor = aColor;", "}"], this.textureCount = 0, this.init() }, i.PixiFastShader.prototype.constructor = i.PixiFastShader, i.PixiFastShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); if (t.useProgram(e), this.uSampler = i._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), i._enableMultiTextureToggle) { var r = [], n = t.createTexture(); t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null); for (var s = 0; s < this.MAX_TEXTURES; ++s)t.activeTexture(t.TEXTURE0 + s), t.bindTexture(t.TEXTURE_2D, n), r.push(s); t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, r) } this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.dimensions = t.getUniformLocation(e, "dimensions"), this.uMatrix = t.getUniformLocation(e, "uMatrix"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aPositionCoord = t.getAttribLocation(e, "aPositionCoord"), this.aScale = t.getAttribLocation(e, "aScale"), this.aRotation = t.getAttribLocation(e, "aRotation"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), -1 === this.colorAttribute && (this.colorAttribute = 2), this.attributes = [this.aVertexPosition, this.aPositionCoord, this.aScale, this.aRotation, this.aTextureCoord, this.colorAttribute, this.aTextureIndex], this.program = e }, i.PixiFastShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null }, i.StripShader = function (t) { if (this._UID = Phaser._UID++ , this.gl = t, this.program = null, i._enableMultiTextureToggle) { t = this.gl; this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS); for (var e = "\tif (vTextureIndex == 0.0) { gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord);return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) { gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) ;return;}\n"; this.fragmentSrc = ["//StripShader Fragment Shader.", "precision mediump float;", "bool isnan( float val ) {  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true; }", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "const vec4 BLUE = vec4(1.0, 0.0, 1.0, 1.0);", "const vec4 RED = vec4(1.0, 0.0, 0.0, 1.0);", "void main(void) {", e, "   if(vTextureIndex >= " + this.MAX_TEXTURES + ".0) { gl_FragColor = BLUE;return;}", "   if(isnan(vTextureIndex)) {gl_FragColor = RED;return;}", "}"] } else this.fragmentSrc = ["//StripShader Fragment Shader.", "precision mediump float;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "uniform float alpha;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord);", "}"]; this.vertexSrc = ["//StripShader Vertex Shader.", "attribute vec2 aVertexPosition;", "attribute vec2 aTextureCoord;", "attribute float aTextureIndex;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "varying vec2 vTextureCoord;", "varying float vTextureIndex;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);", "   vTextureCoord = aTextureCoord;", "   vTextureIndex = aTextureIndex;", "}"], this.init() }, i.StripShader.prototype.constructor = i.StripShader, i.StripShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); if (t.useProgram(e), this.uSampler = i._enableMultiTextureToggle ? t.getUniformLocation(e, "uSamplerArray[0]") : t.getUniformLocation(e, "uSampler"), i._enableMultiTextureToggle) { var r = [], n = t.createTexture(); t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n), t.texImage2D(t.TEXTURE_2D, 0, t.RGB, 1, 1, 0, t.RGB, t.UNSIGNED_BYTE, null); for (var s = 0; s < this.MAX_TEXTURES; ++s)t.activeTexture(t.TEXTURE0 + s), t.bindTexture(t.TEXTURE_2D, n), r.push(s); t.activeTexture(t.TEXTURE0), t.uniform1iv(this.uSampler, r) } this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.aTextureIndex = t.getAttribLocation(e, "aTextureIndex"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.aTextureCoord = t.getAttribLocation(e, "aTextureCoord"), this.attributes = [this.aVertexPosition, this.aTextureCoord, this.aTextureIndex], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e }, i.StripShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null }, i.PrimitiveShader = function (t) { this._UID = Phaser._UID++ , this.gl = t, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "attribute vec4 aColor;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform float alpha;", "uniform float flipY;", "uniform vec3 tint;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = aColor * vec4(tint * alpha, alpha);", "}"], this.init() }, i.PrimitiveShader.prototype.constructor = i.PrimitiveShader, i.PrimitiveShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.colorAttribute = t.getAttribLocation(e, "aColor"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e }, i.PrimitiveShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attributes = null }, i.ComplexPrimitiveShader = function (t) { this._UID = Phaser._UID++ , this.gl = t, this.program = null, this.fragmentSrc = ["precision mediump float;", "varying vec4 vColor;", "void main(void) {", "   gl_FragColor = vColor;", "}"], this.vertexSrc = ["attribute vec2 aVertexPosition;", "uniform mat3 translationMatrix;", "uniform vec2 projectionVector;", "uniform vec2 offsetVector;", "uniform vec3 tint;", "uniform float alpha;", "uniform vec3 color;", "uniform float flipY;", "varying vec4 vColor;", "void main(void) {", "   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);", "   v -= offsetVector.xyx;", "   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);", "   vColor = vec4(color * alpha * tint, alpha);", "}"], this.init() }, i.ComplexPrimitiveShader.prototype.constructor = i.ComplexPrimitiveShader, i.ComplexPrimitiveShader.prototype.init = function () { var t = this.gl, e = i.compileProgram(t, this.vertexSrc, this.fragmentSrc); t.useProgram(e), this.projectionVector = t.getUniformLocation(e, "projectionVector"), this.offsetVector = t.getUniformLocation(e, "offsetVector"), this.tintColor = t.getUniformLocation(e, "tint"), this.color = t.getUniformLocation(e, "color"), this.flipY = t.getUniformLocation(e, "flipY"), this.aVertexPosition = t.getAttribLocation(e, "aVertexPosition"), this.attributes = [this.aVertexPosition, this.colorAttribute], this.translationMatrix = t.getUniformLocation(e, "translationMatrix"), this.alpha = t.getUniformLocation(e, "alpha"), this.program = e }, i.ComplexPrimitiveShader.prototype.destroy = function () { this.gl.deleteProgram(this.program), this.uniforms = null, this.gl = null, this.attribute = null }, i.glContexts = [], i.instances = [], i._enableMultiTextureToggle = !1, i.WebGLRenderer = function (t, e) { this.game = t, i.defaultRenderer || (i.defaultRenderer = this), this.extensions = {}, this.type = Phaser.WEBGL, this.resolution = t.resolution, this.transparent = t.transparent, this.autoResize = !1, this.preserveDrawingBuffer = t.preserveDrawingBuffer, this.clearBeforeRender = t.clearBeforeRender, this.width = t.width, this.height = t.height, this.view = t.canvas, this._contextOptions = { alpha: this.transparent, antialias: t.antialias, failIfMajorPerformanceCaveat: e.failIfMajorPerformanceCaveat, premultipliedAlpha: this.transparent && "notMultiplied" !== this.transparent, stencil: !0, preserveDrawingBuffer: this.preserveDrawingBuffer }, this.projection = new i.Point, this.offset = new i.Point, this.shaderManager = new i.WebGLShaderManager, this.spriteBatch = new i.WebGLSpriteBatch(t), this.maskManager = new i.WebGLMaskManager, this.filterManager = new i.WebGLFilterManager, this.stencilManager = new i.WebGLStencilManager, this.blendModeManager = new i.WebGLBlendModeManager, this.renderSession = {}, this.currentBatchedTextures = [], this.renderSession.game = this.game, this.renderSession.gl = this.gl, this.renderSession.drawCount = 0, this.renderSession.shaderManager = this.shaderManager, this.renderSession.maskManager = this.maskManager, this.renderSession.filterManager = this.filterManager, this.renderSession.blendModeManager = this.blendModeManager, this.renderSession.spriteBatch = this.spriteBatch, this.renderSession.stencilManager = this.stencilManager, this.renderSession.renderer = this, this.renderSession.resolution = this.resolution, this.renderSession.roundPixels = e.roundPixels || !1, this.renderSession.maxTextureAvailableSpace = null, this.initContext(), this.mapBlendModes() }, i.WebGLRenderer.prototype.constructor = i.WebGLRenderer, i.WebGLRenderer.prototype.initContext = function () { var t = this.view.getContext("webgl", this._contextOptions) || this.view.getContext("experimental-webgl", this._contextOptions); if (this.gl = t, !t) throw new Error("This browser does not support webGL. Try using the canvas renderer"); this.maxTextures = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.maxTextureSize = this.gl.getParameter(t.MAX_TEXTURE_SIZE), this.glContextId = t.id = i.WebGLRenderer.glContextId++ , i.glContexts[this.glContextId] = t, i.instances[this.glContextId] = this, t.disable(t.DEPTH_TEST), t.disable(t.CULL_FACE), t.enable(t.BLEND), this.shaderManager.setContext(t), this.spriteBatch.setContext(t), this.maskManager.setContext(t), this.filterManager.setContext(t), this.blendModeManager.setContext(t), this.stencilManager.setContext(t), this.renderSession.gl = this.gl, this.resize(this.width, this.height), this.extensions.compression = {}; var e = t.getExtension("WEBGL_compressed_texture_etc1") || t.getExtension("WEBKIT_WEBGL_compressed_texture_etc1"), r = t.getExtension("WEBGL_compressed_texture_pvrtc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"), n = t.getExtension("WEBGL_compressed_texture_s3tc") || t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc"); e && (this.extensions.compression.ETC1 = e), r && (this.extensions.compression.PVRTC = r), n && (this.extensions.compression.S3TC = n) }, i.WebGLRenderer.prototype.setTexturePriority = function (t) { if (i._enableMultiTextureToggle) { for (var e = function (t) { return --t, t |= t >> 1, t |= t >> 2, t |= t >> 4, t |= t >> 8, t |= t >> 16, ++t }, r = this.gl, n = r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS), s = r.getParameter(r.MAX_TEXTURE_SIZE), o = this.game.cache._cache.image, a = null, h = 0; h < this.currentBatchedTextures.length; h++)(a = this.currentBatchedTextures[h]) in o ? o[a].base.textureIndex = 0 : console.warn('setTexturePriority: There is no image "%s" in the image cache.', a); var u = s - e(Math.max(this.width, this.height)); this.currentBatchedTextures.length = 0; for (var l = 0; l < t.length; ++l)if ((a = t[l]) in o) { var c = o[a].base; (u -= e(Math.max(c.width, c.height))) <= 0 ? (c.textureIndex = 0, console.warn('setTexturePriority: Image "%s" was given textureIndex=0 because there is no available texture space (%s).', a, u)) : c.textureIndex = 1 + l % (n - 1), this.currentBatchedTextures.push(a) } else console.warn('setTexturePriority: There is no image "%s" in the image cache.', a); return this.renderSession.maxTextureAvailableSpace = u, this.currentBatchedTextures } console.warn("setTexturePriority error: Multi Texture support hasn't been enabled in the Phaser Game Config.") }, i.WebGLRenderer.prototype.render = function (t) { if (!this.contextLost) { var e = this.gl; e.viewport(0, 0, this.width, this.height), e.bindFramebuffer(e.FRAMEBUFFER, null), this.game.clearBeforeRender && (e.clearColor(t._bgColor.r, t._bgColor.g, t._bgColor.b, t._bgColor.a), e.clear(e.COLOR_BUFFER_BIT)), this.offset.x = this.game.camera._shake.x, this.offset.y = this.game.camera._shake.y, this.renderDisplayObject(t, this.projection) } }, i.WebGLRenderer.prototype.renderDisplayObject = function (t, e, r, n) { this.renderSession.blendModeManager.setBlendMode(i.blendModes.NORMAL), this.renderSession.drawCount = 0, this.renderSession.flipY = r ? -1 : 1, this.renderSession.projection = e, this.renderSession.offset = this.offset, this.spriteBatch.begin(this.renderSession), this.filterManager.begin(this.renderSession, r), t._renderWebGL(this.renderSession, n), this.spriteBatch.end() }, i.WebGLRenderer.prototype.resize = function (t, e) { this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.gl.viewport(0, 0, this.width, this.height), this.projection.x = this.width / 2 / this.resolution, this.projection.y = -this.height / 2 / this.resolution }, i.WebGLRenderer.prototype.updateCompressedTexture = function (t) { if (!t.hasLoaded) return !1; var e = this.gl, r = t.source; return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.compressedTexImage2D(e.TEXTURE_2D, 0, r.glExtensionFormat, r.width, r.height, 0, r.textureData), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), t._dirty[e.id] = !1, !0 }, i.WebGLRenderer.prototype.updateTexture = function (t) { if (!t.hasLoaded) return !1; if (t.source.compressionAlgorithm) return this.updateCompressedTexture(t); var e = this.gl; return t._glTextures[e.id] || (t._glTextures[e.id] = e.createTexture()), e.activeTexture(e.TEXTURE0 + t.textureIndex), e.bindTexture(e.TEXTURE_2D, t._glTextures[e.id]), e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL, t.premultipliedAlpha), e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, t.source), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t.mipmap && Phaser.Math.isPowerOfTwo(t.width, t.height) ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR_MIPMAP_LINEAR : e.NEAREST_MIPMAP_NEAREST), e.generateMipmap(e.TEXTURE_2D)) : e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, t.scaleMode === i.scaleModes.LINEAR ? e.LINEAR : e.NEAREST), t._powerOf2 ? (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.REPEAT), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.REPEAT)) : (e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE)), t._dirty[e.id] = !1, !0 }, i.WebGLRenderer.prototype.destroy = function () { i.glContexts[this.glContextId] = null, this.projection = null, this.offset = null, this.shaderManager.destroy(), this.spriteBatch.destroy(), this.maskManager.destroy(), this.filterManager.destroy(), this.shaderManager = null, this.spriteBatch = null, this.maskManager = null, this.filterManager = null, this.gl = null, this.renderSession = null, Phaser.CanvasPool.remove(this), i.instances[this.glContextId] = null, i.WebGLRenderer.glContextId-- }, i.WebGLRenderer.prototype.mapBlendModes = function () { var t = this.gl; if (!i.blendModesWebGL) { var e = [], r = i.blendModes; e[r.NORMAL] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.ADD] = [t.SRC_ALPHA, t.DST_ALPHA], e[r.MULTIPLY] = [t.DST_COLOR, t.ONE_MINUS_SRC_ALPHA], e[r.SCREEN] = [t.SRC_ALPHA, t.ONE], e[r.OVERLAY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.DARKEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.LIGHTEN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.COLOR_DODGE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.COLOR_BURN] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.HARD_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.SOFT_LIGHT] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.DIFFERENCE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.EXCLUSION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.HUE] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.SATURATION] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.COLOR] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], e[r.LUMINOSITY] = [t.ONE, t.ONE_MINUS_SRC_ALPHA], i.blendModesWebGL = e } }, i.WebGLRenderer.prototype.getMaxTextureUnit = function () { var t = this.gl; return t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS) }, i.enableMultiTexture = function () { i._enableMultiTextureToggle = !0 }, i.WebGLRenderer.glContextId = 0, i.WebGLRenderer.textureArray = [], i.WebGLBlendModeManager = function () { this.currentBlendMode = 99999 }, i.WebGLBlendModeManager.prototype.constructor = i.WebGLBlendModeManager, i.WebGLBlendModeManager.prototype.setContext = function (t) { this.gl = t }, i.WebGLBlendModeManager.prototype.setBlendMode = function (t) { if (this.currentBlendMode === t) return !1; this.currentBlendMode = t; var e = i.blendModesWebGL[this.currentBlendMode]; return e && this.gl.blendFunc(e[0], e[1]), !0 }, i.WebGLBlendModeManager.prototype.destroy = function () { this.gl = null }, i.WebGLMaskManager = function () { }, i.WebGLMaskManager.prototype.constructor = i.WebGLMaskManager, i.WebGLMaskManager.prototype.setContext = function (t) { this.gl = t }, i.WebGLMaskManager.prototype.pushMask = function (t, e) { var r = e.gl; t.dirty && i.WebGLGraphics.updateGraphics(t, r), void 0 !== t._webGL[r.id] && void 0 !== t._webGL[r.id].data && 0 !== t._webGL[r.id].data.length && e.stencilManager.pushStencil(t, t._webGL[r.id].data[0], e) }, i.WebGLMaskManager.prototype.popMask = function (t, e) { var i = this.gl; void 0 !== t._webGL[i.id] && void 0 !== t._webGL[i.id].data && 0 !== t._webGL[i.id].data.length && e.stencilManager.popStencil(t, t._webGL[i.id].data[0], e) }, i.WebGLMaskManager.prototype.destroy = function () { this.gl = null }, i.WebGLStencilManager = function () { this.stencilStack = [], this.reverse = !0, this.count = 0 }, i.WebGLStencilManager.prototype.setContext = function (t) { this.gl = t }, i.WebGLStencilManager.prototype.pushStencil = function (t, e, i) { var r = this.gl; this.bindGraphics(t, e, i), 0 === this.stencilStack.length && (r.enable(r.STENCIL_TEST), r.clear(r.STENCIL_BUFFER_BIT), this.reverse = !0, this.count = 0), this.stencilStack.push(e); var n = this.count; r.colorMask(!1, !1, !1, !1), r.stencilFunc(r.ALWAYS, 0, 255), r.stencilOp(r.KEEP, r.KEEP, r.INVERT), 1 === e.mode ? (r.drawElements(r.TRIANGLE_FAN, e.indices.length - 4, r.UNSIGNED_SHORT, 0), this.reverse ? (r.stencilFunc(r.EQUAL, 255 - n, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)) : (r.stencilFunc(r.EQUAL, n, 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)), r.drawElements(r.TRIANGLE_FAN, 4, r.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), this.reverse ? r.stencilFunc(r.EQUAL, 255 - (n + 1), 255) : r.stencilFunc(r.EQUAL, n + 1, 255), this.reverse = !this.reverse) : (this.reverse ? (r.stencilFunc(r.EQUAL, n, 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)) : (r.stencilFunc(r.EQUAL, 255 - n, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)), r.drawElements(r.TRIANGLE_STRIP, e.indices.length, r.UNSIGNED_SHORT, 0), this.reverse ? r.stencilFunc(r.EQUAL, n + 1, 255) : r.stencilFunc(r.EQUAL, 255 - (n + 1), 255)), r.colorMask(!0, !0, !0, !0), r.stencilOp(r.KEEP, r.KEEP, r.KEEP), this.count++ }, i.WebGLStencilManager.prototype.bindGraphics = function (t, e, i) { this._currentGraphics = t; var r, n = this.gl, s = i.projection, o = i.offset; 1 === e.mode ? (r = i.shaderManager.complexPrimitiveShader, i.shaderManager.setShader(r), n.uniform1f(r.flipY, i.flipY), n.uniformMatrix3fv(r.translationMatrix, !1, t.worldTransform.toArray(!0)), n.uniform2f(r.projectionVector, s.x, -s.y), n.uniform2f(r.offsetVector, -o.x, -o.y), n.uniform3fv(r.tintColor, Phaser.Color.hexToRGBArray(t.tint)), n.uniform3fv(r.color, e.color), n.uniform1f(r.alpha, t.worldAlpha * e.alpha), n.bindBuffer(n.ARRAY_BUFFER, e.buffer), n.vertexAttribPointer(r.aVertexPosition, 2, n.FLOAT, !1, 8, 0), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer)) : (r = i.shaderManager.primitiveShader, i.shaderManager.setShader(r), n.uniformMatrix3fv(r.translationMatrix, !1, t.worldTransform.toArray(!0)), n.uniform1f(r.flipY, i.flipY), n.uniform2f(r.projectionVector, s.x, -s.y), n.uniform2f(r.offsetVector, -o.x, -o.y), n.uniform3fv(r.tintColor, Phaser.Color.hexToRGBArray(t.tint)), n.uniform1f(r.alpha, t.worldAlpha), n.bindBuffer(n.ARRAY_BUFFER, e.buffer), n.vertexAttribPointer(r.aVertexPosition, 2, n.FLOAT, !1, 24, 0), n.vertexAttribPointer(r.colorAttribute, 4, n.FLOAT, !1, 24, 8), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, e.indexBuffer)) }, i.WebGLStencilManager.prototype.popStencil = function (t, e, i) { var r = this.gl; if (this.stencilStack.pop(), this.count-- , 0 === this.stencilStack.length) r.disable(r.STENCIL_TEST); else { var n = this.count; this.bindGraphics(t, e, i), r.colorMask(!1, !1, !1, !1), 1 === e.mode ? (this.reverse = !this.reverse, this.reverse ? (r.stencilFunc(r.EQUAL, 255 - (n + 1), 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)) : (r.stencilFunc(r.EQUAL, n + 1, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)), r.drawElements(r.TRIANGLE_FAN, 4, r.UNSIGNED_SHORT, 2 * (e.indices.length - 4)), r.stencilFunc(r.ALWAYS, 0, 255), r.stencilOp(r.KEEP, r.KEEP, r.INVERT), r.drawElements(r.TRIANGLE_FAN, e.indices.length - 4, r.UNSIGNED_SHORT, 0), this.reverse ? r.stencilFunc(r.EQUAL, n, 255) : r.stencilFunc(r.EQUAL, 255 - n, 255)) : (this.reverse ? (r.stencilFunc(r.EQUAL, n + 1, 255), r.stencilOp(r.KEEP, r.KEEP, r.DECR)) : (r.stencilFunc(r.EQUAL, 255 - (n + 1), 255), r.stencilOp(r.KEEP, r.KEEP, r.INCR)), r.drawElements(r.TRIANGLE_STRIP, e.indices.length, r.UNSIGNED_SHORT, 0), this.reverse ? r.stencilFunc(r.EQUAL, n, 255) : r.stencilFunc(r.EQUAL, 255 - n, 255)), r.colorMask(!0, !0, !0, !0), r.stencilOp(r.KEEP, r.KEEP, r.KEEP) } }, i.WebGLStencilManager.prototype.destroy = function () { this.stencilStack = null, this.gl = null }, i.WebGLShaderManager = function () { this.maxAttibs = 10, this.attribState = [], this.tempAttribState = []; for (var t = 0; t < this.maxAttibs; t++)this.attribState[t] = !1; this.stack = [] }, i.WebGLShaderManager.prototype.constructor = i.WebGLShaderManager, i.WebGLShaderManager.prototype.setContext = function (t) { this.gl = t, this.primitiveShader = new i.PrimitiveShader(t), this.complexPrimitiveShader = new i.ComplexPrimitiveShader(t), this.defaultShader = new i.PixiShader(t), this.fastShader = new i.PixiFastShader(t), this.stripShader = new i.StripShader(t), this.creatureShader = i.CreatureShader ? new i.CreatureShader(t) : null, this.setShader(this.defaultShader) }, i.WebGLShaderManager.prototype.setAttribs = function (t) { var e; for (e = 0; e < this.tempAttribState.length; e++)this.tempAttribState[e] = !1; for (e = 0; e < t.length; e++) { var i = t[e]; this.tempAttribState[i] = !0 } var r = this.gl; for (e = 0; e < this.attribState.length; e++)this.attribState[e] !== this.tempAttribState[e] && (this.attribState[e] = this.tempAttribState[e], this.tempAttribState[e] ? r.enableVertexAttribArray(e) : r.disableVertexAttribArray(e)) }, i.WebGLShaderManager.prototype.setShader = function (t) { return this._currentId !== t._UID && (this._currentId = t._UID, this.currentShader = t, this.gl.useProgram(t.program), this.setAttribs(t.attributes), !0) }, i.WebGLShaderManager.prototype.destroy = function () { this.attribState = null, this.tempAttribState = null, this.primitiveShader.destroy(), this.complexPrimitiveShader.destroy(), this.defaultShader.destroy(), this.fastShader.destroy(), this.stripShader.destroy(), this.creatureShader && this.creatureShader.destroy(), this.gl = null }, i.WebGLSpriteBatch = function (t) { this.game = t, this.vertSize = 5, this.size = 2e3, this.vertexSize = 24; var e = this.vertexSize * this.size * 4, i = 6 * this.size; this.vertices = new ArrayBuffer(e), this.positions = new Float32Array(this.vertices), this.colors = new Uint32Array(this.vertices), this.indices = new Uint16Array(i), this.lastIndexCount = 0; for (var r = 0, n = 0; r < i; r += 6, n += 4)this.indices[r + 0] = n + 0, this.indices[r + 1] = n + 1, this.indices[r + 2] = n + 2, this.indices[r + 3] = n + 0, this.indices[r + 4] = n + 2, this.indices[r + 5] = n + 3; this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.dirty = !0, this.textures = [], this.blendModes = [], this.shaders = [], this.sprites = [], this.defaultShader = null }, i.WebGLSpriteBatch.prototype.setContext = function (t) { if (this.MAX_TEXTURES = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS), this.gl = t, i._enableMultiTextureToggle) { for (var e = "\tif (vTextureIndex == 0.0) {gl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;return;}\n", r = 1; r < this.MAX_TEXTURES; ++r)e += "\tif (vTextureIndex == " + r + ".0) {gl_FragColor = texture2D(uSamplerArray[" + r + "], vTextureCoord) * vColor;return;}\n"; this.defaultShader = new Phaser.Filter(this.game, void 0, ["//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSamplerArray[" + this.MAX_TEXTURES + "];", "void main(void) {", e, "\tgl_FragColor = texture2D(uSamplerArray[0], vTextureCoord) * vColor;", "}"]) } else this.defaultShader = new Phaser.Filter(this.game, void 0, ["//WebGLSpriteBatch Fragment Shader.", "precision lowp float;", "varying vec2 vTextureCoord;", "varying vec4 vColor;", "varying float vTextureIndex;", "uniform sampler2D uSampler;", "void main(void) {", "   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;", "}"]); this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW), this.currentBlendMode = 99999; var n = new i.PixiShader(t); n.fragmentSrc = this.defaultShader.fragmentSrc, n.uniforms = {}, n.init(), this.defaultShader.shaders[t.id] = n }, i.WebGLSpriteBatch.prototype.begin = function (t) { this.renderSession = t, this.shader = this.renderSession.shaderManager.defaultShader, this.start() }, i.WebGLSpriteBatch.prototype.end = function () { this.flush() }, i.WebGLSpriteBatch.prototype.render = function (t, e) { var r = t.texture, n = r.baseTexture, s = this.gl; i.WebGLRenderer.textureArray[n.textureIndex] != n && (this.flush(), s.activeTexture(s.TEXTURE0 + n.textureIndex), s.bindTexture(s.TEXTURE_2D, n._glTextures[s.id]), i.WebGLRenderer.textureArray[n.textureIndex] = n); var o = t.worldTransform; e && (o = e), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = r.baseTexture); var a = r._uvs; if (a) { var h, u, l, c, d = t.anchor.x, p = t.anchor.y; if (r.trim) { var f = r.trim; h = (u = f.x - d * f.width) + r.crop.width, l = (c = f.y - p * f.height) + r.crop.height } else h = r.frame.width * (1 - d), u = r.frame.width * -d, l = r.frame.height * (1 - p), c = r.frame.height * -p; var g = this.currentBatchSize * this.vertexSize, m = (this.currentBatchSize, r.baseTexture.resolution), v = r.baseTexture.textureIndex, y = o.a / m, x = o.b / m, _ = o.c / m, b = o.d / m, T = o.tx, w = o.ty, S = (r.crop.width, r.crop.height); if (r.rotated) { var C = o.a, P = o.b, E = o.c, A = o.d, R = u, M = h; T = o.c * S + T, w = o.d * S + w, y = 6.123233995736766e-17 * C - E, x = 6.123233995736766e-17 * P - A, _ = C + 6.123233995736766e-17 * E, b = P + 6.123233995736766e-17 * A, r._updateUvsInverted(), h = l, u = c, l = M, c = R } var L = this.colors, I = this.positions, O = t.tint, D = (O >> 16) + (65280 & O) + ((255 & O) << 16) + (255 * t.worldAlpha << 24); this.renderSession.roundPixels ? (I[g++] = y * u + _ * c + T | 0, I[g++] = b * c + x * u + w | 0, I[g++] = a.x0, I[g++] = a.y0, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * c + T | 0, I[g++] = b * c + x * h + w | 0, I[g++] = a.x1, I[g++] = a.y1, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * l + T | 0, I[g++] = b * l + x * h + w | 0, I[g++] = a.x2, I[g++] = a.y2, L[g++] = D, I[g++] = v, I[g++] = y * u + _ * l + T | 0, I[g++] = b * l + x * u + w | 0, I[g++] = a.x3, I[g++] = a.y3, L[g++] = D, I[g++] = v) : (I[g++] = y * u + _ * c + T, I[g++] = b * c + x * u + w, I[g++] = a.x0, I[g++] = a.y0, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * c + T, I[g++] = b * c + x * h + w, I[g++] = a.x1, I[g++] = a.y1, L[g++] = D, I[g++] = v, I[g++] = y * h + _ * l + T, I[g++] = b * l + x * h + w, I[g++] = a.x2, I[g++] = a.y2, L[g++] = D, I[g++] = v, I[g++] = y * u + _ * l + T, I[g++] = b * l + x * u + w, I[g++] = a.x3, I[g++] = a.y3, L[g++] = D, I[g++] = v), this.sprites[this.currentBatchSize++] = t } }, i.WebGLSpriteBatch.prototype.renderTilingSprite = function (t) { var e = t.tilingTexture, r = e.baseTexture, n = this.gl, s = t.texture.baseTexture.textureIndex; i.WebGLRenderer.textureArray[s] != r && (this.flush(), n.activeTexture(n.TEXTURE0 + s), n.bindTexture(n.TEXTURE_2D, r._glTextures[n.id]), i.WebGLRenderer.textureArray[s] = r), this.currentBatchSize >= this.size && (this.flush(), this.currentBaseTexture = e.baseTexture), t._uvs || (t._uvs = new i.TextureUvs); var o = t._uvs, a = e.baseTexture.width, h = e.baseTexture.height; t.tilePosition.x %= a * t.tileScaleOffset.x, t.tilePosition.y %= h * t.tileScaleOffset.y; var u = t.tilePosition.x / (a * t.tileScaleOffset.x), l = t.tilePosition.y / (h * t.tileScaleOffset.y), c = t.width / a / (t.tileScale.x * t.tileScaleOffset.x), d = t.height / h / (t.tileScale.y * t.tileScaleOffset.y); o.x0 = 0 - u, o.y0 = 0 - l, o.x1 = 1 * c - u, o.y1 = 0 - l, o.x2 = 1 * c - u, o.y2 = 1 * d - l, o.x3 = 0 - u, o.y3 = 1 * d - l; var p = t.tint, f = (p >> 16) + (65280 & p) + ((255 & p) << 16) + (255 * t.worldAlpha << 24), g = this.positions, m = this.colors, v = t.width, y = t.height, x = t.anchor.x, _ = t.anchor.y, b = v * (1 - x), T = v * -x, w = y * (1 - _), S = y * -_, C = this.currentBatchSize * this.vertexSize, P = e.baseTexture.resolution, E = t.worldTransform, A = E.a / P, R = E.b / P, M = E.c / P, L = E.d / P, I = E.tx, O = E.ty; g[C++] = A * T + M * S + I, g[C++] = L * S + R * T + O, g[C++] = o.x0, g[C++] = o.y0, m[C++] = f, g[C++] = s, g[C++] = A * b + M * S + I, g[C++] = L * S + R * b + O, g[C++] = o.x1, g[C++] = o.y1, m[C++] = f, g[C++] = s, g[C++] = A * b + M * w + I, g[C++] = L * w + R * b + O, g[C++] = o.x2, g[C++] = o.y2, m[C++] = f, g[C++] = s, g[C++] = A * T + M * w + I, g[C++] = L * w + R * T + O, g[C++] = o.x3, g[C++] = o.y3, m[C++] = f, g[C++] = s, this.sprites[this.currentBatchSize++] = t }, i.WebGLSpriteBatch.prototype.flush = function () { if (0 !== this.currentBatchSize) { var t, e, r, n, s = this.gl; if (this.dirty) { this.dirty = !1, t = this.defaultShader.shaders[s.id], s.activeTexture(s.TEXTURE0), s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, this.indexBuffer); var o = this.vertexSize; s.vertexAttribPointer(t.aVertexPosition, 2, s.FLOAT, !1, o, 0), s.vertexAttribPointer(t.aTextureCoord, 2, s.FLOAT, !1, o, 8), s.vertexAttribPointer(t.colorAttribute, 4, s.UNSIGNED_BYTE, !0, o, 16), s.vertexAttribPointer(t.aTextureIndex, 1, s.FLOAT, !1, o, 20) } if (this.currentBatchSize > .5 * this.size) s.bufferSubData(s.ARRAY_BUFFER, 0, this.vertices); else { s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer); var a = this.positions.subarray(0, this.currentBatchSize * this.vertexSize); s.bufferSubData(s.ARRAY_BUFFER, 0, a) } for (var h, u = 0, l = 0, c = null, d = this.renderSession.blendModeManager.currentBlendMode, p = null, f = !1, g = !1, m = 0, v = this.currentBatchSize; m < v; m++) { e = (h = this.sprites[m]).tilingTexture ? h.tilingTexture.baseTexture : h.texture.baseTexture, f = d !== (r = h.blendMode), g = p !== (n = h.shader || this.defaultShader); var y = e.skipRender; if (y && h.children.length > 0 && (y = !1), (f || g) && (this.renderBatch(c, u, l), l = m, u = 0, c = e, f && (d = r, this.renderSession.blendModeManager.setBlendMode(d)), g)) { (t = (p = n).shaders[s.id]) || ((t = new i.PixiShader(s)).fragmentSrc = p.fragmentSrc, t.uniforms = p.uniforms, t.init(), p.shaders[s.id] = t), this.renderSession.shaderManager.setShader(t), t.dirty && t.syncUniforms(); var x = this.renderSession.projection; s.uniform2f(t.projectionVector, x.x, x.y); var _ = this.renderSession.offset; s.uniform2f(t.offsetVector, _.x, _.y) } u++ } this.renderBatch(c, u, l), this.currentBatchSize = 0 } }, i.WebGLSpriteBatch.prototype.renderBatch = function (t, e, i) { if (0 !== e) { var r = this.gl; if (t._dirty[r.id]) { if (!this.renderSession.renderer.updateTexture(t)) return } else r.bindTexture(r.TEXTURE_2D, t._glTextures[r.id]); r.drawElements(r.TRIANGLES, 6 * e, r.UNSIGNED_SHORT, 6 * i * 2), this.renderSession.drawCount++ } }, i.WebGLSpriteBatch.prototype.stop = function () { this.flush(), this.dirty = !0 }, i.WebGLSpriteBatch.prototype.start = function () { this.dirty = !0 }, i.WebGLSpriteBatch.prototype.destroy = function () { this.vertices = null, this.indices = null, this.gl.deleteBuffer(this.vertexBuffer), this.gl.deleteBuffer(this.indexBuffer), this.currentBaseTexture = null, this.gl = null }, i.WebGLFastSpriteBatch = function (t) { this.vertSize = 11, this.maxSize = 6e3, this.size = this.maxSize; var e = 4 * this.size * this.vertSize, i = 6 * this.maxSize; this.vertices = new Float32Array(e), this.indices = new Uint16Array(i), this.vertexBuffer = null, this.indexBuffer = null, this.lastIndexCount = 0; for (var r = 0, n = 0; r < i; r += 6, n += 4)this.indices[r + 0] = n + 0, this.indices[r + 1] = n + 1, this.indices[r + 2] = n + 2, this.indices[r + 3] = n + 0, this.indices[r + 4] = n + 2, this.indices[r + 5] = n + 3; this.drawing = !1, this.currentBatchSize = 0, this.currentBaseTexture = null, this.currentBlendMode = 0, this.renderSession = null, this.shader = null, this.matrix = null, this.setContext(t) }, i.WebGLFastSpriteBatch.prototype.constructor = i.WebGLFastSpriteBatch, i.WebGLFastSpriteBatch.prototype.setContext = function (t) { this.gl = t, this.vertexBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.indices, t.STATIC_DRAW), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertices, t.DYNAMIC_DRAW) }, i.WebGLFastSpriteBatch.prototype.begin = function (t, e) { this.renderSession = e, this.shader = this.renderSession.shaderManager.fastShader, this.matrix = t.worldTransform.toArray(!0), this.start() }, i.WebGLFastSpriteBatch.prototype.end = function () { this.flush() }, i.WebGLFastSpriteBatch.prototype.render = function (t) { var e = t.children, i = e[0]; if (i.texture._uvs) { this.currentBaseTexture = i.texture.baseTexture, i.blendMode !== this.renderSession.blendModeManager.currentBlendMode && (this.flush(), this.renderSession.blendModeManager.setBlendMode(i.blendMode)); for (var r = 0, n = e.length; r < n; r++)this.renderSprite(e[r]); this.flush() } }, i.WebGLFastSpriteBatch.prototype.renderSprite = function (t) { var e = t.texture.baseTexture, r = this.gl, n = t.texture.baseTexture.textureIndex; if ((i.WebGLRenderer.textureArray[n] == e || !e._glTextures[r.id] || t.texture.baseTexture.skipRender || (this.flush(), r.activeTexture(r.TEXTURE0 + n), r.bindTexture(r.TEXTURE_2D, e._glTextures[r.id]), i.WebGLRenderer.textureArray[n] = e, t.texture._uvs)) && t.visible) { var s, o, a, h, u, l, c = this.vertices; if (s = t.texture._uvs, t.texture.frame.width, t.texture.frame.height, t.texture.trim) { var d = t.texture.trim; o = (a = d.x - t.anchor.x * d.width) + t.texture.crop.width, h = (u = d.y - t.anchor.y * d.height) + t.texture.crop.height } else o = t.texture.frame.width * (1 - t.anchor.x), a = t.texture.frame.width * -t.anchor.x, h = t.texture.frame.height * (1 - t.anchor.y), u = t.texture.frame.height * -t.anchor.y; l = 4 * this.currentBatchSize * this.vertSize, c[l++] = a, c[l++] = u, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x0, c[l++] = s.y1, c[l++] = t.alpha, c[l++] = n, c[l++] = o, c[l++] = u, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x1, c[l++] = s.y1, c[l++] = t.alpha, c[l++] = n, c[l++] = o, c[l++] = h, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x2, c[l++] = s.y2, c[l++] = t.alpha, c[l++] = n, c[l++] = a, c[l++] = h, c[l++] = t.position.x, c[l++] = t.position.y, c[l++] = t.scale.x, c[l++] = t.scale.y, c[l++] = t.rotation, c[l++] = s.x3, c[l++] = s.y3, c[l++] = t.alpha, c[l++] = n, this.currentBatchSize++ , this.currentBatchSize >= this.size && this.flush() } }, i.WebGLFastSpriteBatch.prototype.flush = function () { if (0 !== this.currentBatchSize) { var t = this.gl; if (this.currentBaseTexture._glTextures[t.id]) { if (this.currentBatchSize > .5 * this.size) t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertices); else { var e = this.vertices.subarray(0, 4 * this.currentBatchSize * this.vertSize); t.bufferSubData(t.ARRAY_BUFFER, 0, e) } t.drawElements(t.TRIANGLES, 6 * this.currentBatchSize, t.UNSIGNED_SHORT, 0), this.currentBatchSize = 0, this.renderSession.drawCount++ } else this.renderSession.renderer.updateTexture(this.currentBaseTexture, t) } }, i.WebGLFastSpriteBatch.prototype.stop = function () { this.flush() }, i.WebGLFastSpriteBatch.prototype.start = function () { var t = this.gl; t.activeTexture(t.TEXTURE0), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer); var e = this.renderSession.projection; t.uniform2f(this.shader.projectionVector, e.x, e.y), t.uniformMatrix3fv(this.shader.uMatrix, !1, this.matrix); var i = 4 * this.vertSize; t.vertexAttribPointer(this.shader.aVertexPosition, 2, t.FLOAT, !1, i, 0), t.vertexAttribPointer(this.shader.aPositionCoord, 2, t.FLOAT, !1, i, 8), t.vertexAttribPointer(this.shader.aScale, 2, t.FLOAT, !1, i, 16), t.vertexAttribPointer(this.shader.aRotation, 1, t.FLOAT, !1, i, 24), t.vertexAttribPointer(this.shader.aTextureCoord, 2, t.FLOAT, !1, i, 28), t.vertexAttribPointer(this.shader.colorAttribute, 1, t.FLOAT, !1, i, 36), t.vertexAttribPointer(this.shader.aTextureIndex, 1, t.FLOAT, !1, i, 40) }, i.WebGLFilterManager = function () { this.filterStack = [], this.offsetX = 0, this.offsetY = 0 }, i.WebGLFilterManager.prototype.constructor = i.WebGLFilterManager, i.WebGLFilterManager.prototype.setContext = function (t) { this.gl = t, this.texturePool = [], this.initShaderBuffers() }, i.WebGLFilterManager.prototype.begin = function (t, e) { this.renderSession = t, this.defaultShader = t.shaderManager.defaultShader; var i = this.renderSession.projection; this.width = 2 * i.x, this.height = 2 * -i.y, this.buffer = e }, i.WebGLFilterManager.prototype.pushFilter = function (t) { var e = this.gl, r = this.renderSession.projection, n = this.renderSession.offset; t._filterArea = t.target.filterArea || t.target.getBounds(), t._previous_stencil_mgr = this.renderSession.stencilManager, this.renderSession.stencilManager = new i.WebGLStencilManager, this.renderSession.stencilManager.setContext(e), e.disable(e.STENCIL_TEST), this.filterStack.push(t); var s = t.filterPasses[0]; this.offsetX += t._filterArea.x, this.offsetY += t._filterArea.y; var o = this.texturePool.pop(); o ? o.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution) : o = new i.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), e.bindTexture(e.TEXTURE_2D, o.texture); var a = t._filterArea, h = s.padding; a.x -= h, a.y -= h, a.width += 2 * h, a.height += 2 * h, a.x < 0 && (a.x = 0), a.width > this.width && (a.width = this.width), a.y < 0 && (a.y = 0), a.height > this.height && (a.height = this.height), e.bindFramebuffer(e.FRAMEBUFFER, o.frameBuffer), e.viewport(0, 0, a.width * this.renderSession.resolution, a.height * this.renderSession.resolution), r.x = a.width / 2, r.y = -a.height / 2, n.x = -a.x, n.y = -a.y, e.colorMask(!0, !0, !0, !0), e.clearColor(0, 0, 0, 0), e.clear(e.COLOR_BUFFER_BIT), t._glFilterTexture = o }, i.WebGLFilterManager.prototype.popFilter = function () { var t = this.gl, e = this.filterStack.pop(), r = e._filterArea, n = e._glFilterTexture, s = this.renderSession.projection, o = this.renderSession.offset; if (e.filterPasses.length > 1) { t.viewport(0, 0, r.width * this.renderSession.resolution, r.height * this.renderSession.resolution), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = 0, this.vertexArray[1] = r.height, this.vertexArray[2] = r.width, this.vertexArray[3] = r.height, this.vertexArray[4] = 0, this.vertexArray[5] = 0, this.vertexArray[6] = r.width, this.vertexArray[7] = 0, t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = r.width / this.width, this.uvArray[5] = r.height / this.height, this.uvArray[6] = r.width / this.width, this.uvArray[7] = r.height / this.height, t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray); var a = n, h = this.texturePool.pop(); h || (h = new i.FilterTexture(this.gl, this.width * this.renderSession.resolution, this.height * this.renderSession.resolution)), h.resize(this.width * this.renderSession.resolution, this.height * this.renderSession.resolution), t.bindFramebuffer(t.FRAMEBUFFER, h.frameBuffer), t.clear(t.COLOR_BUFFER_BIT), t.disable(t.BLEND); for (var u = 0; u < e.filterPasses.length - 1; u++) { var l = e.filterPasses[u]; t.bindFramebuffer(t.FRAMEBUFFER, h.frameBuffer), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, a.texture), this.applyFilterPass(l, r, r.width, r.height); var c = a; a = h, h = c } t.enable(t.BLEND), n = a, this.texturePool.push(h) } var d = e.filterPasses[e.filterPasses.length - 1]; this.offsetX -= r.x, this.offsetY -= r.y; var p = this.width, f = this.height, g = 0, m = 0, v = this.buffer; if (0 === this.filterStack.length) t.colorMask(!0, !0, !0, !0); else { var y = this.filterStack[this.filterStack.length - 1]; p = (r = y._filterArea).width, f = r.height, g = r.x, m = r.y, v = y._glFilterTexture.frameBuffer } s.x = p / 2, s.y = -f / 2, o.x = g, o.y = m; var x = (r = e._filterArea).x - g, _ = r.y - m; t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), this.vertexArray[0] = x, this.vertexArray[1] = _ + r.height, this.vertexArray[2] = x + r.width, this.vertexArray[3] = _ + r.height, this.vertexArray[4] = x, this.vertexArray[5] = _, this.vertexArray[6] = x + r.width, this.vertexArray[7] = _, t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertexArray), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), this.uvArray[2] = r.width / this.width, this.uvArray[5] = r.height / this.height, this.uvArray[6] = r.width / this.width, this.uvArray[7] = r.height / this.height, t.bufferSubData(t.ARRAY_BUFFER, 0, this.uvArray), t.viewport(0, 0, p * this.renderSession.resolution, f * this.renderSession.resolution), t.bindFramebuffer(t.FRAMEBUFFER, v), t.activeTexture(t.TEXTURE0), t.bindTexture(t.TEXTURE_2D, n.texture), this.renderSession.stencilManager && this.renderSession.stencilManager.destroy(), this.renderSession.stencilManager = e._previous_stencil_mgr, e._previous_stencil_mgr = null, this.renderSession.stencilManager.count > 0 ? t.enable(t.STENCIL_TEST) : t.disable(t.STENCIL_TEST), this.applyFilterPass(d, r, p, f), this.texturePool.push(n), e._glFilterTexture = null }, i.WebGLFilterManager.prototype.applyFilterPass = function (t, e, r, n) { var s = this.gl, o = t.shaders[s.id]; o || ((o = new i.PixiShader(s)).fragmentSrc = t.fragmentSrc, o.uniforms = t.uniforms, o.init(!0), t.shaders[s.id] = o), this.renderSession.shaderManager.setShader(o), s.uniform2f(o.projectionVector, r / 2, -n / 2), s.uniform2f(o.offsetVector, 0, 0), t.uniforms.dimensions && (t.uniforms.dimensions.value[0] = this.width, t.uniforms.dimensions.value[1] = this.height, t.uniforms.dimensions.value[2] = this.vertexArray[0], t.uniforms.dimensions.value[3] = this.vertexArray[5]), o.syncUniforms(), s.bindBuffer(s.ARRAY_BUFFER, this.vertexBuffer), s.vertexAttribPointer(o.aVertexPosition, 2, s.FLOAT, !1, 0, 0), s.bindBuffer(s.ARRAY_BUFFER, this.uvBuffer), s.vertexAttribPointer(o.aTextureCoord, 2, s.FLOAT, !1, 0, 0), s.bindBuffer(s.ARRAY_BUFFER, this.colorBuffer), s.vertexAttribPointer(o.colorAttribute, 2, s.FLOAT, !1, 0, 0), s.bindBuffer(s.ELEMENT_ARRAY_BUFFER, this.indexBuffer), s.drawElements(s.TRIANGLES, 6, s.UNSIGNED_SHORT, 0), this.renderSession.drawCount++ }, i.WebGLFilterManager.prototype.initShaderBuffers = function () { var t = this.gl; this.vertexBuffer = t.createBuffer(), this.uvBuffer = t.createBuffer(), this.colorBuffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), this.vertexArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), t.bindBuffer(t.ARRAY_BUFFER, this.vertexBuffer), t.bufferData(t.ARRAY_BUFFER, this.vertexArray, t.STATIC_DRAW), this.uvArray = new Float32Array([0, 0, 1, 0, 0, 1, 1, 1]), t.bindBuffer(t.ARRAY_BUFFER, this.uvBuffer), t.bufferData(t.ARRAY_BUFFER, this.uvArray, t.STATIC_DRAW), this.colorArray = new Float32Array([1, 16777215, 1, 16777215, 1, 16777215, 1, 16777215]), t.bindBuffer(t.ARRAY_BUFFER, this.colorBuffer), t.bufferData(t.ARRAY_BUFFER, this.colorArray, t.STATIC_DRAW), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, new Uint16Array([0, 1, 2, 1, 3, 2]), t.STATIC_DRAW) }, i.WebGLFilterManager.prototype.destroy = function () { var t = this.gl; this.filterStack = null, this.offsetX = 0, this.offsetY = 0; for (var e = 0; e < this.texturePool.length; e++)this.texturePool[e].destroy(); this.texturePool = null, t.deleteBuffer(this.vertexBuffer), t.deleteBuffer(this.uvBuffer), t.deleteBuffer(this.colorBuffer), t.deleteBuffer(this.indexBuffer) }; var r = { 36054: "Incomplete attachment", 36055: "Missing attachment", 36057: "Incomplete dimensions", 36061: "Framebuffer unsupported" }; function n(t, e, n, s, o) { var a, h, u = t.createFramebuffer(), l = t.createRenderbuffer(); return t.activeTexture(t.TEXTURE0 + o), t.bindFramebuffer(t.FRAMEBUFFER, u), t.bindRenderbuffer(t.RENDERBUFFER, l), t.framebufferRenderbuffer(t.FRAMEBUFFER, t.DEPTH_STENCIL_ATTACHMENT, t.RENDERBUFFER, this.renderBuffer), a = function (t, e, r, n) { var s = t.createTexture(); return t.bindTexture(t.TEXTURE_2D, s), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, n === i.scaleModes.LINEAR ? t.LINEAR : t.NEAREST), t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, n === i.scaleModes.LINEAR ? t.LINEAR : t.NEAREST), t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, e, r, 0, t.RGBA, t.UNSIGNED_BYTE, null), s }(t, e, n, s), t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, a, 0), (h = t.checkFramebufferStatus(t.FRAMEBUFFER)) !== t.FRAMEBUFFER_COMPLETE && console.error("Incomplete GL framebuffer. ", r[h]), u.width = e, u.height = n, u.targetTexture = a, u.renderBuffer = l, u } return i.FilterTexture = function (t, e, r, s, o) { o = "number" == typeof o ? o : 0, this.gl = t, this.frameBuffer = n(t, e, r, s || i.scaleModes.DEFAULT, o), this.texture = this.frameBuffer.targetTexture, this.width = e, this.height = r, this.renderBuffer = this.frameBuffer.renderBuffer }, i.FilterTexture.prototype.constructor = i.FilterTexture, i.FilterTexture.prototype.clear = function () { var t = this.gl; t.clearColor(0, 0, 0, 0), t.clear(t.COLOR_BUFFER_BIT) }, i.FilterTexture.prototype.resize = function (t, e) { if (this.width !== t || this.height !== e) { this.width = t, this.height = e; var i = this.gl; i.bindTexture(i.TEXTURE_2D, this.texture), i.texImage2D(i.TEXTURE_2D, 0, i.RGBA, t, e, 0, i.RGBA, i.UNSIGNED_BYTE, null), i.bindRenderbuffer(i.RENDERBUFFER, this.renderBuffer), i.renderbufferStorage(i.RENDERBUFFER, i.DEPTH_STENCIL, t, e) } }, i.FilterTexture.prototype.destroy = function () { var t = this.gl; t.deleteFramebuffer(this.frameBuffer), t.deleteTexture(this.texture), this.frameBuffer = null, this.texture = null }, i.CanvasBuffer = function (t, e) { this.width = t, this.height = e, this.canvas = Phaser.CanvasPool.create(this, this.width, this.height), this.context = this.canvas.getContext("2d"), this.canvas.width = t, this.canvas.height = e }, i.CanvasBuffer.prototype.constructor = i.CanvasBuffer, i.CanvasBuffer.prototype.clear = function () { this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.clearRect(0, 0, this.width, this.height) }, i.CanvasBuffer.prototype.resize = function (t, e) { this.width = this.canvas.width = t, this.height = this.canvas.height = e }, i.CanvasBuffer.prototype.destroy = function () { Phaser.CanvasPool.remove(this) }, i.CanvasMaskManager = function () { }, i.CanvasMaskManager.prototype.constructor = i.CanvasMaskManager, i.CanvasMaskManager.prototype.pushMask = function (t, e) { var r = e.context; r.save(); var n = t.alpha, s = t.worldTransform, o = e.resolution; r.setTransform(s.a * o, s.b * o, s.c * o, s.d * o, s.tx * o, s.ty * o), i.CanvasGraphics.renderGraphicsMask(t, r), r.clip(), t.worldAlpha = n }, i.CanvasMaskManager.prototype.popMask = function (t) { t.context.restore() }, i.CanvasTinter = function () { }, i.CanvasTinter.getTintedTexture = function (t, e) { var r = t.tintedTexture || Phaser.CanvasPool.create(this); return i.CanvasTinter.tintMethod(t.texture, e, r), r }, i.CanvasTinter.tintWithMultiply = function (t, e, i) { var r = i.getContext("2d"), n = t.crop, s = n.width, o = n.height; t.rotated && (s = o, o = n.width), i.width === s && i.height === o || (i.width = s, i.height = o), r.clearRect(0, 0, s, o), r.fillStyle = "#" + ("00000" + (0 | e).toString(16)).substr(-6), r.fillRect(0, 0, s, o), r.globalCompositeOperation = "multiply", r.drawImage(t.baseTexture.source, n.x, n.y, s, o, 0, 0, s, o), r.globalCompositeOperation = "destination-atop", r.drawImage(t.baseTexture.source, n.x, n.y, s, o, 0, 0, s, o) }, i.CanvasTinter.tintWithPerPixel = function (t, e, r) { var n = r.getContext("2d"), s = t.crop, o = s.width, a = s.height; t.rotated && (o = a, a = s.width), r.width === o && r.height === a || (r.width = o, r.height = a), n.globalCompositeOperation = "copy", n.drawImage(t.baseTexture.source, s.x, s.y, o, a, 0, 0, o, a); for (var h = Phaser.Color.hexToRGBArray(e), u = h[0], l = h[1], c = h[2], d = n.getImageData(0, 0, o, a), p = d.data, f = 0; f < p.length; f += 4)if (p[f + 0] *= u, p[f + 1] *= l, p[f + 2] *= c, !i.CanvasTinter.canHandleAlpha) { var g = p[f + 3]; p[f + 0] /= 255 / g, p[f + 1] /= 255 / g, p[f + 2] /= 255 / g } n.putImageData(d, 0, 0) }, i.CanvasRenderer = function (t, e) { this.game = t, i.defaultRenderer || (i.defaultRenderer = this), this.type = Phaser.CANVAS, this.resolution = t.resolution, this.clearBeforeRender = t.clearBeforeRender, this.transparent = t.transparent, this.autoResize = !1, this.width = t.width * this.resolution, this.height = t.height * this.resolution, this.view = t.canvas, this.context = this.view.getContext("2d", { alpha: this.transparent }), this.refresh = !0, this.count = 0, this.maskManager = new i.CanvasMaskManager, this.renderSession = { context: this.context, maskManager: this.maskManager, scaleMode: null, smoothProperty: Phaser.Canvas.getSmoothingPrefix(this.context), roundPixels: e.roundPixels || !1 }, this.mapBlendModes(), this.resize(this.width, this.height) }, i.CanvasRenderer.prototype.constructor = i.CanvasRenderer, i.CanvasRenderer.prototype.render = function (t) { this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.globalAlpha = 1, this.renderSession.currentBlendMode = 0, this.renderSession.shakeX = this.game.camera._shake.x, this.renderSession.shakeY = this.game.camera._shake.y, this.context.globalCompositeOperation = "source-over", navigator.isCocoonJS && this.view.screencanvas && (this.context.fillStyle = "black", this.context.clear()), this.clearBeforeRender && (this.transparent ? this.context.clearRect(0, 0, this.width, this.height) : t._bgColor && (this.context.fillStyle = t._bgColor.rgba, this.context.fillRect(0, 0, this.width, this.height))), this.renderDisplayObject(t) }, i.CanvasRenderer.prototype.setTexturePriority = function (t) { }, i.CanvasRenderer.prototype.destroy = function (t) { void 0 === t && (t = !0), t && this.view.parent && this.view.parent.removeChild(this.view), this.view = null, this.context = null, this.maskManager = null, this.renderSession = null }, i.CanvasRenderer.prototype.resize = function (t, e) { this.width = t * this.resolution, this.height = e * this.resolution, this.view.width = this.width, this.view.height = this.height, this.autoResize && (this.view.style.width = this.width / this.resolution + "px", this.view.style.height = this.height / this.resolution + "px"), this.renderSession.smoothProperty && (this.context[this.renderSession.smoothProperty] = this.renderSession.scaleMode === i.scaleModes.LINEAR) }, i.CanvasRenderer.prototype.renderDisplayObject = function (t, e, i) { this.renderSession.context = e || this.context, this.renderSession.resolution = this.resolution, t._renderCanvas(this.renderSession, i) }, i.CanvasRenderer.prototype.mapBlendModes = function () { if (!i.blendModesCanvas) { var t = [], e = i.blendModes, r = this.game.device.canUseMultiply; t[e.NORMAL] = "source-over", t[e.ADD] = "lighter", t[e.MULTIPLY] = r ? "multiply" : "source-over", t[e.SCREEN] = r ? "screen" : "source-over", t[e.OVERLAY] = r ? "overlay" : "source-over", t[e.DARKEN] = r ? "darken" : "source-over", t[e.LIGHTEN] = r ? "lighten" : "source-over", t[e.COLOR_DODGE] = r ? "color-dodge" : "source-over", t[e.COLOR_BURN] = r ? "color-burn" : "source-over", t[e.HARD_LIGHT] = r ? "hard-light" : "source-over", t[e.SOFT_LIGHT] = r ? "soft-light" : "source-over", t[e.DIFFERENCE] = r ? "difference" : "source-over", t[e.EXCLUSION] = r ? "exclusion" : "source-over", t[e.HUE] = r ? "hue" : "source-over", t[e.SATURATION] = r ? "saturation" : "source-over", t[e.COLOR] = r ? "color" : "source-over", t[e.LUMINOSITY] = r ? "luminosity" : "source-over", i.blendModesCanvas = t } }, i.BaseTexture = function (t, e, r) { this.resolution = r || 1, this.width = 100, this.height = 100, this.scaleMode = e || i.scaleModes.DEFAULT, this.hasLoaded = !1, this.source = t, this.premultipliedAlpha = !0, this._glTextures = [], this.mipmap = !1, this.textureIndex = 0, this._dirty = [!0, !0, !0, !0], t && ((this.source.complete || this.source.getContext) && this.source.width && this.source.height && (this.hasLoaded = !0, this.width = this.source.naturalWidth || this.source.width, this.height = this.source.naturalHeight || this.source.height, this.dirty()), this.skipRender = !1, this._powerOf2 = !1) }, i.BaseTexture.prototype.constructor = i.BaseTexture, i.BaseTexture.prototype.forceLoaded = function (t, e) { this.hasLoaded = !0, this.width = t, this.height = e, this.dirty() }, i.BaseTexture.prototype.destroy = function () { this.source && Phaser.CanvasPool.removeByCanvas(this.source), this.source = null, this.unloadFromGPU() }, i.BaseTexture.prototype.dirty = function () { for (var t = 0; t < this._glTextures.length; t++)this._dirty[t] = !0 }, i.BaseTexture.prototype.unloadFromGPU = function () { this.dirty(); for (var t = this._glTextures.length - 1; t >= 0; t--) { var e = this._glTextures[t], r = i.glContexts[t]; r && e && r.deleteTexture(e) } this._glTextures.length = 0, this.dirty() }, i.BaseTexture.fromCanvas = function (t, e, r) { return 0 === t.width && (t.width = 1), 0 === t.height && (t.height = 1), r = r || 1, new i.BaseTexture(t, e, r) }, i.TextureSilentFail = !1, i.Texture = function (t, e, r, n) { this.noFrame = !1, e || (this.noFrame = !0, e = new i.Rectangle(0, 0, 1, 1)), t instanceof i.Texture && (t = t.baseTexture), this.baseTexture = t, this.frame = e, this.trim = n, this.valid = !1, this.isTiling = !1, this.requiresUpdate = !1, this.requiresReTint = !1, this._uvs = null, this.width = 0, this.height = 0, this.crop = r || new i.Rectangle(0, 0, 1, 1), this.rotated = !1, t.hasLoaded && (this.noFrame && (e = new i.Rectangle(0, 0, t.width, t.height)), this.setFrame(e)) }, i.Texture.prototype.constructor = i.Texture, i.Texture.prototype.onBaseTextureLoaded = function () { var t = this.baseTexture; this.noFrame && (this.frame = new i.Rectangle(0, 0, t.width, t.height)), this.setFrame(this.frame) }, i.Texture.prototype.destroy = function (t) { t && this.baseTexture.destroy(), this.valid = !1 }, i.Texture.prototype.setFrame = function (t) { if (this.noFrame = !1, this.frame = t, this.width = t.width, this.height = t.height, this.crop.x = t.x, this.crop.y = t.y, this.crop.width = t.width, this.crop.height = t.height, this.trim || !(t.x + t.width > this.baseTexture.width || t.y + t.height > this.baseTexture.height)) this.valid = t && t.width && t.height && this.baseTexture.source && this.baseTexture.hasLoaded, this.trim && (this.width = this.trim.width, this.height = this.trim.height, this.frame.width = this.trim.width, this.frame.height = this.trim.height), this.valid && this._updateUvs(); else { if (!i.TextureSilentFail) throw new Error("Texture Error: frame does not fit inside the base Texture dimensions " + this); this.valid = !1 } }, i.Texture.prototype._updateUvs = function () { this._uvs || (this._uvs = new i.TextureUvs); var t = this.crop, e = this.baseTexture.width, r = this.baseTexture.height; this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / r, this._uvs.x1 = (t.x + t.width) / e, this._uvs.y1 = t.y / r, this._uvs.x2 = (t.x + t.width) / e, this._uvs.y2 = (t.y + t.height) / r, this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.height) / r }, i.Texture.prototype._updateUvsInverted = function () { this._uvs || (this._uvs = new i.TextureUvs); var t = this.crop, e = this.baseTexture.width, r = this.baseTexture.height; this._uvs.x0 = t.x / e, this._uvs.y0 = t.y / r, this._uvs.x1 = (t.x + t.height) / e, this._uvs.y1 = t.y / r, this._uvs.x2 = (t.x + t.height) / e, this._uvs.y2 = (t.y + t.width) / r, this._uvs.x3 = t.x / e, this._uvs.y3 = (t.y + t.width) / r }, i.Texture.fromCanvas = function (t, e) { var r = i.BaseTexture.fromCanvas(t, e); return new i.Texture(r) }, i.TextureUvs = function () { this.x0 = 0, this.y0 = 0, this.x1 = 0, this.y1 = 0, this.x2 = 0, this.y2 = 0, this.x3 = 0, this.y3 = 0 }, void 0 !== t && t.exports && (e = t.exports = i), e.PIXI = i, i }).call(void 0), function () { var n, s = s || { VERSION: "2.10.1", GAMES: [], AUTO: 0, CANVAS: 1, WEBGL: 2, HEADLESS: 3, WEBGL_MULTI: 4, NONE: 0, LEFT: 1, RIGHT: 2, UP: 3, DOWN: 4, SPRITE: 0, BUTTON: 1, IMAGE: 2, GRAPHICS: 3, TEXT: 4, TILESPRITE: 5, BITMAPTEXT: 6, GROUP: 7, RENDERTEXTURE: 8, TILEMAP: 9, TILEMAPLAYER: 10, EMITTER: 11, POLYGON: 12, BITMAPDATA: 13, CANVAS_FILTER: 14, WEBGL_FILTER: 15, ELLIPSE: 16, SPRITEBATCH: 17, RETROFONT: 18, POINTER: 19, ROPE: 20, CIRCLE: 21, RECTANGLE: 22, LINE: 23, MATRIX: 24, POINT: 25, ROUNDEDRECTANGLE: 26, CREATURE: 27, VIDEO: 28, PENDING_ATLAS: -1, HORIZONTAL: 0, VERTICAL: 1, LANDSCAPE: 0, PORTRAIT: 1, ANGLE_UP: 270, ANGLE_DOWN: 90, ANGLE_LEFT: 180, ANGLE_RIGHT: 0, ANGLE_NORTH_EAST: 315, ANGLE_NORTH_WEST: 225, ANGLE_SOUTH_EAST: 45, ANGLE_SOUTH_WEST: 135, TOP_LEFT: 0, TOP_CENTER: 1, TOP_RIGHT: 2, LEFT_TOP: 3, LEFT_CENTER: 4, LEFT_BOTTOM: 5, CENTER: 6, RIGHT_TOP: 7, RIGHT_CENTER: 8, RIGHT_BOTTOM: 9, BOTTOM_LEFT: 10, BOTTOM_CENTER: 11, BOTTOM_RIGHT: 12, blendModes: { NORMAL: 0, ADD: 1, MULTIPLY: 2, SCREEN: 3, OVERLAY: 4, DARKEN: 5, LIGHTEN: 6, COLOR_DODGE: 7, COLOR_BURN: 8, HARD_LIGHT: 9, SOFT_LIGHT: 10, DIFFERENCE: 11, EXCLUSION: 12, HUE: 13, SATURATION: 14, COLOR: 15, LUMINOSITY: 16 }, scaleModes: { DEFAULT: 0, LINEAR: 0, NEAREST: 1 }, PIXI: PIXI || {}, _UID: 0 }; if (Math.trunc || (Math.trunc = function (t) { return t < 0 ? Math.ceil(t) : Math.floor(t) }), Function.prototype.bind || (Function.prototype.bind = (n = Array.prototype.slice, function (t) { var e = this, i = n.call(arguments, 1); if ("function" != typeof e) throw new TypeError; function r() { var s = i.concat(n.call(arguments)); e.apply(this instanceof r ? this : t, s) } return r.prototype = function t(e) { if (e && (t.prototype = e), !(this instanceof t)) return new t }(e.prototype), r })), Array.isArray || (Array.isArray = function (t) { return "[object Array]" === Object.prototype.toString.call(t) }), Array.prototype.forEach || (Array.prototype.forEach = function (t) { if (void 0 === this || null === this) throw new TypeError; var e = Object(this), i = e.length >>> 0; if ("function" != typeof t) throw new TypeError; for (var r = arguments.length >= 2 ? arguments[1] : void 0, n = 0; n < i; n++)n in e && t.call(r, e[n], n, e) }), "function" != typeof window.Uint32Array && "object" !== r(window.Uint32Array)) { var o = function (t) { var e = new Array; window[t] = function (t) { if ("number" == typeof t) { Array.call(this, t), this.length = t; for (var e = 0; e < this.length; e++)this[e] = 0 } else { Array.call(this, t.length), this.length = t.length; for (e = 0; e < this.length; e++)this[e] = t[e] } }, window[t].prototype = e, window[t].constructor = window[t] }; o("Float32Array"), o("Uint32Array"), o("Uint16Array"), o("Int16Array"), o("ArrayBuffer") } function a(t, e) { this._scaleFactor = t, this._deltaMode = e, this.originalEvent = null } for (var h in window.console || (window.console = {}, window.console.log = window.console.assert = function () { }, window.console.warn = window.console.assert = function () { }), Object.assign || (Object.assign = function (t, e) { if (null == t) throw new TypeError("Cannot convert undefined or null to object"); for (var i = Object(t), r = Object.prototype.hasOwnProperty, n = 1; n < arguments.length; n++) { var s = arguments[n]; if (null != s) for (var o in s) r.call(s, o) && (i[o] = s[o]) } return i }), s.Utils = { reverseString: function (t) { return t.split("").reverse().join("") }, getProperty: function (t, e) { var i = e.split("."); switch (i.length) { case 1: return t[e]; case 2: return t[i[0]][i[1]]; case 3: return t[i[0]][i[1]][i[2]]; case 4: return t[i[0]][i[1]][i[2]][i[3]]; default: return this._getProperty(t, e) } }, setProperties: function (t, e) { for (var i in e) this.setProperty(t, i, e[i]); return t }, setProperty: function (t, e, i) { var r = e.split("."); switch (r.length) { case 1: t[e] = i; break; case 2: t[r[0]][r[1]] = i; break; case 3: t[r[0]][r[1]][r[2]] = i; break; case 4: t[r[0]][r[1]][r[2]][r[3]] = i; break; default: this._setProperty(t, e, i) } }, _getProperty: function (t, e) { for (var i = e.split("."), r = i.length, n = 0, s = t; n < r;) { var o = i[n]; if (null == s) return; s = s[o], n++ } return s }, _setProperty: function (t, e, i) { var r = e.split("."), n = r.length, s = 0, o = t, a = r[0]; if (1 === n) t[e] = i; else { for (; s < n - 1;)o = o[a], a = r[++s]; o[a] = i } return t }, chanceRoll: function (t) { return void 0 === t && (t = 50), t > 0 && 100 * Math.random() <= t }, randomChoice: function (t, e) { return Math.random() < .5 ? t : e }, parseDimension: function (t, e) { var i = 0, r = 0; return "string" == typeof t ? "%" === t.substr(-1) ? (i = parseInt(t, 10) / 100, r = 0 === e ? window.innerWidth * i : window.innerHeight * i) : r = parseInt(t, 10) : r = t, r }, pad: function (t, e, i, r) { if (void 0 === e) e = 0; if (void 0 === i) i = " "; if (void 0 === r) r = 3; var n = 0; if (e + 1 >= (t = t.toString()).length) switch (r) { case 1: t = new Array(e + 1 - t.length).join(i) + t; break; case 3: var s = Math.ceil((n = e - t.length) / 2); t = new Array(n - s + 1).join(i) + t + new Array(s + 1).join(i); break; default: t += new Array(e + 1 - t.length).join(i) }return t }, isPlainObject: function (t) { if ("object" !== (void 0 === t ? "undefined" : r(t)) || t.nodeType || t === t.window) return !1; try { if (t.constructor && !{}.hasOwnProperty.call(t.constructor.prototype, "isPrototypeOf")) return !1 } catch (t) { return !1 } return !0 }, extend: function () { var t, e, i, r, n, o, a = arguments[0] || {}, h = 1, u = arguments.length, l = !1; for ("boolean" == typeof a && (l = a, a = arguments[1] || {}, h = 2), u === h && (a = this, --h); h < u; h++)if (null != (t = arguments[h])) for (e in t) i = a[e], a !== (r = t[e]) && (l && r && (s.Utils.isPlainObject(r) || (n = Array.isArray(r))) ? (n ? (n = !1, o = i && Array.isArray(i) ? i : []) : o = i && s.Utils.isPlainObject(i) ? i : {}, a[e] = s.Utils.extend(l, o, r)) : void 0 !== r && (a[e] = r)); return a }, mixinPrototype: function (t, e, i) { void 0 === i && (i = !1); for (var r = Object.keys(e), n = 0; n < r.length; n++) { var s = r[n], o = e[s]; !i && s in t || (!o || "function" != typeof o.get && "function" != typeof o.set ? t[s] = o : "function" == typeof o.clone ? t[s] = o.clone() : Object.defineProperty(t, s, o)) } }, mixin: function (t, e) { if (!t || "object" !== (void 0 === t ? "undefined" : r(t))) return e; for (var i in t) { var n = t[i]; if (!n.childNodes && !n.cloneNode) { var o = r(t[i]); t[i] && "object" === o ? r(e[i]) === o ? e[i] = s.Utils.mixin(t[i], e[i]) : e[i] = s.Utils.mixin(t[i], new n.constructor) : e[i] = t[i] } } return e } }, s.Circle = function (t, e, i) { t = t || 0, e = e || 0, i = i || 0, this.x = t, this.y = e, this._diameter = i, this._radius = 0, i > 0 && (this._radius = .5 * i), this.type = s.CIRCLE }, s.Circle.prototype = { circumference: function () { return Math.PI * this._radius * 2 }, random: function (t) { void 0 === t && (t = new s.Point); var e = 2 * Math.PI * Math.random(), i = Math.random() + Math.random(), r = i > 1 ? 2 - i : i, n = r * Math.cos(e), o = r * Math.sin(e); return t.x = this.x + n * this.radius, t.y = this.y + o * this.radius, t }, getBounds: function () { return new s.Rectangle(this.x - this.radius, this.y - this.radius, this.diameter, this.diameter) }, setTo: function (t, e, i) { return this.x = t, this.y = e, this._diameter = i, this._radius = .5 * i, this }, copyFrom: function (t) { return this.setTo(t.x, t.y, t.diameter) }, copyTo: function (t) { return t.x = this.x, t.y = this.y, t.diameter = this._diameter, t }, distance: function (t, e) { var i = s.Math.distance(this.x, this.y, t.x, t.y); return e ? Math.round(i) : i }, clone: function (t) { return void 0 === t || null === t ? t = new s.Circle(this.x, this.y, this.diameter) : t.setTo(this.x, this.y, this.diameter), t }, contains: function (t, e) { return s.Circle.contains(this, t, e) }, circumferencePoint: function (t, e, i) { return s.Circle.circumferencePoint(this, t, e, i) }, sample: function (t, e, i, r, n) { t || (t = 60), null == e && (e = 0), null == i && (i = s.Math.PI2), n || (n = []); for (var o = 0; o < t;)this.circumferencePoint(s.Math.linear(e, i, o / t), r, n[o] || (n[o] = new s.Point)), o += 1; return n }, offset: function (t, e) { return this.x += t, this.y += e, this }, offsetPoint: function (t) { return this.offset(t.x, t.y) }, toString: function () { return "[{Phaser.Circle (x=" + this.x + " y=" + this.y + " diameter=" + this.diameter + " radius=" + this.radius + ")}]" } }, s.Circle.prototype.constructor = s.Circle, Object.defineProperty(s.Circle.prototype, "diameter", { get: function () { return this._diameter }, set: function (t) { t > 0 && (this._diameter = t, this._radius = .5 * t) } }), Object.defineProperty(s.Circle.prototype, "radius", { get: function () { return this._radius }, set: function (t) { t > 0 && (this._radius = t, this._diameter = 2 * t) } }), Object.defineProperty(s.Circle.prototype, "left", { get: function () { return this.x - this._radius }, set: function (t) { t > this.x ? (this._radius = 0, this._diameter = 0) : this.radius = this.x - t } }), Object.defineProperty(s.Circle.prototype, "right", { get: function () { return this.x + this._radius }, set: function (t) { t < this.x ? (this._radius = 0, this._diameter = 0) : this.radius = t - this.x } }), Object.defineProperty(s.Circle.prototype, "top", { get: function () { return this.y - this._radius }, set: function (t) { t > this.y ? (this._radius = 0, this._diameter = 0) : this.radius = this.y - t } }), Object.defineProperty(s.Circle.prototype, "bottom", { get: function () { return this.y + this._radius }, set: function (t) { t < this.y ? (this._radius = 0, this._diameter = 0) : this.radius = t - this.y } }), Object.defineProperty(s.Circle.prototype, "area", { get: function () { return this._radius > 0 ? Math.PI * this._radius * this._radius : 0 } }), Object.defineProperty(s.Circle.prototype, "empty", { get: function () { return 0 === this._diameter }, set: function (t) { !0 === t && this.setTo(0, 0, 0) } }), s.Circle.contains = function (t, e, i) { return t.radius > 0 && e >= t.left && e <= t.right && i >= t.top && i <= t.bottom && (t.x - e) * (t.x - e) + (t.y - i) * (t.y - i) <= t.radius * t.radius }, s.Circle.equals = function (t, e) { return t.x === e.x && t.y === e.y && t.diameter === e.diameter }, s.Circle.intersects = function (t, e) { return s.Math.distance(t.x, t.y, e.x, e.y) <= t.radius + e.radius }, s.Circle.circumferencePoint = function (t, e, i, r) { return void 0 === i && (i = !1), void 0 === r && (r = new s.Point), !0 === i && (e = s.Math.degToRad(e)), r.x = t.x + t.radius * Math.cos(e), r.y = t.y + t.radius * Math.sin(e), r }, s.Circle.intersectsRectangle = function (t, e) { var i = Math.abs(t.x - e.x - e.halfWidth); if (i > e.halfWidth + t.radius) return !1; var r = Math.abs(t.y - e.y - e.halfHeight); if (r > e.halfHeight + t.radius) return !1; if (i <= e.halfWidth || r <= e.halfHeight) return !0; var n = i - e.halfWidth, s = r - e.halfHeight; return n * n + s * s <= t.radius * t.radius }, s.Circle.intersectsLine = function (t, e, i) { var r = t.x, n = t.y, o = (e.end.y - e.start.y) / (e.end.x - e.start.x), a = e.end.y - o * e.end.x, h = t.radius, u = t.radius, l = a + o * r, c = (r * (u * u) - o * (h * h) * (a - n) + h * u * Math.sqrt(h * h * (o * o) + u * u - l * l - n * n + 2 * l * n)) / (h * h * (o * o) + u * u), d = (r * (u * u) - o * (h * h) * (a - n) - h * u * Math.sqrt(h * h * (o * o) + u * u - l * l - n * n + 2 * l * n)) / (h * h * (o * o) + u * u), p = o * c + a, f = o * d + a, g = new s.Point(c, p), m = new s.Point(d, f), v = e.pointOnSegment(g.x, g.y, .01), y = e.pointOnSegment(m.x, m.y, .01); return v && y ? !i || [g, m] : v ? !i || [g] : y ? !i || [m] : !!i && [] }, PIXI.Circle = s.Circle, s.Ellipse = function (t, e, i, r) { t = t || 0, e = e || 0, i = i || 0, r = r || 0, this.x = t, this.y = e, this.width = i, this.height = r, this.type = s.ELLIPSE }, s.Ellipse.prototype = { setTo: function (t, e, i, r) { return this.x = t, this.y = e, this.width = i, this.height = r, this }, getBounds: function () { return new s.Rectangle(this.x - this.width, this.y - this.height, this.width, this.height) }, copyFrom: function (t) { return this.setTo(t.x, t.y, t.width, t.height) }, copyTo: function (t) { return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t }, clone: function (t) { return void 0 === t || null === t ? t = new s.Ellipse(this.x, this.y, this.width, this.height) : t.setTo(this.x, this.y, this.width, this.height), t }, contains: function (t, e) { return s.Ellipse.contains(this, t, e) }, random: function (t) { void 0 === t && (t = new s.Point); var e = Math.random() * Math.PI * 2, i = Math.random(); return t.x = Math.sqrt(i) * Math.cos(e), t.y = Math.sqrt(i) * Math.sin(e), t.x = this.x + t.x * this.width / 2, t.y = this.y + t.y * this.height / 2, t }, toString: function () { return "[{Phaser.Ellipse (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + ")}]" } }, s.Ellipse.prototype.constructor = s.Ellipse, Object.defineProperty(s.Ellipse.prototype, "left", { get: function () { return this.x }, set: function (t) { this.x = t } }), Object.defineProperty(s.Ellipse.prototype, "right", { get: function () { return this.x + this.width }, set: function (t) { t < this.x ? this.width = 0 : this.width = t - this.x } }), Object.defineProperty(s.Ellipse.prototype, "top", { get: function () { return this.y }, set: function (t) { this.y = t } }), Object.defineProperty(s.Ellipse.prototype, "bottom", { get: function () { return this.y + this.height }, set: function (t) { t < this.y ? this.height = 0 : this.height = t - this.y } }), Object.defineProperty(s.Ellipse.prototype, "empty", { get: function () { return 0 === this.width || 0 === this.height }, set: function (t) { !0 === t && this.setTo(0, 0, 0, 0) } }), s.Ellipse.contains = function (t, e, i) { if (t.width <= 0 || t.height <= 0) return !1; var r = (e - t.x) / t.width - .5, n = (i - t.y) / t.height - .5; return (r *= r) + (n *= n) < .25 }, s.Ellipse.intersectsLine = function (t, e, i) { var r = t.x, n = t.y, o = (e.end.y - e.start.y) / (e.end.x - e.start.x), a = e.end.y - o * e.end.x, h = t.width / 2, u = t.height / 2, l = a + o * r, c = (r * (u * u) - o * (h * h) * (a - n) + h * u * Math.sqrt(h * h * (o * o) + u * u - l * l - n * n + 2 * l * n)) / (h * h * (o * o) + u * u), d = (r * (u * u) - o * (h * h) * (a - n) - h * u * Math.sqrt(h * h * (o * o) + u * u - l * l - n * n + 2 * l * n)) / (h * h * (o * o) + u * u), p = o * c + a, f = o * d + a, g = new s.Point(c, p), m = new s.Point(d, f), v = e.pointOnSegment(g.x, g.y, .01), y = e.pointOnSegment(m.x, m.y, .01); return v && y ? !i || [g, m] : v ? !i || [g] : y ? !i || [m] : !!i && [] }, PIXI.Ellipse = s.Ellipse, s.Line = function (t, e, i, r) { t = t || 0, e = e || 0, i = i || 0, r = r || 0, this.start = new s.Point(t, e), this.end = new s.Point(i, r), this.type = s.LINE }, s.Line.prototype = { setTo: function (t, e, i, r) { return this.start.setTo(t, e), this.end.setTo(i, r), this }, fromPoints: function (t, e) { return this.setTo(t.x, t.y, e.x, e.y), this }, fromSprite: function (t, e, i) { return void 0 === i && (i = !1), i ? this.setTo(t.centerX, t.centerY, e.centerX, e.centerY) : this.fromPoints(t, e) }, fromAngle: function (t, e, i, r) { return this.start.setTo(t, e), this.end.setTo(t + Math.cos(i) * r, e + Math.sin(i) * r), this }, rotate: function (t, e) { var i = (this.start.x + this.end.x) / 2, r = (this.start.y + this.end.y) / 2; return this.start.rotate(i, r, t, e), this.end.rotate(i, r, t, e), this }, rotateAround: function (t, e, i, r) { return this.start.rotate(t, e, i, r), this.end.rotate(t, e, i, r), this }, intersects: function (t, e, i) { return s.Line.intersectsPoints(this.start, this.end, t.start, t.end, e, i) }, reflect: function (t) { return s.Line.reflect(this, t) }, midPoint: function (t) { return void 0 === t && (t = new s.Point), t.x = (this.start.x + this.end.x) / 2, t.y = (this.start.y + this.end.y) / 2, t }, centerOn: function (t, e) { var i = t - (this.start.x + this.end.x) / 2, r = e - (this.start.y + this.end.y) / 2; this.start.add(i, r), this.end.add(i, r) }, pointOnLine: function (t, e, i) { return s.Math.fuzzyEqual((t - this.start.x) * (this.end.y - this.start.y), (this.end.x - this.start.x) * (e - this.start.y), i || 0) }, pointOnSegment: function (t, e, i) { var r = Math.min(this.start.x, this.end.x), n = Math.max(this.start.x, this.end.x), s = Math.min(this.start.y, this.end.y), o = Math.max(this.start.y, this.end.y); return this.pointOnLine(t, e, i) && t >= r && t <= n && e >= s && e <= o }, random: function (t) { void 0 === t && (t = new s.Point); var e = Math.random(); return t.x = this.start.x + e * (this.end.x - this.start.x), t.y = this.start.y + e * (this.end.y - this.start.y), t }, coordinatesOnLine: function (t, e) { void 0 === t && (t = 1), void 0 === e && (e = []); var i = Math.round(this.start.x), r = Math.round(this.start.y), n = Math.round(this.end.x), s = Math.round(this.end.y), o = Math.abs(n - i), a = Math.abs(s - r), h = i < n ? 1 : -1, u = r < s ? 1 : -1, l = o - a; e.push([i, r]); for (var c = 1; i !== n || r !== s;) { var d = l << 1; d > -a && (l -= a, i += h), d < o && (l += o, r += u), c % t == 0 && e.push([i, r]), c++ } return e }, clone: function (t) { return void 0 === t || null === t ? t = new s.Line(this.start.x, this.start.y, this.end.x, this.end.y) : t.setTo(this.start.x, this.start.y, this.end.x, this.end.y), t } }, Object.defineProperty(s.Line.prototype, "length", { get: function () { return Math.sqrt((this.end.x - this.start.x) * (this.end.x - this.start.x) + (this.end.y - this.start.y) * (this.end.y - this.start.y)) } }), Object.defineProperty(s.Line.prototype, "angle", { get: function () { return s.Point.angle(this.end, this.start) } }), Object.defineProperty(s.Line.prototype, "slope", { get: function () { return (this.end.y - this.start.y) / (this.end.x - this.start.x) } }), Object.defineProperty(s.Line.prototype, "perpSlope", { get: function () { return -(this.end.x - this.start.x) / (this.end.y - this.start.y) } }), Object.defineProperty(s.Line.prototype, "x", { get: function () { return Math.min(this.start.x, this.end.x) } }), Object.defineProperty(s.Line.prototype, "y", { get: function () { return Math.min(this.start.y, this.end.y) } }), Object.defineProperty(s.Line.prototype, "left", { get: function () { return Math.min(this.start.x, this.end.x) } }), Object.defineProperty(s.Line.prototype, "right", { get: function () { return Math.max(this.start.x, this.end.x) } }), Object.defineProperty(s.Line.prototype, "top", { get: function () { return Math.min(this.start.y, this.end.y) } }), Object.defineProperty(s.Line.prototype, "bottom", { get: function () { return Math.max(this.start.y, this.end.y) } }), Object.defineProperty(s.Line.prototype, "width", { get: function () { return Math.abs(this.start.x - this.end.x) } }), Object.defineProperty(s.Line.prototype, "height", { get: function () { return Math.abs(this.start.y - this.end.y) } }), Object.defineProperty(s.Line.prototype, "normalX", { get: function () { return Math.cos(this.angle - 1.5707963267948966) } }), Object.defineProperty(s.Line.prototype, "normalY", { get: function () { return Math.sin(this.angle - 1.5707963267948966) } }), Object.defineProperty(s.Line.prototype, "normalAngle", { get: function () { return s.Math.wrap(this.angle - 1.5707963267948966, -Math.PI, Math.PI) } }), s.Line.intersectsPoints = function (t, e, i, r, n, o) { void 0 === n && (n = !0), void 0 === o && (o = new s.Point); var a = e.y - t.y, h = r.y - i.y, u = t.x - e.x, l = i.x - r.x, c = e.x * t.y - t.x * e.y, d = r.x * i.y - i.x * r.y, p = a * l - h * u; if (0 === p) return null; if (o.x = (u * d - l * c) / p, o.y = (h * c - a * d) / p, n) { var f = (r.y - i.y) * (e.x - t.x) - (r.x - i.x) * (e.y - t.y), g = ((r.x - i.x) * (t.y - i.y) - (r.y - i.y) * (t.x - i.x)) / f, m = ((e.x - t.x) * (t.y - i.y) - (e.y - t.y) * (t.x - i.x)) / f; return g >= 0 && g <= 1 && m >= 0 && m <= 1 ? o : null } return o }, s.Line.intersects = function (t, e, i, r) { return s.Line.intersectsPoints(t.start, t.end, e.start, e.end, i, r) }, s.Line.intersectsRectangle = function (t, e) { if (0 === t.length || e.empty) return !1; var i = t.start.x, r = t.start.y, n = t.end.x, s = t.end.y, o = e.x, a = e.y, h = e.right, u = e.bottom, l = 0; if (i >= o && i <= h && r >= a && r <= u || n >= o && n <= h && s >= a && s <= u) return !0; if (i < o && n >= o) { if ((l = r + (s - r) * (o - i) / (n - i)) > a && l <= u) return !0 } else if (i > h && n <= h && (l = r + (s - r) * (h - i) / (n - i)) >= a && l <= u) return !0; if (r < a && s >= a) { if ((l = i + (n - i) * (a - r) / (s - r)) >= o && l <= h) return !0 } else if (r > u && s <= u && (l = i + (n - i) * (u - r) / (s - r)) >= o && l <= h) return !0; return !1 }, s.Line.intersectionWithRectangle = function (t, e, i) { var r = s.Line.intersectionWithRectangle; i || (i = new s.Point), r.edges || (r.edges = [new s.Line, new s.Line, new s.Line, new s.Line]), r.edgeIntersection || (r.edgeIntersection = new s.Point); var n = r.edges, o = r.edgeIntersection.set(0), a = e.x, h = e.y, u = e.right, l = e.bottom, c = 1 / 0; n[0].setTo(a, h, u, h), n[1].setTo(a, l, u, l), n[2].setTo(a, h, a, l), n[3].setTo(u, h, u, l); for (var d, p = 0; d = n[p]; p++)if (t.intersects(d, !0, o)) { var f = t.start.distance(o); f < c && (c = f, i.copyFrom(o)) } return null != f ? i : null }, s.Line.reflect = function (t, e) { return 2 * e.normalAngle - 3.141592653589793 - t.angle }, s.Matrix = function (t, e, i, r, n, o) { void 0 !== t && null !== t || (t = 1), void 0 !== e && null !== e || (e = 0), void 0 !== i && null !== i || (i = 0), void 0 !== r && null !== r || (r = 1), void 0 !== n && null !== n || (n = 0), void 0 !== o && null !== o || (o = 0), this.a = t, this.b = e, this.c = i, this.d = r, this.tx = n, this.ty = o, this.type = s.MATRIX }, s.Matrix.prototype = { fromArray: function (t) { return this.setTo(t[0], t[1], t[3], t[4], t[2], t[5]) }, setTo: function (t, e, i, r, n, s) { return this.a = t, this.b = e, this.c = i, this.d = r, this.tx = n, this.ty = s, this }, clone: function (t) { return void 0 === t || null === t ? t = new s.Matrix(this.a, this.b, this.c, this.d, this.tx, this.ty) : (t.a = this.a, t.b = this.b, t.c = this.c, t.d = this.d, t.tx = this.tx, t.ty = this.ty), t }, copyTo: function (t) { return t.copyFrom(this), t }, copyFrom: function (t) { return this.a = t.a, this.b = t.b, this.c = t.c, this.d = t.d, this.tx = t.tx, this.ty = t.ty, this }, toArray: function (t, e) { return void 0 === e && (e = new Float32Array(9)), t ? (e[0] = this.a, e[1] = this.b, e[2] = 0, e[3] = this.c, e[4] = this.d, e[5] = 0, e[6] = this.tx, e[7] = this.ty, e[8] = 1) : (e[0] = this.a, e[1] = this.c, e[2] = this.tx, e[3] = this.b, e[4] = this.d, e[5] = this.ty, e[6] = 0, e[7] = 0, e[8] = 1), e }, apply: function (t, e) { return void 0 === e && (e = new s.Point), e.x = this.a * t.x + this.c * t.y + this.tx, e.y = this.b * t.x + this.d * t.y + this.ty, e }, applyInverse: function (t, e) { void 0 === e && (e = new s.Point); var i = 1 / (this.a * this.d + this.c * -this.b), r = t.x, n = t.y; return e.x = this.d * i * r + -this.c * i * n + (this.ty * this.c - this.tx * this.d) * i, e.y = this.a * i * n + -this.b * i * r + (-this.ty * this.a + this.tx * this.b) * i, e }, translate: function (t, e) { return this.tx += t, this.ty += e, this }, scale: function (t, e) { return this.a *= t, this.d *= e, this.c *= t, this.b *= e, this.tx *= t, this.ty *= e, this }, rotate: function (t) { var e = Math.cos(t), i = Math.sin(t), r = this.a, n = this.c, s = this.tx; return this.a = r * e - this.b * i, this.b = r * i + this.b * e, this.c = n * e - this.d * i, this.d = n * i + this.d * e, this.tx = s * e - this.ty * i, this.ty = s * i + this.ty * e, this }, append: function (t) { var e = this.a, i = this.b, r = this.c, n = this.d; return this.a = t.a * e + t.b * r, this.b = t.a * i + t.b * n, this.c = t.c * e + t.d * r, this.d = t.c * i + t.d * n, this.tx = t.tx * e + t.ty * r + this.tx, this.ty = t.tx * i + t.ty * n + this.ty, this }, identity: function () { return this.setTo(1, 0, 0, 1, 0, 0) } }, s.identityMatrix = new s.Matrix, s.Point = function (t, e) { t = t || 0, e = e || 0, this.x = t, this.y = e, this.type = s.POINT }, s.Point.prototype = { copyFrom: function (t) { return this.setTo(t.x, t.y) }, invert: function () { return this.setTo(this.y, this.x) }, setTo: function (t, e) { return s.Point.set(this, t, e) }, set: function (t, e) { return s.Point.set(this, t, e) }, setToPolar: function (t, e, i) { return null == e && (e = 1), i && (t = s.Math.degToRad(t)), this.setTo(Math.cos(t) * e, Math.sin(t) * e) }, add: function (t, e) { return this.x += t, this.y += e, this }, subtract: function (t, e) { return this.x -= t, this.y -= e, this }, multiply: function (t, e) { return this.x *= t, this.y *= e, this }, divide: function (t, e) { return this.x /= t, this.y /= e, this }, clampX: function (t, e) { return this.x = s.Math.clamp(this.x, t, e), this }, clampY: function (t, e) { return this.y = s.Math.clamp(this.y, t, e), this }, clamp: function (t, e) { return this.x = s.Math.clamp(this.x, t, e), this.y = s.Math.clamp(this.y, t, e), this }, clip: function (t) { var e = t.left, i = t.top, r = t.right, n = t.bottom; return this.x < e ? this.x = e : this.x > r && (this.x = r), this.y < i ? this.y = i : this.y > n && (this.y = n), this }, clone: function (t) { return void 0 === t || null === t ? t = new s.Point(this.x, this.y) : t.setTo(this.x, this.y), t }, copyTo: function (t) { return t.x = this.x, t.y = this.y, t }, distance: function (t, e) { return s.Point.distance(this, t, e) }, equals: function (t) { return t.x === this.x && t.y === this.y }, equalsXY: function (t, e) { return this.x === t && this.y === e }, fuzzyEquals: function (t, e) { return s.Point.fuzzyEquals(this, t, e) }, fuzzyEqualsXY: function (t, e, i) { return s.Point.fuzzyEqualsXY(this, t, e, i) }, angle: function (t, e) { return this.angleXY(t.x, t.y, e) }, angleXY: function (t, e, i) { var r = Math.atan2(e - this.y, t - this.x); return i ? s.Math.radToDeg(r) : r }, atan: function (t) { var e = Math.atan2(this.y, this.x); return t ? s.Math.radToDeg(e) : e }, rotate: function (t, e, i, r, n) { return s.Point.rotate(this, t, e, i, r, n) }, getMagnitude: function () { return Math.sqrt(this.x * this.x + this.y * this.y) }, getMagnitudeSq: function () { return this.x * this.x + this.y * this.y }, setMagnitude: function (t) { return this.normalize().multiply(t, t) }, normalize: function () { if (!this.isZero()) { var t = this.getMagnitude(); this.x /= t, this.y /= t } return this }, limit: function (t) { return this.getMagnitudeSq() > t * t && this.setMagnitude(t), this }, expand: function (t) { return this.getMagnitudeSq() < t * t && this.setMagnitude(t), this }, isZero: function () { return 0 === this.x && 0 === this.y }, dot: function (t) { return this.x * t.x + this.y * t.y }, cross: function (t) { return this.x * t.y - this.y * t.x }, perp: function () { return this.setTo(-this.y, this.x) }, rperp: function () { return this.setTo(this.y, -this.x) }, normalRightHand: function () { return this.setTo(-1 * this.y, this.x) }, floor: function () { return this.setTo(Math.floor(this.x), Math.floor(this.y)) }, ceil: function () { return this.setTo(Math.ceil(this.x), Math.ceil(this.y)) }, round: function () { return this.setTo(Math.round(this.x), Math.round(this.y)) }, toString: function () { return "[{Point (x=" + this.x + " y=" + this.y + ")}]" } }, s.Point.prototype.constructor = s.Point, s.Point.add = function (t, e, i) { return void 0 === i && (i = new s.Point), i.x = t.x + e.x, i.y = t.y + e.y, i }, s.Point.subtract = function (t, e, i) { return void 0 === i && (i = new s.Point), i.x = t.x - e.x, i.y = t.y - e.y, i }, s.Point.multiply = function (t, e, i) { return void 0 === i && (i = new s.Point), i.x = t.x * e.x, i.y = t.y * e.y, i }, s.Point.divide = function (t, e, i) { return void 0 === i && (i = new s.Point), i.x = t.x / e.x, i.y = t.y / e.y, i }, s.Point.equals = function (t, e) { return t.x === e.x && t.y === e.y }, s.Point.equalsXY = function (t, e, i) { return t.x === e && t.y === i }, s.Point.fuzzyEquals = function (t, e, i) { return s.Math.fuzzyEquals(t.x, e.x, i) && s.Math.fuzzyEquals(t.y, e.y, i) }, s.Point.fuzzyEqualsXY = function (t, e, i, r) { return s.Math.fuzzyEquals(t.x, e, r) && s.Math.fuzzyEquals(t.y, i, r) }, s.Point.angle = function (t, e) { return Math.atan2(t.y - e.y, t.x - e.x) }, s.Point.negative = function (t, e) { return void 0 === e && (e = new s.Point), e.setTo(-t.x, -t.y) }, s.Point.multiplyAdd = function (t, e, i, r) { return void 0 === r && (r = new s.Point), r.setTo(t.x + e.x * i, t.y + e.y * i) }, s.Point.interpolate = function (t, e, i, r) { return void 0 === r && (r = new s.Point), r.setTo(t.x + (e.x - t.x) * i, t.y + (e.y - t.y) * i) }, s.Point.perp = function (t, e) { return void 0 === e && (e = new s.Point), e.setTo(-t.y, t.x) }, s.Point.rperp = function (t, e) { return void 0 === e && (e = new s.Point), e.setTo(t.y, -t.x) }, s.Point.distance = function (t, e, i) { var r = s.Math.distance(t.x, t.y, e.x, e.y); return i ? Math.round(r) : r }, s.Point.project = function (t, e, i) { void 0 === i && (i = new s.Point); var r = t.dot(e) / e.getMagnitudeSq(); return 0 !== r && i.setTo(r * e.x, r * e.y), i }, s.Point.projectUnit = function (t, e, i) { void 0 === i && (i = new s.Point); var r = t.dot(e); return 0 !== r && i.setTo(r * e.x, r * e.y), i }, s.Point.normalRightHand = function (t, e) { return void 0 === e && (e = new s.Point), e.setTo(-1 * t.y, t.x) }, s.Point.normalize = function (t, e) { void 0 === e && (e = new s.Point); var i = t.getMagnitude(); return 0 !== i && e.setTo(t.x / i, t.y / i), e }, s.Point.rotate = function (t, e, i, r, n, o) { if (n && (r = s.Math.degToRad(r)), void 0 === o) { t.subtract(e, i); var a = Math.sin(r), h = Math.cos(r), u = h * t.x - a * t.y, l = a * t.x + h * t.y; t.x = u + e, t.y = l + i } else { var c = r + Math.atan2(t.y - i, t.x - e); t.x = e + o * Math.cos(c), t.y = i + o * Math.sin(c) } return t }, s.Point.centroid = function (t, e) { if (void 0 === e && (e = new s.Point), "[object Array]" !== Object.prototype.toString.call(t)) throw new Error("Phaser.Point. Parameter 'points' must be an array"); var i = t.length; if (i < 1) throw new Error("Phaser.Point. Parameter 'points' array must not be empty"); if (1 === i) return e.copyFrom(t[0]), e; for (var r = 0; r < i; r++)s.Point.add(e, t[r], e); return e.divide(i, i), e }, s.Point.parse = function (t, e, i) { e = e || "x", i = i || "y"; var r = new s.Point; return t[e] && (r.x = parseInt(t[e], 10)), t[i] && (r.y = parseInt(t[i], 10)), r }, s.Point.isPoint = function (t) { return null != t && "number" == typeof t.x && "number" == typeof t.y }, s.Point.set = function (t, e, i) { return t.x = e || 0, t.y = i || (0 !== i ? t.x : 0), t }, s.Point.sortClockwise = function (t, e) { e || (e = this.centroid(t)); var i = e.x, r = e.y; return t.sort(function (t, e) { if (t.x - i >= 0 && e.x - i < 0) return -1; if (t.x - i < 0 && e.x - i >= 0) return 1; if (t.x - i == 0 && e.x - i == 0) return t.y - r >= 0 || e.y - r >= 0 ? t.y > e.y ? 1 : -1 : e.y > t.y ? 1 : -1; var n = (t.x - i) * -(e.y - r) - (e.x - i) * -(t.y - r); return n < 0 ? -1 : n > 0 ? 1 : (t.x - i) * (t.x - i) + (t.y - r) * (t.y - r) > (e.x - i) * (e.x - i) + (e.y - r) * (e.y - r) ? -1 : 1 }) }, PIXI.Point = s.Point, s.Polygon = function () { this.area = 0, this._points = [], arguments.length > 0 && this.setTo.apply(this, arguments), this.closed = !0, this.flattened = !1, this.type = s.POLYGON }, s.Polygon.prototype = { toNumberArray: function (t) { void 0 === t && (t = []); for (var e = 0; e < this._points.length; e++)"number" == typeof this._points[e] ? (t.push(this._points[e]), t.push(this._points[e + 1]), e++) : (t.push(this._points[e].x), t.push(this._points[e].y)); return t }, flatten: function () { return this._points = this.toNumberArray(), this.flattened = !0, this }, clone: function (t) { var e = this._points.slice(); return void 0 === t || null === t ? t = new s.Polygon(e) : t.setTo(e), t }, contains: function (t, e) { var i = !1; if (this.flattened) for (var r = -2, n = this._points.length - 2; (r += 2) < this._points.length; n = r) { var s = this._points[r], o = this._points[r + 1], a = this._points[n], h = this._points[n + 1]; (o <= e && e < h || h <= e && e < o) && t < (a - s) * (e - o) / (h - o) + s && (i = !i) } else for (r = -1, n = this._points.length - 1; ++r < this._points.length; n = r) { s = this._points[r].x, o = this._points[r].y, a = this._points[n].x, h = this._points[n].y; (o <= e && e < h || h <= e && e < o) && t < (a - s) * (e - o) / (h - o) + s && (i = !i) } return i }, setTo: function (t) { if (this.area = 0, this._points = [], arguments.length > 0) { Array.isArray(t) || (t = Array.prototype.slice.call(arguments)); for (var e = Number.MAX_VALUE, i = 0, r = t.length; i < r; i++) { if ("number" == typeof t[i]) { var n = new PIXI.Point(t[i], t[i + 1]); i++ } else if (Array.isArray(t[i])) n = new PIXI.Point(t[i][0], t[i][1]); else n = new PIXI.Point(t[i].x, t[i].y); this._points.push(n), n.y < e && (e = n.y) } this.calculateArea(e) } return this }, calculateArea: function (t) { for (var e, i, r, n, s = 0, o = this._points.length; s < o; s++)e = this._points[s], i = s === o - 1 ? this._points[0] : this._points[s + 1], r = (e.y - t + (i.y - t)) / 2, n = e.x - i.x, this.area += r * n; return this.area } }, s.Polygon.prototype.constructor = s.Polygon, Object.defineProperty(s.Polygon.prototype, "points", { get: function () { return this._points } }), PIXI.Polygon = s.Polygon, s.Rectangle = function (t, e, i, r) { t = t || 0, e = e || 0, i = i || 0, r = r || 0, this.x = t, this.y = e, this.width = i, this.height = r, this.type = s.RECTANGLE }, s.Rectangle.prototype = { offset: function (t, e) { return this.x += t, this.y += e, this }, offsetPoint: function (t) { return this.offset(t.x, t.y) }, setTo: function (t, e, i, r) { return this.x = t, this.y = e, this.width = i, this.height = r, this }, scale: function (t, e) { return void 0 === e && (e = t), this.width *= t, this.height *= e, this }, centerOn: function (t, e) { return this.centerX = t, this.centerY = e, this }, floor: function () { this.x = Math.floor(this.x), this.y = Math.floor(this.y) }, floorAll: function () { this.x = Math.floor(this.x), this.y = Math.floor(this.y), this.width = Math.floor(this.width), this.height = Math.floor(this.height) }, ceil: function () { this.x = Math.ceil(this.x), this.y = Math.ceil(this.y) }, ceilAll: function () { this.x = Math.ceil(this.x), this.y = Math.ceil(this.y), this.width = Math.ceil(this.width), this.height = Math.ceil(this.height) }, copyFrom: function (t) { return this.setTo(t.x, t.y, t.width, t.height) }, copyFromBounds: function (t) { return this.setTo(t.left, t.top, t.width, t.height) }, copyTo: function (t) { return t.x = this.x, t.y = this.y, t.width = this.width, t.height = this.height, t }, inflate: function (t, e) { return s.Rectangle.inflate(this, t, e) }, size: function (t) { return s.Rectangle.size(this, t) }, resize: function (t, e) { return this.width = t, this.height = e, this }, clone: function (t) { return s.Rectangle.clone(this, t) }, contains: function (t, e) { return s.Rectangle.contains(this, t, e) }, containsRect: function (t) { return s.Rectangle.containsRect(t, this) }, equals: function (t) { return s.Rectangle.equals(this, t) }, intersection: function (t, e) { return s.Rectangle.intersection(this, t, e) }, intersects: function (t) { return s.Rectangle.intersects(this, t) }, intersectsRaw: function (t, e, i, r, n) { return s.Rectangle.intersectsRaw(this, t, e, i, r, n) }, union: function (t, e) { return s.Rectangle.union(this, t, e) }, random: function (t) { return void 0 === t && (t = new s.Point), t.x = this.randomX, t.y = this.randomY, t }, getPoint: function (t, e) { switch (void 0 === e && (e = new s.Point), t) { default: case s.TOP_LEFT: return e.set(this.x, this.y); case s.TOP_CENTER: return e.set(this.centerX, this.y); case s.TOP_RIGHT: return e.set(this.right, this.y); case s.LEFT_CENTER: return e.set(this.x, this.centerY); case s.CENTER: return e.set(this.centerX, this.centerY); case s.RIGHT_CENTER: return e.set(this.right, this.centerY); case s.BOTTOM_LEFT: return e.set(this.x, this.bottom); case s.BOTTOM_CENTER: return e.set(this.centerX, this.bottom); case s.BOTTOM_RIGHT: return e.set(this.right, this.bottom) } }, sides: function (t, e, i, r) { arguments.length || (t = new s.Line, e = new s.Line, i = new s.Line, r = new s.Line); var n = this.x, o = this.y, a = this.right, h = this.bottom; return t.setTo(n, o, a, o), e.setTo(a, o, a, h), i.setTo(n, h, a, h), r.setTo(n, o, n, h), arguments.length ? null : [t, e, i, r] }, toString: function () { return "[{Rectangle (x=" + this.x + " y=" + this.y + " width=" + this.width + " height=" + this.height + " empty=" + this.empty + ")}]" } }, Object.defineProperty(s.Rectangle.prototype, "halfWidth", { get: function () { return Math.round(this.width / 2) } }), Object.defineProperty(s.Rectangle.prototype, "halfHeight", { get: function () { return Math.round(this.height / 2) } }), Object.defineProperty(s.Rectangle.prototype, "bottom", { get: function () { return this.y + this.height }, set: function (t) { t <= this.y ? this.height = 0 : this.height = t - this.y } }), Object.defineProperty(s.Rectangle.prototype, "bottomLeft", { get: function () { return new s.Point(this.x, this.bottom) }, set: function (t) { this.x = t.x, this.bottom = t.y } }), Object.defineProperty(s.Rectangle.prototype, "bottomRight", { get: function () { return new s.Point(this.right, this.bottom) }, set: function (t) { this.right = t.x, this.bottom = t.y } }), Object.defineProperty(s.Rectangle.prototype, "left", { get: function () { return this.x }, set: function (t) { t >= this.right ? this.width = 0 : this.width = this.right - t, this.x = t } }), Object.defineProperty(s.Rectangle.prototype, "right", { get: function () { return this.x + this.width }, set: function (t) { t <= this.x ? this.width = 0 : this.width = t - this.x } }), Object.defineProperty(s.Rectangle.prototype, "volume", { get: function () { return this.width * this.height } }), Object.defineProperty(s.Rectangle.prototype, "perimeter", { get: function () { return 2 * this.width + 2 * this.height } }), Object.defineProperty(s.Rectangle.prototype, "centerX", { get: function () { return this.x + this.halfWidth }, set: function (t) { this.x = t - this.halfWidth } }), Object.defineProperty(s.Rectangle.prototype, "centerY", { get: function () { return this.y + this.halfHeight }, set: function (t) { this.y = t - this.halfHeight } }), Object.defineProperty(s.Rectangle.prototype, "randomX", { get: function () { return this.x + Math.random() * this.width } }), Object.defineProperty(s.Rectangle.prototype, "randomY", { get: function () { return this.y + Math.random() * this.height } }), Object.defineProperty(s.Rectangle.prototype, "top", { get: function () { return this.y }, set: function (t) { t >= this.bottom ? (this.height = 0, this.y = t) : this.height = this.bottom - t } }), Object.defineProperty(s.Rectangle.prototype, "topLeft", { get: function () { return new s.Point(this.x, this.y) }, set: function (t) { this.x = t.x, this.y = t.y } }), Object.defineProperty(s.Rectangle.prototype, "topRight", { get: function () { return new s.Point(this.x + this.width, this.y) }, set: function (t) { this.right = t.x, this.y = t.y } }), Object.defineProperty(s.Rectangle.prototype, "empty", { get: function () { return !this.width || !this.height }, set: function (t) { !0 === t && this.setTo(0, 0, 0, 0) } }), s.Rectangle.prototype.constructor = s.Rectangle, s.Rectangle.inflate = function (t, e, i) { return t.x -= e, t.width += 2 * e, t.y -= i, t.height += 2 * i, t }, s.Rectangle.inflatePoint = function (t, e) { return s.Rectangle.inflate(t, e.x, e.y) }, s.Rectangle.size = function (t, e) { return void 0 === e || null === e ? e = new s.Point(t.width, t.height) : e.setTo(t.width, t.height), e }, s.Rectangle.clone = function (t, e) { return void 0 === e || null === e ? e = new s.Rectangle(t.x, t.y, t.width, t.height) : e.setTo(t.x, t.y, t.width, t.height), e }, s.Rectangle.createFromBounds = function (t, e) { return void 0 !== e && null !== e || (e = new s.Rectangle(t.x, t.y, t.width, t.height)), e.copyFromBounds(t) }, s.Rectangle.contains = function (t, e, i) { return !(t.width <= 0 || t.height <= 0) && (e >= t.x && e < t.right && i >= t.y && i < t.bottom) }, s.Rectangle.containsRaw = function (t, e, i, r, n, s) { return n >= t && n < t + i && s >= e && s < e + r }, s.Rectangle.containsPoint = function (t, e) { return s.Rectangle.contains(t, e.x, e.y) }, s.Rectangle.containsRect = function (t, e) { return !(t.volume > e.volume) && (t.x >= e.x && t.y >= e.y && t.right < e.right && t.bottom < e.bottom) }, s.Rectangle.equals = function (t, e) { return t.x === e.x && t.y === e.y && t.width === e.width && t.height === e.height }, s.Rectangle.sameDimensions = function (t, e) { return t.width === e.width && t.height === e.height }, s.Rectangle.intersection = function (t, e, i) { return void 0 === i && (i = new s.Rectangle), s.Rectangle.intersects(t, e) && (i.x = Math.max(t.x, e.x), i.y = Math.max(t.y, e.y), i.width = Math.min(t.right, e.right) - i.x, i.height = Math.min(t.bottom, e.bottom) - i.y), i }, s.Rectangle.intersects = function (t, e) { return !(t.width <= 0 || t.height <= 0 || e.width <= 0 || e.height <= 0) && !(t.right < e.x || t.bottom < e.y || t.x > e.right || t.y > e.bottom) }, s.Rectangle.intersectsRaw = function (t, e, i, r, n, s) { return void 0 === s && (s = 0), !(e > t.right + s || i < t.left - s || r > t.bottom + s || n < t.top - s) }, s.Rectangle.union = function (t, e, i) { return void 0 === i && (i = new s.Rectangle), i.setTo(Math.min(t.x, e.x), Math.min(t.y, e.y), Math.max(t.right, e.right) - Math.min(t.left, e.left), Math.max(t.bottom, e.bottom) - Math.min(t.top, e.top)) }, s.Rectangle.aabb = function (t, e) { void 0 === e && (e = new s.Rectangle); var i = Number.NEGATIVE_INFINITY, r = Number.POSITIVE_INFINITY, n = Number.NEGATIVE_INFINITY, o = Number.POSITIVE_INFINITY; return t.forEach(function (t) { t.x > i && (i = t.x), t.x < r && (r = t.x), t.y > n && (n = t.y), t.y < o && (o = t.y) }), e.setTo(r, o, i - r, n - o), e }, PIXI.Rectangle = s.Rectangle, PIXI.EmptyRectangle = new s.Rectangle(0, 0, 0, 0), s.RoundedRectangle = function (t, e, i, r, n) { void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === r && (r = 0), void 0 === n && (n = 20), this.x = t, this.y = e, this.width = i, this.height = r, this.radius = n || 20, this.type = s.ROUNDEDRECTANGLE }, s.RoundedRectangle.prototype = { clone: function () { return new s.RoundedRectangle(this.x, this.y, this.width, this.height, this.radius) }, contains: function (t, e) { if (this.width <= 0 || this.height <= 0) return !1; var i = this.x; if (t >= i && t <= i + this.width) { var r = this.y; if (e >= r && e <= r + this.height) return !0 } return !1 } }, s.RoundedRectangle.prototype.constructor = s.RoundedRectangle, PIXI.RoundedRectangle = s.RoundedRectangle, s.Camera = function (t, e, i, r, n, o) { this.game = t, this.world = t.world, this.id = 0, this.view = new s.Rectangle(i, r, n, o), this.bounds = new s.Rectangle(i, r, n, o), this.deadzone = null, this.visible = !0, this.roundPx = !0, this.atLimit = { x: !1, y: !1 }, this.target = null, this.displayObject = null, this.scale = null, this.totalInView = 0, this.lerp = new s.Point(1, 1), this.onShakeComplete = new s.Signal, this.onFlashComplete = new s.Signal, this.onFadeComplete = new s.Signal, this.fx = null, this._targetPosition = new s.Point, this._edge = 0, this._position = new s.Point, this._shake = { intensity: 0, duration: 0, horizontal: !1, vertical: !1, shakeBounds: !0, x: 0, y: 0 }, this._fxDuration = 0, this._fxType = 0, this._fixedView = new s.Rectangle }, s.Camera.FOLLOW_LOCKON = 0, s.Camera.FOLLOW_PLATFORMER = 1, s.Camera.FOLLOW_TOPDOWN = 2, s.Camera.FOLLOW_TOPDOWN_TIGHT = 3, s.Camera.SHAKE_BOTH = 4, s.Camera.SHAKE_HORIZONTAL = 5, s.Camera.SHAKE_VERTICAL = 6, s.Camera.ENABLE_FX = !0, s.Camera.prototype = { boot: function () { this.displayObject = this.game.world, this.scale = this.game.world.scale, this.game.camera = this, s.Graphics && s.Camera.ENABLE_FX && (this.fx = new s.Graphics(this.game), this.game.stage.addChild(this.fx)) }, preUpdate: function () { this.totalInView = 0 }, follow: function (t, e, i, r) { var n; switch (void 0 === e && (e = s.Camera.FOLLOW_LOCKON), void 0 === i && (i = 1), void 0 === r && (r = 1), this.target = t, this.lerp.set(i, r), e) { case s.Camera.FOLLOW_PLATFORMER: var o = this.width / 8, a = this.height / 3; this.deadzone = new s.Rectangle((this.width - o) / 2, (this.height - a) / 2 - .25 * a, o, a); break; case s.Camera.FOLLOW_TOPDOWN: n = Math.max(this.width, this.height) / 4, this.deadzone = new s.Rectangle((this.width - n) / 2, (this.height - n) / 2, n, n); break; case s.Camera.FOLLOW_TOPDOWN_TIGHT: n = Math.max(this.width, this.height) / 8, this.deadzone = new s.Rectangle((this.width - n) / 2, (this.height - n) / 2, n, n); break; case s.Camera.FOLLOW_LOCKON: default: this.deadzone = null } }, unfollow: function () { this.target = null }, focusOn: function (t) { this.setPosition(Math.round(t.x - this.view.halfWidth), Math.round(t.y - this.view.halfHeight)) }, focusOnXY: function (t, e) { this.setPosition(Math.round(t - this.view.halfWidth), Math.round(e - this.view.halfHeight)) }, shake: function (t, e, i, r, n) { return void 0 === t && (t = .05), void 0 === e && (e = 500), void 0 === i && (i = !0), void 0 === r && (r = s.Camera.SHAKE_BOTH), void 0 === n && (n = !0), !(!i && this._shake.duration > 0) && (this._shake.intensity = t, this._shake.duration = e, this._shake.shakeBounds = n, this._shake.x = 0, this._shake.y = 0, this._shake.horizontal = r === s.Camera.SHAKE_BOTH || r === s.Camera.SHAKE_HORIZONTAL, this._shake.vertical = r === s.Camera.SHAKE_BOTH || r === s.Camera.SHAKE_VERTICAL, !0) }, flash: function (t, e, i, r) { return void 0 === t && (t = 16777215), void 0 === e && (e = 500), void 0 === i && (i = !1), void 0 === r && (r = 1), !(!this.fx || !i && this._fxDuration > 0) && (this.fx.clear(), this.fx.beginFill(t, r), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), this.fx.alpha = 1, this._fxDuration = e, this._fxType = 0, !0) }, fade: function (t, e, i, r) { return void 0 === t && (t = 0), void 0 === e && (e = 500), void 0 === i && (i = !1), void 0 === r && (r = 1), !(!this.fx || !i && this._fxDuration > 0) && (this.fx.clear(), this.fx.beginFill(t, r), this.fx.drawRect(0, 0, this.width, this.height), this.fx.endFill(), this.fx.alpha = 0, this._fxDuration = e, this._fxType = 1, !0) }, update: function () { this._fxDuration > 0 && this.updateFX(), this._shake.duration > 0 && this.updateShake(), this.bounds && this.checkBounds(), this.roundPx && (this.view.floor(), this._shake.x = Math.floor(this._shake.x), this._shake.y = Math.floor(this._shake.y)), this.displayObject.position.x = -this.view.x, this.displayObject.position.y = -this.view.y }, updateFX: function () { 0 === this._fxType ? (this.fx.alpha -= this.game.time.elapsedMS / this._fxDuration, this.fx.alpha <= 0 && (this._fxDuration = 0, this.fx.alpha = 0, this.onFlashComplete.dispatch())) : (this.fx.alpha += this.game.time.elapsedMS / this._fxDuration, this.fx.alpha >= 1 && (this._fxDuration = 0, this.fx.alpha = 1, this.onFadeComplete.dispatch())) }, updateShake: function () { this._shake.duration -= this.game.time.elapsedMS, this._shake.duration <= 0 ? (this.onShakeComplete.dispatch(), this._shake.x = 0, this._shake.y = 0) : (this._shake.horizontal && (this._shake.x = this.game.rnd.frac() * this._shake.intensity * this.view.width * 2 - this._shake.intensity * this.view.width), this._shake.vertical && (this._shake.y = this.game.rnd.frac() * this._shake.intensity * this.view.height * 2 - this._shake.intensity * this.view.height)) }, updateTarget: function () { this._targetPosition.x = this.view.x + this.target.worldPosition.x, this._targetPosition.y = this.view.y + this.target.worldPosition.y, this.deadzone ? (this._edge = this._targetPosition.x - this.view.x, this._edge < this.deadzone.left ? this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.left, this.lerp.x) : this._edge > this.deadzone.right && (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.deadzone.right, this.lerp.x)), this._edge = this._targetPosition.y - this.view.y, this._edge < this.deadzone.top ? this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.top, this.lerp.y) : this._edge > this.deadzone.bottom && (this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.deadzone.bottom, this.lerp.y))) : (this.view.x = this.game.math.linear(this.view.x, this._targetPosition.x - this.view.halfWidth, this.lerp.x), this.view.y = this.game.math.linear(this.view.y, this._targetPosition.y - this.view.halfHeight, this.lerp.y)), this.bounds && this.checkBounds(), this.roundPx && this.view.floor(), this.displayObject.position.x = -this.view.x, this.displayObject.position.y = -this.view.y }, setBoundsToWorld: function () { this.bounds && this.bounds.copyFrom(this.game.world.bounds) }, checkBounds: function () { this.atLimit.x = !1, this.atLimit.y = !1; var t = this.view.x + this._shake.x, e = this.view.right + this._shake.x, i = this.view.y + this._shake.y, r = this.view.bottom + this._shake.y; t <= this.bounds.x * this.scale.x ? (this.atLimit.x = !0, this.view.x = this.bounds.x * this.scale.x, this._shake.shakeBounds || (this._shake.x = 0)) : e >= this.bounds.right * this.scale.x && (this.atLimit.x = !0, this.view.x = this.bounds.right * this.scale.x - this.width, this._shake.shakeBounds || (this._shake.x = 0)), i <= this.bounds.top * this.scale.y ? (this.atLimit.y = !0, this.view.y = this.bounds.top * this.scale.y, this._shake.shakeBounds || (this._shake.y = 0)) : r >= this.bounds.bottom * this.scale.y && (this.atLimit.y = !0, this.view.y = this.bounds.bottom * this.scale.y - this.height, this._shake.shakeBounds || (this._shake.y = 0)) }, setPosition: function (t, e) { this.view.x = t, this.view.y = e, this.bounds && this.checkBounds() }, setSize: function (t, e) { this.view.width = t, this.view.height = e }, reset: function () { this.target = null, this.view.x = 0, this.view.y = 0, this._shake.duration = 0, this._shake.x = 0, this._shake.y = 0, this.resetFX() }, resetFX: function () { this.fx && (this.fx.clear(), this.fx.alpha = 0), this._fxDuration = 0 } }, s.Camera.prototype.constructor = s.Camera, Object.defineProperty(s.Camera.prototype, "x", { get: function () { return this.view.x }, set: function (t) { this.view.x = t, this.bounds && this.checkBounds() } }), Object.defineProperty(s.Camera.prototype, "y", { get: function () { return this.view.y }, set: function (t) { this.view.y = t, this.bounds && this.checkBounds() } }), Object.defineProperty(s.Camera.prototype, "position", { get: function () { return this._position.set(this.view.x, this.view.y), this._position }, set: function (t) { void 0 !== t.x && (this.view.x = t.x), void 0 !== t.y && (this.view.y = t.y), this.bounds && this.checkBounds() } }), Object.defineProperty(s.Camera.prototype, "width", { get: function () { return this.view.width }, set: function (t) { this.view.width = t } }), Object.defineProperty(s.Camera.prototype, "height", { get: function () { return this.view.height }, set: function (t) { this.view.height = t } }), Object.defineProperty(s.Camera.prototype, "shakeIntensity", { get: function () { return this._shake.intensity }, set: function (t) { this._shake.intensity = t } }), Object.defineProperty(s.Camera.prototype, "fixedView", { get: function () { return this._fixedView.setTo(0, 0, this.view.width, this.view.height), this._fixedView } }), s.State = function () { this.game = null, this.key = "", this.add = null, this.make = null, this.camera = null, this.cache = null, this.input = null, this.load = null, this.math = null, this.sound = null, this.scale = null, this.stage = null, this.state = null, this.time = null, this.tweens = null, this.world = null, this.particles = null, this.physics = null, this.rnd = null }, s.State.prototype = { init: function () { }, preload: function () { }, loadUpdate: function () { }, loadRender: function () { }, create: function () { }, update: function () { }, preRender: function () { }, render: function () { }, resize: function () { }, paused: function () { }, resumed: function () { }, pauseUpdate: function () { }, shutdown: function () { } }, s.State.prototype.constructor = s.State, s.StateManager = function (t, e) { this.game = t, this.states = {}, this._pendingState = null, void 0 !== e && null !== e && (this._pendingState = e), this._clearWorld = !1, this._clearCache = !1, this._created = !1, this._args = [], this.current = "", this.onStateChange = new s.Signal, this.onInitCallback = null, this.onPreloadCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, this.onPreRenderCallback = null, this.onLoadUpdateCallback = null, this.onLoadRenderCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.onShutDownCallback = null }, s.StateManager.prototype = { boot: function () { this.game.onPause.add(this.pause, this), this.game.onResume.add(this.resume, this), null !== this._pendingState && "string" != typeof this._pendingState && this.add("default", this._pendingState, !0) }, add: function (t, e, i) { var n; return void 0 === i && (i = !1), e instanceof s.State ? n = e : "object" === (void 0 === e ? "undefined" : r(e)) ? (n = e).game = this.game : "function" == typeof e && (n = new e(this.game)), this.states[t] = n, i && (this.game.isBooted ? this.start(t) : this._pendingState = t), n }, remove: function (t) { this.current === t && (this.callbackContext = null, this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onPreRenderCallback = null, this.onRenderCallback = null, this.onResizeCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null), delete this.states[t] }, start: function (t, e, i) { void 0 === e && (e = !0), void 0 === i && (i = !1), this.checkState(t) && (this._pendingState = t, this._clearWorld = e, this._clearCache = i, arguments.length > 3 && (this._args = Array.prototype.splice.call(arguments, 3))) }, restart: function (t, e) { void 0 === t && (t = !0), void 0 === e && (e = !1), this._pendingState = this.current, this._clearWorld = t, this._clearCache = e, arguments.length > 2 && (this._args = Array.prototype.slice.call(arguments, 2)) }, dummy: function () { }, preUpdate: function () { if (this._pendingState && this.game.isBooted) { var t = this.current; if (this.clearCurrentState(), this.setCurrentState(this._pendingState), this.onStateChange.dispatch(this.current, t), this.current !== this._pendingState) return; this._pendingState = null, this.onPreloadCallback ? (this.game.load.reset(!0), this.onPreloadCallback.call(this.callbackContext, this.game), 0 === this.game.load.totalQueuedFiles() && 0 === this.game.load.totalQueuedPacks() ? this.loadComplete() : this.game.load.start()) : this.loadComplete() } }, clearCurrentState: function () { this.current && (this.onShutDownCallback && this.onShutDownCallback.call(this.callbackContext, this.game), this.game.tweens.removeAll(), this.game.camera.reset(), this.game.input.reset(!0), this.game.physics.clear(), this.game.time.removeAll(), this.game.scale.reset(this._clearWorld), this.game.debug && this.game.debug.reset(), this._clearWorld && (this.game.world.shutdown(), this._clearCache && this.game.cache.destroy())) }, checkState: function (t) { var e = this.states[t]; return e ? !!(e.preload || e.create || e.update || e.render) || (console.warn("Invalid Phaser State object given. Must contain at least one of the required functions: preload, create, update or render"), !1) : (console.warn("Phaser.StateManager - No state found with the key: " + t), !1) }, link: function (t) { var e = this.states[t]; e.game = this.game, e.add = this.game.add, e.make = this.game.make, e.camera = this.game.camera, e.cache = this.game.cache, e.input = this.game.input, e.load = this.game.load, e.math = this.game.math, e.sound = this.game.sound, e.scale = this.game.scale, e.state = this, e.stage = this.game.stage, e.time = this.game.time, e.tweens = this.game.tweens, e.world = this.game.world, e.particles = this.game.particles, e.rnd = this.game.rnd, e.physics = this.game.physics, e.key = t }, unlink: function (t) { var e = this.states[t]; e && (e.game = null, e.add = null, e.make = null, e.camera = null, e.cache = null, e.input = null, e.load = null, e.math = null, e.sound = null, e.scale = null, e.state = null, e.stage = null, e.time = null, e.tweens = null, e.world = null, e.particles = null, e.rnd = null, e.physics = null) }, setCurrentState: function (t) { var e = this.states[t]; this.callbackContext = e, this.link(t), this.onInitCallback = e.init || this.dummy, this.onPreloadCallback = e.preload || null, this.onLoadRenderCallback = e.loadRender || null, this.onLoadUpdateCallback = e.loadUpdate || null, this.onCreateCallback = e.create || null, this.onUpdateCallback = e.update || null, this.onPreRenderCallback = e.preRender || null, this.onRenderCallback = e.render || null, this.onResizeCallback = e.resize || null, this.onPausedCallback = e.paused || null, this.onResumedCallback = e.resumed || null, this.onPauseUpdateCallback = e.pauseUpdate || null, this.onShutDownCallback = e.shutdown || this.dummy, "" !== this.current && this.game.physics.reset(), this.current = t, this._created = !1, this.onInitCallback.apply(this.callbackContext, this._args), t === this._pendingState && (this._args = []), this.game._kickstart = !0 }, getCurrentState: function () { return this.states[this.current] }, loadComplete: function () { !1 === this._created && this.onCreateCallback ? (this._created = !0, this.onCreateCallback.call(this.callbackContext, this.game)) : this._created = !0 }, loadUpdate: function () { !1 === this._created && this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game) }, pause: function () { this._created && this.onPausedCallback && this.onPausedCallback.call(this.callbackContext, this.game) }, resume: function () { this._created && this.onResumedCallback && this.onResumedCallback.call(this.callbackContext, this.game) }, update: function () { this._created ? this.onUpdateCallback && this.onUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game) }, pauseUpdate: function () { this._created ? this.onPauseUpdateCallback && this.onPauseUpdateCallback.call(this.callbackContext, this.game) : this.onLoadUpdateCallback && this.onLoadUpdateCallback.call(this.callbackContext, this.game) }, preRender: function (t) { this._created && this.onPreRenderCallback && this.onPreRenderCallback.call(this.callbackContext, this.game, t) }, resize: function (t, e) { this.onResizeCallback && this.onResizeCallback.call(this.callbackContext, t, e) }, render: function () { this._created ? this.onRenderCallback && (this.game.renderType === s.CANVAS ? (this.game.context.save(), this.game.context.setTransform(1, 0, 0, 1, 0, 0), this.onRenderCallback.call(this.callbackContext, this.game), this.game.context.restore()) : this.onRenderCallback.call(this.callbackContext, this.game)) : this.onLoadRenderCallback && this.onLoadRenderCallback.call(this.callbackContext, this.game) }, destroy: function () { this._clearWorld = !0, this._clearCache = !0, this.clearCurrentState(), this.callbackContext = null, this.onInitCallback = null, this.onShutDownCallback = null, this.onPreloadCallback = null, this.onLoadRenderCallback = null, this.onLoadUpdateCallback = null, this.onCreateCallback = null, this.onUpdateCallback = null, this.onRenderCallback = null, this.onPausedCallback = null, this.onResumedCallback = null, this.onPauseUpdateCallback = null, this.game = null, this.states = {}, this._pendingState = null, this.current = "" } }, s.StateManager.prototype.constructor = s.StateManager, Object.defineProperty(s.StateManager.prototype, "created", { get: function () { return this._created } }), s.Signal = function () { }, s.Signal.prototype = { _bindings: null, _prevParams: null, memorize: !1, _shouldPropagate: !0, active: !0, _boundDispatch: !1, validateListener: function (t, e) { if ("function" != typeof t) throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}", e)) }, _registerListener: function (t, e, i, r, n) { var o, a = this._indexOfListener(t, i); if (-1 !== a) { if ((o = this._bindings[a]).isOnce() !== e) throw new Error("You cannot add" + (e ? "" : "Once") + "() then add" + (e ? "Once" : "") + "() the same listener without removing the relationship first.") } else o = new s.SignalBinding(this, t, e, i, r, n), this._addBinding(o); return this.memorize && this._prevParams && o.execute(this._prevParams), o }, _addBinding: function (t) { this._bindings || (this._bindings = []); var e = this._bindings.length; do { e-- } while (this._bindings[e] && t._priority <= this._bindings[e]._priority); this._bindings.splice(e + 1, 0, t) }, _indexOfListener: function (t, e) { if (!this._bindings) return -1; void 0 === e && (e = null); for (var i, r = this._bindings.length; r--;)if ((i = this._bindings[r])._listener === t && i.context === e) return r; return -1 }, has: function (t, e) { return -1 !== this._indexOfListener(t, e) }, add: function (t, e, i) { this.validateListener(t, "add"); var r = []; if (arguments.length > 3) for (var n = 3; n < arguments.length; n++)r.push(arguments[n]); return this._registerListener(t, !1, e, i, r) }, addOnce: function (t, e, i) { this.validateListener(t, "addOnce"); var r = []; if (arguments.length > 3) for (var n = 3; n < arguments.length; n++)r.push(arguments[n]); return this._registerListener(t, !0, e, i, r) }, remove: function (t, e) { this.validateListener(t, "remove"); var i = this._indexOfListener(t, e); return -1 !== i && (this._bindings[i]._destroy(), this._bindings.splice(i, 1)), t }, removeAll: function (t) { if (void 0 === t && (t = null), this._bindings) { for (var e = this._bindings.length; e--;)t ? this._bindings[e].context === t && (this._bindings[e]._destroy(), this._bindings.splice(e, 1)) : this._bindings[e]._destroy(); t || (this._bindings.length = 0) } }, getNumListeners: function () { return this._bindings ? this._bindings.length : 0 }, halt: function () { this._shouldPropagate = !1 }, dispatch: function () { if (this.active && this._bindings) { var t, e = Array.prototype.slice.call(arguments), i = this._bindings.length; if (this.memorize && (this._prevParams = e), i) { t = this._bindings.slice(), this._shouldPropagate = !0; do { i-- } while (t[i] && this._shouldPropagate && !1 !== t[i].execute(e)) } } }, forget: function () { this._prevParams && (this._prevParams = null) }, dispose: function () { this.removeAll(), this._bindings = null, this._prevParams && (this._prevParams = null) }, toString: function () { return "[Phaser.Signal active:" + this.active + " numListeners:" + this.getNumListeners() + "]" } }, Object.defineProperty(s.Signal.prototype, "boundDispatch", { get: function () { var t = this; return this._boundDispatch || (this._boundDispatch = function () { return t.dispatch.apply(t, arguments) }) } }), s.Signal.prototype.constructor = s.Signal, s.SignalBinding = function (t, e, i, r, n, s) { this._listener = e, i && (this._isOnce = !0), null != r && (this.context = r), this._signal = t, n && (this._priority = n), s && s.length && (this._args = s) }, s.SignalBinding.prototype = { context: null, _isOnce: !1, _priority: 0, _args: null, callCount: 0, active: !0, params: null, execute: function (t) { var e, i; return this.active && this._listener && (i = this.params ? this.params.concat(t) : t, this._args && (i = i.concat(this._args)), e = this._listener.apply(this.context, i), this.callCount++ , this._isOnce && this.detach()), e }, detach: function () { return this.isBound() ? this._signal.remove(this._listener, this.context) : null }, isBound: function () { return !!this._signal && !!this._listener }, isOnce: function () { return this._isOnce }, getListener: function () { return this._listener }, getSignal: function () { return this._signal }, _destroy: function () { delete this._signal, delete this._listener, delete this.context }, toString: function () { return "[Phaser.SignalBinding isOnce:" + this._isOnce + ", isBound:" + this.isBound() + ", active:" + this.active + "]" } }, s.SignalBinding.prototype.constructor = s.SignalBinding, s.Filter = function (t, e, i) { this.game = t, this.type = s.WEBGL_FILTER, this.passes = [this], this.shaders = [], this.dirty = !0, this.padding = 0, this.prevPoint = new s.Point; var r = new Date; if (this.uniforms = { resolution: { type: "2f", value: { x: 256, y: 256 } }, time: { type: "1f", value: 0 }, mouse: { type: "2f", value: { x: 0, y: 0 } }, date: { type: "4fv", value: [r.getFullYear(), r.getMonth(), r.getDate(), 60 * r.getHours() * 60 + 60 * r.getMinutes() + r.getSeconds()] }, sampleRate: { type: "1f", value: 44100 }, iChannel0: { type: "sampler2D", value: null, textureData: { repeat: !0 } }, iChannel1: { type: "sampler2D", value: null, textureData: { repeat: !0 } }, iChannel2: { type: "sampler2D", value: null, textureData: { repeat: !0 } }, iChannel3: { type: "sampler2D", value: null, textureData: { repeat: !0 } } }, e) for (var n in e) this.uniforms[n] = e[n]; "string" == typeof i && (i = i.split("\n")), this.fragmentSrc = i || [] }, s.Filter.prototype = { init: function () { }, setResolution: function (t, e) { this.uniforms.resolution.value.x = t, this.uniforms.resolution.value.y = e }, update: function (t) { if (t) { var e = t.x / this.game.width, i = 1 - t.y / this.game.height; e === this.prevPoint.x && i === this.prevPoint.y || (this.uniforms.mouse.value.x = e.toFixed(2), this.uniforms.mouse.value.y = i.toFixed(2), this.prevPoint.set(e, i)) } this.uniforms.time.value = this.game.time.totalElapsedSeconds() }, addToWorld: function (t, e, i, r, n, o) { void 0 === n && (n = 0), void 0 === o && (o = 0), void 0 !== i && null !== i ? this.width = i : i = this.width, void 0 !== r && null !== r ? this.height = r : r = this.height; var a = this.game.add.image(t, e, s.Cache.DEFAULT); return a.width = i, a.height = r, a.anchor.set(n, o), a.filters = [this], a }, syncUniforms: function () { for (var t = 0; t < this.shaders.length; t++)this.shaders[t].dirty = !0 }, destroy: function () { this.passes.length = 0, this.shaders.length = 0, this.fragmentSrc.length = 0, this.game = null, this.uniforms = null, this.prevPoint = null } }, s.Filter.prototype.constructor = s.Filter, Object.defineProperty(s.Filter.prototype, "width", { get: function () { return this.uniforms.resolution.value.x }, set: function (t) { this.uniforms.resolution.value.x = t } }), Object.defineProperty(s.Filter.prototype, "height", { get: function () { return this.uniforms.resolution.value.y }, set: function (t) { this.uniforms.resolution.value.y = t } }), s.Plugin = function (t, e) { void 0 === e && (e = null), this.game = t, this.parent = e, this.active = !1, this.visible = !1, this.hasPreUpdate = !1, this.hasUpdate = !1, this.hasPostUpdate = !1, this.hasRender = !1, this.hasPostRender = !1 }, s.Plugin.prototype = { preUpdate: function () { }, update: function () { }, render: function () { }, postRender: function () { }, destroy: function () { this.game = null, this.parent = null, this.active = !1, this.visible = !1 } }, s.Plugin.prototype.constructor = s.Plugin, s.PluginManager = function (t) { this.game = t, this.plugins = [], this._len = 0, this._i = 0 }, s.PluginManager.prototype = { add: function (t) { var e = Array.prototype.slice.call(arguments, 1), i = !1; return "function" == typeof t ? t = new t(this.game, this) : (t.game = this.game, t.parent = this), "function" == typeof t.preUpdate && (t.hasPreUpdate = !0, i = !0), "function" == typeof t.update && (t.hasUpdate = !0, i = !0), "function" == typeof t.postUpdate && (t.hasPostUpdate = !0, i = !0), "function" == typeof t.render && (t.hasRender = !0, i = !0), "function" == typeof t.postRender && (t.hasPostRender = !0, i = !0), i ? ((t.hasPreUpdate || t.hasUpdate || t.hasPostUpdate) && (t.active = !0), (t.hasRender || t.hasPostRender) && (t.visible = !0), this._len = this.plugins.push(t), "function" == typeof t.init && t.init.apply(t, e), t) : null }, remove: function (t, e) { for (void 0 === e && (e = !0), this._i = this._len; this._i--;)if (this.plugins[this._i] === t) return e && t.destroy(), this.plugins.splice(this._i, 1), void this._len-- }, removeAll: function () { for (this._i = this._len; this._i--;)this.plugins[this._i].destroy(); this.plugins.length = 0, this._len = 0 }, preUpdate: function () { for (this._i = this._len; this._i--;)this.plugins[this._i].active && this.plugins[this._i].hasPreUpdate && this.plugins[this._i].preUpdate() }, update: function () { for (this._i = this._len; this._i--;)this.plugins[this._i].active && this.plugins[this._i].hasUpdate && this.plugins[this._i].update() }, postUpdate: function () { for (this._i = this._len; this._i--;)this.plugins[this._i].active && this.plugins[this._i].hasPostUpdate && this.plugins[this._i].postUpdate() }, render: function () { for (this._i = this._len; this._i--;)this.plugins[this._i].visible && this.plugins[this._i].hasRender && this.plugins[this._i].render() }, postRender: function () { for (this._i = this._len; this._i--;)this.plugins[this._i].visible && this.plugins[this._i].hasPostRender && this.plugins[this._i].postRender() }, destroy: function () { this.removeAll(), this.game = null } }, s.PluginManager.prototype.constructor = s.PluginManager, s.Stage = function (t) { this.game = t, PIXI.DisplayObjectContainer.call(this), this.name = "_stage_root", this.disableVisibilityChange = !1, this.exists = !0, this.worldTransform = new s.Matrix, this.stage = this, this.currentRenderOrderID = 0, this._hiddenVar = "hidden", this._onChange = null, this._bgColor = { r: 0, g: 0, b: 0, a: 0, color: 0, rgba: "#000000" }, this.game.transparent || (this._bgColor.a = 1), t.config && this.parseConfig(t.config) }, s.Stage.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), s.Stage.prototype.constructor = s.Stage, s.Stage.prototype.parseConfig = function (t) { t.disableVisibilityChange && (this.disableVisibilityChange = t.disableVisibilityChange), t.backgroundColor && this.setBackgroundColor(t.backgroundColor) }, s.Stage.prototype.boot = function () { s.DOM.getOffset(this.game.canvas, this.offset), s.Canvas.setUserSelect(this.game.canvas, "none"), s.Canvas.setTouchAction(this.game.canvas, "none"), this.checkVisibility() }, s.Stage.prototype.preUpdate = function () { this.currentRenderOrderID = 0; for (var t = 0; t < this.children.length;) { var e = this.children[t]; e.preUpdate(), this === e.parent && t++ } }, s.Stage.prototype.update = function () { for (var t = this.children.length; t--;)this.children[t].update() }, s.Stage.prototype.postUpdate = function () { this.game.camera.update(), this.game.camera.target && (this.game.camera.target.postUpdate(), this.updateTransform(), this.game.camera.updateTarget()); for (var t = 0; t < this.children.length; t++)this.children[t].postUpdate(); this.updateTransform() }, s.Stage.prototype.updateTransform = function () { this.worldAlpha = 1; for (var t = 0; t < this.children.length; t++)this.children[t].updateTransform() }, s.Stage.prototype.checkVisibility = function () { void 0 !== document.hidden ? this._hiddenVar = "visibilitychange" : void 0 !== document.webkitHidden ? this._hiddenVar = "webkitvisibilitychange" : void 0 !== document.mozHidden ? this._hiddenVar = "mozvisibilitychange" : void 0 !== document.msHidden ? this._hiddenVar = "msvisibilitychange" : this._hiddenVar = null; var t = this; this._onChange = function (e) { return t.visibilityChange(e) }, this._onClick = function (e) { void 0 === document.hasFocus || document.hasFocus() || t.visibilityChange(e) }, this._hiddenVar && document.addEventListener(this._hiddenVar, this._onChange, !1), window.onblur = this._onChange, window.onfocus = this._onChange, window.onpagehide = this._onChange, window.onpageshow = this._onChange, window.addEventListener("click", this._onClick), this.game.device.cocoonJSApp && (CocoonJS.App.onSuspended.addEventListener(function () { s.Stage.prototype.visibilityChange.call(t, { type: "pause" }) }), CocoonJS.App.onActivated.addEventListener(function () { s.Stage.prototype.visibilityChange.call(t, { type: "resume" }) })) }, s.Stage.prototype.visibilityChange = function (t) { switch (t.type) { case "blur": case "pagehide": return void this.game.focusLoss(t); case "click": case "focus": case "pageshow": return void this.game.focusGain(t) }this.disableVisibilityChange || (document.hidden || document.mozHidden || document.msHidden || document.webkitHidden || "pause" === t.type ? this.game.gamePaused(t) : this.game.gameResumed(t)) }, s.Stage.prototype.setBackgroundColor = function (t) { this.game.transparent || (s.Color.valueToColor(t, this._bgColor), s.Color.updateColor(this._bgColor), this._bgColor.r /= 255, this._bgColor.g /= 255, this._bgColor.b /= 255, this._bgColor.a = 1) }, s.Stage.prototype.destroy = function () { this._hiddenVar && document.removeEventListener(this._hiddenVar, this._onChange, !1), window.onpagehide = null, window.onpageshow = null, window.onblur = null, window.onfocus = null, window.removeEventListener("click", this._onClick) }, s.Stage.prototype.add = function (t, e, i) { return t.parent === this ? t : (t.body && t.parent && t.parent.hash && t.parent.removeFromHash(t), void 0 === i ? this.addChild(t) : this.addChildAt(t, i), t) }, Object.defineProperty(s.Stage.prototype, "backgroundColor", { get: function () { return this._bgColor.color }, set: function (t) { this.setBackgroundColor(t) } }), Object.defineProperty(s.Stage.prototype, "smoothed", { get: function () { return PIXI.scaleModes.DEFAULT === PIXI.scaleModes.LINEAR }, set: function (t) { PIXI.scaleModes.DEFAULT = t ? PIXI.scaleModes.LINEAR : PIXI.scaleModes.NEAREST } }), s.Group = function (t, e, i, r, n, o) { void 0 === r && (r = !1), void 0 === n && (n = !1), void 0 === o && (o = s.Physics.ARCADE), this.game = t, void 0 === e && (e = t.world), this.name = i || "group", this.z = 0, PIXI.DisplayObjectContainer.call(this), r ? (this.game.stage.addChild(this), this.z = this.game.stage.children.length) : e && (e.addChild(this), this.z = e.children.length), this.type = s.GROUP, this.physicsType = s.GROUP, this.alive = !0, this.exists = !0, this.ignoreDestroy = !1, this.pendingDestroy = !1, this.classType = s.Sprite, this.cursor = null, this.inputEnableChildren = !1, this.updateOnlyExistingChildren = !1, this.onChildInputDown = new s.Signal, this.onChildInputUp = new s.Signal, this.onChildInputOver = new s.Signal, this.onChildInputOut = new s.Signal, this.enableBody = n, this.enableBodyDebug = !1, this.physicsBodyType = o, this.physicsSortDirection = null, this.onDestroy = new s.Signal, this.cursorIndex = 0, this.fixedToCamera = !1, this.cameraOffset = new s.Point, this.hash = [], this._sortProperty = "z" }, s.Group.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), s.Group.prototype.constructor = s.Group, s.Group.RETURN_NONE = 0, s.Group.RETURN_TOTAL = 1, s.Group.RETURN_CHILD = 2, s.Group.RETURN_ALL = 3, s.Group.SORT_ASCENDING = -1, s.Group.SORT_DESCENDING = 1, s.Group.prototype.add = function (t, e, i) { return void 0 === e && (e = !1), t.parent === this ? t : (t.body && t.parent && t.parent.hash && t.parent.removeFromHash(t), void 0 === i ? (t.z = this.children.length, this.addChild(t)) : (this.addChildAt(t, i), this.updateZ()), this.enableBody && t.hasOwnProperty("body") && null === t.body ? this.game.physics.enable(t, this.physicsBodyType) : t.body && this.addToHash(t), !this.inputEnableChildren || t.input && !t.inputEnabled || (t.inputEnabled = !0), !e && t.events && t.events.onAddedToGroup$dispatch(t, this), null === this.cursor && (this.cursor = t), t) }, s.Group.prototype.addAt = function (t, e, i) { return this.add(t, i, e) }, s.Group.prototype.addToHash = function (t) { if (t.parent === this && -1 === this.hash.indexOf(t)) return this.hash.push(t), !0; return !1 }, s.Group.prototype.removeFromHash = function (t) { if (t) { var e = this.hash.indexOf(t); if (-1 !== e) return this.hash.splice(e, 1), !0 } return !1 }, s.Group.prototype.addMultiple = function (t, e) { if (t instanceof s.Group) t.moveAll(this, e); else if (Array.isArray(t)) for (var i = 0; i < t.length; i++)this.add(t[i], e); return t }, s.Group.prototype.getAt = function (t) { return t < 0 || t >= this.children.length ? -1 : this.getChildAt(t) }, s.Group.prototype.create = function (t, e, i, r, n, s) { void 0 === n && (n = !0); var o = new this.classType(this.game, t, e, i, r); return o.exists = n, o.visible = n, o.alive = n, this.add(o, !1, s) }, s.Group.prototype.createMultiple = function (t, e, i, r, n, s) { void 0 === i && (i = 0), void 0 === r && (r = !1), Array.isArray(e) || (e = [e]), Array.isArray(i) || (i = [i]); var o = this, a = []; return e.forEach(function (e) { i.forEach(function (i) { for (var h = 0; h < t; h++) { var u = o.create(0, 0, e, i, r); n && n.call(s || u, u, h), a.push(u) } }) }), a }, s.Group.prototype.updateZ = function () { for (var t = this.children.length; t--;)this.children[t].z = t }, s.Group.prototype.align = function (t, e, i, r, n, o) { if (void 0 === n && (n = s.TOP_LEFT), void 0 === o && (o = 0), 0 === this.children.length || o > this.children.length || -1 === t && -1 === e) return !1; for (var a = new s.Rectangle(0, 0, i, r), h = t * i, u = e * r, l = o; l < this.children.length; l++) { var c = this.children[l]; if (c.alignIn) if (c.alignIn(a, n), -1 === t) a.y += r, a.y === u && (a.x += i, a.y = 0); else if (-1 === e) a.x += i, a.x === h && (a.x = 0, a.y += r); else if (a.x += i, a.x === h && (a.x = 0, a.y += r, a.y === u)) return !0 } return !0 }, s.Group.prototype.resetCursor = function (t) { if (void 0 === t && (t = 0), t > this.children.length - 1 && (t = 0), this.cursor) return this.cursorIndex = t, this.cursor = this.children[this.cursorIndex], this.cursor }, s.Group.prototype.next = function () { if (this.cursor) return this.cursorIndex >= this.children.length - 1 ? this.cursorIndex = 0 : this.cursorIndex++ , this.cursor = this.children[this.cursorIndex], this.cursor }, s.Group.prototype.previous = function () { if (this.cursor) return 0 === this.cursorIndex ? this.cursorIndex = this.children.length - 1 : this.cursorIndex-- , this.cursor = this.children[this.cursorIndex], this.cursor }, s.Group.prototype.swap = function (t, e) { this.swapChildren(t, e), this.updateZ() }, s.Group.prototype.bringToTop = function (t) { return t.parent === this && this.getIndex(t) < this.children.length && (this.remove(t, !1, !0), this.add(t, !0)), t }, s.Group.prototype.sendToBack = function (t) { return t.parent === this && this.getIndex(t) > 0 && (this.remove(t, !1, !0), this.addAt(t, 0, !0)), t }, s.Group.prototype.moveUp = function (t) { if (t.parent === this && this.getIndex(t) < this.children.length - 1) { var e = this.getIndex(t), i = this.getAt(e + 1); i && this.swap(t, i) } return t }, s.Group.prototype.moveDown = function (t) { if (t.parent === this && this.getIndex(t) > 0) { var e = this.getIndex(t), i = this.getAt(e - 1); i && this.swap(t, i) } return t }, s.Group.prototype.xy = function (t, e, i) { if (t < 0 || t > this.children.length) return -1; this.getChildAt(t).x = e, this.getChildAt(t).y = i }, s.Group.prototype.reverse = function () { this.children.reverse(), this.updateZ() }, s.Group.prototype.getIndex = function (t) { return this.children.indexOf(t) }, s.Group.prototype.getByName = function (t) { for (var e = 0; e < this.children.length; e++)if (this.children[e].name === t) return this.children[e]; return null }, s.Group.prototype.replace = function (t, e) { var i = this.getIndex(t); if (-1 !== i) return e.parent && (e.parent instanceof s.Group ? e.parent.remove(e) : e.parent.removeChild(e)), this.remove(t), this.addAt(e, i), t }, s.Group.prototype.hasProperty = function (t, e) { var i = e.length; return 1 === i && e[0] in t || (2 === i && e[0] in t && e[1] in t[e[0]] || (3 === i && e[0] in t && e[1] in t[e[0]] && e[2] in t[e[0]][e[1]] || 4 === i && e[0] in t && e[1] in t[e[0]] && e[2] in t[e[0]][e[1]] && e[3] in t[e[0]][e[1]][e[2]])) }, s.Group.prototype.setProperty = function (t, e, i, r, n) { if (void 0 === n && (n = !1), r = r || 0, !this.hasProperty(t, e) && (!n || r > 0)) return !1; var s = e.length; return 1 === s ? 0 === r ? t[e[0]] = i : 1 === r ? t[e[0]] += i : 2 === r ? t[e[0]] -= i : 3 === r ? t[e[0]] *= i : 4 === r && (t[e[0]] /= i) : 2 === s ? 0 === r ? t[e[0]][e[1]] = i : 1 === r ? t[e[0]][e[1]] += i : 2 === r ? t[e[0]][e[1]] -= i : 3 === r ? t[e[0]][e[1]] *= i : 4 === r && (t[e[0]][e[1]] /= i) : 3 === s ? 0 === r ? t[e[0]][e[1]][e[2]] = i : 1 === r ? t[e[0]][e[1]][e[2]] += i : 2 === r ? t[e[0]][e[1]][e[2]] -= i : 3 === r ? t[e[0]][e[1]][e[2]] *= i : 4 === r && (t[e[0]][e[1]][e[2]] /= i) : 4 === s && (0 === r ? t[e[0]][e[1]][e[2]][e[3]] = i : 1 === r ? t[e[0]][e[1]][e[2]][e[3]] += i : 2 === r ? t[e[0]][e[1]][e[2]][e[3]] -= i : 3 === r ? t[e[0]][e[1]][e[2]][e[3]] *= i : 4 === r && (t[e[0]][e[1]][e[2]][e[3]] /= i)), !0 }, s.Group.prototype.checkProperty = function (t, e, i, r) { if (void 0 === r && (r = !1), this !== t.parent) return !1; var n = s.Utils.getProperty(t, e); return !(void 0 === n && r || n !== i) }, s.Group.prototype.set = function (t, e, i, r, n, s, o) { if (void 0 === o && (o = !1), e = e.split("."), void 0 === r && (r = !1), void 0 === n && (n = !1), (!1 === r || r && t.alive) && (!1 === n || n && t.visible)) return this.setProperty(t, e, i, s, o) }, s.Group.prototype.setAll = function (t, e, i, r, n, s) { void 0 === i && (i = !1), void 0 === r && (r = !1), void 0 === s && (s = !1), t = t.split("."), n = n || 0; for (var o = 0; o < this.children.length; o++)(!i || i && this.children[o].alive) && (!r || r && this.children[o].visible) && this.setProperty(this.children[o], t, e, n, s) }, s.Group.prototype.setAllChildren = function (t, e, i, r, n, o) { void 0 === i && (i = !1), void 0 === r && (r = !1), void 0 === o && (o = !1), n = n || 0; for (var a = 0; a < this.children.length; a++)(!i || i && this.children[a].alive) && (!r || r && this.children[a].visible) && (this.children[a] instanceof s.Group ? this.children[a].setAllChildren(t, e, i, r, n, o) : this.setProperty(this.children[a], t.split("."), e, n, o)) }, s.Group.prototype.checkAll = function (t, e, i, r, n) { void 0 === i && (i = !1), void 0 === r && (r = !1), void 0 === n && (n = !1); for (var s = 0; s < this.children.length; s++) { var o = this.children[s]; if ((!i || i && o.alive) && (!r || r && o.visible) && !this.checkProperty(o, t, e, n)) return !1 } return !0 }, s.Group.prototype.checkAny = function (t, e, i, r) { void 0 === i && (i = !1), void 0 === r && (r = !1); for (var n = 0; n < this.children.length; n++) { var s = this.children[n]; if ((!i || i && s.alive) && (!r || r && s.visible) && this.checkProperty(s, t, e)) return !0 } return !1 }, s.Group.prototype.addAll = function (t, e, i, r) { this.setAll(t, e, i, r, 1) }, s.Group.prototype.subAll = function (t, e, i, r) { this.setAll(t, e, i, r, 2) }, s.Group.prototype.multiplyAll = function (t, e, i, r) { this.setAll(t, e, i, r, 3) }, s.Group.prototype.divideAll = function (t, e, i, r) { this.setAll(t, e, i, r, 4) }, s.Group.prototype.kill = function () { this.alive = !1, this.exists = !1, this.visible = !1 }, s.Group.prototype.killAll = function () { this.callAllExists("kill", !0) }, s.Group.prototype.revive = function () { this.alive = !0, this.exists = !0, this.visible = !0 }, s.Group.prototype.reviveAll = function () { this.callAllExists("revive", !1) }, s.Group.prototype.resetAll = function (t, e, i, r, n) { this.forEach(this.resetChild, this, n, t, e, i, r) }, s.Group.prototype.callAllExists = function (t, e) { var i; if (arguments.length > 2) { i = []; for (var r = 2; r < arguments.length; r++)i.push(arguments[r]) } for (r = 0; r < this.children.length; r++)this.children[r].exists === e && this.children[r][t] && this.children[r][t].apply(this.children[r], i) }, s.Group.prototype.callbackFromArray = function (t, e, i) { if (1 === i) { if (t[e[0]]) return t[e[0]] } else if (2 === i) { if (t[e[0]][e[1]]) return t[e[0]][e[1]] } else if (3 === i) { if (t[e[0]][e[1]][e[2]]) return t[e[0]][e[1]][e[2]] } else if (4 === i) { if (t[e[0]][e[1]][e[2]][e[3]]) return t[e[0]][e[1]][e[2]][e[3]] } else if (t[e]) return t[e]; return !1 }, s.Group.prototype.callAll = function (t, e) { if (void 0 !== t) { var i, r = (t = t.split(".")).length; if (void 0 === e || null === e || "" === e) e = null; else if ("string" == typeof e) var n = (e = e.split(".")).length; if (arguments.length > 2) { i = []; for (var s = 2; s < arguments.length; s++)i.push(arguments[s]) } var o = null, a = null; for (s = 0; s < this.children.length; s++)o = this.callbackFromArray(this.children[s], t, r), e && o ? (a = this.callbackFromArray(this.children[s], e, n), o && o.apply(a, i)) : o && o.apply(this.children[s], i) } }, s.Group.prototype.preUpdate = function () { if (this.pendingDestroy) return this.destroy(), !1; if (!this.exists || !this.parent.exists) return this.renderOrderID = -1, !1; for (var t = 0; t < this.children.length;) { var e = this.children[t]; e.preUpdate(), this === e.parent && t++ } return !0 }, s.Group.prototype.update = function () { for (var t = this.children.length; t--;) { var e = this.children.length; t >= e && (t = e - 1); var i = this.children[t]; this.updateOnlyExistingChildren && !i.exists || i.update() } }, s.Group.prototype.postUpdate = function () { this.fixedToCamera && (this.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y); for (var t = 0; t < this.children.length; t++)this.children[t].postUpdate() }, s.Group.prototype.filter = function (t, e) { for (var i = -1, r = this.children.length, n = []; ++i < r;) { var o = this.children[i]; (!e || e && o.exists) && t(o, i, this.children) && n.push(o) } return new s.ArraySet(n) }, s.Group.prototype.forEach = function (t, e, i) { if (void 0 === i && (i = !1), arguments.length <= 3) for (var r = 0; r < this.children.length; r++)(!i || i && this.children[r].exists) && t.call(e, this.children[r]); else { var n = [null]; for (r = 3; r < arguments.length; r++)n.push(arguments[r]); for (r = 0; r < this.children.length; r++)(!i || i && this.children[r].exists) && (n[0] = this.children[r], t.apply(e, n)) } }, s.Group.prototype.forEachExists = function (t, e) { var i; if (arguments.length > 2) { i = [null]; for (var r = 2; r < arguments.length; r++)i.push(arguments[r]) } this.iterate("exists", !0, s.Group.RETURN_TOTAL, t, e, i) }, s.Group.prototype.forEachAlive = function (t, e) { var i; if (arguments.length > 2) { i = [null]; for (var r = 2; r < arguments.length; r++)i.push(arguments[r]) } this.iterate("alive", !0, s.Group.RETURN_TOTAL, t, e, i) }, s.Group.prototype.forEachDead = function (t, e) { var i; if (arguments.length > 2) { i = [null]; for (var r = 2; r < arguments.length; r++)i.push(arguments[r]) } this.iterate("alive", !1, s.Group.RETURN_TOTAL, t, e, i) }, s.Group.prototype.sort = function (t, e) { this.children.length < 2 || (void 0 === t && (t = "z"), void 0 === e && (e = s.Group.SORT_ASCENDING), this._sortProperty = t, e === s.Group.SORT_ASCENDING ? this.children.sort(this.ascendingSortHandler.bind(this)) : this.children.sort(this.descendingSortHandler.bind(this)), this.updateZ()) }, s.Group.prototype.customSort = function (t, e) { this.children.length < 2 || (this.children.sort(t.bind(e)), this.updateZ()) }, s.Group.prototype.ascendingSortHandler = function (t, e) { return t[this._sortProperty] < e[this._sortProperty] ? -1 : t[this._sortProperty] > e[this._sortProperty] ? 1 : t.z < e.z ? -1 : 1 }, s.Group.prototype.descendingSortHandler = function (t, e) { return t[this._sortProperty] < e[this._sortProperty] ? 1 : t[this._sortProperty] > e[this._sortProperty] ? -1 : 0 }, s.Group.prototype.iterate = function (t, e, i, r, n, o) { if (0 === this.children.length) { if (i === s.Group.RETURN_TOTAL) return 0; if (i === s.Group.RETURN_ALL) return [] } var a = 0; if (i === s.Group.RETURN_ALL) var h = []; for (var u = 0; u < this.children.length; u++)if (this.children[u][t] === e) { if (a++ , r && (o ? (o[0] = this.children[u], r.apply(n, o)) : r.call(n, this.children[u])), i === s.Group.RETURN_CHILD) return this.children[u]; i === s.Group.RETURN_ALL && h.push(this.children[u]) } return i === s.Group.RETURN_TOTAL ? a : i === s.Group.RETURN_ALL ? h : null }, s.Group.prototype.getFirst = function (t, e) { return this.iterate(t, e, s.Group.RETURN_CHILD) }, s.Group.prototype.getFirstExists = function (t, e, i, r, n, s) { void 0 === e && (e = !1), "boolean" != typeof t && (t = !0); var o = this.getFirst("exists", t); return null === o && e ? this.create(i, r, n, s) : this.resetChild(o, i, r, n, s) }, s.Group.prototype.getFirstAlive = function (t, e, i, r, n) { void 0 === t && (t = !1); var s = this.getFirst("alive", !0); return null === s && t ? this.create(e, i, r, n) : this.resetChild(s, e, i, r, n) }, s.Group.prototype.getFirstDead = function (t, e, i, r, n) { void 0 === t && (t = !1); var s = this.getFirst("alive", !1); return null === s && t ? this.create(e, i, r, n) : this.resetChild(s, e, i, r, n) }, s.Group.prototype.resetChild = function (t, e, i, r, n) { return null === t ? null : (void 0 === e && (e = null), void 0 === i && (i = null), null !== e && null !== i && t.reset(e, i), void 0 !== r && t.loadTexture(r, n), t) }, s.Group.prototype.getTop = function () { if (this.children.length > 0) return this.children[this.children.length - 1] }, s.Group.prototype.getBottom = function () { if (this.children.length > 0) return this.children[0] }, s.Group.prototype.getClosestTo = function (t, e, i) { for (var r = Number.MAX_VALUE, n = 0, o = null, a = 0; a < this.children.length; a++) { var h = this.children[a]; h.exists && (n = Math.abs(s.Point.distance(t, h))) < r && (!e || e.call(i, h, n)) && (r = n, o = h) } return o }, s.Group.prototype.getFurthestFrom = function (t, e, i) { for (var r = 0, n = 0, o = null, a = 0; a < this.children.length; a++) { var h = this.children[a]; h.exists && (n = Math.abs(s.Point.distance(t, h))) > r && (!e || e.call(i, h, n)) && (r = n, o = h) } return o }, s.Group.prototype.count = function (t, e) { return this.iterate(t, e, s.Group.RETURN_TOTAL) }, s.Group.prototype.countLiving = function () { return this.count("alive", !0) }, s.Group.prototype.countDead = function () { return this.count("alive", !1) }, s.Group.prototype.getRandom = function (t, e) { return void 0 === t && (t = 0), void 0 === e && (e = this.children.length), 0 === e ? null : s.ArrayUtils.getRandomItem(this.children, t, e) }, s.Group.prototype.getRandomExists = function (t, e) { var i = this.getAll("exists", !0, t, e); return this.game.rnd.pick(i) }, s.Group.prototype.getAll = function (t, e, i, r) { void 0 === i && (i = 0), void 0 === r && (r = this.children.length); for (var n = [], s = i; s < r; s++) { var o = this.children[s]; t ? o[t] === e && n.push(o) : n.push(o) } return n }, s.Group.prototype.remove = function (t, e, i) { if (void 0 === e && (e = !1), void 0 === i && (i = !1), 0 === this.children.length || -1 === this.children.indexOf(t)) return !1; i || !t.events || t.destroyPhase || t.events.onRemovedFromGroup$dispatch(t, this); var r = this.removeChild(t); return this.removeFromHash(t), this.updateZ(), this.cursor === t && this.next(), e && r && r.destroy(!0), !0 }, s.Group.prototype.moveAll = function (t, e) { if (void 0 === e && (e = !1), this.children.length > 0 && t instanceof s.Group) { do { t.add(this.children[0], e) } while (this.children.length > 0); this.hash = [], this.cursor = null } return t }, s.Group.prototype.removeAll = function (t, e, i) { if (void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = !1), 0 !== this.children.length) { do { !e && this.children[0].events && this.children[0].events.onRemovedFromGroup$dispatch(this.children[0], this); var r = this.removeChild(this.children[0]); this.removeFromHash(r), t && r && r.destroy(!0, i) } while (this.children.length > 0); this.hash = [], this.cursor = null } }, s.Group.prototype.removeBetween = function (t, e, i, r) { if (void 0 === e && (e = this.children.length - 1), void 0 === i && (i = !1), void 0 === r && (r = !1), 0 !== this.children.length) { if (t > e || t < 0 || e > this.children.length) return !1; for (var n = e; n >= t;) { !r && this.children[n].events && this.children[n].events.onRemovedFromGroup$dispatch(this.children[n], this); var s = this.removeChild(this.children[n]); this.removeFromHash(s), i && s && s.destroy(!0), this.cursor === this.children[n] && (this.cursor = null), n-- } this.updateZ() } }, s.Group.prototype.scatter = function (t, e) { null == t && (t = this.game.world.bounds), this.forEach(function (e) { e.position.set(t.randomX, t.randomY) }, null, e) }, s.Group.prototype.shuffle = function () { s.ArrayUtils.shuffle(this.children), this.updateZ() }, s.Group.prototype.destroy = function (t, e) { null === this.game || this.ignoreDestroy || (void 0 === t && (t = !0), void 0 === e && (e = !1), this.onDestroy.dispatch(this, t, e), this.removeAll(t), this.cursor = null, this.filters = null, this.pendingDestroy = !1, e || (this.parent && this.parent.removeChild(this), this.game = null, this.exists = !1)) }, Object.defineProperty(s.Group.prototype, "total", { get: function () { return this.iterate("exists", !0, s.Group.RETURN_TOTAL) } }), Object.defineProperty(s.Group.prototype, "length", { get: function () { return this.children.length } }), Object.defineProperty(s.Group.prototype, "angle", { get: function () { return s.Math.radToDeg(this.rotation) }, set: function (t) { this.rotation = s.Math.degToRad(t) } }), Object.defineProperty(s.Group.prototype, "centerX", { get: function () { return this.getBounds(this.parent).centerX }, set: function (t) { var e = this.getBounds(this.parent), i = this.x - e.x; this.x = t + i - e.halfWidth } }), Object.defineProperty(s.Group.prototype, "centerY", { get: function () { return this.getBounds(this.parent).centerY }, set: function (t) { var e = this.getBounds(this.parent), i = this.y - e.y; this.y = t + i - e.halfHeight } }), Object.defineProperty(s.Group.prototype, "left", { get: function () { return this.getBounds(this.parent).left }, set: function (t) { var e = this.getBounds(this.parent), i = this.x - e.x; this.x = t + i } }), Object.defineProperty(s.Group.prototype, "right", { get: function () { return this.getBounds(this.parent).right }, set: function (t) { var e = this.getBounds(this.parent), i = this.x - e.x; this.x = t + i - e.width } }), Object.defineProperty(s.Group.prototype, "top", { get: function () { return this.getBounds(this.parent).top }, set: function (t) { var e = this.getBounds(this.parent), i = this.y - e.y; this.y = t + i } }), Object.defineProperty(s.Group.prototype, "bottom", { get: function () { return this.getBounds(this.parent).bottom }, set: function (t) { var e = this.getBounds(this.parent), i = this.y - e.y; this.y = t + i - e.height } }), s.World = function (t) { s.Group.call(this, t, null, "__world", !1), this.bounds = new s.Rectangle(0, 0, t.width, t.height), this.camera = null, this._definedSize = !1, this._width = t.width, this._height = t.height, this.game.state.onStateChange.add(this.stateChange, this) }, s.World.prototype = Object.create(s.Group.prototype), s.World.prototype.constructor = s.World, s.World.prototype.boot = function () { this.camera = new s.Camera(this.game, 0, 0, 0, this.game.width, this.game.height), this.game.stage.addChild(this), this.camera.boot() }, s.World.prototype.stateChange = function () { this.x = 0, this.y = 0, this.camera.reset() }, s.World.prototype.setBounds = function (t, e, i, r) { this._definedSize = !0, this._width = i, this._height = r, this.bounds.setTo(t, e, i, r), this.x = t, this.y = e, this.camera.bounds && this.camera.bounds.setTo(t, e, Math.max(i, this.game.width), Math.max(r, this.game.height)), this.game.physics.setBoundsToWorld() }, s.World.prototype.resize = function (t, e) { this._definedSize && (t < this._width && (t = this._width), e < this._height && (e = this._height)), this.bounds.width = t, this.bounds.height = e, this.game.camera.setBoundsToWorld(), this.game.physics.setBoundsToWorld() }, s.World.prototype.shutdown = function () { this.destroy(!0, !0) }, s.World.prototype.wrap = function (t, e, i, r, n) { void 0 === e && (e = 0), void 0 === i && (i = !1), void 0 === r && (r = !0), void 0 === n && (n = !0), i ? (t.getBounds(), r && (t.x + t._currentBounds.width < this.bounds.x ? t.x = this.bounds.right : t.x > this.bounds.right && (t.x = this.bounds.left)), n && (t.y + t._currentBounds.height < this.bounds.top ? t.y = this.bounds.bottom : t.y > this.bounds.bottom && (t.y = this.bounds.top))) : (r && t.x + e < this.bounds.x ? t.x = this.bounds.right + e : r && t.x - e > this.bounds.right && (t.x = this.bounds.left - e), n && t.y + e < this.bounds.top ? t.y = this.bounds.bottom + e : n && t.y - e > this.bounds.bottom && (t.y = this.bounds.top - e)) }, s.World.prototype.wrapAll = function (t, e, i, r, n, s) { t.forEach(this.wrap, this, e, i, r, n, s) }, Object.defineProperty(s.World.prototype, "width", { get: function () { return this.bounds.width }, set: function (t) { t < this.game.width && (t = this.game.width), this.bounds.width = t, this._width = t, this._definedSize = !0 } }), Object.defineProperty(s.World.prototype, "height", { get: function () { return this.bounds.height }, set: function (t) { t < this.game.height && (t = this.game.height), this.bounds.height = t, this._height = t, this._definedSize = !0 } }), Object.defineProperty(s.World.prototype, "centerX", { get: function () { return this.bounds.halfWidth + this.bounds.x } }), Object.defineProperty(s.World.prototype, "centerY", { get: function () { return this.bounds.halfHeight + this.bounds.y } }), Object.defineProperty(s.World.prototype, "randomX", { get: function () { return this.bounds.x < 0 ? this.game.rnd.between(this.bounds.x, this.bounds.width - Math.abs(this.bounds.x)) : this.game.rnd.between(this.bounds.x, this.bounds.width) } }), Object.defineProperty(s.World.prototype, "randomY", { get: function () { return this.bounds.y < 0 ? this.game.rnd.between(this.bounds.y, this.bounds.height - Math.abs(this.bounds.y)) : this.game.rnd.between(this.bounds.y, this.bounds.height) } }), s.Game = function (t, e, i, n, o, a, h, u) { return this.id = s.GAMES.push(this) - 1, this.config = null, this.physicsConfig = u, this.parent = "", this.width = 800, this.height = 600, this.resolution = 1, this._width = 800, this._height = 600, this.transparent = !1, this.antialias = !0, this.multiTexture = !1, this.preserveDrawingBuffer = !1, this.clearBeforeRender = !0, this.renderer = null, this.renderType = s.AUTO, this.state = null, this.isBooted = !1, this.isRunning = !1, this.raf = null, this.add = null, this.make = null, this.cache = null, this.input = null, this.load = null, this.math = null, this.net = null, this.scale = null, this.sound = null, this.stage = null, this.time = null, this.tweens = null, this.world = null, this.physics = null, this.plugins = null, this.rnd = null, this.device = s.Device, this.camera = null, this.canvas = null, this.context = null, this.debug = null, this.particles = null, this.create = null, this.lockRender = !1, this.pendingDestroy = !1, this.stepping = !1, this.pendingStep = !1, this.stepCount = 0, this.onPause = null, this.onResume = null, this.onBlur = null, this.onFocus = null, this._paused = !1, this._codePaused = !1, this.currentUpdateID = 0, this.updatesThisFrame = 1, this.rendersThisFrame = 1, this._deltaTime = 0, this._lastCount = 0, this._spiraling = 0, this._kickstart = !0, this.fpsProblemNotifier = new s.Signal, this.forceSingleUpdate = !0, this.forceSingleRender = !0, this.dropFrames = !1, this._nextFpsNotification = 0, 1 === arguments.length && "object" === r(arguments[0]) ? this.parseConfig(arguments[0]) : (this.config = { enableDebug: !0 }, void 0 !== t && (this._width = t), void 0 !== e && (this._height = e), void 0 !== i && (this.renderType = i), void 0 !== n && (this.parent = n), void 0 !== a && (this.transparent = a), void 0 !== h && (this.antialias = h), this.rnd = new s.RandomDataGenerator([(Date.now() * Math.random()).toString()]), this.state = new s.StateManager(this, o)), this.device.whenReady(this.boot, this), this }, s.Game.prototype = { parseConfig: function (t) { this.config = t, void 0 === t.enableDebug && (this.config.enableDebug = !0), t.width && (this._width = t.width), t.height && (this._height = t.height), t.renderer && (this.renderType = t.renderer), t.parent && (this.parent = t.parent), void 0 !== t.transparent && (this.transparent = t.transparent), void 0 !== t.antialias && (this.antialias = t.antialias), void 0 !== t.multiTexture && (this.multiTexture = t.multiTexture), t.resolution && (this.resolution = t.resolution), void 0 !== t.preserveDrawingBuffer && (this.preserveDrawingBuffer = t.preserveDrawingBuffer), t.physicsConfig && (this.physicsConfig = t.physicsConfig); var e = [(Date.now() * Math.random()).toString()]; t.seed && (e = t.seed), this.rnd = new s.RandomDataGenerator(e); var i = null; t.state && (i = t.state), this.state = new s.StateManager(this, i) }, boot: function () { this.isBooted || (this.onPause = new s.Signal, this.onResume = new s.Signal, this.onBlur = new s.Signal, this.onFocus = new s.Signal, this.isBooted = !0, PIXI.game = this, this.math = s.Math, this.scale = new s.ScaleManager(this, this._width, this._height), this.stage = new s.Stage(this), this.setUpRenderer(), this.world = new s.World(this), this.add = new s.GameObjectFactory(this), this.make = new s.GameObjectCreator(this), this.cache = new s.Cache(this), this.load = new s.Loader(this), this.time = new s.Time(this), this.tweens = new s.TweenManager(this), this.input = new s.Input(this), this.sound = new s.SoundManager(this), this.physics = new s.Physics(this, this.physicsConfig), this.particles = new s.Particles(this), this.create = new s.Create(this), this.plugins = new s.PluginManager(this), this.net = new s.Net(this), this.time.boot(), this.stage.boot(), this.world.boot(), this.scale.boot(), this.input.boot(), this.sound.boot(), this.state.boot(), this.config.enableDebug ? (this.debug = new s.Utils.Debug(this), this.debug.boot()) : this.debug = { preUpdate: function () { }, update: function () { }, reset: function () { }, isDisabled: !0 }, this.showDebugHeader(), this.isRunning = !0, this.config && this.config.forceSetTimeOut ? this.raf = new s.RequestAnimationFrame(this, this.config.forceSetTimeOut) : this.raf = new s.RequestAnimationFrame(this, !1), this._kickstart = !0, window.focus && (!window.PhaserGlobal || window.PhaserGlobal && !window.PhaserGlobal.stopFocus) && window.focus(), this.config.disableStart || (this.cache.isReady ? this.raf.start() : this.cache.onReady.addOnce(function () { this.raf.start() }, this))) }, showDebugHeader: function () { if (!window.PhaserGlobal || !window.PhaserGlobal.hideBanner) { var t = s.VERSION, e = "Canvas", i = "HTML Audio", r = 1; if (this.renderType === s.WEBGL ? (e = "WebGL", r++) : this.renderType === s.HEADLESS && (e = "Headless"), this.device.webAudio && (i = "WebAudio", r++), this.device.ie) window.console && console.log("Phaser v" + t + " | Pixi.js | " + e + " | " + i + " | http://phaser.io"); else { for (var n = ["%c %c %c Phaser CE v" + t + " | Pixi.js | " + e + " | " + i + "  %c %c %c http://phaser.io %c%c%c", "background: #fb8cb3", "background: #d44a52", "color: #ffffff; background: #871905;", "background: #d44a52", "background: #fb8cb3", "background: #ffffff"], o = 0; o < 3; o++)o < r ? n.push("color: #ff2424; background: #fff") : n.push("color: #959595; background: #fff"); console.log.apply(console, n) } } }, setUpRenderer: function () { if (!this.device.canvas) throw new Error("Phaser.Game - Cannot create Canvas 2d context, aborting."); if (this.config.canvas ? this.canvas = this.config.canvas : this.canvas = s.Canvas.create(this, this.width, this.height, this.config.canvasID, !0), this.config.canvasStyle ? this.canvas.style = this.config.canvasStyle : this.canvas.style["-webkit-full-screen"] = "width: 100%; height: 100%", this.config.crisp && s.Canvas.setImageRenderingCrisp(this.canvas), this.renderType === s.WEBGL || this.renderType === s.WEBGL_MULTI || this.renderType === s.AUTO && this.device.webGL) { (this.multiTexture || this.renderType === s.WEBGL_MULTI) && (PIXI.enableMultiTexture(), this.multiTexture = !0); try { this.renderer = new PIXI.WebGLRenderer(this, this.config), this.renderType = s.WEBGL, this.context = null, this.canvas.addEventListener("webglcontextlost", this.contextLost.bind(this), !1), this.canvas.addEventListener("webglcontextrestored", this.contextRestored.bind(this), !1) } catch (t) { if (this.renderer = null, this.multiTexture = !1, PIXI._enableMultiTextureToggle = !1, this.renderType === s.WEBGL) throw t } } this.renderer || (this.renderer = new PIXI.CanvasRenderer(this, this.config), this.context = this.renderer.context, this.renderType === s.AUTO && (this.renderType = s.CANVAS)), this.device.cocoonJS && (this.canvas.screencanvas = this.renderType === s.CANVAS), this.renderType !== s.HEADLESS && (this.stage.smoothed = this.antialias, s.Canvas.addToDOM(this.canvas, this.parent, !1), s.Canvas.setTouchAction(this.canvas)) }, contextLost: function (t) { t.preventDefault(), this.renderer.contextLost = !0 }, contextRestored: function () { this.renderer.initContext(), this.cache.clearGLTextures(), this.renderer.contextLost = !1 }, update: function (t) { if (this.pendingDestroy) this.destroy(); else { if (this.time.update(t), this._kickstart) return this.updateLogic(this.time.desiredFpsMult), this.updateRender(this.time.slowMotion * this.time.desiredFps), void (this._kickstart = !1); if (this._spiraling > 1 && !this.forceSingleUpdate) this.time.time > this._nextFpsNotification && (this._nextFpsNotification = this.time.time + 1e4, this.fpsProblemNotifier.dispatch()), this._deltaTime = 0, this._spiraling = 0, this.dropFrames ? this.rendersThisFrame = 0 : (this.updateRender(this.time.slowMotion * this.time.desiredFps), this.rendersThisFrame = 1); else { var e = 1e3 * this.time.slowMotion / this.time.desiredFps; this._deltaTime += Math.max(Math.min(3 * e, this.time.elapsed), 0); var i = 0; for (this.updatesThisFrame = Math.floor(this._deltaTime / e), this.forceSingleUpdate && (this.updatesThisFrame = Math.min(1, this.updatesThisFrame)), this.forceSingleRender ? this.rendersThisFrame = 1 : this.rendersThisFrame = Math.min(1, this.updatesThisFrame); this._deltaTime >= e && (this._deltaTime -= e, this.currentUpdateID = i, this.updateLogic(this.time.desiredFpsMult), i++ , !this.forceSingleUpdate || 1 !== i);)this.time.refresh(); i > this._lastCount ? this._spiraling++ : i < this._lastCount && (this._spiraling = 0), this._lastCount = i, this.rendersThisFrame > 0 && this.updateRender(this._deltaTime / e) } } }, updateLogic: function (t) { this._paused || this.pendingStep ? (this.scale.pauseUpdate(), this.state.pauseUpdate(t), this.debug.preUpdate(), this.input.pauseUpdate()) : (this.stepping && (this.pendingStep = !0), this.time.countUpdate(), this.scale.preUpdate(), this.debug.preUpdate(), this.camera.preUpdate(), this.physics.preUpdate(), this.state.preUpdate(t), this.plugins.preUpdate(t), this.stage.preUpdate(), this.state.update(), this.stage.update(), this.tweens.update(), this.sound.update(), this.input.update(), this.physics.update(), this.plugins.update(), this.stage.postUpdate(), this.plugins.postUpdate()), this.stage.updateTransform() }, updateRender: function (t) { this.lockRender || (this.time.countRender(), this.state.preRender(t), this.renderType !== s.HEADLESS && (this.renderer.render(this.stage), this.plugins.render(t), this.state.render(t)), this.plugins.postRender(t)) }, enableStep: function () { this.stepping = !0, this.pendingStep = !1, this.stepCount = 0 }, disableStep: function () { this.stepping = !1, this.pendingStep = !1 }, step: function () { this.pendingStep = !1, this.stepCount++ }, destroy: function () { this.raf.stop(), this.debug.destroy && this.debug.destroy(), this.state.destroy(), this.sound.destroy(), this.scale.destroy(), this.stage.destroy(), this.input.destroy(), this.physics.destroy(), this.plugins.destroy(), this.debug = null, this.state = null, this.sound = null, this.scale = null, this.stage = null, this.input = null, this.physics = null, this.plugins = null, this.cache = null, this.load = null, this.time = null, this.world = null, this.isBooted = !1, this.renderer.destroy(!1), s.Canvas.removeFromDOM(this.canvas), PIXI.defaultRenderer = null, s.GAMES[this.id] = null }, gamePaused: function (t) { this._paused || (this._paused = !0, this.time.gamePaused(), this.sound.muteOnPause && this.sound.setMute(), this.onPause.dispatch(t), this.device.cordova && this.device.iOS && (this.lockRender = !0)) }, gameResumed: function (t) { this._paused && !this._codePaused && (this._paused = !1, this.time.gameResumed(), this.input.reset(), this.sound.muteOnPause && this.sound.unsetMute(), this.onResume.dispatch(t), this.device.cordova && this.device.iOS && (this.lockRender = !1)) }, focusLoss: function (t) { this.onBlur.dispatch(t), this.stage.disableVisibilityChange || this.gamePaused(t) }, focusGain: function (t) { this.onFocus.dispatch(t), this.stage.disableVisibilityChange || this.gameResumed(t) } }, s.Game.prototype.constructor = s.Game, Object.defineProperty(s.Game.prototype, "paused", { get: function () { return this._paused }, set: function (t) { !0 === t ? (!1 === this._paused && (this._paused = !0, this.sound.setMute(), this.time.gamePaused(), this.onPause.dispatch(this)), this._codePaused = !0) : (this._paused && (this._paused = !1, this.input.reset(), this.sound.unsetMute(), this.time.gameResumed(), this.onResume.dispatch(this)), this._codePaused = !1) } }), s.Input = function (t) { this.game = t, this.hitCanvas = null, this.hitContext = null, this.moveCallbacks = [], this.customCandidateHandler = null, this.customCandidateHandlerContext = null, this.pollRate = 0, this.enabled = !0, this.multiInputOverride = s.Input.MOUSE_TOUCH_COMBINE, this.position = null, this.speed = null, this.circle = null, this.scale = null, this.maxPointers = -1, this.tapRate = 200, this.doubleTapRate = 300, this.holdRate = 2e3, this.justPressedRate = 200, this.justReleasedRate = 200, this.recordPointerHistory = !1, this.recordRate = 100, this.recordLimit = 100, this.touchLockCallbacks = [], this.pointer1 = null, this.pointer2 = null, this.pointer3 = null, this.pointer4 = null, this.pointer5 = null, this.pointer6 = null, this.pointer7 = null, this.pointer8 = null, this.pointer9 = null, this.pointer10 = null, this.pointers = [], this.activePointer = null, this.mousePointer = null, this.mouse = null, this.keyboard = null, this.touch = null, this.mspointer = null, this.gamepad = null, this.resetLocked = !1, this.onDown = null, this.onUp = null, this.onTap = null, this.onHold = null, this.minPriorityID = 0, this.interactiveItems = new s.ArraySet, this._localPoint = new s.Point, this._pollCounter = 0, this._oldPosition = null, this._x = 0, this._y = 0 }, s.Input.MOUSE_OVERRIDES_TOUCH = 0, s.Input.TOUCH_OVERRIDES_MOUSE = 1, s.Input.MOUSE_TOUCH_COMBINE = 2, s.Input.MAX_POINTERS = 10, s.Input.prototype = { boot: function () { this.mousePointer = new s.Pointer(this.game, 0, s.PointerMode.CURSOR), this.addPointer(), this.addPointer(), this.mouse = new s.Mouse(this.game), this.touch = new s.Touch(this.game), this.mspointer = new s.MSPointer(this.game), s.Keyboard && (this.keyboard = new s.Keyboard(this.game)), s.Gamepad && (this.gamepad = new s.Gamepad(this.game)), this.onDown = new s.Signal, this.onUp = new s.Signal, this.onTap = new s.Signal, this.onHold = new s.Signal, this.scale = new s.Point(1, 1), this.speed = new s.Point, this.position = new s.Point, this._oldPosition = new s.Point, this.circle = new s.Circle(0, 0, 44), this.activePointer = this.mousePointer, this.hitCanvas = s.CanvasPool.create(this, 1, 1), this.hitContext = this.hitCanvas.getContext("2d"), this.mouse.start(), this.game.device.mspointer || this.touch.start(), this.mspointer.start(), this.mousePointer.active = !0, this.keyboard && this.keyboard.start(); var t = this; this._onClickTrampoline = function (e) { t.onClickTrampoline(e) }, this.game.canvas.addEventListener("click", this._onClickTrampoline, !1) }, destroy: function () { this.mouse.stop(), this.touch.stop(), this.mspointer.stop(), this.keyboard && this.keyboard.stop(), this.gamepad && this.gamepad.stop(), this.moveCallbacks = [], s.CanvasPool.remove(this), this.game.canvas.removeEventListener("click", this._onClickTrampoline) }, setInteractiveCandidateHandler: function (t, e) { this.customCandidateHandler = t, this.customCandidateHandlerContext = e }, addMoveCallback: function (t, e) { this.moveCallbacks.push({ callback: t, context: e }) }, addTouchLockCallback: function (t, e, i) { void 0 === i && (i = !1), this.touchLockCallbacks.push({ callback: t, context: e, onEnd: i }) }, removeTouchLockCallback: function (t, e) { for (var i = this.touchLockCallbacks.length; i--;)if (this.touchLockCallbacks[i].callback === t && this.touchLockCallbacks[i].context === e) return this.touchLockCallbacks.splice(i, 1), !0; return !1 }, executeTouchLockCallbacks: function (t, e) { for (var i = this.touchLockCallbacks.length; i--;) { var r = this.touchLockCallbacks[i]; r.onEnd === t && r.callback.call(r.context, this, e) && this.touchLockCallbacks.splice(i, 1) } }, deleteMoveCallback: function (t, e) { for (var i = this.moveCallbacks.length; i--;)if (this.moveCallbacks[i].callback === t && this.moveCallbacks[i].context === e) return void this.moveCallbacks.splice(i, 1) }, addPointer: function () { if (this.pointers.length >= s.Input.MAX_POINTERS) return console.warn("Phaser.Input.addPointer: Maximum limit of " + s.Input.MAX_POINTERS + " pointers reached."), null; var t = this.pointers.length + 1, e = new s.Pointer(this.game, t, s.PointerMode.CONTACT); return this.pointers.push(e), this["pointer" + t] = e, e }, update: function () { if (this.keyboard && this.keyboard.update(), this.pollRate > 0 && this._pollCounter < this.pollRate) this._pollCounter++; else { this.speed.x = this.position.x - this._oldPosition.x, this.speed.y = this.position.y - this._oldPosition.y, this._oldPosition.copyFrom(this.position), this.mousePointer.update(), this.gamepad && this.gamepad.active && this.gamepad.update(); for (var t = 0; t < this.pointers.length; t++)this.pointers[t].update(); this._pollCounter = 0 } }, pauseUpdate: function () { this.gamepad && this.gamepad.active && this.gamepad.update() }, reset: function (t) { if (this.game.isBooted && !this.resetLocked) { void 0 === t && (t = !1), this.mousePointer.reset(), this.keyboard && this.keyboard.reset(t); for (var e = 0; e < this.pointers.length; e++)this.pointers[e].reset(); "none" !== this.game.canvas.style.cursor && (this.game.canvas.style.cursor = ""), t && (this.onDown.dispose(), this.onUp.dispose(), this.onTap.dispose(), this.onHold.dispose(), this.onDown = new s.Signal, this.onUp = new s.Signal, this.onTap = new s.Signal, this.onHold = new s.Signal, this.moveCallbacks = []), this._pollCounter = 0 } }, resetSpeed: function (t, e) { this._oldPosition.setTo(t, e), this.speed.setTo(0, 0) }, startPointer: function (t) { if (this.maxPointers >= 0 && this.countActivePointers(this.maxPointers) >= this.maxPointers) return null; if (!this.pointer1.active) return this.pointer1.start(t); if (!this.pointer2.active) return this.pointer2.start(t); for (var e = 2; e < this.pointers.length; e++) { var i = this.pointers[e]; if (!i.active) return i.start(t) } return null }, updatePointer: function (t) { if (this.pointer1.active && this.pointer1.identifier === t.identifier) return this.pointer1.move(t); if (this.pointer2.active && this.pointer2.identifier === t.identifier) return this.pointer2.move(t); for (var e = 2; e < this.pointers.length; e++) { var i = this.pointers[e]; if (i.active && i.identifier === t.identifier) return i.move(t) } return null }, stopPointer: function (t) { if (this.pointer1.active && this.pointer1.identifier === t.identifier) return this.pointer1.stop(t); if (this.pointer2.active && this.pointer2.identifier === t.identifier) return this.pointer2.stop(t); for (var e = 2; e < this.pointers.length; e++) { var i = this.pointers[e]; if (i.active && i.identifier === t.identifier) return i.stop(t) } return null }, countActivePointers: function (t) { void 0 === t && (t = this.pointers.length); for (var e = t, i = 0; i < this.pointers.length && e > 0; i++) { this.pointers[i].active && e-- } return t - e }, getPointer: function (t) { void 0 === t && (t = !1); for (var e = 0; e < this.pointers.length; e++) { var i = this.pointers[e]; if (i.active === t) return i } return null }, getPointerFromIdentifier: function (t) { for (var e = 0; e < this.pointers.length; e++) { var i = this.pointers[e]; if (i.identifier === t) return i } return null }, getPointerFromId: function (t) { for (var e = 0; e < this.pointers.length; e++) { var i = this.pointers[e]; if (i.pointerId === t) return i } return null }, getLocalPosition: function (t, e, i) { void 0 === i && (i = new s.Point); var r = t.worldTransform, n = 1 / (r.a * r.d + r.c * -r.b); return i.setTo(r.d * n * e.x + -r.c * n * e.y + (r.ty * r.c - r.tx * r.d) * n, r.a * n * e.y + -r.b * n * e.x + (-r.ty * r.a + r.tx * r.b) * n) }, hitTest: function (t, e, i) { if (!t.worldVisible) return !1; if (this.getLocalPosition(t, e, this._localPoint), i.copyFrom(this._localPoint), t.hitArea && t.hitArea.contains) return t.hitArea.contains(this._localPoint.x, this._localPoint.y); if (s.Creature && t instanceof s.Creature) { var r = Math.abs(t.width), n = Math.abs(t.height), o = t.x - r * t.anchorX; if (this.game.camera.x + e.x >= o && this.game.camera.x + e.x < o + r) { var a = t.y - n * t.anchorY; if (this.game.camera.y + e.y >= a && this.game.camera.y + e.y < a + n) return !0 } } else if (t instanceof s.TileSprite) { r = t.width, n = t.height, o = -r * t.anchor.x; if (this._localPoint.x >= o && this._localPoint.x < o + r) { a = -n * t.anchor.y; if (this._localPoint.y >= a && this._localPoint.y < a + n) return !0 } } else if (t instanceof PIXI.Sprite) { r = t.texture.frame.width / t.texture.baseTexture.resolution, n = t.texture.frame.height / t.texture.baseTexture.resolution, o = -r * t.anchor.x; if (this._localPoint.x >= o && this._localPoint.x < o + r) { a = -n * t.anchor.y; if (this._localPoint.y >= a && this._localPoint.y < a + n) return !0 } } else if (t instanceof s.Graphics) for (var h = 0; h < t.graphicsData.length; h++) { var u = t.graphicsData[h]; if (u.fill && (u.shape && u.shape.contains(this._localPoint.x, this._localPoint.y))) return !0 } for (h = 0; h < t.children.length; h++)if (this.hitTest(t.children[h], e, i)) return !0; return !1 }, onClickTrampoline: function () { this.activePointer.processClickTrampolines() } }, s.Input.prototype.constructor = s.Input, Object.defineProperty(s.Input.prototype, "x", { get: function () { return this._x }, set: function (t) { this._x = Math.floor(t) } }), Object.defineProperty(s.Input.prototype, "y", { get: function () { return this._y }, set: function (t) { this._y = Math.floor(t) } }), Object.defineProperty(s.Input.prototype, "pollLocked", { get: function () { return this.pollRate > 0 && this._pollCounter < this.pollRate } }), Object.defineProperty(s.Input.prototype, "totalInactivePointers", { get: function () { return this.pointers.length - this.countActivePointers() } }), Object.defineProperty(s.Input.prototype, "totalActivePointers", { get: function () { return this.countActivePointers() } }), Object.defineProperty(s.Input.prototype, "worldX", { get: function () { return this.game.camera.view.x + this.x } }), Object.defineProperty(s.Input.prototype, "worldY", { get: function () { return this.game.camera.view.y + this.y } }), s.Mouse = function (t) { this.game = t, this.input = t.input, this.callbackContext = this.game, this.mouseDownCallback = null, this.mouseUpCallback = null, this.mouseOutCallback = null, this.mouseOverCallback = null, this.mouseWheelCallback = null, this.capture = !1, this.button = -1, this.wheelDelta = 0, this.enabled = !0, this.locked = !1, this.stopOnGameOut = !1, this.pointerLock = new s.Signal, this.event = null, this._onMouseDown = null, this._onMouseMove = null, this._onMouseUp = null, this._onMouseOut = null, this._onMouseOver = null, this._onMouseWheel = null, this._wheelEvent = null }, s.Mouse.NO_BUTTON = -1, s.Mouse.LEFT_BUTTON = 0, s.Mouse.MIDDLE_BUTTON = 1, s.Mouse.RIGHT_BUTTON = 2, s.Mouse.BACK_BUTTON = 3, s.Mouse.FORWARD_BUTTON = 4, s.Mouse.WHEEL_UP = 1, s.Mouse.WHEEL_DOWN = -1, s.Mouse.prototype = { start: function () { if ((!this.game.device.android || !1 !== this.game.device.chrome) && null === this._onMouseDown) { var t = this; this._onMouseDown = function (e) { return t.onMouseDown(e) }, this._onMouseMove = function (e) { return t.onMouseMove(e) }, this._onMouseUp = function (e) { return t.onMouseUp(e) }, this._onMouseUpGlobal = function (e) { return t.onMouseUpGlobal(e) }, this._onMouseOutGlobal = function (e) { return t.onMouseOutGlobal(e) }, this._onMouseOut = function (e) { return t.onMouseOut(e) }, this._onMouseOver = function (e) { return t.onMouseOver(e) }, this._onMouseWheel = function (e) { return t.onMouseWheel(e) }; var e = this.game.canvas; e.addEventListener("mousedown", this._onMouseDown, !0), e.addEventListener("mousemove", this._onMouseMove, !0), e.addEventListener("mouseup", this._onMouseUp, !0), this.game.device.cocoonJS || (window.addEventListener("mouseup", this._onMouseUpGlobal, !0), window.addEventListener("mouseout", this._onMouseOutGlobal, !0), e.addEventListener("mouseover", this._onMouseOver, !0), e.addEventListener("mouseout", this._onMouseOut, !0)); var i = this.game.device.wheelEvent; i && (e.addEventListener(i, this._onMouseWheel, !0), "mousewheel" === i ? this._wheelEvent = new a(-.025, 1) : "DOMMouseScroll" === i && (this._wheelEvent = new a(1, 1))) } }, onMouseDown: function (t) { this.event = t, this.capture && t.preventDefault(), this.mouseDownCallback && this.mouseDownCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.start(t)) }, onMouseMove: function (t) { this.event = t, this.capture && t.preventDefault(), this.mouseMoveCallback && this.mouseMoveCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.move(t)) }, onMouseUp: function (t) { this.event = t, this.capture && t.preventDefault(), this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = 0, this.input.mousePointer.stop(t)) }, onMouseUpGlobal: function (t) { this.input.mousePointer.withinGame || (this.mouseUpCallback && this.mouseUpCallback.call(this.callbackContext, t), t.identifier = 0, this.input.mousePointer.stop(t)) }, onMouseOutGlobal: function (t) { this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !1, this.input.enabled && this.enabled && (this.input.mousePointer.stop(t), this.input.mousePointer.resetButtons()) }, onMouseOut: function (t) { if (this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !1, this.mouseOutCallback && this.mouseOutCallback.call(this.callbackContext, t), this.input.enabled && this.enabled) for (var e in this.stopOnGameOut && (t.identifier = 0, this.input.mousePointer.stop(t)), this.input.interactiveItems.list) !0 === this.input.interactiveItems.list[e].enabled && this.input.interactiveItems.list[e]._pointerOutHandler(this.input.mousePointer) }, onMouseOver: function (t) { this.event = t, this.capture && t.preventDefault(), this.input.mousePointer.withinGame = !0, this.mouseOverCallback && this.mouseOverCallback.call(this.callbackContext, t) }, onMouseWheel: function (t) { this._wheelEvent && (t = this._wheelEvent.bindEvent(t)), this.event = t, this.capture && t.preventDefault(), this.wheelDelta = s.Math.clamp(-t.deltaY, -1, 1), this.mouseWheelCallback && this.mouseWheelCallback.call(this.callbackContext, t) }, requestPointerLock: function () { if (this.game.device.pointerLock) { var t = this.game.canvas; t.requestPointerLock = t.requestPointerLock || t.mozRequestPointerLock || t.webkitRequestPointerLock, t.requestPointerLock(); var e = this; this._pointerLockChange = function (t) { return e.pointerLockChange(t) }, document.addEventListener("pointerlockchange", this._pointerLockChange, !0), document.addEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.addEventListener("webkitpointerlockchange", this._pointerLockChange, !0) } }, pointerLockChange: function (t) { var e = this.game.canvas; document.pointerLockElement === e || document.mozPointerLockElement === e || document.webkitPointerLockElement === e ? (this.locked = !0, this.pointerLock.dispatch(!0, t)) : (this.locked = !1, this.pointerLock.dispatch(!1, t)) }, releasePointerLock: function () { document.exitPointerLock = document.exitPointerLock || document.mozExitPointerLock || document.webkitExitPointerLock, document.exitPointerLock(), document.removeEventListener("pointerlockchange", this._pointerLockChange, !0), document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0) }, stop: function () { var t = this.game.canvas; t.removeEventListener("mousedown", this._onMouseDown, !0), t.removeEventListener("mousemove", this._onMouseMove, !0), t.removeEventListener("mouseup", this._onMouseUp, !0), t.removeEventListener("mouseover", this._onMouseOver, !0), t.removeEventListener("mouseout", this._onMouseOut, !0); var e = this.game.device.wheelEvent; e && t.removeEventListener(e, this._onMouseWheel, !0), window.removeEventListener("mouseup", this._onMouseUpGlobal, !0), window.removeEventListener("mouseout", this._onMouseOutGlobal, !0), document.removeEventListener("pointerlockchange", this._pointerLockChange, !0), document.removeEventListener("mozpointerlockchange", this._pointerLockChange, !0), document.removeEventListener("webkitpointerlockchange", this._pointerLockChange, !0) } }, s.Mouse.prototype.constructor = s.Mouse, a.prototype = {}, a.prototype.constructor = a, a.prototype.bindEvent = function (t) { if (!a._stubsGenerated && t) { var e = function (t) { return function () { var e = this.originalEvent[t]; return "function" != typeof e ? e : e.bind(this.originalEvent) } }; for (var i in t) i in a.prototype || Object.defineProperty(a.prototype, i, { get: e(i) }); a._stubsGenerated = !0 } return this.originalEvent = t, this }, Object.defineProperties(a.prototype, { type: { value: "wheel" }, deltaMode: { get: function () { return this._deltaMode } }, deltaY: { get: function () { return this._scaleFactor * (this.originalEvent.wheelDelta || this.originalEvent.detail) || 0 } }, deltaX: { get: function () { return this._scaleFactor * this.originalEvent.wheelDeltaX || 0 } }, deltaZ: { value: 0 } }), s.MSPointer = function (t) { this.game = t, this.input = t.input, this.callbackContext = this.game, this.pointerDownCallback = null, this.pointerMoveCallback = null, this.pointerUpCallback = null, this.capture = !0, this.button = -1, this.event = null, this.enabled = !0, this._onMSPointerDown = null, this._onMSPointerMove = null, this._onMSPointerUp = null, this._onMSPointerUpGlobal = null, this._onMSPointerOut = null, this._onMSPointerOver = null }, s.MSPointer.prototype = { start: function () { if (null === this._onMSPointerDown) { var t = this; if (this.game.device.mspointer) { this._onMSPointerDown = function (e) { return t.onPointerDown(e) }, this._onMSPointerMove = function (e) { return t.onPointerMove(e) }, this._onMSPointerUp = function (e) { return t.onPointerUp(e) }, this._onMSPointerUpGlobal = function (e) { return t.onPointerUpGlobal(e) }, this._onMSPointerOut = function (e) { return t.onPointerOut(e) }, this._onMSPointerOver = function (e) { return t.onPointerOver(e) }; var e = this.game.canvas; e.addEventListener("MSPointerDown", this._onMSPointerDown, !1), e.addEventListener("MSPointerMove", this._onMSPointerMove, !1), e.addEventListener("MSPointerUp", this._onMSPointerUp, !1), e.addEventListener("pointerdown", this._onMSPointerDown, !1), e.addEventListener("pointermove", this._onMSPointerMove, !1), e.addEventListener("pointerup", this._onMSPointerUp, !1), e.style["-ms-content-zooming"] = "none", e.style["-ms-touch-action"] = "none", this.game.device.cocoonJS || (window.addEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), e.addEventListener("MSPointerOver", this._onMSPointerOver, !0), e.addEventListener("MSPointerOut", this._onMSPointerOut, !0), window.addEventListener("pointerup", this._onMSPointerUpGlobal, !0), e.addEventListener("pointerover", this._onMSPointerOver, !0), e.addEventListener("pointerout", this._onMSPointerOut, !0)) } } }, onPointerDown: function (t) { this.game.input.executeTouchLockCallbacks(!1, t), this.event = t, this.capture && t.preventDefault(), this.pointerDownCallback && this.pointerDownCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.start(t) : this.input.startPointer(t)) }, onPointerMove: function (t) { this.event = t, this.capture && t.preventDefault(), this.pointerMoveCallback && this.pointerMoveCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.move(t) : this.input.updatePointer(t)) }, onPointerUp: function (t) { this.game.input.executeTouchLockCallbacks(!0, t), this.event = t, this.capture && t.preventDefault(), this.pointerUpCallback && this.pointerUpCallback.call(this.callbackContext, t), this.input.enabled && this.enabled && (t.identifier = t.pointerId, "mouse" === t.pointerType || 4 === t.pointerType ? this.input.mousePointer.stop(t) : this.input.stopPointer(t)) }, onPointerUpGlobal: function (t) { if ("mouse" !== t.pointerType && 4 !== t.pointerType || this.input.mousePointer.withinGame) { var e = this.input.getPointerFromIdentifier(t.identifier); e && e.withinGame && this.onPointerUp(t) } else this.onPointerUp(t) }, onPointerOut: function (t) { if (this.event = t, this.capture && t.preventDefault(), "mouse" === t.pointerType || 4 === t.pointerType) this.input.mousePointer.withinGame = !1; else { var e = this.input.getPointerFromIdentifier(t.identifier); e && (e.withinGame = !1) } this.input.mouse.mouseOutCallback && this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext, t), this.input.enabled && this.enabled && this.input.mouse.stopOnGameOut && (t.identifier = 0, e ? e.stop(t) : this.input.mousePointer.stop(t)) }, onPointerOver: function (t) { if (this.event = t, this.capture && t.preventDefault(), "mouse" === t.pointerType || 4 === t.pointerType) this.input.mousePointer.withinGame = !0; else { var e = this.input.getPointerFromIdentifier(t.identifier); e && (e.withinGame = !0) } this.input.mouse.mouseOverCallback && this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext, t) }, stop: function () { var t = this.game.canvas; t.removeEventListener("MSPointerDown", this._onMSPointerDown, !1), t.removeEventListener("MSPointerMove", this._onMSPointerMove, !1), t.removeEventListener("MSPointerUp", this._onMSPointerUp, !1), t.removeEventListener("pointerdown", this._onMSPointerDown, !1), t.removeEventListener("pointermove", this._onMSPointerMove, !1), t.removeEventListener("pointerup", this._onMSPointerUp, !1), window.removeEventListener("MSPointerUp", this._onMSPointerUpGlobal, !0), t.removeEventListener("MSPointerOver", this._onMSPointerOver, !0), t.removeEventListener("MSPointerOut", this._onMSPointerOut, !0), window.removeEventListener("pointerup", this._onMSPointerUpGlobal, !0), t.removeEventListener("pointerover", this._onMSPointerOver, !0), t.removeEventListener("pointerout", this._onMSPointerOut, !0) } }, s.MSPointer.prototype.constructor = s.MSPointer, s.DeviceButton = function (t, e) { this.parent = t, this.game = t.game, this.event = null, this.isDown = !1, this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1, this.value = 0, this.buttonCode = e, this.onDown = new s.Signal, this.onUp = new s.Signal, this.onFloat = new s.Signal }, s.DeviceButton.prototype = { start: function (t, e) { this.isDown || (this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, this.repeats = 0, this.event = t, this.value = e, t && (this.altKey = t.altKey, this.shiftKey = t.shiftKey, this.ctrlKey = t.ctrlKey), this.onDown.dispatch(this, e)) }, stop: function (t, e) { this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.event = t, this.value = e, t && (this.altKey = t.altKey, this.shiftKey = t.shiftKey, this.ctrlKey = t.ctrlKey), this.onUp.dispatch(this, e)) }, startStop: function (t, e, i) { t ? this.start(e, i) : this.stop(e, i) }, padFloat: function (t) { this.isDown = !1, this.isUp = !1, this.value = t, this.onFloat.dispatch(this, t) }, justPressed: function (t) { return t = t || 250, this.isDown && this.timeDown + t > this.game.time.time }, justReleased: function (t) { return t = t || 250, this.isUp && this.timeUp + t > this.game.time.time }, reset: function () { this.isDown = !1, this.isUp = !0, this.timeDown = this.game.time.time, this.repeats = 0, this.altKey = !1, this.shiftKey = !1, this.ctrlKey = !1 }, destroy: function () { this.onDown.dispose(), this.onUp.dispose(), this.onFloat.dispose(), this.parent = null, this.game = null } }, s.DeviceButton.prototype.constructor = s.DeviceButton, Object.defineProperty(s.DeviceButton.prototype, "duration", { get: function () { return this.isUp ? -1 : this.game.time.time - this.timeDown } }), s.Pointer = function (t, e, i) { this.game = t, this.id = e, this.type = s.POINTER, this.exists = !0, this.identifier = 0, this.pointerId = null, this.pointerMode = i || s.PointerMode.CURSOR | s.PointerMode.CONTACT, this.target = null, this.button = null, this.leftButton = new s.DeviceButton(this, s.Pointer.LEFT_BUTTON), this.middleButton = new s.DeviceButton(this, s.Pointer.MIDDLE_BUTTON), this.rightButton = new s.DeviceButton(this, s.Pointer.RIGHT_BUTTON), this.backButton = new s.DeviceButton(this, s.Pointer.BACK_BUTTON), this.forwardButton = new s.DeviceButton(this, s.Pointer.FORWARD_BUTTON), this.eraserButton = new s.DeviceButton(this, s.Pointer.ERASER_BUTTON), this._holdSent = !1, this._history = [], this._nextDrop = 0, this._stateReset = !1, this.withinGame = !1, this.clientX = -1, this.clientY = -1, this.pageX = -1, this.pageY = -1, this.screenX = -1, this.screenY = -1, this.rawMovementX = 0, this.rawMovementY = 0, this.movementX = 0, this.movementY = 0, this.x = -1, this.y = -1, this.isMouse = 0 === e, this.isDown = !1, this.isUp = !0, this.timeDown = 0, this.timeUp = 0, this.previousTapTime = 0, this.totalTouches = 0, this.msSinceLastClick = Number.MAX_VALUE, this.targetObject = null, this.interactiveCandidates = [], this.active = !1, this.dirty = !1, this.position = new s.Point, this.positionDown = new s.Point, this.positionUp = new s.Point, this.circle = new s.Circle(0, 0, 44), this._clickTrampolines = null, this._trampolineTargetObject = null }, s.Pointer.NO_BUTTON = 0, s.Pointer.LEFT_BUTTON = 1, s.Pointer.RIGHT_BUTTON = 2, s.Pointer.MIDDLE_BUTTON = 4, s.Pointer.BACK_BUTTON = 8, s.Pointer.FORWARD_BUTTON = 16, s.Pointer.ERASER_BUTTON = 32, s.Pointer.prototype = { resetButtons: function () { this.isDown = !1, this.isUp = !0, this.isMouse && (this.leftButton.reset(), this.middleButton.reset(), this.rightButton.reset(), this.backButton.reset(), this.forwardButton.reset(), this.eraserButton.reset()) }, processButtonsDown: function (t, e) { t === s.Mouse.LEFT_BUTTON && this.leftButton.start(e), t === s.Mouse.RIGHT_BUTTON && this.rightButton.start(e), t === s.Mouse.MIDDLE_BUTTON && this.middleButton.start(e), t === s.Mouse.BACK_BUTTON && this.backButton.start(e), t === s.Mouse.FORWARD_BUTTON && this.forwardButton.start(e) }, processButtonsUp: function (t, e) { t === s.Mouse.LEFT_BUTTON && this.leftButton.stop(e), t === s.Mouse.RIGHT_BUTTON && this.rightButton.stop(e), t === s.Mouse.MIDDLE_BUTTON && this.middleButton.stop(e), t === s.Mouse.BACK_BUTTON && this.backButton.stop(e), t === s.Mouse.FORWARD_BUTTON && this.forwardButton.stop(e) }, processButtonsUpDown: function (t, e) { var i = "down" === e.type.toLowerCase().substr(-4), r = "move" === e.type.toLowerCase().substr(-4); void 0 !== t ? (i && 1 === t && e.ctrlKey && (t = 2), this.leftButton.startStop(s.Pointer.LEFT_BUTTON & t, e), this.rightButton.startStop(s.Pointer.RIGHT_BUTTON & t, e), this.middleButton.startStop(s.Pointer.MIDDLE_BUTTON & t, e), this.backButton.startStop(s.Pointer.BACK_BUTTON & t, e), this.forwardButton.startStop(s.Pointer.FORWARD_BUTTON & t, e), this.eraserButton.startStop(s.Pointer.ERASER_BUTTON & t, e)) : void 0 !== e.button ? i && e.ctrlKey && 0 === e.button ? this.rightButton.start(e) : i ? this.processButtonsDown(e.button, e) : r || this.processButtonsUp(e.button, e) : i ? e.ctrlKey ? this.rightButton.start(e) : this.leftButton.start(e) : (this.leftButton.stop(e), this.rightButton.stop(e)) }, updateButtons: function (t) { this.button = t.button, this.processButtonsUpDown(t.buttons, t), this.isUp = !0, this.isDown = !1, (this.leftButton.isDown || this.rightButton.isDown || this.middleButton.isDown || this.backButton.isDown || this.forwardButton.isDown || this.eraserButton.isDown) && (this.isUp = !1, this.isDown = !0) }, start: function (t) { var e = this.game.input; return t.pointerId && (this.pointerId = t.pointerId), this.identifier = t.identifier, this.target = t.target, this.isMouse ? this.updateButtons(t) : (this.isDown = !0, this.isUp = !1), this.active = !0, this.withinGame = !0, this.dirty = !1, this._history = [], this._clickTrampolines = null, this._trampolineTargetObject = null, this.msSinceLastClick = this.game.time.time - this.timeDown, this.timeDown = this.game.time.time, this._holdSent = !1, this.move(t, !0), this.positionDown.setTo(this.x, this.y), (e.multiInputOverride === s.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === s.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === s.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.x = this.x, e.y = this.y, e.position.setTo(this.x, this.y), e.onDown.dispatch(this, t), e.resetSpeed(this.x, this.y)), this._stateReset = !1, this.totalTouches++ , null !== this.targetObject && this.targetObject._touchedHandler(this), this }, update: function () { var t = this.game.input; this.active && (this.dirty && (t.interactiveItems.total > 0 && this.processInteractiveObjects(!1), this.dirty = !1), !1 === this._holdSent && this.duration >= t.holdRate && ((t.multiInputOverride === s.Input.MOUSE_OVERRIDES_TOUCH || t.multiInputOverride === s.Input.MOUSE_TOUCH_COMBINE || t.multiInputOverride === s.Input.TOUCH_OVERRIDES_MOUSE && 0 === t.totalActivePointers) && t.onHold.dispatch(this), this._holdSent = !0), t.recordPointerHistory && this.game.time.time >= this._nextDrop && (this._nextDrop = this.game.time.time + t.recordRate, this._history.push({ x: this.position.x, y: this.position.y }), this._history.length > t.recordLimit && this._history.shift())) }, move: function (t, e) { var i = this.game.input; if (!i.pollLocked) { void 0 === e && (e = !1), void 0 !== t.button && (this.button = t.button), this.isMouse && this.updateButtons(t), this.clientX = t.clientX, this.clientY = t.clientY, this.pageX = t.pageX, this.pageY = t.pageY, this.screenX = t.screenX, this.screenY = t.screenY, this.isMouse && i.mouse.locked && !e && (this.rawMovementX = t.movementX || t.mozMovementX || t.webkitMovementX || 0, this.rawMovementY = t.movementY || t.mozMovementY || t.webkitMovementY || 0, this.movementX += this.rawMovementX, this.movementY += this.rawMovementY), this.x = (this.pageX - this.game.scale.offset.x) * i.scale.x, this.y = (this.pageY - this.game.scale.offset.y) * i.scale.y, this.position.setTo(this.x, this.y), this.circle.x = this.x, this.circle.y = this.y, (i.multiInputOverride === s.Input.MOUSE_OVERRIDES_TOUCH || i.multiInputOverride === s.Input.MOUSE_TOUCH_COMBINE || i.multiInputOverride === s.Input.TOUCH_OVERRIDES_MOUSE && 0 === i.totalActivePointers) && (i.activePointer = this, i.x = this.x, i.y = this.y, i.position.setTo(i.x, i.y), i.circle.x = i.x, i.circle.y = i.y), this.withinGame = this.game.scale.bounds.contains(this.pageX, this.pageY); for (var r = i.moveCallbacks.length; r--;)i.moveCallbacks[r].callback.call(i.moveCallbacks[r].context, this, this.x, this.y, e); return null === this.targetObject || this.game.paused && !this.targetObject.noPause || !0 !== this.targetObject.isDragged ? i.interactiveItems.total > 0 && this.processInteractiveObjects(e) : !1 === this.targetObject.update(this) && (this.targetObject = null), this } }, processInteractiveObjects: function (t) { var e = 0, i = -1, r = null, n = this.game.input.interactiveItems.first; for (this.interactiveCandidates = []; n;)n.checked = !1, !n.validForInput(i, e, !1) || this.game.paused && !n.sprite.noPause || (n.checked = !0, (t && n.checkPointerDown(this, !0) || !t && n.checkPointerOver(this, !0)) && (e = n.sprite.renderOrderID, i = n.priorityID, r = n, this.interactiveCandidates.push(n))), n = this.game.input.interactiveItems.next; for (n = this.game.input.interactiveItems.first; n;)!n.checked && n.validForInput(i, e, !0) && (t && n.checkPointerDown(this, !1) || !t && n.checkPointerOver(this, !1)) && (e = n.sprite.renderOrderID, i = n.priorityID, r = n, this.interactiveCandidates.push(n)), n = this.game.input.interactiveItems.next; return this.game.input.customCandidateHandler && (r = this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext, this, this.interactiveCandidates, r)), this.swapTarget(r, !1), null !== this.targetObject }, swapTarget: function (t, e) { void 0 === e && (e = !1), null === t ? this.targetObject && (this.targetObject._pointerOutHandler(this, e), this.targetObject = null) : null === this.targetObject ? (this.targetObject = t, t._pointerOverHandler(this, e)) : this.targetObject === t ? !1 === t.update(this) && (this.targetObject = null) : (this.targetObject._pointerOutHandler(this, e), this.targetObject = t, this.targetObject._pointerOverHandler(this, e)) }, leave: function (t) { this.withinGame = !1, this.move(t, !1) }, stop: function (t) { var e = this.game.input; if (!this._stateReset || !this.withinGame) return this.timeUp = this.game.time.time, (e.multiInputOverride === s.Input.MOUSE_OVERRIDES_TOUCH || e.multiInputOverride === s.Input.MOUSE_TOUCH_COMBINE || e.multiInputOverride === s.Input.TOUCH_OVERRIDES_MOUSE && 0 === e.totalActivePointers) && (e.onUp.dispatch(this, t), this.duration >= 0 && this.duration <= e.tapRate && (this.timeUp - this.previousTapTime < e.doubleTapRate ? e.onTap.dispatch(this, !0) : e.onTap.dispatch(this, !1), this.previousTapTime = this.timeUp)), this.isMouse ? this.updateButtons(t) : (this.isDown = !1, this.isUp = !0), this.id > 0 && (this.active = !1), this.withinGame = this.game.scale.bounds.contains(t.pageX, t.pageY), this.pointerId = null, this.identifier = null, this.positionUp.setTo(this.x, this.y), !1 === this.isMouse && e.currentPointers-- , e.interactiveItems.callAll("_releasedHandler", this), this._clickTrampolines && (this._trampolineTargetObject = this.targetObject), this.targetObject = null, this; t.preventDefault() }, justPressed: function (t) { return t = t || this.game.input.justPressedRate, !0 === this.isDown && this.timeDown + t > this.game.time.time }, justReleased: function (t) { return t = t || this.game.input.justReleasedRate, this.isUp && this.timeUp + t > this.game.time.time }, addClickTrampoline: function (t, e, i, r) { if (this.isDown) { for (var n = this._clickTrampolines = this._clickTrampolines || [], s = 0; s < n.length; s++)if (n[s].name === t) { n.splice(s, 1); break } n.push({ name: t, targetObject: this.targetObject, callback: e, callbackContext: i, callbackArgs: r }) } }, processClickTrampolines: function () { var t = this._clickTrampolines; if (t) { for (var e = 0; e < t.length; e++) { var i = t[e]; i.targetObject === this._trampolineTargetObject && i.callback.apply(i.callbackContext, i.callbackArgs) } this._clickTrampolines = null, this._trampolineTargetObject = null } }, reset: function () { !1 === this.isMouse && (this.active = !1), this.pointerId = null, this.identifier = null, this.dirty = !1, this.totalTouches = 0, this._holdSent = !1, this._history.length = 0, this._stateReset = !0, this.resetButtons(), this.targetObject && this.targetObject._releasedHandler(this), this.targetObject = null }, resetMovement: function () { this.movementX = 0, this.movementY = 0 } }, s.Pointer.prototype.constructor = s.Pointer, Object.defineProperty(s.Pointer.prototype, "duration", { get: function () { return this.isUp ? -1 : this.game.time.time - this.timeDown } }), Object.defineProperty(s.Pointer.prototype, "worldX", { get: function () { return this.game.world.camera.x + this.x } }), Object.defineProperty(s.Pointer.prototype, "worldY", { get: function () { return this.game.world.camera.y + this.y } }), s.PointerMode = { CURSOR: 1, CONTACT: 2 }, s.Touch = function (t) { this.game = t, this.enabled = !0, this.callbackContext = this.game, this.touchStartCallback = null, this.touchMoveCallback = null, this.touchEndCallback = null, this.touchEnterCallback = null, this.touchLeaveCallback = null, this.touchCancelCallback = null, this.preventDefault = !0, this.event = null, this._onTouchStart = null, this._onTouchMove = null, this._onTouchEnd = null, this._onTouchEnter = null, this._onTouchLeave = null, this._onTouchCancel = null, this._onTouchMove = null }, s.Touch.prototype = { start: function () { if (null === this._onTouchStart) { var t = this; this.game.device.touch && (this._onTouchStart = function (e) { return t.onTouchStart(e) }, this._onTouchMove = function (e) { return t.onTouchMove(e) }, this._onTouchEnd = function (e) { return t.onTouchEnd(e) }, this._onTouchEnter = function (e) { return t.onTouchEnter(e) }, this._onTouchLeave = function (e) { return t.onTouchLeave(e) }, this._onTouchCancel = function (e) { return t.onTouchCancel(e) }, this.game.canvas.addEventListener("touchstart", this._onTouchStart, !1), this.game.canvas.addEventListener("touchmove", this._onTouchMove, !1), this.game.canvas.addEventListener("touchend", this._onTouchEnd, !1), this.game.canvas.addEventListener("touchcancel", this._onTouchCancel, !1), this.game.device.cocoonJS || (this.game.canvas.addEventListener("touchenter", this._onTouchEnter, !1), this.game.canvas.addEventListener("touchleave", this._onTouchLeave, !1))) } }, consumeDocumentTouches: function () { this._documentTouchMove = function (t) { t.preventDefault() }, document.addEventListener("touchmove", this._documentTouchMove, !1) }, onTouchStart: function (t) { if (this.game.input.executeTouchLockCallbacks(!1, t), this.event = t, this.game.input.enabled && this.enabled) { this.touchStartCallback && this.touchStartCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault(); for (var e = 0; e < t.changedTouches.length; e++)this.game.input.startPointer(t.changedTouches[e]) } }, onTouchCancel: function (t) { if (this.event = t, this.touchCancelCallback && this.touchCancelCallback.call(this.callbackContext, t), this.game.input.enabled && this.enabled) { this.preventDefault && t.preventDefault(); for (var e = 0; e < t.changedTouches.length; e++)this.game.input.stopPointer(t.changedTouches[e]) } }, onTouchEnter: function (t) { this.event = t, this.touchEnterCallback && this.touchEnterCallback.call(this.callbackContext, t), this.game.input.enabled && this.enabled && this.preventDefault && t.preventDefault() }, onTouchLeave: function (t) { this.event = t, this.touchLeaveCallback && this.touchLeaveCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault() }, onTouchMove: function (t) { this.event = t, this.touchMoveCallback && this.touchMoveCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault(); for (var e = 0; e < t.changedTouches.length; e++)this.game.input.updatePointer(t.changedTouches[e]) }, onTouchEnd: function (t) { this.game.input.executeTouchLockCallbacks(!0, t), this.event = t, this.touchEndCallback && this.touchEndCallback.call(this.callbackContext, t), this.preventDefault && t.preventDefault(); for (var e = 0; e < t.changedTouches.length; e++)this.game.input.stopPointer(t.changedTouches[e]) }, stop: function () { this.game.device.touch && (this.game.canvas.removeEventListener("touchstart", this._onTouchStart), this.game.canvas.removeEventListener("touchmove", this._onTouchMove), this.game.canvas.removeEventListener("touchend", this._onTouchEnd), this.game.canvas.removeEventListener("touchenter", this._onTouchEnter), this.game.canvas.removeEventListener("touchleave", this._onTouchLeave), this.game.canvas.removeEventListener("touchcancel", this._onTouchCancel)) } }, s.Touch.prototype.constructor = s.Touch, s.InputHandler = function (t) { this.sprite = t, this.game = t.game, this.enabled = !1, this.checked = !1, this.priorityID = 0, this.useHandCursor = !1, this._setHandCursor = !1, this.isDragged = !1, this.allowHorizontalDrag = !0, this.allowVerticalDrag = !0, this.bringToTop = !1, this.snapOffset = null, this.snapOnDrag = !1, this.snapOnRelease = !1, this.snapX = 0, this.snapY = 0, this.snapOffsetX = 0, this.snapOffsetY = 0, this.pixelPerfectOver = !1, this.pixelPerfectClick = !1, this.pixelPerfectAlpha = 255, this.draggable = !1, this.boundsRect = null, this.boundsSprite = null, this.scaleLayer = !1, this.dragOffset = new s.Point, this.dragFromCenter = !1, this.dragStopBlocksInputUp = !1, this.dragStartPoint = new s.Point, this.dragDistanceThreshold = 0, this.dragTimeThreshold = 0, this.downPoint = new s.Point, this.snapPoint = new s.Point, this._dragPoint = new s.Point, this._dragPhase = !1, this._pendingDrag = !1, this._dragTimePass = !1, this._dragDistancePass = !1, this._wasEnabled = !1, this._tempPoint = new s.Point, this._pointerData = [], this._pointerData.push({ id: 0, x: 0, y: 0, camX: 0, camY: 0, isDown: !1, isUp: !1, isOver: !1, isOut: !1, timeOver: 0, timeOut: 0, timeDown: 0, timeUp: 0, downDuration: 0, isDragged: !1 }) }, s.InputHandler.prototype = { start: function (t, e) { if (t = t || 0, void 0 === e && (e = !1), !1 === this.enabled) { this.game.input.interactiveItems.add(this), this.useHandCursor = e, this.priorityID = t; for (var i = 0; i < 10; i++)this._pointerData[i] = { id: i, x: 0, y: 0, isDown: !1, isUp: !1, isOver: !1, isOut: !1, timeOver: 0, timeOut: 0, timeDown: 0, timeUp: 0, downDuration: 0, isDragged: !1 }; this.snapOffset = new s.Point, this.enabled = !0, this._wasEnabled = !0 } return this.sprite.events.onAddedToGroup.add(this.addedToGroup, this), this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup, this), this.sprite }, addedToGroup: function () { this._dragPhase || this._wasEnabled && !this.enabled && this.start() }, removedFromGroup: function () { this._dragPhase || (this.enabled ? (this._wasEnabled = !0, this.stop()) : this._wasEnabled = !1) }, reset: function () { this.enabled = !1; for (var t = 0; t < 10; t++)this._pointerData[t] = { id: t, x: 0, y: 0, isDown: !1, isUp: !1, isOver: !1, isOut: !1, timeOver: 0, timeOut: 0, timeDown: 0, timeUp: 0, downDuration: 0, isDragged: !1 } }, stop: function () { !1 !== this.enabled && (this.enabled = !1, this.game.input.interactiveItems.remove(this)) }, destroy: function () { this.sprite && (this._setHandCursor && (this.game.canvas.style.cursor = "", this._setHandCursor = !1), this.enabled = !1, this.game.input.interactiveItems.remove(this), this._pointerData.length = 0, this.boundsRect = null, this.boundsSprite = null, this.sprite = null) }, validForInput: function (t, e, i) { return void 0 === i && (i = !0), !(!this.enabled || 0 === this.sprite.scale.x || 0 === this.sprite.scale.y || this.priorityID < this.game.input.minPriorityID || this.sprite.parent && this.sprite.parent.ignoreChildInput) && (!(!i && (this.pixelPerfectClick || this.pixelPerfectOver)) && (this.priorityID > t || this.priorityID === t && this.sprite.renderOrderID > e)) }, isPixelPerfect: function () { return this.pixelPerfectClick || this.pixelPerfectOver }, pointerX: function (t) { return t = t || 0, this._pointerData[t].x }, pointerY: function (t) { return t = t || 0, this._pointerData[t].y }, pointerDown: function (t) { return t = t || 0, this._pointerData[t].isDown }, pointerUp: function (t) { return t = t || 0, this._pointerData[t].isUp }, pointerTimeDown: function (t) { return t = t || 0, this._pointerData[t].timeDown }, pointerTimeUp: function (t) { return t = t || 0, this._pointerData[t].timeUp }, pointerOver: function (t) { if (!this.enabled) return !1; if (void 0 === t) { for (var e = 0; e < 10; e++)if (this._pointerData[e].isOver) return !0; return !1 } return this._pointerData[t].isOver }, pointerOut: function (t) { if (!this.enabled) return !1; if (void 0 !== t) return this._pointerData[t].isOut; for (var e = 0; e < 10; e++)if (this._pointerData[e].isOut) return !0 }, pointerTimeOver: function (t) { return t = t || 0, this._pointerData[t].timeOver }, pointerTimeOut: function (t) { return t = t || 0, this._pointerData[t].timeOut }, pointerDragged: function (t) { return t = t || 0, this._pointerData[t].isDragged }, checkPointerDown: function (t, e) { return !!(t.isDown && this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && (!!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1), !(!e && this.pixelPerfectClick) || this.checkPixel(this._tempPoint.x, this._tempPoint.y))) }, checkPointerOver: function (t, e) { return !!(this.enabled && this.sprite && this.sprite.parent && this.sprite.visible && this.sprite.parent.visible && 0 !== this.sprite.worldScale.x && 0 !== this.sprite.worldScale.y) && (!!this.game.input.hitTest(this.sprite, t, this._tempPoint) && (void 0 === e && (e = !1), !(!e && this.pixelPerfectOver) || this.checkPixel(this._tempPoint.x, this._tempPoint.y))) }, checkPixel: function (t, e, i) { if (this.sprite.texture.baseTexture.source) { if (null === t && null === e) { this.game.input.getLocalPosition(this.sprite, i, this._tempPoint); t = this._tempPoint.x, e = this._tempPoint.y } if (0 !== this.sprite.anchor.x && (t -= -this.sprite.texture.frame.width * this.sprite.anchor.x), 0 !== this.sprite.anchor.y && (e -= -this.sprite.texture.frame.height * this.sprite.anchor.y), t += this.sprite.texture.frame.x, e += this.sprite.texture.frame.y, this.sprite.texture.trim && (t -= this.sprite.texture.trim.x, e -= this.sprite.texture.trim.y, t < this.sprite.texture.crop.x || t > this.sprite.texture.crop.right || e < this.sprite.texture.crop.y || e > this.sprite.texture.crop.bottom)) return this._dx = t, this._dy = e, !1; if (this._dx = t, this._dy = e, this.game.input.hitContext.clearRect(0, 0, 1, 1), this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source, t, e, 1, 1, 0, 0, 1, 1), this.game.input.hitContext.getImageData(0, 0, 1, 1).data[3] >= this.pixelPerfectAlpha) return !0 } return !1 }, update: function (t) { if (null !== this.sprite && void 0 !== this.sprite.parent) return this.enabled && this.sprite.visible && this.sprite.parent.visible ? this._pendingDrag ? (this._dragDistancePass || (this._dragDistancePass = s.Math.distance(t.x, t.y, this.downPoint.x, this.downPoint.y) >= this.dragDistanceThreshold), this._dragDistancePass && this._dragTimePass && this.startDrag(t), !0) : this.draggable && this._draggedPointerID === t.id ? this.updateDrag(t, !1) : this._pointerData[t.id].isOver ? this.checkPointerOver(t) ? (this._pointerData[t.id].x = t.x - this.sprite.x, this._pointerData[t.id].y = t.y - this.sprite.y, !0) : (this._pointerOutHandler(t), !1) : void 0 : (this._pointerOutHandler(t), !1) }, _pointerOverHandler: function (t, e) { if (null !== this.sprite) { var i = this._pointerData[t.id]; if (!1 === i.isOver || t.dirty) { var r = !1 === i.isOver; i.isOver = !0, i.isOut = !1, i.timeOver = this.game.time.time, i.x = t.x - this.sprite.x, i.y = t.y - this.sprite.y, this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "pointer", this._setHandCursor = !0), !e && r && this.sprite && this.sprite.events && this.sprite.events.onInputOver$dispatch(this.sprite, t), this.sprite.parent && this.sprite.parent.onChildInputOver && this.sprite.parent.onChildInputOver.dispatch(this.sprite, t) } } }, _pointerOutHandler: function (t, e) { if (null !== this.sprite) { var i = this._pointerData[t.id]; i.isOver = !1, i.isOut = !0, i.timeOut = this.game.time.time, this.useHandCursor && !1 === i.isDragged && (this.game.canvas.style.cursor = "", this._setHandCursor = !1), !e && this.sprite && this.sprite.events && (this.sprite.events.onInputOut$dispatch(this.sprite, t), this.sprite && this.sprite.parent && this.sprite.parent.onChildInputOut && this.sprite.parent.onChildInputOut.dispatch(this.sprite, t)) } }, _touchedHandler: function (t) { if (null !== this.sprite) { var e = this._pointerData[t.id]; if (!e.isDown && e.isOver) { if (this.pixelPerfectClick && !this.checkPixel(null, null, t)) return; if (e.isDown = !0, e.isUp = !1, e.timeDown = this.game.time.time, this.downPoint.set(t.x, t.y), t.dirty = !0, this.sprite && this.sprite.events && (this.sprite.events.onInputDown$dispatch(this.sprite, t), this.sprite && this.sprite.parent && this.sprite.parent.onChildInputDown && this.sprite.parent.onChildInputDown.dispatch(this.sprite, t), null === this.sprite)) return; this.draggable && !1 === this.isDragged && (0 === this.dragTimeThreshold && 0 === this.dragDistanceThreshold ? this.startDrag(t) : (this._pendingDrag = !0, this._dragDistancePass = 0 === this.dragDistanceThreshold, this.dragTimeThreshold > 0 ? (this._dragTimePass = !1, this.game.time.events.add(this.dragTimeThreshold, this.dragTimeElapsed, this, t)) : this._dragTimePass = !0)), this.bringToTop && this.sprite.bringToTop() } } }, dragTimeElapsed: function (t) { this._dragTimePass = !0, this._pendingDrag && this.sprite && this._dragDistancePass && this.startDrag(t) }, _releasedHandler: function (t) { if (null !== this.sprite) { var e = this._pointerData[t.id]; if (e.isDown && t.isUp) { e.isDown = !1, e.isUp = !0, e.timeUp = this.game.time.time, e.downDuration = e.timeUp - e.timeDown; var i = this.checkPointerOver(t); this.sprite && this.sprite.events && (this.dragStopBlocksInputUp && (!this.dragStopBlocksInputUp || this.draggable && this.isDragged && this._draggedPointerID === t.id) || this.sprite.events.onInputUp$dispatch(this.sprite, t, i), this.sprite && this.sprite.parent && this.sprite.parent.onChildInputUp && this.sprite.parent.onChildInputUp.dispatch(this.sprite, t, i), i && (i = this.checkPointerOver(t))), e.isOver = i, !i && this.useHandCursor && (this.game.canvas.style.cursor = "default", this._setHandCursor = !1), t.dirty = !0, this._pendingDrag = !1, this.draggable && this.isDragged && this._draggedPointerID === t.id && this.stopDrag(t) } } }, updateDrag: function (t, e) { if (void 0 === e && (e = !1), t.isUp) return this.stopDrag(t), !1; var i = this.globalToLocal(t); if (this.sprite.fixedToCamera) var r = this.game.camera.scale.x * i.x + this._dragPoint.x + this.dragOffset.x, n = this.game.camera.scale.y * i.y + this._dragPoint.y + this.dragOffset.y; else r = i.x + this._dragPoint.x + this.dragOffset.x, n = i.y + this._dragPoint.y + this.dragOffset.y; if (this.sprite.fixedToCamera) this.allowHorizontalDrag && (this.sprite.cameraOffset.x = r - this.game.camera.x), this.allowVerticalDrag && (this.sprite.cameraOffset.y = n - this.game.camera.y), this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), this.snapOnDrag && (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, this.snapPoint.set(this.sprite.cameraOffset.x, this.sprite.cameraOffset.y)); else { var s = this.game.camera.x - this._pointerData[t.id].camX, o = this.game.camera.y - this._pointerData[t.id].camY; this.allowHorizontalDrag && (this.sprite.x = r + s), this.allowVerticalDrag && (this.sprite.y = n + o), this.boundsRect && this.checkBoundsRect(), this.boundsSprite && this.checkBoundsSprite(), this.snapOnDrag && (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY, this.snapPoint.set(this.sprite.x, this.sprite.y)) } return this.sprite.events.onDragUpdate.dispatch(this.sprite, t, r, n, this.snapPoint, e), !0 }, justOver: function (t, e) { return t = t || 0, e = e || 500, this._pointerData[t].isOver && this.overDuration(t) < e }, justOut: function (t, e) { return t = t || 0, e = e || 500, this._pointerData[t].isOut && this.game.time.time - this._pointerData[t].timeOut < e }, justPressed: function (t, e) { return t = t || 0, e = e || 500, this._pointerData[t].isDown && this.downDuration(t) < e }, justReleased: function (t, e) { return t = t || 0, e = e || 500, this._pointerData[t].isUp && this.game.time.time - this._pointerData[t].timeUp < e }, overDuration: function (t) { return t = t || 0, this._pointerData[t].isOver ? this.game.time.time - this._pointerData[t].timeOver : -1 }, downDuration: function (t) { return t = t || 0, this._pointerData[t].isDown ? this.game.time.time - this._pointerData[t].timeDown : -1 }, enableDrag: function (t, e, i, r, n, o) { void 0 === t && (t = !1), void 0 === e && (e = !1), void 0 === i && (i = !1), void 0 === r && (r = 255), void 0 === n && (n = null), void 0 === o && (o = null), this._dragPoint = new s.Point, this.draggable = !0, this.bringToTop = e, this.dragOffset = new s.Point, this.dragFromCenter = t, this.pixelPerfectClick = i, this.pixelPerfectAlpha = r, n && (this.boundsRect = n), o && (this.boundsSprite = o) }, disableDrag: function () { if (this._pointerData) for (var t = 0; t < 10; t++)this._pointerData[t].isDragged = !1; this.draggable = !1, this.isDragged = !1, this._draggedPointerID = -1, this._pendingDrag = !1 }, startDrag: function (t) { var e = this.sprite.x, i = this.sprite.y, r = this.globalToLocal(t); if (this.isDragged = !0, this._draggedPointerID = t.id, this._pointerData[t.id].camX = this.game.camera.x, this._pointerData[t.id].camY = this.game.camera.y, this._pointerData[t.id].isDragged = !0, this.sprite.fixedToCamera) { if (this.dragFromCenter) { var n = this.sprite.getBounds(), o = this.globalToLocal(new s.Point(n.centerX, n.centerY)); this.sprite.cameraOffset.x = r.x + (this.sprite.cameraOffset.x - o.x), this.sprite.cameraOffset.y = r.y + (this.sprite.cameraOffset.y - o.y) } this._dragPoint.setTo(this.sprite.cameraOffset.x - t.x, this.sprite.cameraOffset.y - t.y) } else { if (this.dragFromCenter) { n = this.sprite.getBounds(), o = this.globalToLocal(new s.Point(n.centerX, n.centerY)); this.sprite.x = r.x + (this.sprite.x - o.x), this.sprite.y = r.y + (this.sprite.y - o.y) } this._dragPoint.setTo(this.sprite.x - r.x, this.sprite.y - r.y) } this.updateDrag(t, !0), this.bringToTop && (this._dragPhase = !0, this.sprite.bringToTop()), this.dragStartPoint.set(e, i), this.sprite.events.onDragStart$dispatch(this.sprite, t, e, i), this._pendingDrag = !1 }, globalToLocalX: function (t) { return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.x, t *= this.game.scale.grid.scaleFluidInversed.x), t }, globalToLocalY: function (t) { return this.scaleLayer && (t -= this.game.scale.grid.boundsFluid.y, t *= this.game.scale.grid.scaleFluidInversed.y), t }, globalToLocal: function (t) { return this.sprite.parent ? this.game.input.getLocalPosition(this.sprite.parent, { x: t.x, y: t.y }) : t }, stopDrag: function (t) { this.isDragged = !1, this._draggedPointerID = -1, this._pointerData[t.id].isDragged = !1, this._dragPhase = !1, this._pendingDrag = !1, this.snapOnRelease && (this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x = Math.round((this.sprite.cameraOffset.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.cameraOffset.y = Math.round((this.sprite.cameraOffset.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY) : (this.sprite.x = Math.round((this.sprite.x - this.snapOffsetX % this.snapX) / this.snapX) * this.snapX + this.snapOffsetX % this.snapX, this.sprite.y = Math.round((this.sprite.y - this.snapOffsetY % this.snapY) / this.snapY) * this.snapY + this.snapOffsetY % this.snapY)), this.sprite.events.onDragStop$dispatch(this.sprite, t), !1 === this.checkPointerOver(t) && this._pointerOutHandler(t) }, setDragLock: function (t, e) { void 0 === t && (t = !0), void 0 === e && (e = !0), this.allowHorizontalDrag = t, this.allowVerticalDrag = e }, enableSnap: function (t, e, i, r, n, s) { void 0 === i && (i = !0), void 0 === r && (r = !1), void 0 === n && (n = 0), void 0 === s && (s = 0), this.snapX = t, this.snapY = e, this.snapOffsetX = n, this.snapOffsetY = s, this.snapOnDrag = i, this.snapOnRelease = r }, disableSnap: function () { this.snapOnDrag = !1, this.snapOnRelease = !1 }, checkBoundsRect: function () { this.sprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsRect.left ? this.sprite.cameraOffset.x = this.boundsRect.left : this.sprite.cameraOffset.x + this.sprite.width > this.boundsRect.right && (this.sprite.cameraOffset.x = this.boundsRect.right - this.sprite.width), this.sprite.cameraOffset.y < this.boundsRect.top ? this.sprite.cameraOffset.y = this.boundsRect.top : this.sprite.cameraOffset.y + this.sprite.height > this.boundsRect.bottom && (this.sprite.cameraOffset.y = this.boundsRect.bottom - this.sprite.height)) : (this.sprite.left < this.boundsRect.left ? this.sprite.x = this.boundsRect.x + this.sprite.offsetX : this.sprite.right > this.boundsRect.right && (this.sprite.x = this.boundsRect.right - (this.sprite.width - this.sprite.offsetX)), this.sprite.top < this.boundsRect.top ? this.sprite.y = this.boundsRect.top + this.sprite.offsetY : this.sprite.bottom > this.boundsRect.bottom && (this.sprite.y = this.boundsRect.bottom - (this.sprite.height - this.sprite.offsetY))) }, checkBoundsSprite: function () { this.sprite.fixedToCamera && this.boundsSprite.fixedToCamera ? (this.sprite.cameraOffset.x < this.boundsSprite.cameraOffset.x ? this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x : this.sprite.cameraOffset.x + this.sprite.width > this.boundsSprite.cameraOffset.x + this.boundsSprite.width && (this.sprite.cameraOffset.x = this.boundsSprite.cameraOffset.x + this.boundsSprite.width - this.sprite.width), this.sprite.cameraOffset.y < this.boundsSprite.cameraOffset.y ? this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y : this.sprite.cameraOffset.y + this.sprite.height > this.boundsSprite.cameraOffset.y + this.boundsSprite.height && (this.sprite.cameraOffset.y = this.boundsSprite.cameraOffset.y + this.boundsSprite.height - this.sprite.height)) : (this.sprite.left < this.boundsSprite.left ? this.sprite.x = this.boundsSprite.left + this.sprite.offsetX : this.sprite.right > this.boundsSprite.right && (this.sprite.x = this.boundsSprite.right - (this.sprite.width - this.sprite.offsetX)), this.sprite.top < this.boundsSprite.top ? this.sprite.y = this.boundsSprite.top + this.sprite.offsetY : this.sprite.bottom > this.boundsSprite.bottom && (this.sprite.y = this.boundsSprite.bottom - (this.sprite.height - this.sprite.offsetY))) } }, s.InputHandler.prototype.constructor = s.InputHandler, s.Gamepad = function (t) { this.game = t, this._gamepadIndexMap = {}, this._rawPads = [], this._active = !1, this.enabled = !0, this._gamepadSupportAvailable = !!navigator.webkitGetGamepads || !!navigator.webkitGamepads || -1 !== navigator.userAgent.indexOf("Firefox/") || !!navigator.getGamepads, this._prevRawGamepadTypes = [], this._prevTimestamps = [], this.callbackContext = this, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null, this._ongamepadconnected = null, this._gamepaddisconnected = null, this._gamepads = [new s.SinglePad(t, this), new s.SinglePad(t, this), new s.SinglePad(t, this), new s.SinglePad(t, this)] }, s.Gamepad.prototype = { addCallbacks: function (t, e) { void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback, this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback, this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback, this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback, this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback, this.callbackContext = t) }, start: function () { if (!this._active) { this._active = !0; var t = this; this._onGamepadConnected = function (e) { return t.onGamepadConnected(e) }, this._onGamepadDisconnected = function (e) { return t.onGamepadDisconnected(e) }, window.addEventListener("gamepadconnected", this._onGamepadConnected, !1), window.addEventListener("gamepaddisconnected", this._onGamepadDisconnected, !1) } }, onGamepadConnected: function (t) { var e = t.gamepad; this._rawPads.push(e), this._gamepads[e.index].connect(e) }, onGamepadDisconnected: function (t) { var e = t.gamepad; for (var i in this._rawPads) this._rawPads[i].index === e.index && this._rawPads.splice(i, 1); this._gamepads[e.index].disconnect() }, update: function () { this._pollGamepads(), this.pad1.pollStatus(), this.pad2.pollStatus(), this.pad3.pollStatus(), this.pad4.pollStatus() }, _pollGamepads: function () { if (this._active) { if (navigator.getGamepads) var t = navigator.getGamepads(); else if (navigator.webkitGetGamepads) t = navigator.webkitGetGamepads(); else if (navigator.webkitGamepads) t = navigator.webkitGamepads(); if (t) { this._rawPads = []; for (var e = !1, i = 0; i < t.length && (r(t[i]) !== this._prevRawGamepadTypes[i] && (e = !0, this._prevRawGamepadTypes[i] = r(t[i])), t[i] && this._rawPads.push(t[i]), 3 !== i); i++); for (var n = 0; n < this._gamepads.length; n++)this._gamepads[n]._rawPad = this._rawPads[n]; if (e) { for (var s, o = { rawIndices: {}, padIndices: {} }, a = 0; a < this._gamepads.length; a++)if ((s = this._gamepads[a]).connected) for (var h = 0; h < this._rawPads.length; h++)this._rawPads[h].index === s.index && (o.rawIndices[s.index] = !0, o.padIndices[a] = !0); for (var u = 0; u < this._gamepads.length; u++)if (s = this._gamepads[u], !o.padIndices[u]) { this._rawPads.length < 1 && s.disconnect(); for (var l = 0; l < this._rawPads.length && !o.padIndices[u]; l++) { var c = this._rawPads[l]; if (c) { if (o.rawIndices[c.index]) { s.disconnect(); continue } s.connect(c), o.rawIndices[c.index] = !0, o.padIndices[u] = !0 } else s.disconnect() } } } } } }, setDeadZones: function (t) { for (var e = 0; e < this._gamepads.length; e++)this._gamepads[e].deadZone = t }, stop: function () { this._active = !1, window.removeEventListener("gamepadconnected", this._onGamepadConnected), window.removeEventListener("gamepaddisconnected", this._onGamepadDisconnected) }, reset: function () { this.update(); for (var t = 0; t < this._gamepads.length; t++)this._gamepads[t].reset() }, justPressed: function (t, e) { for (var i = 0; i < this._gamepads.length; i++)if (!0 === this._gamepads[i].justPressed(t, e)) return !0; return !1 }, justReleased: function (t, e) { for (var i = 0; i < this._gamepads.length; i++)if (!0 === this._gamepads[i].justReleased(t, e)) return !0; return !1 }, isDown: function (t) { for (var e = 0; e < this._gamepads.length; e++)if (!0 === this._gamepads[e].isDown(t)) return !0; return !1 }, destroy: function () { this.stop(); for (var t = 0; t < this._gamepads.length; t++)this._gamepads[t].destroy() } }, s.Gamepad.prototype.constructor = s.Gamepad, Object.defineProperty(s.Gamepad.prototype, "active", { get: function () { return this._active } }), Object.defineProperty(s.Gamepad.prototype, "supported", { get: function () { return this._gamepadSupportAvailable } }), Object.defineProperty(s.Gamepad.prototype, "padsConnected", { get: function () { return this._rawPads.length } }), Object.defineProperty(s.Gamepad.prototype, "pad1", { get: function () { return this._gamepads[0] } }), Object.defineProperty(s.Gamepad.prototype, "pad2", { get: function () { return this._gamepads[1] } }), Object.defineProperty(s.Gamepad.prototype, "pad3", { get: function () { return this._gamepads[2] } }), Object.defineProperty(s.Gamepad.prototype, "pad4", { get: function () { return this._gamepads[3] } }), s.Gamepad.BUTTON_0 = 0, s.Gamepad.BUTTON_1 = 1, s.Gamepad.BUTTON_2 = 2, s.Gamepad.BUTTON_3 = 3, s.Gamepad.BUTTON_4 = 4, s.Gamepad.BUTTON_5 = 5, s.Gamepad.BUTTON_6 = 6, s.Gamepad.BUTTON_7 = 7, s.Gamepad.BUTTON_8 = 8, s.Gamepad.BUTTON_9 = 9, s.Gamepad.BUTTON_10 = 10, s.Gamepad.BUTTON_11 = 11, s.Gamepad.BUTTON_12 = 12, s.Gamepad.BUTTON_13 = 13, s.Gamepad.BUTTON_14 = 14, s.Gamepad.BUTTON_15 = 15, s.Gamepad.AXIS_0 = 0, s.Gamepad.AXIS_1 = 1, s.Gamepad.AXIS_2 = 2, s.Gamepad.AXIS_3 = 3, s.Gamepad.AXIS_4 = 4, s.Gamepad.AXIS_5 = 5, s.Gamepad.AXIS_6 = 6, s.Gamepad.AXIS_7 = 7, s.Gamepad.AXIS_8 = 8, s.Gamepad.AXIS_9 = 9, s.Gamepad.XBOX360_A = 0, s.Gamepad.XBOX360_B = 1, s.Gamepad.XBOX360_X = 2, s.Gamepad.XBOX360_Y = 3, s.Gamepad.XBOX360_LEFT_BUMPER = 4, s.Gamepad.XBOX360_RIGHT_BUMPER = 5, s.Gamepad.XBOX360_LEFT_TRIGGER = 6, s.Gamepad.XBOX360_RIGHT_TRIGGER = 7, s.Gamepad.XBOX360_BACK = 8, s.Gamepad.XBOX360_START = 9, s.Gamepad.XBOX360_STICK_LEFT_BUTTON = 10, s.Gamepad.XBOX360_STICK_RIGHT_BUTTON = 11, s.Gamepad.XBOX360_DPAD_LEFT = 14, s.Gamepad.XBOX360_DPAD_RIGHT = 15, s.Gamepad.XBOX360_DPAD_UP = 12, s.Gamepad.XBOX360_DPAD_DOWN = 13, s.Gamepad.XBOX360_STICK_LEFT_X = 0, s.Gamepad.XBOX360_STICK_LEFT_Y = 1, s.Gamepad.XBOX360_STICK_RIGHT_X = 2, s.Gamepad.XBOX360_STICK_RIGHT_Y = 3, s.Gamepad.PS3XC_X = 0, s.Gamepad.PS3XC_CIRCLE = 1, s.Gamepad.PS3XC_SQUARE = 2, s.Gamepad.PS3XC_TRIANGLE = 3, s.Gamepad.PS3XC_L1 = 4, s.Gamepad.PS3XC_R1 = 5, s.Gamepad.PS3XC_L2 = 6, s.Gamepad.PS3XC_R2 = 7, s.Gamepad.PS3XC_SELECT = 8, s.Gamepad.PS3XC_START = 9, s.Gamepad.PS3XC_STICK_LEFT_BUTTON = 10, s.Gamepad.PS3XC_STICK_RIGHT_BUTTON = 11, s.Gamepad.PS3XC_DPAD_UP = 12, s.Gamepad.PS3XC_DPAD_DOWN = 13, s.Gamepad.PS3XC_DPAD_LEFT = 14, s.Gamepad.PS3XC_DPAD_RIGHT = 15, s.Gamepad.PS3XC_STICK_LEFT_X = 0, s.Gamepad.PS3XC_STICK_LEFT_Y = 1, s.Gamepad.PS3XC_STICK_RIGHT_X = 2, s.Gamepad.PS3XC_STICK_RIGHT_Y = 3, s.SinglePad = function (t, e) { this.game = t, this.index = null, this.connected = !1, this.callbackContext = this, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null, this.deadZone = .26, this._padParent = e, this._rawPad = null, this._prevTimestamp = null, this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0 }, s.SinglePad.prototype = { addCallbacks: function (t, e) { void 0 !== e && (this.onConnectCallback = "function" == typeof e.onConnect ? e.onConnect : this.onConnectCallback, this.onDisconnectCallback = "function" == typeof e.onDisconnect ? e.onDisconnect : this.onDisconnectCallback, this.onDownCallback = "function" == typeof e.onDown ? e.onDown : this.onDownCallback, this.onUpCallback = "function" == typeof e.onUp ? e.onUp : this.onUpCallback, this.onAxisCallback = "function" == typeof e.onAxis ? e.onAxis : this.onAxisCallback, this.onFloatCallback = "function" == typeof e.onFloat ? e.onFloat : this.onFloatCallback, this.callbackContext = t) }, getButton: function (t) { return this._buttons[t] ? this._buttons[t] : null }, pollStatus: function () { if (this.connected && this.game.input.enabled && this.game.input.gamepad.enabled && (!this._rawPad.timestamp || this._rawPad.timestamp !== this._prevTimestamp)) { for (var t = 0; t < this._buttonsLen; t++) { var e = isNaN(this._rawPad.buttons[t]) ? this._rawPad.buttons[t].value : this._rawPad.buttons[t]; e !== this._buttons[t].value && (1 === e ? this.processButtonDown(t, e) : 0 === e ? this.processButtonUp(t, e) : this.processButtonFloat(t, e)) } for (var i = 0; i < this._axesLen; i++) { var r = this._rawPad.axes[i]; r > 0 && r > this.deadZone || r < 0 && r < -this.deadZone ? this.processAxisChange(i, r) : this.processAxisChange(i, 0) } this._prevTimestamp = this._rawPad.timestamp } }, connect: function (t) { var e = !this.connected; this.connected = !0, this.index = t.index, this._rawPad = t, this._buttons = [], this._buttonsLen = t.buttons.length, this._axes = [], this._axesLen = t.axes.length; for (var i = 0; i < this._axesLen; i++)this._axes[i] = t.axes[i]; for (var r in t.buttons) r = parseInt(r, 10), this._buttons[r] = new s.DeviceButton(this, r); e && this._padParent.onConnectCallback && this._padParent.onConnectCallback.call(this._padParent.callbackContext, this.index), e && this.onConnectCallback && this.onConnectCallback.call(this.callbackContext) }, disconnect: function () { var t = this.connected, e = this.index; this.connected = !1, this.index = null, this._rawPad = void 0; for (var i = 0; i < this._buttonsLen; i++)this._buttons[i].destroy(); this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, t && this._padParent.onDisconnectCallback && this._padParent.onDisconnectCallback.call(this._padParent.callbackContext, e), t && this.onDisconnectCallback && this.onDisconnectCallback.call(this.callbackContext) }, destroy: function () { this._rawPad = void 0; for (var t = 0; t < this._buttonsLen; t++)this._buttons[t].destroy(); this._buttons = [], this._buttonsLen = 0, this._axes = [], this._axesLen = 0, this.onConnectCallback = null, this.onDisconnectCallback = null, this.onDownCallback = null, this.onUpCallback = null, this.onAxisCallback = null, this.onFloatCallback = null }, processAxisChange: function (t, e) { this._axes[t] !== e && (this._axes[t] = e, this._padParent.onAxisCallback && this._padParent.onAxisCallback.call(this._padParent.callbackContext, this, t, e), this.onAxisCallback && this.onAxisCallback.call(this.callbackContext, this, t, e)) }, processButtonDown: function (t, e) { this._buttons[t] && this._buttons[t].start(null, e), this._padParent.onDownCallback && this._padParent.onDownCallback.call(this._padParent.callbackContext, t, e, this.index), this.onDownCallback && this.onDownCallback.call(this.callbackContext, t, e) }, processButtonUp: function (t, e) { this._padParent.onUpCallback && this._padParent.onUpCallback.call(this._padParent.callbackContext, t, e, this.index), this.onUpCallback && this.onUpCallback.call(this.callbackContext, t, e), this._buttons[t] && this._buttons[t].stop(null, e) }, processButtonFloat: function (t, e) { this._padParent.onFloatCallback && this._padParent.onFloatCallback.call(this._padParent.callbackContext, t, e, this.index), this.onFloatCallback && this.onFloatCallback.call(this.callbackContext, t, e), this._buttons[t] && this._buttons[t].padFloat(e) }, axis: function (t) { return !!this._axes[t] && this._axes[t] }, isDown: function (t) { return !!this._buttons[t] && this._buttons[t].isDown }, isUp: function (t) { return !!this._buttons[t] && this._buttons[t].isUp }, justReleased: function (t, e) { if (this._buttons[t]) return this._buttons[t].justReleased(e) }, justPressed: function (t, e) { if (this._buttons[t]) return this._buttons[t].justPressed(e) }, buttonValue: function (t) { return this._buttons[t] ? this._buttons[t].value : null }, reset: function () { for (var t = 0; t < this._axes.length; t++)this._axes[t] = 0 } }, s.SinglePad.prototype.constructor = s.SinglePad, s.Key = function (t, e) { this.game = t, this._enabled = !0, this.event = null, this.isDown = !1, this.isUp = !0, this.altKey = !1, this.ctrlKey = !1, this.shiftKey = !1, this.timeDown = 0, this.duration = 0, this.timeUp = -2500, this.durationUp = -2500, this.repeats = 0, this.keyCode = e, this.onDown = new s.Signal, this.onHoldCallback = null, this.onHoldContext = null, this.onUp = new s.Signal, this._justDown = !1, this._justUp = !1 }, s.Key.prototype = { update: function () { this._enabled && (this.isDown ? (this.duration = this.game.time.time - this.timeDown, this.repeats++ , this.onHoldCallback && this.onHoldCallback.call(this.onHoldContext, this)) : this.durationUp = this.game.time.time - this.timeUp) }, processKeyDown: function (t) { this._enabled && (this.event = t, this.isDown || (this.altKey = t.altKey, this.ctrlKey = t.ctrlKey, this.shiftKey = t.shiftKey, this.isDown = !0, this.isUp = !1, this.timeDown = this.game.time.time, this.duration = 0, this.durationUp = this.game.time.time - this.timeUp, this.repeats = 0, this._justDown = !0, this.onDown.dispatch(this))) }, processKeyUp: function (t) { this._enabled && (this.event = t, this.isUp || (this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.duration = this.game.time.time - this.timeDown, this.durationUp = 0, this._justUp = !0, this.onUp.dispatch(this))) }, reset: function (t) { void 0 === t && (t = !0), this.isDown = !1, this.isUp = !0, this.timeUp = this.game.time.time, this.duration = 0, this.durationUp = -2500, this._enabled = !0, this._justDown = !1, this._justUp = !1, t && (this.onDown.removeAll(), this.onUp.removeAll(), this.onHoldCallback = null, this.onHoldContext = null) }, downDuration: function (t) { return void 0 === t && (t = 50), this.isDown && this.duration < t }, upDuration: function (t) { return void 0 === t && (t = 50), !this.isDown && this.game.time.time - this.timeUp < t }, justPressed: function () { return this.isDown && 0 === this.duration }, justReleased: function () { return !this.isDown && 0 === this.durationUp } }, Object.defineProperty(s.Key.prototype, "justDown", { get: function () { var t = this._justDown; return this._justDown = !1, t } }), Object.defineProperty(s.Key.prototype, "justUp", { get: function () { var t = this._justUp; return this._justUp = !1, t } }), Object.defineProperty(s.Key.prototype, "enabled", { get: function () { return this._enabled }, set: function (t) { (t = !!t) !== this._enabled && (t || this.reset(!1), this._enabled = t) } }), s.Key.prototype.constructor = s.Key, s.Keyboard = function (t) { this.game = t, this.enabled = !0, this.event = null, this.pressEvent = null, this.callbackContext = this, this.onDownCallback = null, this.onPressCallback = null, this.onUpCallback = null, this._keys = [], this._capture = [], this._onKeyDown = null, this._onKeyPress = null, this._onKeyUp = null, this._i = 0, this._k = 0 }, s.Keyboard.prototype = { addCallbacks: function (t, e, i, r) { this.callbackContext = t, void 0 !== e && null !== e && (this.onDownCallback = e), void 0 !== i && null !== i && (this.onUpCallback = i), void 0 !== r && null !== r && (this.onPressCallback = r) }, removeCallbacks: function () { this.callbackContext = this, this.onDownCallback = null, this.onUpCallback = null, this.onPressCallback = null }, addKey: function (t) { return this._keys[t] || (this._keys[t] = new s.Key(this.game, t), this.addKeyCapture(t)), this._keys[t] }, addKeys: function (t) { var e = {}; for (var i in t) e[i] = this.addKey(t[i]); return e }, removeKey: function (t) { this._keys[t] && (this._keys[t] = null, this.removeKeyCapture(t)) }, createCursorKeys: function () { return this.addKeys({ up: s.KeyCode.UP, down: s.KeyCode.DOWN, left: s.KeyCode.LEFT, right: s.KeyCode.RIGHT }) }, start: function () { if (!this.game.device.cocoonJS && null === this._onKeyDown) { var t = this; this._onKeyDown = function (e) { return t.processKeyDown(e) }, this._onKeyUp = function (e) { return t.processKeyUp(e) }, this._onKeyPress = function (e) { return t.processKeyPress(e) }, window.addEventListener("keydown", this._onKeyDown, !1), window.addEventListener("keyup", this._onKeyUp, !1), window.addEventListener("keypress", this._onKeyPress, !1) } }, stop: function () { window.removeEventListener("keydown", this._onKeyDown), window.removeEventListener("keyup", this._onKeyUp), window.removeEventListener("keypress", this._onKeyPress), this._onKeyDown = null, this._onKeyUp = null, this._onKeyPress = null }, destroy: function () { this.stop(), this.clearCaptures(), this._keys.length = 0, this._i = 0 }, addKeyCapture: function (t) { if ("object" === (void 0 === t ? "undefined" : r(t))) for (var e in t) this._capture[t[e]] = !0; else this._capture[t] = !0 }, removeKeyCapture: function (t) { delete this._capture[t] }, clearCaptures: function () { this._capture = {} }, update: function () { for (this._i = this._keys.length; this._i--;)this._keys[this._i] && this._keys[this._i].update() }, processKeyDown: function (t) { if (this.event = t, this.game.input.enabled && this.enabled) { var e = t.keyCode; this._capture[e] && t.preventDefault(), this._keys[e] || (this._keys[e] = new s.Key(this.game, e)), this._keys[e].processKeyDown(t), this._k = e, this.onDownCallback && this.onDownCallback.call(this.callbackContext, t) } }, processKeyPress: function (t) { this.pressEvent = t, this.game.input.enabled && this.enabled && this.onPressCallback && this.onPressCallback.call(this.callbackContext, String.fromCharCode(t.charCode), t) }, processKeyUp: function (t) { if (this.event = t, this.game.input.enabled && this.enabled) { var e = t.keyCode; this._capture[e] && t.preventDefault(), this._keys[e] || (this._keys[e] = new s.Key(this.game, e)), this._keys[e].processKeyUp(t), this.onUpCallback && this.onUpCallback.call(this.callbackContext, t) } }, reset: function (t) { void 0 === t && (t = !0), this.event = null; for (var e = this._keys.length; e--;)this._keys[e] && this._keys[e].reset(t) }, downDuration: function (t, e) { return this._keys[t] ? this._keys[t].downDuration(e) : null }, upDuration: function (t, e) { return this._keys[t] ? this._keys[t].upDuration(e) : null }, justPressed: function (t) { return this._keys[t] ? this._keys[t].justPressed() : null }, justReleased: function (t) { return this._keys[t] ? this._keys[t].justReleased() : null }, isDown: function (t) { return this._keys[t] ? this._keys[t].isDown : null } }, Object.defineProperty(s.Keyboard.prototype, "lastChar", { get: function () { return this.event && 32 === this.event.charCode ? "" : this.pressEvent ? String.fromCharCode(this.pressEvent.charCode) : null } }), Object.defineProperty(s.Keyboard.prototype, "lastKey", { get: function () { return this._keys[this._k] } }), s.Keyboard.prototype.constructor = s.Keyboard, s.KeyCode = { A: "A".charCodeAt(0), B: "B".charCodeAt(0), C: "C".charCodeAt(0), D: "D".charCodeAt(0), E: "E".charCodeAt(0), F: "F".charCodeAt(0), G: "G".charCodeAt(0), H: "H".charCodeAt(0), I: "I".charCodeAt(0), J: "J".charCodeAt(0), K: "K".charCodeAt(0), L: "L".charCodeAt(0), M: "M".charCodeAt(0), N: "N".charCodeAt(0), O: "O".charCodeAt(0), P: "P".charCodeAt(0), Q: "Q".charCodeAt(0), R: "R".charCodeAt(0), S: "S".charCodeAt(0), T: "T".charCodeAt(0), U: "U".charCodeAt(0), V: "V".charCodeAt(0), W: "W".charCodeAt(0), X: "X".charCodeAt(0), Y: "Y".charCodeAt(0), Z: "Z".charCodeAt(0), ZERO: "0".charCodeAt(0), ONE: "1".charCodeAt(0), TWO: "2".charCodeAt(0), THREE: "3".charCodeAt(0), FOUR: "4".charCodeAt(0), FIVE: "5".charCodeAt(0), SIX: "6".charCodeAt(0), SEVEN: "7".charCodeAt(0), EIGHT: "8".charCodeAt(0), NINE: "9".charCodeAt(0), NUMPAD_0: 96, NUMPAD_1: 97, NUMPAD_2: 98, NUMPAD_3: 99, NUMPAD_4: 100, NUMPAD_5: 101, NUMPAD_6: 102, NUMPAD_7: 103, NUMPAD_8: 104, NUMPAD_9: 105, NUMPAD_MULTIPLY: 106, NUMPAD_ADD: 107, NUMPAD_ENTER: 108, NUMPAD_SUBTRACT: 109, NUMPAD_DECIMAL: 110, NUMPAD_DIVIDE: 111, F1: 112, F2: 113, F3: 114, F4: 115, F5: 116, F6: 117, F7: 118, F8: 119, F9: 120, F10: 121, F11: 122, F12: 123, F13: 124, F14: 125, F15: 126, COLON: 186, EQUALS: 187, COMMA: 188, UNDERSCORE: 189, PERIOD: 190, QUESTION_MARK: 191, TILDE: 192, OPEN_BRACKET: 219, BACKWARD_SLASH: 220, CLOSED_BRACKET: 221, QUOTES: 222, BACKSPACE: 8, TAB: 9, CLEAR: 12, ENTER: 13, SHIFT: 16, CONTROL: 17, ALT: 18, CAPS_LOCK: 20, ESC: 27, SPACEBAR: 32, PAGE_UP: 33, PAGE_DOWN: 34, END: 35, HOME: 36, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, PLUS: 43, MINUS: 44, INSERT: 45, DELETE: 46, HELP: 47, NUM_LOCK: 144 }, s.KeyCode) s.KeyCode.hasOwnProperty(h) && !h.match(/[a-z]/) && (s.Keyboard[h] = s.KeyCode[h]); for (var u in s.Component = function () { }, s.Component.Angle = function () { }, s.Component.Angle.prototype = { angle: { get: function () { return s.Math.wrapAngle(s.Math.radToDeg(this.rotation)) }, set: function (t) { this.rotation = s.Math.degToRad(s.Math.wrapAngle(t)) } } }, s.Component.Animation = function () { }, s.Component.Animation.prototype = { play: function (t, e, i, r) { if (this.animations) return this.animations.play(t, e, i, r) } }, s.Component.AutoCull = function () { }, s.Component.AutoCull.prototype = { autoCull: !1, inCamera: { get: function () { return this.autoCull || this.checkWorldBounds || (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y), this.game.world.camera.view.intersects(this._bounds) } } }, s.Component.Bounds = function () { }, s.Component.Bounds.prototype = { offsetX: { get: function () { return this.anchor.x * this.width } }, offsetY: { get: function () { return this.anchor.y * this.height } }, centerX: { get: function () { return this.x - this.offsetX + .5 * this.width }, set: function (t) { this.x = t + this.offsetX - .5 * this.width } }, centerY: { get: function () { return this.y - this.offsetY + .5 * this.height }, set: function (t) { this.y = t + this.offsetY - .5 * this.height } }, left: { get: function () { return this.x - this.offsetX }, set: function (t) { this.x = t + this.offsetX } }, right: { get: function () { return this.x + this.width - this.offsetX }, set: function (t) { this.x = t - this.width + this.offsetX } }, top: { get: function () { return this.y - this.offsetY }, set: function (t) { this.y = t + this.offsetY } }, bottom: { get: function () { return this.y + this.height - this.offsetY }, set: function (t) { this.y = t - this.height + this.offsetY } }, alignIn: function (t, e, i, r) { switch (void 0 === i && (i = 0), void 0 === r && (r = 0), e) { default: case s.TOP_LEFT: this.left = t.left - i, this.top = t.top - r; break; case s.TOP_CENTER: this.centerX = t.centerX + i, this.top = t.top - r; break; case s.TOP_RIGHT: this.right = t.right + i, this.top = t.top - r; break; case s.LEFT_CENTER: this.left = t.left - i, this.centerY = t.centerY + r; break; case s.CENTER: this.centerX = t.centerX + i, this.centerY = t.centerY + r; break; case s.RIGHT_CENTER: this.right = t.right + i, this.centerY = t.centerY + r; break; case s.BOTTOM_LEFT: this.left = t.left - i, this.bottom = t.bottom + r; break; case s.BOTTOM_CENTER: this.centerX = t.centerX + i, this.bottom = t.bottom + r; break; case s.BOTTOM_RIGHT: this.right = t.right + i, this.bottom = t.bottom + r }return this }, alignTo: function (t, e, i, r) { switch (void 0 === i && (i = 0), void 0 === r && (r = 0), e) { default: case s.TOP_LEFT: this.left = t.left - i, this.bottom = t.top - r; break; case s.TOP_CENTER: this.centerX = t.centerX + i, this.bottom = t.top - r; break; case s.TOP_RIGHT: this.right = t.right + i, this.bottom = t.top - r; break; case s.LEFT_TOP: this.right = t.left - i, this.top = t.top - r; break; case s.LEFT_CENTER: this.right = t.left - i, this.centerY = t.centerY + r; break; case s.LEFT_BOTTOM: this.right = t.left - i, this.bottom = t.bottom + r; break; case s.RIGHT_TOP: this.left = t.right + i, this.top = t.top - r; break; case s.RIGHT_CENTER: this.left = t.right + i, this.centerY = t.centerY + r; break; case s.RIGHT_BOTTOM: this.left = t.right + i, this.bottom = t.bottom + r; break; case s.BOTTOM_LEFT: this.left = t.left - i, this.top = t.bottom + r; break; case s.BOTTOM_CENTER: this.centerX = t.centerX + i, this.top = t.bottom + r; break; case s.BOTTOM_RIGHT: this.right = t.right + i, this.top = t.bottom + r }return this } }, s.Group.prototype.alignIn = s.Component.Bounds.prototype.alignIn, s.Group.prototype.alignTo = s.Component.Bounds.prototype.alignTo, s.Component.BringToTop = function () { }, s.Component.BringToTop.prototype.bringToTop = function () { return this.parent && this.parent.bringToTop(this), this }, s.Component.BringToTop.prototype.sendToBack = function () { return this.parent && this.parent.sendToBack(this), this }, s.Component.BringToTop.prototype.moveUp = function () { return this.parent && this.parent.moveUp(this), this }, s.Component.BringToTop.prototype.moveDown = function () { return this.parent && this.parent.moveDown(this), this }, s.Component.Core = function () { }, s.Component.Core.skipTypeChecks = !1, s.Component.Core.install = function (t) { s.Utils.mixinPrototype(this, s.Component.Core.prototype), this.components = {}; for (var e = 0; e < t.length; e++) { var i = t[e], r = !1; "Destroy" === i && (r = !0), s.Utils.mixinPrototype(this, s.Component[i].prototype, r), this.components[i] = !0 } }, s.Component.Core.init = function (t, e, i, r, n) { if (!s.Component.Core.skipTypeChecks) { if (!(t instanceof s.Game)) throw new Error("The value passed as the `game` argument (" + t + ") is not an instance of Phaser.Game."); "number" != typeof e && (console.warn("The `x` argument value (%s) should be a number.", e), e = 0), "number" != typeof i && (console.warn("The `y` argument value (%s) should be a number.", i), i = 0) } this.game = t, this.key = r, this.data = {}, this.position.set(e, i), this.world = new s.Point(e, i), this.previousPosition = new s.Point(e, i), this.events = new s.Events(this), this._bounds = new s.Rectangle, this.components.PhysicsBody && (this.body = this.body), this.components.Animation && (this.animations = new s.AnimationManager(this)), this.components.LoadTexture && null !== r && this.loadTexture(r, n), this.components.FixedToCamera && (this.cameraOffset = new s.Point(e, i)) }, s.Component.Core.preUpdate = function () { return this.pendingDestroy ? (this.destroy(), !1) : (this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, this.exists && this.parent.exists ? (this.world.setTo(this.game.camera.x + this.worldTransform.tx, this.game.camera.y + this.worldTransform.ty), this.visible && (this.renderOrderID = this.game.stage.currentRenderOrderID++), this.animations && this.animations.update(), this.body && this.body.preUpdate(), this.preUpdateChildren(), !0) : (this.renderOrderID = -1, !1)) }, s.Component.Core.prototype = { game: null, name: "", data: {}, components: {}, z: 0, events: void 0, animations: void 0, key: "", world: null, debug: !1, previousPosition: null, previousRotation: 0, renderOrderID: 0, fresh: !0, pendingDestroy: !1, _bounds: null, _exists: !0, exists: { get: function () { return this._exists }, set: function (t) { t ? (this._exists = !0, this.body && this.body.type === s.Physics.P2JS && this.body.addToWorld(), this.visible = !0) : (this._exists = !1, this.body && this.body.type === s.Physics.P2JS && this.body.removeFromWorld(), this.visible = !1) } }, preUpdateChildren: function () { for (var t = 0; t < this.children.length;) { var e = this.children[t]; e.preUpdate(), this === e.parent && t++ } }, update: function () { }, postUpdate: function () { this.customRender && this.key.render(), this.components.PhysicsBody && s.Component.PhysicsBody.postUpdate.call(this), this.components.FixedToCamera && s.Component.FixedToCamera.postUpdate.call(this); for (var t = 0; t < this.children.length; t++)this.children[t].postUpdate() } }, s.Component.Crop = function () { }, s.Component.Crop.prototype = { cropRect: null, _crop: null, crop: function (t, e) { void 0 === e && (e = !1), t ? (e && null !== this.cropRect ? this.cropRect.setTo(t.x, t.y, t.width, t.height) : e && null === this.cropRect ? this.cropRect = new s.Rectangle(t.x, t.y, t.width, t.height) : this.cropRect = t, this.updateCrop()) : (this._crop = null, this.cropRect = null, this.resetFrame()) }, updateCrop: function () { if (this.cropRect) { var t = this.texture.crop.x, e = this.texture.crop.y, i = this.texture.crop.width, r = this.texture.crop.height; this._crop = s.Rectangle.clone(this.cropRect, this._crop), this._crop.x += this._frame.x, this._crop.y += this._frame.y; var n = Math.max(this._frame.x, this._crop.x), o = Math.max(this._frame.y, this._crop.y), a = Math.min(this._frame.right, this._crop.right) - n, h = Math.min(this._frame.bottom, this._crop.bottom) - o; this.texture.crop.x = n, this.texture.crop.y = o, this.texture.crop.width = a, this.texture.crop.height = h, this.texture.frame.width = Math.min(a, this.cropRect.width), this.texture.frame.height = Math.min(h, this.cropRect.height), this.texture.width = this.texture.frame.width, this.texture.height = this.texture.frame.height, this.texture._updateUvs(), 16777215 === this.tint || t === n && e === o && i === a && r === h || (this.texture.requiresReTint = !0) } } }, s.Component.Delta = function () { }, s.Component.Delta.prototype = { deltaX: { get: function () { return this.world.x - this.previousPosition.x } }, deltaY: { get: function () { return this.world.y - this.previousPosition.y } }, deltaZ: { get: function () { return this.rotation - this.previousRotation } } }, s.Component.Destroy = function () { }, s.Component.Destroy.prototype = { destroyPhase: !1, destroy: function (t, e) { if (null !== this.game && !this.destroyPhase) { void 0 === t && (t = !0), void 0 === e && (e = !1), this.destroyPhase = !0, this.events && this.events.onDestroy$dispatch(this), this.parent && (this.parent instanceof s.Group ? this.parent.remove(this) : this.parent.removeChild(this)), this.input && this.input.destroy(), this.animations && this.animations.destroy(), this.body && this.body.destroy(), this.events && this.events.destroy(), this.game.tweens.removeFrom(this); var i = this.children.length; if (t) for (; i--;)this.children[i].destroy(t); else for (; i--;)this.removeChild(this.children[i]); this._crop && (this._crop = null, this.cropRect = null), this._frame && (this._frame = null), s.Video && this.key instanceof s.Video && this.key.onChangeSource.remove(this.resizeFrame, this), s.BitmapText && this._glyphs && (this._glyphs = []), this.alive = !1, this.exists = !1, this.visible = !1, this.filters = null, this.mask = null, this.game = null, this.data = {}, this.renderable = !1, this.transformCallback && (this.transformCallback = null, this.transformCallbackContext = null), this.hitArea = null, this.parent = null, this.stage = null, this.worldTransform = null, this.filterArea = null, this._bounds = null, this._currentBounds = null, this._mask = null, this._destroyCachedSprite(), e && this.texture.destroy(!0), this.destroyPhase = !1, this.pendingDestroy = !1 } } }, s.Events = function (t) { this.parent = t }, s.Events.prototype = { destroy: function () { this._parent = null, this._onDestroy && this._onDestroy.dispose(), this._onAddedToGroup && this._onAddedToGroup.dispose(), this._onRemovedFromGroup && this._onRemovedFromGroup.dispose(), this._onKilled && this._onKilled.dispose(), this._onRevived && this._onRevived.dispose(), this._onEnterBounds && this._onEnterBounds.dispose(), this._onOutOfBounds && this._onOutOfBounds.dispose(), this._onInputOver && this._onInputOver.dispose(), this._onInputOut && this._onInputOut.dispose(), this._onInputDown && this._onInputDown.dispose(), this._onInputUp && this._onInputUp.dispose(), this._onDragStart && this._onDragStart.dispose(), this._onDragUpdate && this._onDragUpdate.dispose(), this._onDragStop && this._onDragStop.dispose(), this._onAnimationStart && this._onAnimationStart.dispose(), this._onAnimationComplete && this._onAnimationComplete.dispose(), this._onAnimationLoop && this._onAnimationLoop.dispose() }, onAddedToGroup: null, onRemovedFromGroup: null, onDestroy: null, onKilled: null, onRevived: null, onOutOfBounds: null, onEnterBounds: null, onInputOver: null, onInputOut: null, onInputDown: null, onInputUp: null, onDragStart: null, onDragUpdate: null, onDragStop: null, onAnimationStart: null, onAnimationComplete: null, onAnimationLoop: null }, s.Events.prototype.constructor = s.Events, s.Events.prototype) s.Events.prototype.hasOwnProperty(u) && 0 === u.indexOf("on") && null === s.Events.prototype[u] && function (t, e) { Object.defineProperty(s.Events.prototype, t, { get: function () { return this[e] || (this[e] = new s.Signal) } }), s.Events.prototype[t + "$dispatch"] = function () { return this[e] ? this[e].dispatch.apply(this[e], arguments) : null } }(u, "_" + u); s.Component.FixedToCamera = function () { }, s.Component.FixedToCamera.postUpdate = function () { this.fixedToCamera && (this.position.x = (this.game.camera.view.x + this.cameraOffset.x) / this.game.camera.scale.x, this.position.y = (this.game.camera.view.y + this.cameraOffset.y) / this.game.camera.scale.y) }, s.Component.FixedToCamera.prototype = { _fixedToCamera: !1, fixedToCamera: { get: function () { return this._fixedToCamera }, set: function (t) { t ? (this._fixedToCamera = !0, this.cameraOffset.set(this.x, this.y)) : this._fixedToCamera = !1 } }, cameraOffset: new s.Point }, s.Component.Health = function () { }, s.Component.Health.prototype = { health: 1, maxHealth: 100, damage: function (t) { return this.alive && (this.health -= t, this.health <= 0 && this.kill()), this }, setHealth: function (t) { return this.health = t, this.health > this.maxHealth && (this.health = this.maxHealth), this }, heal: function (t) { return this.alive && (this.health += t, this.health > this.maxHealth && (this.health = this.maxHealth)), this } }, s.Component.InCamera = function () { }, s.Component.InCamera.prototype = { inCamera: { get: function () { return this.game.world.camera.view.intersects(this._bounds) } } }, s.Component.InputEnabled = function () { }, s.Component.InputEnabled.prototype = { input: null, inputEnabled: { get: function () { return this.input && this.input.enabled }, set: function (t) { t ? null === this.input ? (this.input = new s.InputHandler(this), this.input.start()) : this.input && !this.input.enabled && this.input.start() : this.input && this.input.enabled && this.input.stop() } } }, s.Component.InWorld = function () { }, s.Component.InWorld.preUpdate = function () { if (this.pendingDestroy) return this.destroy(), !1; if (this.autoCull || this.checkWorldBounds) { if (this._bounds.copyFrom(this.getBounds()), this._bounds.x += this.game.camera.view.x, this._bounds.y += this.game.camera.view.y, this.autoCull) if (this.game.world.camera.view.intersects(this._bounds)) this.renderable = !0, this.game.world.camera.totalInView++; else if (this.renderable = !1, this.outOfCameraBoundsKill) return this.kill(), !1; if (this.checkWorldBounds) if (this._outOfBoundsFired && this.game.world.bounds.intersects(this._bounds)) this._outOfBoundsFired = !1, this.events.onEnterBounds$dispatch(this); else if (!this._outOfBoundsFired && !this.game.world.bounds.intersects(this._bounds) && (this._outOfBoundsFired = !0, this.events.onOutOfBounds$dispatch(this), this.outOfBoundsKill)) return this.kill(), !1 } return !0 }, s.Component.InWorld.prototype = { checkWorldBounds: !1, outOfBoundsKill: !1, outOfCameraBoundsKill: !1, _outOfBoundsFired: !1, inWorld: { get: function () { return this.game.world.bounds.intersects(this.getBounds()) } } }, s.Component.LifeSpan = function () { }, s.Component.LifeSpan.preUpdate = function () { return this.pendingDestroy ? (this.destroy(), !1) : !(this.lifespan > 0 && (this.lifespan -= this.game.time.physicsElapsedMS, this.lifespan <= 0)) || (this.kill(), !1) }, s.Component.LifeSpan.prototype = { alive: !0, lifespan: 0, revive: function (t) { return void 0 === t && (t = 100), this.alive = !0, this.exists = !0, this.visible = !0, "function" == typeof this.setHealth && this.setHealth(t), this.events && this.events.onRevived$dispatch(this), this }, kill: function () { return this.alive = !1, this.exists = !1, this.visible = !1, this.events && this.events.onKilled$dispatch(this), this } }, s.Component.LoadTexture = function () { }, s.Component.LoadTexture.prototype = { customRender: !1, _frame: null, loadTexture: function (t, e, i) { t === s.PENDING_ATLAS ? (t = e, e = 0) : e = e || 0, (i || void 0 === i) && this.animations && this.animations.stop(), this.key = t, this.customRender = !1; var r = this.game.cache, n = !0, o = !this.texture.baseTexture.scaleMode; if (s.RenderTexture && t instanceof s.RenderTexture) this.key = t.key, this.setTexture(t); else if (s.BitmapData && t instanceof s.BitmapData) this.customRender = !0, this.setTexture(t.texture), n = r.hasFrameData(t.key, s.Cache.BITMAPDATA) ? !this.animations.loadFrameData(r.getFrameData(t.key, s.Cache.BITMAPDATA), e) : !this.animations.loadFrameData(t.frameData, 0); else if (s.Video && t instanceof s.Video) { this.customRender = !0; var a = t.texture.valid; this.setTexture(t.texture), this.setFrame(t.texture.frame.clone()), t.onChangeSource.add(this.resizeFrame, this), this.texture.valid = a } else if (s.Tilemap && t instanceof s.TilemapLayer) this.setTexture(PIXI.Texture.fromCanvas(t.canvas)); else if (t instanceof PIXI.Texture) this.setTexture(t); else { var h = r.getImage(t, !0); this.key = h.key, this.setTexture(new PIXI.Texture(h.base)), this.texture.baseTexture.skipRender = "__default" === t, n = !this.animations.loadFrameData(h.frameData, e) } n && (this._frame = s.Rectangle.clone(this.texture.frame)), o || (this.texture.baseTexture.scaleMode = 1) }, setFrame: function (t) { this._frame = t, this.texture.frame.x = t.x, this.texture.frame.y = t.y, this.texture.frame.width = t.width, this.texture.frame.height = t.height, this.texture.crop.x = t.x, this.texture.crop.y = t.y, this.texture.crop.width = t.width, this.texture.crop.height = t.height, t.trimmed ? (this.texture.trim ? (this.texture.trim.x = t.spriteSourceSizeX, this.texture.trim.y = t.spriteSourceSizeY, this.texture.trim.width = t.sourceSizeW, this.texture.trim.height = t.sourceSizeH) : this.texture.trim = { x: t.spriteSourceSizeX, y: t.spriteSourceSizeY, width: t.sourceSizeW, height: t.sourceSizeH }, this.texture.width = t.sourceSizeW, this.texture.height = t.sourceSizeH, this.texture.frame.width = t.sourceSizeW, this.texture.frame.height = t.sourceSizeH) : !t.trimmed && this.texture.trim && (this.texture.trim = null), t.rotated && (this.texture.rotated = !0), this.cropRect && this.updateCrop(), this.texture.requiresReTint = !0, this.texture._updateUvs(), this.tilingTexture && (this.refreshTexture = !0) }, resizeFrame: function (t, e, i) { this.texture.frame.resize(e, i), this.texture.setFrame(this.texture.frame) }, resetFrame: function () { this._frame && this.setFrame(this._frame) }, frame: { get: function () { return this.animations.frame }, set: function (t) { this.animations.frame = t } }, frameName: { get: function () { return this.animations.frameName }, set: function (t) { this.animations.frameName = t } } }, s.Component.Overlap = function () { }, s.Component.Overlap.prototype = { overlap: function (t) { return s.Rectangle.intersects(this.getBounds(), t.getBounds()) } }, s.Component.PhysicsBody = function () { }, s.Component.PhysicsBody.preUpdate = function () { return this.pendingDestroy ? (this.destroy(), !1) : this.fresh && this.exists ? (this.world.setTo(this.parent.position.x + this.position.x, this.parent.position.y + this.position.y), this.worldTransform.tx = this.world.x, this.worldTransform.ty = this.world.y, this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, this.body && this.body.preUpdate(), this.fresh = !1, this.preUpdateChildren(), !1) : (this.previousPosition.set(this.world.x, this.world.y), this.previousRotation = this.rotation, !(!this._exists || !this.parent.exists) || (this.renderOrderID = -1, !1)) }, s.Component.PhysicsBody.postUpdate = function () { this.exists && this.body && this.body.postUpdate() }, s.Component.PhysicsBody.prototype = { body: null, x: { get: function () { return this.position.x }, set: function (t) { this.position.x = t, this.body && !this.body.dirty && (this.body._reset = !0) } }, y: { get: function () { return this.position.y }, set: function (t) { this.position.y = t, this.body && !this.body.dirty && (this.body._reset = !0) } } }, s.Component.Reset = function () { }, s.Component.Reset.prototype.reset = function (t, e, i) { return void 0 === i && (i = 1), this.world.set(t, e), this.position.set(t, e), this.fresh = !0, this.exists = !0, this.visible = !0, this.renderable = !0, this.components.InWorld && (this._outOfBoundsFired = !1), this.components.LifeSpan && (this.alive = !0, this.health = i), this.components.PhysicsBody && this.body && this.body.reset(t, e, !1, !1), this }, s.Component.ScaleMinMax = function () { }, s.Component.ScaleMinMax.prototype = { transformCallback: null, transformCallbackContext: this, scaleMin: null, scaleMax: null, checkTransform: function (t) { this.scaleMin && (t.a < this.scaleMin.x && (t.a = this.scaleMin.x), t.d < this.scaleMin.y && (t.d = this.scaleMin.y)), this.scaleMax && (t.a > this.scaleMax.x && (t.a = this.scaleMax.x), t.d > this.scaleMax.y && (t.d = this.scaleMax.y)) }, setScaleMinMax: function (t, e, i, r) { void 0 === e ? e = i = r = t : void 0 === i && (i = r = e, e = t), null === t ? this.scaleMin = null : this.scaleMin ? this.scaleMin.set(t, e) : this.scaleMin = new s.Point(t, e), null === i ? this.scaleMax = null : this.scaleMax ? this.scaleMax.set(i, r) : this.scaleMax = new s.Point(i, r), null === this.scaleMin ? this.transformCallback = null : (this.transformCallback = this.checkTransform, this.transformCallbackContext = this) } }, s.Component.Smoothed = function () { }, s.Component.Smoothed.prototype = { smoothed: { get: function () { return !this.texture.baseTexture.scaleMode }, set: function (t) { t ? this.texture && (this.texture.baseTexture.scaleMode = 0, this.texture.baseTexture.dirty()) : this.texture && (this.texture.baseTexture.scaleMode = 1, this.texture.baseTexture.dirty()) } } }, s.GameObjectFactory = function (t) { this.game = t, this.world = this.game.world }, s.GameObjectFactory.prototype = { existing: function (t) { return this.world.add(t) }, weapon: function (t, e, i, r, n) { var o = this.game.plugins.add(s.Weapon); return n && (o.bulletClass = n), o.createBullets(t, e, i, r), o }, image: function (t, e, i, r, n) { return void 0 === n && (n = this.world), n.add(new s.Image(this.game, t, e, i, r)) }, sprite: function (t, e, i, r, n) { return void 0 === n && (n = this.world), n.add(new s.Sprite(this.game, t, e, i, r)) }, creature: function (t, e, i, r, n) { void 0 === n && (n = this.world); var o = new s.Creature(this.game, t, e, i, r); return n.add(o), o }, tween: function (t) { return this.game.tweens.create(t) }, group: function (t, e, i, r, n) { return new s.Group(this.game, t, e, i, r, n) }, physicsGroup: function (t, e, i, r) { return new s.Group(this.game, e, i, r, !0, t) }, spriteBatch: function (t, e, i) { return void 0 === t && (t = null), void 0 === e && (e = "group"), void 0 === i && (i = !1), new s.SpriteBatch(this.game, t, e, i) }, audio: function (t, e, i, r) { return this.game.sound.add(t, e, i, r) }, sound: function (t, e, i, r) { return this.game.sound.add(t, e, i, r) }, audioSprite: function (t) { return this.game.sound.addSprite(t) }, tileSprite: function (t, e, i, r, n, o, a) { return void 0 === a && (a = this.world), a.add(new s.TileSprite(this.game, t, e, i, r, n, o)) }, rope: function (t, e, i, r, n, o) { return void 0 === o && (o = this.world), o.add(new s.Rope(this.game, t, e, i, r, n)) }, text: function (t, e, i, r, n) { return void 0 === n && (n = this.world), n.add(new s.Text(this.game, t, e, i, r)) }, button: function (t, e, i, r, n, o, a, h, u, l) { return void 0 === l && (l = this.world), l.add(new s.Button(this.game, t, e, i, r, n, o, a, h, u)) }, graphics: function (t, e, i) { return void 0 === i && (i = this.world), i.add(new s.Graphics(this.game, t, e)) }, emitter: function (t, e, i) { return this.game.particles.add(new s.Particles.Arcade.Emitter(this.game, t, e, i)) }, retroFont: function (t, e, i, r, n, o, a, h, u) { return new s.RetroFont(this.game, t, e, i, r, n, o, a, h, u) }, bitmapText: function (t, e, i, r, n, o) { return void 0 === o && (o = this.world), o.add(new s.BitmapText(this.game, t, e, i, r, n)) }, tilemap: function (t, e, i, r, n) { return new s.Tilemap(this.game, t, e, i, r, n) }, renderTexture: function (t, e, i, r) { void 0 !== i && "" !== i || (i = this.game.rnd.uuid()), void 0 === r && (r = !1); var n = new s.RenderTexture(this.game, t, e, i); return r && this.game.cache.addRenderTexture(i, n), n }, video: function (t, e) { return new s.Video(this.game, t, e) }, bitmapData: function (t, e, i, r) { void 0 === r && (r = !1), void 0 !== i && "" !== i || (i = this.game.rnd.uuid()); var n = new s.BitmapData(this.game, i, t, e); return r && this.game.cache.addBitmapData(i, n), n }, filter: function (t) { var e = Array.prototype.slice.call(arguments, 1); t = new s.Filter[t](this.game); return t.init.apply(t, e), t }, plugin: function (t) { return this.game.plugins.add(t) } }, s.GameObjectFactory.prototype.constructor = s.GameObjectFactory, s.GameObjectCreator = function (t) { this.game = t, this.world = this.game.world }, s.GameObjectCreator.prototype = { image: function (t, e, i, r) { return new s.Image(this.game, t, e, i, r) }, sprite: function (t, e, i, r) { return new s.Sprite(this.game, t, e, i, r) }, tween: function (t) { return new s.Tween(t, this.game, this.game.tweens) }, group: function (t, e, i, r, n) { return new s.Group(this.game, t, e, i, r, n) }, spriteBatch: function (t, e, i) { return void 0 === e && (e = "group"), void 0 === i && (i = !1), new s.SpriteBatch(this.game, t, e, i) }, audio: function (t, e, i, r) { return this.game.sound.add(t, e, i, r) }, audioSprite: function (t) { return this.game.sound.addSprite(t) }, sound: function (t, e, i, r) { return this.game.sound.add(t, e, i, r) }, tileSprite: function (t, e, i, r, n, o) { return new s.TileSprite(this.game, t, e, i, r, n, o) }, rope: function (t, e, i, r, n) { return new s.Rope(this.game, t, e, i, r, n) }, text: function (t, e, i, r) { return new s.Text(this.game, t, e, i, r) }, button: function (t, e, i, r, n, o, a, h, u) { return new s.Button(this.game, t, e, i, r, n, o, a, h, u) }, graphics: function (t, e) { return new s.Graphics(this.game, t, e) }, emitter: function (t, e, i) { return new s.Particles.Arcade.Emitter(this.game, t, e, i) }, retroFont: function (t, e, i, r, n, o, a, h, u) { return new s.RetroFont(this.game, t, e, i, r, n, o, a, h, u) }, bitmapText: function (t, e, i, r, n, o) { return new s.BitmapText(this.game, t, e, i, r, n, o) }, tilemap: function (t, e, i, r, n) { return new s.Tilemap(this.game, t, e, i, r, n) }, renderTexture: function (t, e, i, r) { void 0 !== i && "" !== i || (i = this.game.rnd.uuid()), void 0 === r && (r = !1); var n = new s.RenderTexture(this.game, t, e, i); return r && this.game.cache.addRenderTexture(i, n), n }, bitmapData: function (t, e, i, r) { void 0 === r && (r = !1), void 0 !== i && "" !== i || (i = this.game.rnd.uuid()); var n = new s.BitmapData(this.game, i, t, e); return r && this.game.cache.addBitmapData(i, n), n }, filter: function (t) { var e = Array.prototype.slice.call(arguments, 1); t = new s.Filter[t](this.game); return t.init.apply(t, e), t } }, s.GameObjectCreator.prototype.constructor = s.GameObjectCreator, s.Sprite = function (t, e, i, r, n) { e = e || 0, i = i || 0, r = r || null, n = n || null, this.type = s.SPRITE, this.physicsType = s.SPRITE, PIXI.Sprite.call(this, s.Cache.DEFAULT), s.Component.Core.init.call(this, t, e, i, r, n) }, s.Sprite.prototype = Object.create(PIXI.Sprite.prototype), s.Sprite.prototype.constructor = s.Sprite, s.Component.Core.install.call(s.Sprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]), s.Sprite.prototype.preUpdatePhysics = s.Component.PhysicsBody.preUpdate, s.Sprite.prototype.preUpdateLifeSpan = s.Component.LifeSpan.preUpdate, s.Sprite.prototype.preUpdateInWorld = s.Component.InWorld.preUpdate, s.Sprite.prototype.preUpdateCore = s.Component.Core.preUpdate, s.Sprite.prototype.preUpdate = function () { return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore() }, s.Image = function (t, e, i, r, n) { e = e || 0, i = i || 0, r = r || null, n = n || null, this.type = s.IMAGE, PIXI.Sprite.call(this, s.Cache.DEFAULT), s.Component.Core.init.call(this, t, e, i, r, n) }, s.Image.prototype = Object.create(PIXI.Sprite.prototype), s.Image.prototype.constructor = s.Image, s.Component.Core.install.call(s.Image.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Destroy", "FixedToCamera", "InputEnabled", "LifeSpan", "LoadTexture", "Overlap", "Reset", "ScaleMinMax", "Smoothed"]), s.Image.prototype.preUpdateLifeSpan = s.Component.LifeSpan.preUpdate, s.Image.prototype.preUpdateInWorld = s.Component.InWorld.preUpdate, s.Image.prototype.preUpdateCore = s.Component.Core.preUpdate, s.Image.prototype.preUpdate = function () { return !(!this.preUpdateInWorld() || !this.preUpdateLifeSpan()) && this.preUpdateCore() }, s.Button = function (t, e, i, r, n, o, a, h, u, l) { e = e || 0, i = i || 0, r = r || null, n = n || null, o = o || this, s.Image.call(this, t, e, i, r, h), this.type = s.BUTTON, this.physicsType = s.SPRITE, this._onOverFrame = null, this._onOutFrame = null, this._onDownFrame = null, this._onUpFrame = null, this.onOverSound = null, this.onOutSound = null, this.onDownSound = null, this.onUpSound = null, this.onOverSoundMarker = "", this.onOutSoundMarker = "", this.onDownSoundMarker = "", this.onUpSoundMarker = "", this.onInputOver = new s.Signal, this.onInputOut = new s.Signal, this.onInputDown = new s.Signal, this.onInputUp = new s.Signal, this.onOverMouseOnly = !0, this.justReleasedPreventsOver = s.PointerMode.CONTACT, this.freezeFrames = !1, this.forceOut = !1, this.inputEnabled = !0, this.input.start(0, !0), this.input.useHandCursor = !0, this.setFrames(a, h, u, l), null !== n && this.onInputUp.add(n, o), this.events.onInputOver.add(this.onInputOverHandler, this), this.events.onInputOut.add(this.onInputOutHandler, this), this.events.onInputDown.add(this.onInputDownHandler, this), this.events.onInputUp.add(this.onInputUpHandler, this) }, s.Button.prototype = Object.create(s.Image.prototype), s.Button.prototype.constructor = s.Button; return s.Button.prototype.clearFrames = function () { this.setFrames(null, null, null, null) }, s.Button.prototype.setStateFrame = function (t, e, i) { var r = "_on" + t + "Frame"; null !== e ? (this[r] = e, i && this.changeStateFrame(t)) : this[r] = null }, s.Button.prototype.changeStateFrame = function (t) { if (this.freezeFrames) return !1; var e = this["_on" + t + "Frame"]; return "string" == typeof e ? (this.frameName = e, !0) : "number" == typeof e && (this.frame = e, !0) }, s.Button.prototype.setFrames = function (t, e, i, r) { this.setStateFrame("Over", t, this.input.pointerOver()), this.setStateFrame("Out", e, !this.input.pointerOver()), this.setStateFrame("Down", i, this.input.pointerDown()), this.setStateFrame("Up", r, this.input.pointerUp()) }, s.Button.prototype.setStateSound = function (t, e, i) { var r = "on" + t + "Sound", n = "on" + t + "SoundMarker"; e instanceof s.Sound || e instanceof s.AudioSprite ? (this[r] = e, this[n] = "string" == typeof i ? i : "") : (this[r] = null, this[n] = "") }, s.Button.prototype.playStateSound = function (t) { var e = this["on" + t + "Sound"]; if (e) { var i = this["on" + t + "SoundMarker"]; return e.play(i), !0 } return !1 }, s.Button.prototype.setSounds = function (t, e, i, r, n, s, o, a) { this.setStateSound("Over", t, e), this.setStateSound("Out", n, s), this.setStateSound("Down", i, r), this.setStateSound("Up", o, a) }, s.Button.prototype.setOverSound = function (t, e) { this.setStateSound("Over", t, e) }, s.Button.prototype.setOutSound = function (t, e) { this.setStateSound("Out", t, e) }, s.Button.prototype.setDownSound = function (t, e) { this.setStateSound("Down", t, e) }, s.Button.prototype.setUpSound = function (t, e) { this.setStateSound("Up", t, e) }, s.Button.prototype.onInputOverHandler = function (t, e) { e.justReleased() && (this.justReleasedPreventsOver & e.pointerMode) === e.pointerMode || (this.changeStateFrame("Over"), this.onOverMouseOnly && !e.isMouse || (this.playStateSound("Over"), this.onInputOver && this.onInputOver.dispatch(this, e))) }, s.Button.prototype.onInputOutHandler = function (t, e) { this.changeStateFrame("Out"), this.playStateSound("Out"), this.onInputOut && this.onInputOut.dispatch(this, e) }, s.Button.prototype.onInputDownHandler = function (t, e) { this.changeStateFrame("Down"), this.playStateSound("Down"), this.onInputDown && this.onInputDown.dispatch(this, e) }, s.Button.prototype.onInputUpHandler = function (t, e, i) { (this.playStateSound("Up"), this.onInputUp && this.onInputUp.dispatch(this, e, i), this.freezeFrames) || (!0 === this.forceOut || (this.forceOut & e.pointerMode) === e.pointerMode ? this.changeStateFrame("Out") : this.changeStateFrame("Up") || (i ? this.changeStateFrame("Over") : this.changeStateFrame("Out"))) }, s.SpriteBatch = function (t, e, i, r) { void 0 !== e && null !== e || (e = t.world), s.Group.call(this, t, e, i, r), this.type = s.SPRITEBATCH, this.fastSpriteBatch = null, this.ready = !1 }, s.SpriteBatch.prototype = Object.create(s.Group.prototype), s.SpriteBatch.prototype.constructor = s.SpriteBatch, s.SpriteBatch.prototype._renderWebGL = function (t) { !this.visible || this.alpha <= 0 || !this.children.length || (this.ready || (this.fastSpriteBatch = new PIXI.WebGLFastSpriteBatch(t.gl), this.ready = !0), this.fastSpriteBatch.gl !== t.gl && this.fastSpriteBatch.setContext(t.gl), t.spriteBatch.stop(), t.shaderManager.setShader(t.shaderManager.fastShader), this.fastSpriteBatch.begin(this, t), this.fastSpriteBatch.render(this), t.spriteBatch.start()) }, s.SpriteBatch.prototype._renderCanvas = function (t) { if (this.visible && !(this.alpha <= 0) && this.children.length) { var e = t.context; e.globalAlpha = this.worldAlpha, this.displayObjectUpdateTransform(); for (var i = this.worldTransform, r = !0, n = 0; n < this.children.length; n++) { var s = this.children[n]; if (s.visible) { var o = s.texture, a = o.frame; if (e.globalAlpha = this.worldAlpha * s.alpha, s.rotation % (2 * Math.PI) == 0) r && (e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), r = !1), e.drawImage(o.baseTexture.source, a.x, a.y, a.width, a.height, s.anchor.x * (-a.width * s.scale.x) + s.position.x + .5 + t.shakeX | 0, s.anchor.y * (-a.height * s.scale.y) + s.position.y + .5 + t.shakeY | 0, a.width * s.scale.x, a.height * s.scale.y); else { r || (r = !0), s.displayObjectUpdateTransform(); var h = s.worldTransform, u = h.tx * t.resolution + t.shakeX, l = h.ty * t.resolution + t.shakeY; t.roundPixels ? e.setTransform(h.a, h.b, h.c, h.d, 0 | u, 0 | l) : e.setTransform(h.a, h.b, h.c, h.d, u, l), e.drawImage(o.baseTexture.source, a.x, a.y, a.width, a.height, s.anchor.x * -a.width + .5 | 0, s.anchor.y * -a.height + .5 | 0, a.width, a.height) } } } } }, s.BitmapData = function (t, e, i, r, n) { void 0 !== i && 0 !== i || (i = 256), void 0 !== r && 0 !== r || (r = 256), void 0 === n && (n = !1), this.game = t, this.key = e, this.width = i, this.height = r, this.canvas = s.Canvas.create(this, i, r, null, n), this.context = this.canvas.getContext("2d", { alpha: !0 }), this.ctx = this.context, this.smoothProperty = t.renderType === s.CANVAS ? t.renderer.renderSession.smoothProperty : s.Canvas.getSmoothingPrefix(this.context), this.imageData = this.context.getImageData(0, 0, i, r), this.data = null, this.imageData && (this.data = this.imageData.data), this.pixels = null, this.data && (this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data), this.baseTexture = new PIXI.BaseTexture(this.canvas, null, this.game.resolution), this.texture = new PIXI.Texture(this.baseTexture), this.frameData = new s.FrameData, this.textureFrame = this.frameData.addFrame(new s.Frame(0, 0, 0, i, r, "bitmapData")), this.texture.frame = this.textureFrame, this.type = s.BITMAPDATA, this.disableTextureUpload = !1, this.dirty = !1, this.cls = this.clear, this._image = null, this._pos = new s.Point, this._size = new s.Point, this._scale = new s.Point, this._rotate = 0, this._alpha = { prev: 1, current: 1 }, this._anchor = new s.Point, this._tempR = 0, this._tempG = 0, this._tempB = 0, this._circle = new s.Circle, this._swapCanvas = void 0 }, s.BitmapData.prototype = { move: function (t, e, i) { return 0 !== t && this.moveH(t, i), 0 !== e && this.moveV(e, i), this }, moveH: function (t, e) { void 0 === e && (e = !0), void 0 === this._swapCanvas && (this._swapCanvas = s.CanvasPool.create(this, this.width, this.height)); var i = this._swapCanvas.getContext("2d"), r = this.height, n = this.canvas; if (i.clearRect(0, 0, this.width, this.height), t < 0) { t = Math.abs(t); var o = this.width - t; e && i.drawImage(n, 0, 0, t, r, o, 0, t, r), i.drawImage(n, t, 0, o, r, 0, 0, o, r) } else { o = this.width - t; e && i.drawImage(n, o, 0, t, r, 0, 0, t, r), i.drawImage(n, 0, 0, o, r, t, 0, o, r) } return this.clear(), this.copy(this._swapCanvas) }, moveV: function (t, e) { void 0 === e && (e = !0), void 0 === this._swapCanvas && (this._swapCanvas = s.CanvasPool.create(this, this.width, this.height)); var i = this._swapCanvas.getContext("2d"), r = this.width, n = this.canvas; if (i.clearRect(0, 0, this.width, this.height), t < 0) { t = Math.abs(t); var o = this.height - t; e && i.drawImage(n, 0, 0, r, t, 0, o, r, t), i.drawImage(n, 0, t, r, o, 0, 0, r, o) } else { o = this.height - t; e && i.drawImage(n, 0, o, r, t, 0, 0, r, t), i.drawImage(n, 0, 0, r, o, 0, t, r, o) } return this.clear(), this.copy(this._swapCanvas) }, add: function (t) { if (Array.isArray(t)) for (var e = 0; e < t.length; e++)t[e].loadTexture && t[e].loadTexture(this); else t.loadTexture(this); return this }, load: function (t) { if ("string" == typeof t && (t = this.game.cache.getImage(t)), t) return this.resize(t.width, t.height), this.cls(), this.draw(t), this.update(), this }, clear: function (t, e, i, r) { return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = this.width), void 0 === r && (r = this.height), this.context.clearRect(t, e, i, r), this.dirty = !0, this }, fill: function (t, e, i, r) { return void 0 === r && (r = 1), this.context.fillStyle = "rgba(" + t + "," + e + "," + i + "," + r + ")", this.context.fillRect(0, 0, this.width, this.height), this.dirty = !0, this }, generateTexture: function (t, e, i) { var r = this.game.cache, n = new Image; if (e && (n.onload = function () { var s = r.addImage(t, "", n), o = new PIXI.Texture(s.base); e.call(i || null, o), n.onload = null }), n.src = this.canvas.toDataURL("image/png"), !e) { var s = r.addImage(t, "", n); return new PIXI.Texture(s.base) } return null }, resize: function (t, e) { return t === this.width && e === this.height || (this.width = t, this.height = e, this.canvas.width = t, this.canvas.height = e, void 0 !== this._swapCanvas && (this._swapCanvas.width = t, this._swapCanvas.height = e), this.baseTexture.width = t, this.baseTexture.height = e, this.textureFrame.width = t, this.textureFrame.height = e, this.texture.width = t, this.texture.height = e, this.texture.crop.width = t, this.texture.crop.height = e, this.update(), this.dirty = !0), this }, update: function (t, e, i, r) { return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = Math.max(1, this.width)), void 0 === r && (r = Math.max(1, this.height)), this.imageData = this.context.getImageData(t, e, i, r), this.data = this.imageData.data, this.imageData.data.buffer ? (this.buffer = this.imageData.data.buffer, this.pixels = new Uint32Array(this.buffer)) : window.ArrayBuffer ? (this.buffer = new ArrayBuffer(this.imageData.data.length), this.pixels = new Uint32Array(this.buffer)) : this.pixels = this.imageData.data, this }, processPixelRGB: function (t, e, i, r, n, o) { void 0 === i && (i = 0), void 0 === r && (r = 0), void 0 === n && (n = this.width), void 0 === o && (o = this.height); for (var a = i + n, h = r + o, u = s.Color.createColor(), l = { r: 0, g: 0, b: 0, a: 0 }, c = !1, d = r; d < h; d++)for (var p = i; p < a; p++)s.Color.unpackPixel(this.getPixel32(p, d), u), !1 !== (l = t.call(e, u, p, d)) && null !== l && void 0 !== l && (this.setPixel32(p, d, l.r, l.g, l.b, l.a, !1), c = !0); return c && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), this }, processPixel: function (t, e, i, r, n, s) { void 0 === i && (i = 0), void 0 === r && (r = 0), void 0 === n && (n = this.width), void 0 === s && (s = this.height); for (var o = i + n, a = r + s, h = 0, u = 0, l = !1, c = r; c < a; c++)for (var d = i; d < o; d++)h = this.getPixel32(d, c), (u = t.call(e, h, d, c)) !== h && (this.pixels[c * this.width + d] = u, l = !0); return l && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0), this }, replaceRGB: function (t, e, i, r, n, o, a, h, u) { var l = 0, c = 0, d = this.width, p = this.height, f = s.Color.packPixel(t, e, i, r); void 0 !== u && u instanceof s.Rectangle && (l = u.x, c = u.y, d = u.width, p = u.height); for (var g = 0; g < p; g++)for (var m = 0; m < d; m++)this.getPixel32(l + m, c + g) === f && this.setPixel32(l + m, c + g, n, o, a, h, !1); return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this }, setHSL: function (t, e, i, r) { var n = t || 0 === t, o = e || 0 === e, a = i || 0 === i; if (n || o || a) { void 0 === r && (r = new s.Rectangle(0, 0, this.width, this.height)); for (var h = s.Color.createColor(), u = r.y; u < r.bottom; u++)for (var l = r.x; l < r.right; l++)s.Color.unpackPixel(this.getPixel32(l, u), h, !0), n && (h.h = t), o && (h.s = e), a && (h.l = i), s.Color.HSLtoRGB(h.h, h.s, h.l, h), this.setPixel32(l, u, h.r, h.g, h.b, h.a, !1); return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this } }, shiftHSL: function (t, e, i, r) { if (void 0 !== t && null !== t || (t = !1), void 0 !== e && null !== e || (e = !1), void 0 !== i && null !== i || (i = !1), t || e || i) { void 0 === r && (r = new s.Rectangle(0, 0, this.width, this.height)); for (var n = s.Color.createColor(), o = r.y; o < r.bottom; o++)for (var a = r.x; a < r.right; a++)s.Color.unpackPixel(this.getPixel32(a, o), n, !0), t && (n.h = this.game.math.wrap(n.h + t, 0, 1)), e && (n.s = this.game.math.clamp(n.s + e, 0, 1)), i && (n.l = this.game.math.clamp(n.l + i, 0, 1)), s.Color.HSLtoRGB(n.h, n.s, n.l, n), this.setPixel32(a, o, n.r, n.g, n.b, n.a, !1); return this.context.putImageData(this.imageData, 0, 0), this.dirty = !0, this } }, setPixel32: function (t, e, i, r, n, o, a) { return void 0 === a && (a = !0), t >= 0 && t <= this.width && e >= 0 && e <= this.height && (s.Device.LITTLE_ENDIAN ? this.pixels[e * this.width + t] = o << 24 | n << 16 | r << 8 | i : this.pixels[e * this.width + t] = i << 24 | r << 16 | n << 8 | o, a && (this.context.putImageData(this.imageData, 0, 0), this.dirty = !0)), this }, setPixel: function (t, e, i, r, n, s) { return this.setPixel32(t, e, i, r, n, 255, s) }, getPixel: function (t, e, i) { i || (i = s.Color.createColor()); var r = ~~(t + e * this.width); return r *= 4, i.r = this.data[r], i.g = this.data[++r], i.b = this.data[++r], i.a = this.data[++r], i }, getPixel32: function (t, e) { if (t >= 0 && t <= this.width && e >= 0 && e <= this.height) return this.pixels[e * this.width + t] }, getPixelRGB: function (t, e, i, r, n) { return s.Color.unpackPixel(this.getPixel32(t, e), i, r, n) }, getPixels: function (t) { return this.context.getImageData(t.x, t.y, t.width, t.height) }, getFirstPixel: function (t) { void 0 === t && (t = 0); var e = s.Color.createColor(), i = 0, r = 0, n = 1, o = !1; 1 === t ? (n = -1, r = this.height) : 3 === t && (n = -1, i = this.width); do { s.Color.unpackPixel(this.getPixel32(i, r), e), 0 === t || 1 === t ? ++i === this.width && (i = 0, ((r += n) >= this.height || r <= 0) && (o = !0)) : 2 !== t && 3 !== t || ++r === this.height && (r = 0, ((i += n) >= this.width || i <= 0) && (o = !0)) } while (0 === e.a && !o); return e.x = i, e.y = r, e }, getBounds: function (t) { return void 0 === t && (t = new s.Rectangle), t.x = this.getFirstPixel(2).x, t.x === this.width ? t.setTo(0, 0, 0, 0) : (t.y = this.getFirstPixel(0).y, t.width = this.getFirstPixel(3).x - t.x + 1, t.height = this.getFirstPixel(1).y - t.y + 1, t) }, addToWorld: function (t, e, i, r, n, s) { n = n || 1, s = s || 1; var o = this.game.add.image(t, e, this); return o.anchor.set(i, r), o.scale.set(n, s), o }, copy: function (t, e, i, r, n, o, a, h, u, l, c, d, p, f, g, m, v) { if (void 0 !== t && null !== t || (t = this), t instanceof s.RenderTexture && (t = t.getCanvas()), this._image = t, t instanceof s.Sprite || t instanceof s.Image || t instanceof s.Text || t instanceof PIXI.Sprite) this._pos.set(t.texture.crop.x, t.texture.crop.y), this._size.set(t.texture.crop.width, t.texture.crop.height), this._scale.set(t.scale.x, t.scale.y), this._anchor.set(t.anchor.x, t.anchor.y), this._rotate = t.rotation, this._alpha.current = t.alpha, t.texture instanceof s.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source, void 0 !== o && null !== o || (o = t.x), void 0 !== a && null !== a || (a = t.y), t.texture.trim && (o += t.texture.trim.x - t.anchor.x * t.texture.trim.width, a += t.texture.trim.y - t.anchor.y * t.texture.trim.height), 16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint, t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)), this._image = t.tintedTexture, this._pos.set(0)); else { if (this._pos.set(0), this._scale.set(1), this._anchor.set(0), this._rotate = 0, this._alpha.current = 1, t instanceof s.BitmapData) this._image = t.canvas; else if ("string" == typeof t) { if (null === (t = this.game.cache.getImage(t))) return; this._image = t } this._size.set(this._image.width, this._image.height) } if (void 0 !== e && null !== e || (e = 0), void 0 !== i && null !== i || (i = 0), r && (this._size.x = r), n && (this._size.y = n), void 0 !== o && null !== o || (o = e), void 0 !== a && null !== a || (a = i), void 0 !== h && null !== h || (h = this._size.x), void 0 !== u && null !== u || (u = this._size.y), "number" == typeof l && (this._rotate = l), "number" == typeof c && (this._anchor.x = c), "number" == typeof d && (this._anchor.y = d), "number" == typeof p && (this._scale.x = p), "number" == typeof f && (this._scale.y = f), "number" == typeof g && (this._alpha.current = g), void 0 === m && (m = null), void 0 === v && (v = !1), !(this._alpha.current <= 0 || 0 === this._scale.x || 0 === this._scale.y || 0 === this._size.x || 0 === this._size.y)) { var y = this.context; return this._alpha.prev = y.globalAlpha, y.save(), y.globalAlpha = this._alpha.current, m && (this.op = m), v && (o |= 0, a |= 0), y.translate(o, a), y.scale(this._scale.x, this._scale.y), y.rotate(this._rotate), y.drawImage(this._image, this._pos.x + e, this._pos.y + i, this._size.x, this._size.y, -h * this._anchor.x, -u * this._anchor.y, h, u), y.restore(), y.globalAlpha = this._alpha.prev, this.dirty = !0, this } }, copyTransform: function (t, e, i) { if (void 0 === e && (e = null), void 0 === i && (i = !1), !t.hasOwnProperty("worldTransform") || !t.worldVisible || 0 === t.worldAlpha) return this; var r = t.worldTransform; if (this._pos.set(t.texture.crop.x, t.texture.crop.y), this._size.set(t.texture.crop.width, t.texture.crop.height), 0 === r.a || 0 === r.d || 0 === this._size.x || 0 === this._size.y) return this; t.texture instanceof s.RenderTexture ? this._image = t.texture.getCanvas() : this._image = t.texture.baseTexture.source; var n = r.tx, o = r.ty; t.texture.trim && (n += t.texture.trim.x - t.anchor.x * t.texture.trim.width, o += t.texture.trim.y - t.anchor.y * t.texture.trim.height), 16777215 !== t.tint && (t.cachedTint !== t.tint && (t.cachedTint = t.tint, t.tintedTexture = PIXI.CanvasTinter.getTintedTexture(t, t.tint)), this._image = t.tintedTexture, this._pos.set(0)), i && (n |= 0, o |= 0); var a = this.context; return this._alpha.prev = a.globalAlpha, a.save(), a.globalAlpha = this._alpha.current, e && (this.op = e), a[this.smoothProperty] = t.texture.baseTexture.scaleMode === PIXI.scaleModes.LINEAR, a.setTransform(r.a, r.b, r.c, r.d, n, o), a.drawImage(this._image, this._pos.x, this._pos.y, this._size.x, this._size.y, -this._size.x * t.anchor.x, -this._size.y * t.anchor.y, this._size.x, this._size.y), a.restore(), a.globalAlpha = this._alpha.prev, this.dirty = !0, this }, copyRect: function (t, e, i, r, n, s, o) { return this.copy(t, e.x, e.y, e.width, e.height, i, r, e.width, e.height, 0, 0, 0, 1, 1, n, s, o) }, draw: function (t, e, i, r, n, s, o) { return this.copy(t, null, null, null, null, e, i, r, n, null, null, null, null, null, null, s, o) }, drawGroup: function (t, e, i) { return t.total > 0 && t.forEachExists(this.drawGroupProxy, this, e, i), this }, drawGroupProxy: function (t, e, i) { if (t.hasOwnProperty("texture") && this.copyTransform(t, e, i), t.type === s.GROUP && t.exists) this.drawGroup(t, e, i); else if (t.hasOwnProperty("children") && t.children.length > 0) for (var r = 0; r < t.children.length; r++)t.children[r].exists && this.copyTransform(t.children[r], e, i) }, drawFull: function (t, e, i) { if (!1 === t.worldVisible || 0 === t.worldAlpha || t.hasOwnProperty("exists") && !1 === t.exists) return this; if (t.type !== s.GROUP && t.type !== s.EMITTER && t.type !== s.BITMAPTEXT) if (t.type === s.GRAPHICS) { var r = t.getBounds(); this.ctx.save(), this.ctx.translate(r.x, r.y), PIXI.CanvasGraphics.renderGraphics(t, this.ctx), this.ctx.restore() } else this.copy(t, null, null, null, null, t.worldPosition.x, t.worldPosition.y, null, null, t.worldRotation, null, null, t.worldScale.x, t.worldScale.y, t.worldAlpha, e, i); if (t.children) for (var n = 0; n < t.children.length; n++)this.drawFull(t.children[n], e, i); return this }, shadow: function (t, e, i, r) { var n = this.context; return void 0 === t || null === t ? n.shadowColor = "rgba(0,0,0,0)" : (n.shadowColor = t, n.shadowBlur = e || 5, n.shadowOffsetX = i || 10, n.shadowOffsetY = r || 10), this }, alphaMask: function (t, e, i, r) { return void 0 === r || null === r ? this.draw(e).blendSourceAtop() : this.draw(e, r.x, r.y, r.width, r.height).blendSourceAtop(), void 0 === i || null === i ? this.draw(t).blendReset() : this.draw(t, i.x, i.y, i.width, i.height).blendReset(), this }, extract: function (t, e, i, r, n, s, o, a, h) { return void 0 === n && (n = 255), void 0 === s && (s = !1), void 0 === o && (o = e), void 0 === a && (a = i), void 0 === h && (h = r), s && t.resize(this.width, this.height), this.processPixelRGB(function (s, u, l) { return s.r === e && s.g === i && s.b === r && t.setPixel32(u, l, o, a, h, n, !1), !1 }, this), t.context.putImageData(t.imageData, 0, 0), t.dirty = !0, t }, rect: function (t, e, i, r, n) { return void 0 !== n && (this.context.fillStyle = n), this.context.fillRect(t, e, i, r), this }, text: function (t, e, i, r, n, s) { void 0 === e && (e = 0), void 0 === i && (i = 0), void 0 === r && (r = "14px Courier"), void 0 === n && (n = "rgb(255,255,255)"), void 0 === s && (s = !0); var o = this.context, a = o.font; return o.font = r, s && (o.fillStyle = "rgb(0,0,0)", o.fillText(t, e + 1, i + 1)), o.fillStyle = n, o.fillText(t, e, i), o.font = a, this }, circle: function (t, e, i, r) { var n = this.context; return void 0 !== r && (n.fillStyle = r), n.beginPath(), n.arc(t, e, i, 0, 2 * Math.PI, !1), n.closePath(), n.fill(), this }, line: function (t, e, i, r, n, s) { void 0 === n && (n = "#fff"), void 0 === s && (s = 1); var o = this.context; return o.beginPath(), o.moveTo(t, e), o.lineTo(i, r), o.lineWidth = s, o.strokeStyle = n, o.stroke(), o.closePath(), this }, polygon: function (t, e, i, r) { void 0 === r && (r = "#fff"), void 0 === i && (i = 0); var n = this.context; e && (n.fillStyle = e), i && (n.lineWidth = i, n.strokeStyle = r), n.beginPath(), n.moveTo(t[0].x, t[0].y); for (var s = 1, o = t.length; s < o; s++) { var a = t[s]; n.lineTo(a.x, a.y) } return n.closePath(), e && n.fill(), i && n.stroke(), this }, textureLine: function (t, e, i) { if (void 0 === i && (i = "repeat-x"), "string" != typeof e || (e = this.game.cache.getImage(e))) { var r = t.length; "no-repeat" === i && r > e.width && (r = e.width); var n = this.context; return n.fillStyle = n.createPattern(e, i), this._circle = new s.Circle(t.start.x, t.start.y, e.height), this._circle.circumferencePoint(t.angle - 1.5707963267948966, !1, this._pos), n.save(), n.translate(this._pos.x, this._pos.y), n.rotate(t.angle), n.fillRect(0, 0, r, e.height), n.restore(), this.dirty = !0, this } }, render: function () { return !this.disableTextureUpload && this.dirty && (this.baseTexture.dirty(), this.dirty = !1), this }, destroy: function () { this.frameData.destroy(), this.texture.destroy(!0), s.CanvasPool.remove(this) }, blendReset: function () { return this.op = "source-over", this }, blendSourceOver: function () { return this.op = "source-over", this }, blendSourceIn: function () { return this.op = "source-in", this }, blendSourceOut: function () { return this.op = "source-out", this }, blendSourceAtop: function () { return this.op = "source-atop", this }, blendDestinationOver: function () { return this.op = "destination-over", this }, blendDestinationIn: function () { return this.op = "destination-in", this }, blendDestinationOut: function () { return this.op = "destination-out", this }, blendDestinationAtop: function () { return this.op = "destination-atop", this }, blendXor: function () { return this.op = "xor", this }, blendAdd: function () { return this.op = "lighter", this }, blendMultiply: function () { return this.op = "multiply", this }, blendScreen: function () { return this.op = "screen", this }, blendOverlay: function () { return this.op = "overlay", this }, blendDarken: function () { return this.op = "darken", this }, blendLighten: function () { return this.op = "lighten", this }, blendColorDodge: function () { return this.op = "color-dodge", this }, blendColorBurn: function () { return this.op = "color-burn", this }, blendHardLight: function () { return this.op = "hard-light", this }, blendSoftLight: function () { return this.op = "soft-light", this }, blendDifference: function () { return this.op = "difference", this }, blendExclusion: function () { return this.op = "exclusion", this }, blendHue: function () { return this.op = "hue", this }, blendSaturation: function () { return this.op = "saturation", this }, blendColor: function () { return this.op = "color", this }, blendLuminosity: function () { return this.op = "luminosity", this }, copyBitmapData: function (t, e, i) { t.update(); for (var r, n = 0; n < t.height; n++) { r = (i + n) * this.width + e; for (var s = 0; s < t.width; s++)this.pixels[r + s] = t.pixels[n * t.width + s] } return this } }, Object.defineProperty(s.BitmapData.prototype, "smoothed", { get: function () { s.Canvas.getSmoothingEnabled(this.context) }, set: function (t) { s.Canvas.setSmoothingEnabled(this.context, t) } }), Object.defineProperty(s.BitmapData.prototype, "op", { get: function () { return this.context.globalCompositeOperation }, set: function (t) { this.context.globalCompositeOperation = t } }), s.BitmapData.getTransform = function (t, e, i, r, n, s) { return "number" != typeof t && (t = 0), "number" != typeof e && (e = 0), "number" != typeof i && (i = 1), "number" != typeof r && (r = 1), "number" != typeof n && (n = 0), "number" != typeof s && (s = 0), { sx: i, sy: r, scaleX: i, scaleY: r, skewX: n, skewY: s, translateX: t, translateY: e, tx: t, ty: e } }, s.BitmapData.prototype.constructor = s.BitmapData, s.EarCut = {}, s.EarCut.Triangulate = function (t, e, i) { i = i || 2; var r, n, o, a, h, u, l, c = e && e.length, d = c ? e[0] * i : t.length, p = s.EarCut.linkedList(t, 0, d, i, !0), f = []; if (!p) return f; if (c && (p = s.EarCut.eliminateHoles(t, e, p, i)), t.length > 80 * i) { r = o = t[0], n = a = t[1]; for (var g = i; g < d; g += i)h = t[g], u = t[g + 1], h < r && (r = h), u < n && (n = u), h > o && (o = h), u > a && (a = u); l = Math.max(o - r, a - n) } return s.EarCut.earcutLinked(p, f, i, r, n, l), f }, s.EarCut.linkedList = function (t, e, i, r, n) { var o, a, h, u = 0; for (o = e, a = i - r; o < i; o += r)u += (t[a] - t[o]) * (t[o + 1] + t[a + 1]), a = o; if (n === u > 0) for (o = e; o < i; o += r)h = s.EarCut.insertNode(o, t[o], t[o + 1], h); else for (o = i - r; o >= e; o -= r)h = s.EarCut.insertNode(o, t[o], t[o + 1], h); return h }, s.EarCut.filterPoints = function (t, e) { if (!t) return t; e || (e = t); var i, r = t; do { if (i = !1, r.steiner || !s.EarCut.equals(r, r.next) && 0 !== s.EarCut.area(r.prev, r, r.next)) r = r.next; else { if (s.EarCut.removeNode(r), (r = e = r.prev) === r.next) return null; i = !0 } } while (i || r !== e); return e }, s.EarCut.earcutLinked = function (t, e, i, r, n, o, a) { if (t) { !a && o && s.EarCut.indexCurve(t, r, n, o); for (var h, u, l = t; t.prev !== t.next;)if (h = t.prev, u = t.next, o ? s.EarCut.isEarHashed(t, r, n, o) : s.EarCut.isEar(t)) e.push(h.i / i), e.push(t.i / i), e.push(u.i / i), s.EarCut.removeNode(t), t = u.next, l = u.next; else if ((t = u) === l) { a ? 1 === a ? (t = s.EarCut.cureLocalIntersections(t, e, i), s.EarCut.earcutLinked(t, e, i, r, n, o, 2)) : 2 === a && s.EarCut.splitEarcut(t, e, i, r, n, o) : s.EarCut.earcutLinked(s.EarCut.filterPoints(t), e, i, r, n, o, 1); break } } }, s.EarCut.isEar = function (t) { var e = t.prev, i = t, r = t.next; if (s.EarCut.area(e, i, r) >= 0) return !1; for (var n = t.next.next; n !== t.prev;) { if (s.EarCut.pointInTriangle(e.x, e.y, i.x, i.y, r.x, r.y, n.x, n.y) && s.EarCut.area(n.prev, n, n.next) >= 0) return !1; n = n.next } return !0 }, s.EarCut.isEarHashed = function (t, e, i, r) { var n = t.prev, o = t, a = t.next; if (s.EarCut.area(n, o, a) >= 0) return !1; for (var h = n.x < o.x ? n.x < a.x ? n.x : a.x : o.x < a.x ? o.x : a.x, u = n.y < o.y ? n.y < a.y ? n.y : a.y : o.y < a.y ? o.y : a.y, l = n.x > o.x ? n.x > a.x ? n.x : a.x : o.x > a.x ? o.x : a.x, c = n.y > o.y ? n.y > a.y ? n.y : a.y : o.y > a.y ? o.y : a.y, d = s.EarCut.zOrder(h, u, e, i, r), p = s.EarCut.zOrder(l, c, e, i, r), f = t.nextZ; f && f.z <= p;) { if (f !== t.prev && f !== t.next && s.EarCut.pointInTriangle(n.x, n.y, o.x, o.y, a.x, a.y, f.x, f.y) && s.EarCut.area(f.prev, f, f.next) >= 0) return !1; f = f.nextZ } for (f = t.prevZ; f && f.z >= d;) { if (f !== t.prev && f !== t.next && s.EarCut.pointInTriangle(n.x, n.y, o.x, o.y, a.x, a.y, f.x, f.y) && s.EarCut.area(f.prev, f, f.next) >= 0) return !1; f = f.prevZ } return !0 }, s.EarCut.cureLocalIntersections = function (t, e, i) { var r = t; do { var n = r.prev, o = r.next.next; s.EarCut.intersects(n, r, r.next, o) && s.EarCut.locallyInside(n, o) && s.EarCut.locallyInside(o, n) && (e.push(n.i / i), e.push(r.i / i), e.push(o.i / i), s.EarCut.removeNode(r), s.EarCut.removeNode(r.next), r = t = o), r = r.next } while (r !== t); return r }, s.EarCut.splitEarcut = function (t, e, i, r, n, o) { var a = t; do { for (var h = a.next.next; h !== a.prev;) { if (a.i !== h.i && s.EarCut.isValidDiagonal(a, h)) { var u = s.EarCut.splitPolygon(a, h); return a = s.EarCut.filterPoints(a, a.next), u = s.EarCut.filterPoints(u, u.next), s.EarCut.earcutLinked(a, e, i, r, n, o), void s.EarCut.earcutLinked(u, e, i, r, n, o) } h = h.next } a = a.next } while (a !== t) }, s.EarCut.eliminateHoles = function (t, e, i, r) { var n, o, a, h, u, l = []; for (n = 0, o = e.length; n < o; n++)a = e[n] * r, h = n < o - 1 ? e[n + 1] * r : t.length, (u = s.EarCut.linkedList(t, a, h, r, !1)) === u.next && (u.steiner = !0), l.push(s.EarCut.getLeftmost(u)); for (l.sort(compareX), n = 0; n < l.length; n++)s.EarCut.eliminateHole(l[n], i), i = s.EarCut.filterPoints(i, i.next); return i }, s.EarCut.compareX = function (t, e) { return t.x - e.x }, s.EarCut.eliminateHole = function (t, e) { if (e = s.EarCut.findHoleBridge(t, e)) { var i = s.EarCut.splitPolygon(e, t); s.EarCut.filterPoints(i, i.next) } }, s.EarCut.findHoleBridge = function (t, e) { var i, r = e, n = t.x, o = t.y, a = -1 / 0; do { if (o <= r.y && o >= r.next.y) { var h = r.x + (o - r.y) * (r.next.x - r.x) / (r.next.y - r.y); h <= n && h > a && (a = h, i = r.x < r.next.x ? r : r.next) } r = r.next } while (r !== e); if (!i) return null; if (t.x === i.x) return i.prev; var u, l = i, c = 1 / 0; for (r = i.next; r !== l;)n >= r.x && r.x >= i.x && s.EarCut.pointInTriangle(o < i.y ? n : a, o, i.x, i.y, o < i.y ? a : n, o, r.x, r.y) && ((u = Math.abs(o - r.y) / (n - r.x)) < c || u === c && r.x > i.x) && s.EarCut.locallyInside(r, t) && (i = r, c = u), r = r.next; return i }, s.EarCut.indexCurve = function (t, e, i, r) { var n = t; do { null === n.z && (n.z = s.EarCut.zOrder(n.x, n.y, e, i, r)), n.prevZ = n.prev, n.nextZ = n.next, n = n.next } while (n !== t); n.prevZ.nextZ = null, n.prevZ = null, s.EarCut.sortLinked(n) }, s.EarCut.sortLinked = function (t) { var e, i, r, n, s, o, a, h, u = 1; do { for (i = t, t = null, s = null, o = 0; i;) { for (o++ , r = i, a = 0, e = 0; e < u && (a++ , r = r.nextZ); e++); for (h = u; a > 0 || h > 0 && r;)0 === a ? (n = r, r = r.nextZ, h--) : 0 !== h && r ? i.z <= r.z ? (n = i, i = i.nextZ, a--) : (n = r, r = r.nextZ, h--) : (n = i, i = i.nextZ, a--), s ? s.nextZ = n : t = n, n.prevZ = s, s = n; i = r } s.nextZ = null, u *= 2 } while (o > 1); return t }, s.EarCut.zOrder = function (t, e, i, r, n) { return (t = 1431655765 & ((t = 858993459 & ((t = 252645135 & ((t = 16711935 & ((t = 32767 * (t - i) / n) | t << 8)) | t << 4)) | t << 2)) | t << 1)) | (e = 1431655765 & ((e = 858993459 & ((e = 252645135 & ((e = 16711935 & ((e = 32767 * (e - r) / n) | e << 8)) | e << 4)) | e << 2)) | e << 1)) << 1 }, s.EarCut.getLeftmost = function (t) { var e = t, i = t; do { e.x < i.x && (i = e), e = e.next } while (e !== t); return i }, s.EarCut.pointInTriangle = function (t, e, i, r, n, s, o, a) { return (n - o) * (e - a) - (t - o) * (s - a) >= 0 && (t - o) * (r - a) - (i - o) * (e - a) >= 0 && (i - o) * (s - a) - (n - o) * (r - a) >= 0 }, s.EarCut.isValidDiagonal = function (t, e) { return s.EarCut.equals(t, e) || t.next.i !== e.i && t.prev.i !== e.i && !s.EarCut.intersectsPolygon(t, e) && s.EarCut.locallyInside(t, e) && s.EarCut.locallyInside(e, t) && s.EarCut.middleInside(t, e) }, s.EarCut.area = function (t, e, i) { return (e.y - t.y) * (i.x - e.x) - (e.x - t.x) * (i.y - e.y) }, s.EarCut.equals = function (t, e) { return t.x === e.x && t.y === e.y }, s.EarCut.intersects = function (t, e, i, r) { return s.EarCut.area(t, e, i) > 0 != s.EarCut.area(t, e, r) > 0 && s.EarCut.area(i, r, t) > 0 != s.EarCut.area(i, r, e) > 0 }, s.EarCut.intersectsPolygon = function (t, e) { var i = t; do { if (i.i !== t.i && i.next.i !== t.i && i.i !== e.i && i.next.i !== e.i && s.EarCut.intersects(i, i.next, t, e)) return !0; i = i.next } while (i !== t); return !1 }, s.EarCut.locallyInside = function (t, e) { return s.EarCut.area(t.prev, t, t.next) < 0 ? s.EarCut.area(t, e, t.next) >= 0 && s.EarCut.area(t, t.prev, e) >= 0 : s.EarCut.area(t, e, t.prev) < 0 || s.EarCut.area(t, t.next, e) < 0 }, s.EarCut.middleInside = function (t, e) { var i = t, r = !1, n = (t.x + e.x) / 2, s = (t.y + e.y) / 2; do { i.y > s != i.next.y > s && n < (i.next.x - i.x) * (s - i.y) / (i.next.y - i.y) + i.x && (r = !r), i = i.next } while (i !== t); return r }, s.EarCut.splitPolygon = function (t, e) { var i = new s.EarCut.Node(t.i, t.x, t.y), r = new s.EarCut.Node(e.i, e.x, e.y), n = t.next, o = e.prev; return t.next = e, e.prev = t, i.next = n, n.prev = i, r.next = i, i.prev = r, o.next = r, r.prev = o, r }, s.EarCut.insertNode = function (t, e, i, r) { var n = new s.EarCut.Node(t, e, i); return r ? (n.next = r.next, n.prev = r, r.next.prev = n, r.next = n) : (n.prev = n, n.next = n), n }, s.EarCut.removeNode = function (t) { t.next.prev = t.prev, t.prev.next = t.next, t.prevZ && (t.prevZ.nextZ = t.nextZ), t.nextZ && (t.nextZ.prevZ = t.prevZ) }, s.EarCut.Node = function (t, e, i) { this.i = t, this.x = e, this.y = i, this.prev = null, this.next = null, this.z = null, this.prevZ = null, this.nextZ = null, this.steiner = !1 }, PIXI.WebGLGraphics = function () { }, PIXI.WebGLGraphics.stencilBufferLimit = 6, PIXI.WebGLGraphics.renderGraphics = function (t, e) { var i, r = e.gl, n = e.projection, o = e.offset, a = e.shaderManager.primitiveShader; t.dirty && PIXI.WebGLGraphics.updateGraphics(t, r); var h = t._webGL[r.id]; if (h) for (var u = 0; u < h.data.length; u++)1 === h.data[u].mode ? (i = h.data[u], e.stencilManager.pushStencil(t, i, e), r.drawElements(r.TRIANGLE_FAN, 4, r.UNSIGNED_SHORT, 2 * (i.indices.length - 4)), e.stencilManager.popStencil(t, i, e)) : (i = h.data[u], e.shaderManager.setShader(a), a = e.shaderManager.primitiveShader, r.uniformMatrix3fv(a.translationMatrix, !1, t.worldTransform.toArray(!0)), r.uniform1f(a.flipY, 1), r.uniform2f(a.projectionVector, n.x, -n.y), r.uniform2f(a.offsetVector, -o.x, -o.y), r.uniform3fv(a.tintColor, s.Color.hexToRGBArray(t.tint)), r.uniform1f(a.alpha, t.worldAlpha), r.bindBuffer(r.ARRAY_BUFFER, i.buffer), r.vertexAttribPointer(a.aVertexPosition, 2, r.FLOAT, !1, 24, 0), r.vertexAttribPointer(a.colorAttribute, 4, r.FLOAT, !1, 24, 8), r.bindBuffer(r.ELEMENT_ARRAY_BUFFER, i.indexBuffer), r.drawElements(r.TRIANGLE_STRIP, i.indices.length, r.UNSIGNED_SHORT, 0)) }, PIXI.WebGLGraphics.updateGraphics = function (t, e) { var i, r, n = t._webGL[e.id]; if (n || (n = t._webGL[e.id] = { lastIndex: 0, data: [], gl: e }), t.dirty = !1, t.clearDirty) { for (t.clearDirty = !1, i = 0; i < n.data.length; i++) { var o = n.data[i]; o.reset(), PIXI.WebGLGraphics.graphicsDataPool.push(o) } n.data = [], n.lastIndex = 0 } for (i = n.lastIndex; i < t.graphicsData.length; i++) { var a = t.graphicsData[i]; if (a.type === s.POLYGON) { if (a.points = a.shape.points.slice(), a.shape.closed && (a.points[0] === a.points[a.points.length - 2] && a.points[1] === a.points[a.points.length - 1] || a.points.push(a.points[0], a.points[1])), a.fill) if (a.points.length >= PIXI.WebGLGraphics.stencilBufferLimit) if (a.points.length < 2 * PIXI.WebGLGraphics.stencilBufferLimit) r = PIXI.WebGLGraphics.switchMode(n, 0), PIXI.WebGLGraphics.buildPoly(a, r) || (r = PIXI.WebGLGraphics.switchMode(n, 1), PIXI.WebGLGraphics.buildComplexPoly(a, r)); else r = PIXI.WebGLGraphics.switchMode(n, 1), PIXI.WebGLGraphics.buildComplexPoly(a, r); a.lineWidth > 0 && (r = PIXI.WebGLGraphics.switchMode(n, 0), PIXI.WebGLGraphics.buildLine(a, r)) } else r = PIXI.WebGLGraphics.switchMode(n, 0), a.type === s.RECTANGLE ? PIXI.WebGLGraphics.buildRectangle(a, r) : a.type === s.CIRCLE || a.type === s.ELLIPSE ? PIXI.WebGLGraphics.buildCircle(a, r) : a.type === s.ROUNDEDRECTANGLE && PIXI.WebGLGraphics.buildRoundedRectangle(a, r); n.lastIndex++ } for (i = 0; i < n.data.length; i++)(r = n.data[i]).dirty && r.upload() }, PIXI.WebGLGraphics.switchMode = function (t, e) { var i; return t.data.length && (i = t.data[t.data.length - 1]).mode === e && 1 !== e || ((i = PIXI.WebGLGraphics.graphicsDataPool.pop() || new PIXI.WebGLGraphicsData(t.gl)).mode = e, t.data.push(i)), i.dirty = !0, i }, PIXI.WebGLGraphics.buildRectangle = function (t, e) { var i = t.shape, r = i.x, n = i.y, o = i.width, a = i.height; if (t.fill) { var h = s.Color.hexToRGBArray(t.fillColor), u = t.fillAlpha, l = h[0] * u, c = h[1] * u, d = h[2] * u, p = e.points, f = e.indices, g = p.length / 6; p.push(r, n), p.push(l, c, d, u), p.push(r + o, n), p.push(l, c, d, u), p.push(r, n + a), p.push(l, c, d, u), p.push(r + o, n + a), p.push(l, c, d, u), f.push(g, g, g + 1, g + 2, g + 3, g + 3) } if (t.lineWidth) { var m = t.points; t.points = [r, n, r + o, n, r + o, n + a, r, n + a, r, n], PIXI.WebGLGraphics.buildLine(t, e), t.points = m } }, PIXI.WebGLGraphics.buildRoundedRectangle = function (t, e) { var i = t.shape, r = i.x, n = i.y, o = i.width, a = i.height, h = i.radius, u = []; if (u.push(r, n + h), u = (u = (u = (u = u.concat(PIXI.WebGLGraphics.quadraticBezierCurve(r, n + a - h, r, n + a, r + h, n + a))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(r + o - h, n + a, r + o, n + a, r + o, n + a - h))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(r + o, n + h, r + o, n, r + o - h, n))).concat(PIXI.WebGLGraphics.quadraticBezierCurve(r + h, n, r, n, r, n + h)), t.fill) { var l = s.Color.hexToRGBArray(t.fillColor), c = t.fillAlpha, d = l[0] * c, p = l[1] * c, f = l[2] * c, g = e.points, m = e.indices, v = g.length / 6, y = s.EarCut.Triangulate(u, null, 2), x = 0; for (x = 0; x < y.length; x += 3)m.push(y[x] + v), m.push(y[x] + v), m.push(y[x + 1] + v), m.push(y[x + 2] + v), m.push(y[x + 2] + v); for (x = 0; x < u.length; x++)g.push(u[x], u[++x], d, p, f, c) } if (t.lineWidth) { var _ = t.points; t.points = u, PIXI.WebGLGraphics.buildLine(t, e), t.points = _ } }, PIXI.WebGLGraphics.quadraticBezierCurve = function (t, e, i, r, n, s) { var o, a, h, u, l, c, d = []; function p(t, e, i) { return t + (e - t) * i } for (var f = 0, g = 0; g <= 20; g++)o = p(t, i, f = g / 20), a = p(e, r, f), h = p(i, n, f), u = p(r, s, f), l = p(o, h, f), c = p(a, u, f), d.push(l, c); return d }, PIXI.WebGLGraphics.buildCircle = function (t, e) { var i, r, n = t.shape, o = n.x, a = n.y; t.type === s.CIRCLE ? (i = n.radius, r = n.radius) : (i = n.width, r = n.height); var h = 2 * Math.PI / 40, u = 0; if (t.fill) { var l = s.Color.hexToRGBArray(t.fillColor), c = t.fillAlpha, d = l[0] * c, p = l[1] * c, f = l[2] * c, g = e.points, m = e.indices, v = g.length / 6; for (m.push(v), u = 0; u < 41; u++)g.push(o, a, d, p, f, c), g.push(o + Math.sin(h * u) * i, a + Math.cos(h * u) * r, d, p, f, c), m.push(v++, v++); m.push(v - 1) } if (t.lineWidth) { var y = t.points; for (t.points = [], u = 0; u < 41; u++)t.points.push(o + Math.sin(h * u) * i, a + Math.cos(h * u) * r); PIXI.WebGLGraphics.buildLine(t, e), t.points = y } }, PIXI.WebGLGraphics.buildLine = function (t, e) { var i = 0, r = t.points; if (0 !== r.length) { if (t.lineWidth % 2) for (i = 0; i < r.length; i++)r[i] += .5; var n = new PIXI.Point(r[0], r[1]), o = new PIXI.Point(r[r.length - 2], r[r.length - 1]); if (n.x === o.x && n.y === o.y) { (r = r.slice()).pop(), r.pop(); var a = (o = new PIXI.Point(r[r.length - 2], r[r.length - 1])).x + .5 * (n.x - o.x), h = o.y + .5 * (n.y - o.y); r.unshift(a, h), r.push(a, h) } var u, l, c, d, p, f, g, m, v, y, x, _, b, T, w, S, C, P, E, A, R, M, L = e.points, I = e.indices, O = r.length / 2, D = r.length, F = L.length / 6, k = t.lineWidth / 2, B = s.Color.hexToRGBArray(t.lineColor), U = t.lineAlpha, G = B[0] * U, N = B[1] * U, X = B[2] * U; for (c = r[0], d = r[1], p = r[2], v = -(d - (f = r[3])), y = c - p, v /= M = Math.sqrt(v * v + y * y), y /= M, v *= k, y *= k, L.push(c - v, d - y, G, N, X, U), L.push(c + v, d + y, G, N, X, U), i = 1; i < O - 1; i++)c = r[2 * (i - 1)], d = r[2 * (i - 1) + 1], p = r[2 * i], f = r[2 * i + 1], g = r[2 * (i + 1)], m = r[2 * (i + 1) + 1], v = -(d - f), y = c - p, v /= M = Math.sqrt(v * v + y * y), y /= M, v *= k, y *= k, x = -(f - m), _ = p - g, x /= M = Math.sqrt(x * x + _ * _), _ /= M, C = (-v + c) * (-y + f) - (-v + p) * (-y + d), A = (-(x *= k) + g) * (-(_ *= k) + f) - (-x + p) * (-_ + m), R = (w = -y + d - (-y + f)) * (E = -x + p - (-x + g)) - (P = -_ + m - (-_ + f)) * (S = -v + p - (-v + c)), Math.abs(R) < .1 ? (R += 10.1, L.push(p - v, f - y, G, N, X, U), L.push(p + v, f + y, G, N, X, U)) : ((u = (S * A - E * C) / R) - p) * (u - p) + ((l = (P * C - w * A) / R) - f) + (l - f) > 19600 ? (b = v - x, T = y - _, b /= M = Math.sqrt(b * b + T * T), T /= M, b *= k, T *= k, L.push(p - b, f - T), L.push(G, N, X, U), L.push(p + b, f + T), L.push(G, N, X, U), L.push(p - b, f - T), L.push(G, N, X, U), D++) : (L.push(u, l), L.push(G, N, X, U), L.push(p - (u - p), f - (l - f)), L.push(G, N, X, U)); for (c = r[2 * (O - 2)], d = r[2 * (O - 2) + 1], p = r[2 * (O - 1)], v = -(d - (f = r[2 * (O - 1) + 1])), y = c - p, v /= M = Math.sqrt(v * v + y * y), y /= M, v *= k, y *= k, L.push(p - v, f - y), L.push(G, N, X, U), L.push(p + v, f + y), L.push(G, N, X, U), I.push(F), i = 0; i < D; i++)I.push(F++); I.push(F - 1) } }, PIXI.WebGLGraphics.buildComplexPoly = function (t, e) { var i = t.points.slice(); if (!(i.length < 6)) { var r = e.indices; e.points = i, e.alpha = t.fillAlpha, e.color = s.Color.hexToRGBArray(t.fillColor); for (var n, o, a = 1 / 0, h = -1 / 0, u = 1 / 0, l = -1 / 0, c = 0; c < i.length; c += 2)n = i[c], o = i[c + 1], a = n < a ? n : a, h = n > h ? n : h, u = o < u ? o : u, l = o > l ? o : l; i.push(a, u, h, u, h, l, a, l); var d = i.length / 2; for (c = 0; c < d; c++)r.push(c) } }, PIXI.WebGLGraphics.buildPoly = function (t, e) { var i = t.points; if (!(i.length < 6)) { var r = e.points, n = e.indices, o = i.length / 2, a = s.Color.hexToRGBArray(t.fillColor), h = t.fillAlpha, u = a[0] * h, l = a[1] * h, c = a[2] * h, d = s.EarCut.Triangulate(i, null, 2); if (!d) return !1; var p = r.length / 6, f = 0; for (f = 0; f < d.length; f += 3)n.push(d[f] + p), n.push(d[f] + p), n.push(d[f + 1] + p), n.push(d[f + 2] + p), n.push(d[f + 2] + p); for (f = 0; f < o; f++)r.push(i[2 * f], i[2 * f + 1], u, l, c, h); return !0 } }, PIXI.WebGLGraphics.graphicsDataPool = [], PIXI.WebGLGraphicsData = function (t) { this.gl = t, this.color = [0, 0, 0], this.points = [], this.indices = [], this.buffer = t.createBuffer(), this.indexBuffer = t.createBuffer(), this.mode = 1, this.alpha = 1, this.dirty = !0 }, PIXI.WebGLGraphicsData.prototype.reset = function () { this.points = [], this.indices = [] }, PIXI.WebGLGraphicsData.prototype.upload = function () { var t = this.gl; this.glPoints = new Float32Array(this.points), t.bindBuffer(t.ARRAY_BUFFER, this.buffer), t.bufferData(t.ARRAY_BUFFER, this.glPoints, t.STATIC_DRAW), this.glIndicies = new Uint16Array(this.indices), t.bindBuffer(t.ELEMENT_ARRAY_BUFFER, this.indexBuffer), t.bufferData(t.ELEMENT_ARRAY_BUFFER, this.glIndicies, t.STATIC_DRAW), this.dirty = !1 }, PIXI.CanvasGraphics = function () { }, PIXI.CanvasGraphics.renderGraphics = function (t, e) { var i = t.worldAlpha; t.dirty && (this.updateGraphicsTint(t), t.dirty = !1); for (var r = 0; r < t.graphicsData.length; r++) { var n = t.graphicsData[r], o = n.shape, a = n._fillTint, h = n._lineTint; if (e.lineWidth = n.lineWidth, n.type === s.POLYGON) { e.beginPath(); var u = o.points; e.moveTo(u[0], u[1]); for (var l = 1; l < u.length / 2; l++)e.lineTo(u[2 * l], u[2 * l + 1]); o.closed && e.lineTo(u[0], u[1]), u[0] === u[u.length - 2] && u[1] === u[u.length - 1] && e.closePath(), n.fill && (e.globalAlpha = n.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), n.lineWidth && (e.globalAlpha = n.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke()) } else if (n.type === s.RECTANGLE) (n.fillColor || 0 === n.fillColor) && (e.globalAlpha = n.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fillRect(o.x, o.y, o.width, o.height)), n.lineWidth && (e.globalAlpha = n.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.strokeRect(o.x, o.y, o.width, o.height)); else if (n.type === s.CIRCLE) e.beginPath(), e.arc(o.x, o.y, o.radius, 0, 2 * Math.PI), e.closePath(), n.fill && (e.globalAlpha = n.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), n.lineWidth && (e.globalAlpha = n.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke()); else if (n.type === s.ELLIPSE) { var c = 2 * o.width, d = 2 * o.height, p = o.x - c / 2, f = o.y - d / 2; e.beginPath(); var g = c / 2 * .5522848, m = d / 2 * .5522848, v = p + c, y = f + d, x = p + c / 2, _ = f + d / 2; e.moveTo(p, _), e.bezierCurveTo(p, _ - m, x - g, f, x, f), e.bezierCurveTo(x + g, f, v, _ - m, v, _), e.bezierCurveTo(v, _ + m, x + g, y, x, y), e.bezierCurveTo(x - g, y, p, _ + m, p, _), e.closePath(), n.fill && (e.globalAlpha = n.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), n.lineWidth && (e.globalAlpha = n.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke()) } else if (n.type === s.ROUNDEDRECTANGLE) { var b = o.x, T = o.y, w = o.width, S = o.height, C = o.radius, P = Math.min(w, S) / 2 | 0; C = C > P ? P : C, e.beginPath(), e.moveTo(b, T + C), e.lineTo(b, T + S - C), e.quadraticCurveTo(b, T + S, b + C, T + S), e.lineTo(b + w - C, T + S), e.quadraticCurveTo(b + w, T + S, b + w, T + S - C), e.lineTo(b + w, T + C), e.quadraticCurveTo(b + w, T, b + w - C, T), e.lineTo(b + C, T), e.quadraticCurveTo(b, T, b, T + C), e.closePath(), (n.fillColor || 0 === n.fillColor) && (e.globalAlpha = n.fillAlpha * i, e.fillStyle = "#" + ("00000" + (0 | a).toString(16)).substr(-6), e.fill()), n.lineWidth && (e.globalAlpha = n.lineAlpha * i, e.strokeStyle = "#" + ("00000" + (0 | h).toString(16)).substr(-6), e.stroke()) } } }, PIXI.CanvasGraphics.renderGraphicsMask = function (t, e) { var i = t.graphicsData.length; if (0 !== i) { e.beginPath(); for (var r = 0; r < i; r++) { var n = t.graphicsData[r], o = n.shape; if (n.type === s.POLYGON) { var a = o.points; e.moveTo(a[0], a[1]); for (var h = 1; h < a.length / 2; h++)e.lineTo(a[2 * h], a[2 * h + 1]); a[0] === a[a.length - 2] && a[1] === a[a.length - 1] && e.closePath() } else if (n.type === s.RECTANGLE) e.rect(o.x, o.y, o.width, o.height), e.closePath(); else if (n.type === s.CIRCLE) e.arc(o.x, o.y, o.radius, 0, 2 * Math.PI), e.closePath(); else if (n.type === s.ELLIPSE) { var u = 2 * o.width, l = 2 * o.height, c = o.x - u / 2, d = o.y - l / 2, p = u / 2 * .5522848, f = l / 2 * .5522848, g = c + u, m = d + l, v = c + u / 2, y = d + l / 2; e.moveTo(c, y), e.bezierCurveTo(c, y - f, v - p, d, v, d), e.bezierCurveTo(v + p, d, g, y - f, g, y), e.bezierCurveTo(g, y + f, v + p, m, v, m), e.bezierCurveTo(v - p, m, c, y + f, c, y), e.closePath() } else if (n.type === s.ROUNDEDRECTANGLE) { var x = o.x, _ = o.y, b = o.width, T = o.height, w = o.radius, S = Math.min(b, T) / 2 | 0; w = w > S ? S : w, e.moveTo(x, _ + w), e.lineTo(x, _ + T - w), e.quadraticCurveTo(x, _ + T, x + w, _ + T), e.lineTo(x + b - w, _ + T), e.quadraticCurveTo(x + b, _ + T, x + b, _ + T - w), e.lineTo(x + b, _ + w), e.quadraticCurveTo(x + b, _, x + b - w, _), e.lineTo(x + w, _), e.quadraticCurveTo(x, _, x, _ + w), e.closePath() } } } }, PIXI.CanvasGraphics.updateGraphicsTint = function (t) { if (16777215 !== t.tint) for (var e = (t.tint >> 16 & 255) / 255, i = (t.tint >> 8 & 255) / 255, r = (255 & t.tint) / 255, n = 0; n < t.graphicsData.length; n++) { var s = t.graphicsData[n], o = 0 | s.fillColor, a = 0 | s.lineColor; s._fillTint = ((o >> 16 & 255) / 255 * e * 255 << 16) + ((o >> 8 & 255) / 255 * i * 255 << 8) + (255 & o) / 255 * r * 255, s._lineTint = ((a >> 16 & 255) / 255 * e * 255 << 16) + ((a >> 8 & 255) / 255 * i * 255 << 8) + (255 & a) / 255 * r * 255 } }, s.GraphicsData = function (t, e, i, r, n, s, o) { this.lineWidth = t, this.lineColor = e, this.lineAlpha = i, this._lineTint = e, this.fillColor = r, this.fillAlpha = n, this._fillTint = r, this.fill = s, this.shape = o, this.type = o.type }, s.GraphicsData.prototype.constructor = s.GraphicsData, s.GraphicsData.prototype.clone = function () { return new s.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.fill, this.shape) }, s.Graphics = function (t, e, i) { void 0 === e && (e = 0), void 0 === i && (i = 0), this.type = s.GRAPHICS, this.physicsType = s.SPRITE, this.anchor = new s.Point, PIXI.DisplayObjectContainer.call(this), this.renderable = !0, this.fillAlpha = 1, this.lineWidth = 0, this.lineColor = 0, this.graphicsData = [], this.tint = 16777215, this.blendMode = PIXI.blendModes.NORMAL, this.currentPath = null, this._webGL = [], this.isMask = !1, this.boundsPadding = 0, this._localBounds = new s.Rectangle(0, 0, 1, 1), this.dirty = !0, this._boundsDirty = !1, this.webGLDirty = !1, this.cachedSpriteDirty = !1, s.Component.Core.init.call(this, t, e, i, "", null) }, s.Graphics.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), s.Graphics.prototype.constructor = s.Graphics, s.Component.Core.install.call(s.Graphics.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]), s.Graphics.prototype.preUpdatePhysics = s.Component.PhysicsBody.preUpdate, s.Graphics.prototype.preUpdateLifeSpan = s.Component.LifeSpan.preUpdate, s.Graphics.prototype.preUpdateInWorld = s.Component.InWorld.preUpdate, s.Graphics.prototype.preUpdateCore = s.Component.Core.preUpdate, s.Graphics.prototype.preUpdate = function () { return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore() }, s.Graphics.prototype.postUpdate = function () { s.Component.PhysicsBody.postUpdate.call(this), s.Component.FixedToCamera.postUpdate.call(this), this._boundsDirty && (this.updateLocalBounds(), this._boundsDirty = !1); for (var t = 0; t < this.children.length; t++)this.children[t].postUpdate() }, s.Graphics.prototype.destroy = function (t) { this.clear(), s.Component.Destroy.prototype.destroy.call(this, t) }, s.Graphics.prototype.drawTriangle = function (t, e) { void 0 === e && (e = !1); var i = new s.Polygon(t); if (e) { var r = new s.Point(this.game.camera.x - t[0].x, this.game.camera.y - t[0].y), n = new s.Point(t[1].x - t[0].x, t[1].y - t[0].y), o = new s.Point(t[1].x - t[2].x, t[1].y - t[2].y).cross(n); r.dot(o) > 0 && this.drawPolygon(i) } else this.drawPolygon(i) }, s.Graphics.prototype.drawTriangles = function (t, e, i) { void 0 === i && (i = !1); var r, n = new s.Point, o = new s.Point, a = new s.Point, h = []; if (e) if (t[0] instanceof s.Point) for (r = 0; r < e.length / 3; r++)h.push(t[e[3 * r]]), h.push(t[e[3 * r + 1]]), h.push(t[e[3 * r + 2]]), 3 === h.length && (this.drawTriangle(h, i), h = []); else for (r = 0; r < e.length; r++)n.x = t[2 * e[r]], n.y = t[2 * e[r] + 1], h.push(n.copyTo({})), 3 === h.length && (this.drawTriangle(h, i), h = []); else if (t[0] instanceof s.Point) for (r = 0; r < t.length / 3; r++)this.drawTriangle([t[3 * r], t[3 * r + 1], t[3 * r + 2]], i); else for (r = 0; r < t.length / 6; r++)n.x = t[6 * r + 0], n.y = t[6 * r + 1], o.x = t[6 * r + 2], o.y = t[6 * r + 3], a.x = t[6 * r + 4], a.y = t[6 * r + 5], this.drawTriangle([n, o, a], i) }, s.Graphics.prototype.lineStyle = function (t, e, i) { return this.lineWidth = t || 0, this.lineColor = e || 0, this.lineAlpha = void 0 === i ? 1 : i, this.currentPath && (this.currentPath.shape.points.length ? this.drawShape(new s.Polygon(this.currentPath.shape.points.slice(-2))) : (this.currentPath.lineWidth = this.lineWidth, this.currentPath.lineColor = this.lineColor, this.currentPath.lineAlpha = this.lineAlpha)), this }, s.Graphics.prototype.moveTo = function (t, e) { return this.drawShape(new s.Polygon([t, e])), this }, s.Graphics.prototype.lineTo = function (t, e) { return this.currentPath || this.moveTo(0, 0), this.currentPath.shape.points.push(t, e), this.dirty = !0, this._boundsDirty = !0, this }, s.Graphics.prototype.quadraticCurveTo = function (t, e, i, r) { this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0); var n, s, o = this.currentPath.shape.points; 0 === o.length && this.moveTo(0, 0); for (var a = o[o.length - 2], h = o[o.length - 1], u = 0, l = 1; l <= 20; ++l)n = a + (t - a) * (u = l / 20), s = h + (e - h) * u, o.push(n + (t + (i - t) * u - n) * u, s + (e + (r - e) * u - s) * u); return this.dirty = !0, this._boundsDirty = !0, this }, s.Graphics.prototype.bezierCurveTo = function (t, e, i, r, n, s) { this.currentPath ? 0 === this.currentPath.shape.points.length && (this.currentPath.shape.points = [0, 0]) : this.moveTo(0, 0); for (var o, a, h, u, l, c = this.currentPath.shape.points, d = c[c.length - 2], p = c[c.length - 1], f = 0, g = 1; g <= 20; ++g)h = (a = (o = 1 - (f = g / 20)) * o) * o, l = (u = f * f) * f, c.push(h * d + 3 * a * f * t + 3 * o * u * i + l * n, h * p + 3 * a * f * e + 3 * o * u * r + l * s); return this.dirty = !0, this._boundsDirty = !0, this }, s.Graphics.prototype.arcTo = function (t, e, i, r, n) { this.currentPath ? 0 === this.currentPath.shape.points.length && this.currentPath.shape.points.push(t, e) : this.moveTo(t, e); var s = this.currentPath.shape.points, o = s[s.length - 2], a = s[s.length - 1] - e, h = o - t, u = r - e, l = i - t, c = Math.abs(a * l - h * u); if (c < 1e-8 || 0 === n) s[s.length - 2] === t && s[s.length - 1] === e || s.push(t, e); else { var d = a * a + h * h, p = u * u + l * l, f = a * u + h * l, g = n * Math.sqrt(d) / c, m = n * Math.sqrt(p) / c, v = g * f / d, y = m * f / p, x = g * l + m * h, _ = g * u + m * a, b = h * (m + v), T = a * (m + v), w = l * (g + y), S = u * (g + y), C = Math.atan2(T - _, b - x), P = Math.atan2(S - _, w - x); this.arc(x + t, _ + e, n, C, P, h * u > l * a) } return this.dirty = !0, this._boundsDirty = !0, this }, s.Graphics.prototype.arc = function (t, e, i, r, n, s, o) { if (r === n) return this; void 0 === s && (s = !1), void 0 === o && (o = 40), !s && n <= r ? n += 2 * Math.PI : s && r <= n && (r += 2 * Math.PI); var a = s ? -1 * (r - n) : n - r, h = Math.ceil(Math.abs(a) / (2 * Math.PI)) * o; if (0 === a) return this; var u = t + Math.cos(r) * i, l = e + Math.sin(r) * i; s && this.filling ? this.moveTo(t, e) : this.moveTo(u, l); for (var c = this.currentPath.shape.points, d = a / (2 * h), p = 2 * d, f = Math.cos(d), g = Math.sin(d), m = h - 1, v = m % 1 / m, y = 0; y <= m; y++) { var x = d + r + p * (y + v * y), _ = Math.cos(x), b = -Math.sin(x); c.push((f * _ + g * b) * i + t, (f * -b + g * _) * i + e) } return this.dirty = !0, this._boundsDirty = !0, this }, s.Graphics.prototype.beginFill = function (t, e) { return this.filling = !0, this.fillColor = t || 0, this.fillAlpha = void 0 === e ? 1 : e, this.currentPath && this.currentPath.shape.points.length <= 2 && (this.currentPath.fill = this.filling, this.currentPath.fillColor = this.fillColor, this.currentPath.fillAlpha = this.fillAlpha), this }, s.Graphics.prototype.endFill = function () { return this.filling = !1, this.fillColor = null, this.fillAlpha = 1, this }, s.Graphics.prototype.drawRect = function (t, e, i, r) { return this.drawShape(new s.Rectangle(t, e, i, r)), this }, s.Graphics.prototype.drawRoundedRect = function (t, e, i, r, n) { return this.drawShape(new s.RoundedRectangle(t, e, i, r, n)), this }, s.Graphics.prototype.drawCircle = function (t, e, i) { return this.drawShape(new s.Circle(t, e, i)), this }, s.Graphics.prototype.drawEllipse = function (t, e, i, r) { return this.drawShape(new s.Ellipse(t, e, i, r)), this }, s.Graphics.prototype.drawPolygon = function (t) { t instanceof s.Polygon && (t = t.points); var e = t; if (!Array.isArray(e)) { e = new Array(arguments.length); for (var i = 0; i < e.length; ++i)e[i] = arguments[i] } return this.drawShape(new s.Polygon(e)), this }, s.Graphics.prototype.clear = function () { return this.lineWidth = 0, this.filling = !1, this.dirty = !0, this._boundsDirty = !0, this.clearDirty = !0, this.graphicsData = [], this.updateLocalBounds(), this }, s.Graphics.prototype.generateTexture = function (t, e, i) { void 0 === t && (t = 1), void 0 === e && (e = PIXI.scaleModes.DEFAULT), void 0 === i && (i = 0); var r = this.getBounds(); r.width += i, r.height += i; var n = new PIXI.CanvasBuffer(r.width * t, r.height * t), s = PIXI.Texture.fromCanvas(n.canvas, e); return s.baseTexture.resolution = t, n.context.scale(t, t), n.context.translate(-r.x, -r.y), PIXI.CanvasGraphics.renderGraphics(this, n.context), s }, s.Graphics.prototype._renderWebGL = function (t) { if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) { if (this._cacheAsBitmap) return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), this._cachedSprite.worldAlpha = this.worldAlpha, void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite, t); if (t.spriteBatch.stop(), t.blendModeManager.setBlendMode(this.blendMode), this._mask && t.maskManager.pushMask(this._mask, t), this._filters && t.filterManager.pushFilter(this._filterBlock), this.blendMode !== t.spriteBatch.currentBlendMode) { t.spriteBatch.currentBlendMode = this.blendMode; var e = PIXI.blendModesWebGL[t.spriteBatch.currentBlendMode]; t.spriteBatch.gl.blendFunc(e[0], e[1]) } if (this.webGLDirty && (this.dirty = !0, this.webGLDirty = !1), PIXI.WebGLGraphics.renderGraphics(this, t), this.children.length) { t.spriteBatch.start(); for (var i = 0; i < this.children.length; i++)this.children[i]._renderWebGL(t); t.spriteBatch.stop() } this._filters && t.filterManager.popFilter(), this._mask && t.maskManager.popMask(this.mask, t), t.drawCount++ , t.spriteBatch.start() } }, s.Graphics.prototype._renderCanvas = function (t) { if (!1 !== this.visible && 0 !== this.alpha && !0 !== this.isMask) { if (this._prevTint !== this.tint && (this.dirty = !0, this._prevTint = this.tint), this._cacheAsBitmap) return (this.dirty || this.cachedSpriteDirty) && (this._generateCachedSprite(), this.updateCachedSpriteTexture(), this.cachedSpriteDirty = !1, this.dirty = !1), this._cachedSprite.alpha = this.alpha, void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite, t); var e = t.context, i = this.worldTransform; this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]), this._mask && t.maskManager.pushMask(this._mask, t); var r = t.resolution, n = i.tx * t.resolution + t.shakeX, s = i.ty * t.resolution + t.shakeY; e.setTransform(i.a * r, i.b * r, i.c * r, i.d * r, n, s), PIXI.CanvasGraphics.renderGraphics(this, e); for (var o = 0; o < this.children.length; o++)this.children[o]._renderCanvas(t); this._mask && t.maskManager.popMask(t) } }, s.Graphics.prototype.getBounds = function (t) { if (this._currentBounds) return this._currentBounds; if (!this.renderable) return s.EmptyRectangle; this.dirty && (this.updateLocalBounds(), this.webGLDirty = !0, this.cachedSpriteDirty = !0, this.dirty = !1); var e = this._localBounds, i = e.x, r = e.width + e.x, n = e.y, o = e.height + e.y, a = t || this.worldTransform, h = a.a, u = a.b, l = a.c, c = a.d, d = a.tx, p = a.ty, f = h * r + l * o + d, g = c * o + u * r + p, m = h * i + l * o + d, v = c * o + u * i + p, y = h * i + l * n + d, x = c * n + u * i + p, _ = h * r + l * n + d, b = c * n + u * r + p, T = f, w = g, S = f, C = g; return S = _ < (S = y < (S = m < S ? m : S) ? y : S) ? _ : S, C = b < (C = x < (C = v < C ? v : C) ? x : C) ? b : C, T = _ > (T = y > (T = m > T ? m : T) ? y : T) ? _ : T, w = b > (w = x > (w = v > w ? v : w) ? x : w) ? b : w, this._bounds.x = S, this._bounds.width = T - S, this._bounds.y = C, this._bounds.height = w - C, this._currentBounds = this._bounds, this._currentBounds }, s.Graphics.prototype.getLocalBounds = function () { var t = this.worldTransform; this.worldTransform = s.identityMatrix; for (var e = 0; e < this.children.length; e++)this.children[e].updateTransform(); var i = this.getBounds(); for (this.worldTransform = t, e = 0; e < this.children.length; e++)this.children[e].updateTransform(); return i }, s.Graphics.prototype.containsPoint = function (t, e) { void 0 === e && (e = new s.Point), this.worldTransform.applyInverse(t, e); for (var i = this.graphicsData, r = 0; r < i.length; r++) { var n = i[r]; if (n.fill && (n.shape && n.shape.contains(e.x, e.y))) return !0 } return !1 }, s.Graphics.prototype.updateLocalBounds = function () { var t = 1 / 0, e = -1 / 0, i = 1 / 0, r = -1 / 0; if (this.graphicsData.length) for (var n, o, a, h, u, l, c = 0; c < this.graphicsData.length; c++) { var d = this.graphicsData[c], p = d.type, f = d.lineWidth; if (n = d.shape, p === s.RECTANGLE || p === s.ROUNDEDRECTANGLE) a = n.x - f / 2, h = n.y - f / 2, u = n.width + f, l = n.height + f, t = a < t ? a : t, e = a + u > e ? a + u : e, i = h < i ? h : i, r = h + l > r ? h + l : r; else if (p === s.CIRCLE) a = n.x, h = n.y, u = n.radius + f / 2, l = n.radius + f / 2, t = a - u < t ? a - u : t, e = a + u > e ? a + u : e, i = h - l < i ? h - l : i, r = h + l > r ? h + l : r; else if (p === s.ELLIPSE) a = n.x, h = n.y, u = n.width + f / 2, l = n.height + f / 2, t = a - u < t ? a - u : t, e = a + u > e ? a + u : e, i = h - l < i ? h - l : i, r = h + l > r ? h + l : r; else { o = n.points; for (var g = 0; g < o.length; g++)o[g] instanceof s.Point ? (a = o[g].x, h = o[g].y) : (a = o[g], h = o[g + 1], g < o.length - 1 && g++), t = a - f < t ? a - f : t, e = a + f > e ? a + f : e, i = h - f < i ? h - f : i, r = h + f > r ? h + f : r } } else t = 0, e = 0, i = 0, r = 0; var m = this.boundsPadding; this._localBounds.x = t - m, this._localBounds.width = e - t + 2 * m, this._localBounds.y = i - m, this._localBounds.height = r - i + 2 * m }, s.Graphics.prototype._generateCachedSprite = function () { var t = this.getLocalBounds(); if (this._cachedSprite) this._cachedSprite.buffer.resize(t.width, t.height); else { var e = new PIXI.CanvasBuffer(t.width, t.height), i = PIXI.Texture.fromCanvas(e.canvas); this._cachedSprite = new PIXI.Sprite(i), this._cachedSprite.buffer = e, this._cachedSprite.worldTransform = this.worldTransform } this._cachedSprite.anchor.x = -t.x / t.width, this._cachedSprite.anchor.y = -t.y / t.height, this._cachedSprite.buffer.context.translate(-t.x, -t.y), this.worldAlpha = 1, PIXI.CanvasGraphics.renderGraphics(this, this._cachedSprite.buffer.context), this._cachedSprite.alpha = this.alpha }, s.Graphics.prototype.updateCachedSpriteTexture = function () { var t = this._cachedSprite, e = t.texture, i = t.buffer.canvas; e.baseTexture.width = i.width, e.baseTexture.height = i.height, e.crop.width = e.frame.width = i.width, e.crop.height = e.frame.height = i.height, t._width = i.width, t._height = i.height, e.baseTexture.dirty() }, s.Graphics.prototype.destroyCachedSprite = function () { this._cachedSprite.texture.destroy(!0), this._cachedSprite = null }, s.Graphics.prototype.drawShape = function (t) { this.currentPath && this.currentPath.shape.points.length <= 2 && this.graphicsData.pop(), this.currentPath = null, t instanceof s.Polygon && (t = t.clone()).flatten(); var e = new s.GraphicsData(this.lineWidth, this.lineColor, this.lineAlpha, this.fillColor, this.fillAlpha, this.filling, t); return this.graphicsData.push(e), e.type === s.POLYGON && (e.shape.closed = this.filling, this.currentPath = e), this.dirty = !0, this._boundsDirty = !0, e }, Object.defineProperty(s.Graphics.prototype, "cacheAsBitmap", { get: function () { return this._cacheAsBitmap }, set: function (t) { this._cacheAsBitmap = t, this._cacheAsBitmap ? this._generateCachedSprite() : this.destroyCachedSprite(), this.dirty = !0, this.webGLDirty = !0 } }), s.RenderTexture = function (t, e, i, r, n, o, a, h) { if (void 0 === e && (e = 100), void 0 === i && (i = 100), void 0 === r && (r = ""), void 0 === n && (n = s.scaleModes.DEFAULT), void 0 === o && (o = 1), void 0 === a && (a = PIXI.defaultRenderer), void 0 === h && (h = 0), this.game = t, this.key = r, this.type = s.RENDERTEXTURE, this._tempMatrix = new s.Matrix, this.width = e, this.height = i, this.resolution = o, this.frame = new s.Rectangle(0, 0, this.width * this.resolution, this.height * this.resolution), this.crop = this.frame.clone(), this.baseTexture = new PIXI.BaseTexture, this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution, this.baseTexture._glTextures = [], this.baseTexture.resolution = this.resolution, this.baseTexture.scaleMode = n, this.baseTexture.hasLoaded = !0, PIXI.Texture.call(this, this.baseTexture, this.frame.clone()), this.renderer = a, this.renderer.type === s.WEBGL) { var u = this.renderer.gl; this.baseTexture.textureIndex = h, this.baseTexture._dirty[u.id] = !1, this.textureBuffer = new PIXI.FilterTexture(u, this.width, this.height, this.baseTexture.scaleMode, h), this.baseTexture._glTextures[u.id] = this.textureBuffer.texture, this.projection = new s.Point(.5 * this.width, .5 * -this.height) } else this.textureBuffer = new PIXI.CanvasBuffer(this.width * this.resolution, this.height * this.resolution), this.baseTexture.source = this.textureBuffer.canvas; this.valid = !0, this.tempMatrix = new s.Matrix, this._updateUvs() }, s.RenderTexture.prototype = Object.create(PIXI.Texture.prototype), s.RenderTexture.prototype.constructor = s.RenderTexture, s.RenderTexture.prototype.renderXY = function (t, e, i, r) { t.updateTransform(), this._tempMatrix.copyFrom(t.worldTransform), this._tempMatrix.tx = e, this._tempMatrix.ty = i, this.renderer.type === s.WEBGL ? this._renderWebGL(t, this._tempMatrix, r) : this._renderCanvas(t, this._tempMatrix, r) }, s.RenderTexture.prototype.renderRawXY = function (t, e, i, r) { this._tempMatrix.identity().translate(e, i), this.renderer.type === s.WEBGL ? this._renderWebGL(t, this._tempMatrix, r) : this._renderCanvas(t, this._tempMatrix, r) }, s.RenderTexture.prototype.render = function (t, e, i) { void 0 === e || null === e ? this._tempMatrix.copyFrom(t.worldTransform) : this._tempMatrix.copyFrom(e), this.renderer.type === s.WEBGL ? this._renderWebGL(t, this._tempMatrix, i) : this._renderCanvas(t, this._tempMatrix, i) }, s.RenderTexture.prototype.resize = function (t, e, i) { t === this.width && e === this.height || (this.valid = t > 0 && e > 0, this.width = t, this.height = e, this.frame.width = this.crop.width = t * this.resolution, this.frame.height = this.crop.height = e * this.resolution, i && (this.baseTexture.width = this.width * this.resolution, this.baseTexture.height = this.height * this.resolution), this.renderer.type === s.WEBGL && (this.projection.x = this.width / 2, this.projection.y = -this.height / 2), this.valid && this.textureBuffer.resize(this.width, this.height)) }, s.RenderTexture.prototype.clear = function () { this.valid && (this.renderer.type === s.WEBGL && this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER, this.textureBuffer.frameBuffer), this.textureBuffer.clear()) }, s.RenderTexture.prototype._renderWebGL = function (t, e, i) { if (this.valid && 0 !== t.alpha) { var r = t.worldTransform; r.identity(), r.translate(0, 2 * this.projection.y), e && r.append(e), r.scale(1, -1); for (var n = 0; n < t.children.length; n++)t.children[n].updateTransform(); var s = this.renderer.gl; s.viewport(0, 0, this.width * this.resolution, this.height * this.resolution), s.bindFramebuffer(s.FRAMEBUFFER, this.textureBuffer.frameBuffer), i && this.textureBuffer.clear(), this.renderer.spriteBatch.dirty = !0, this.renderer.renderDisplayObject(t, this.projection, this.textureBuffer.frameBuffer, e), this.renderer.spriteBatch.dirty = !0, s.bindFramebuffer(s.FRAMEBUFFER, null) } }, s.RenderTexture.prototype._renderCanvas = function (t, e, i) { if (this.valid && 0 !== t.alpha) { var r = t.worldTransform; r.identity(), e && r.append(e); for (var n = 0; n < t.children.length; n++)t.children[n].updateTransform(); i && this.textureBuffer.clear(); var s = this.renderer.resolution; this.renderer.resolution = this.resolution, this.renderer.renderDisplayObject(t, this.textureBuffer.context, e), this.renderer.resolution = s } }, s.RenderTexture.prototype.getImage = function () { var t = new Image; return t.src = this.getBase64(), t }, s.RenderTexture.prototype.getBase64 = function () { return this.getCanvas().toDataURL() }, s.RenderTexture.prototype.getCanvas = function () { if (this.renderer.type === s.WEBGL) { var t = this.renderer.gl, e = this.textureBuffer.width, i = this.textureBuffer.height, r = new Uint8Array(4 * e * i); t.bindFramebuffer(t.FRAMEBUFFER, this.textureBuffer.frameBuffer), t.readPixels(0, 0, e, i, t.RGBA, t.UNSIGNED_BYTE, r), t.bindFramebuffer(t.FRAMEBUFFER, null); var n = new PIXI.CanvasBuffer(e, i), o = n.context.getImageData(0, 0, e, i); return o.data.set(r), n.context.putImageData(o, 0, 0), n.canvas } return this.textureBuffer.canvas }, s.Text = function (t, e, i, r, n) { e = e || 0, i = i || 0, r = void 0 === r || null === r ? "" : r.toString(), this.type = s.TEXT, this.physicsType = s.SPRITE, this.padding = new s.Point, this.textBounds = null, this.canvas = s.CanvasPool.create(this), this.context = this.canvas.getContext("2d"), this.colors = [], this.strokeColors = [], this.fontStyles = [], this.fontWeights = [], this.autoRound = !1, this.useAdvancedWrap = !1, this.splitRegExp = /(?:\r\n|\r|\n)/, this.characterLimitSize = -1, this.characterLimitSuffix = "", this._res = t.renderer.resolution, this._text = r, this._fontComponents = null, this._lineSpacing = 0, this._charCount = 0, this._width = 0, this._height = 0, s.Sprite.call(this, t, e, i, PIXI.Texture.fromCanvas(this.canvas)), this.style = {}, this.setStyle(n || {}), "" !== r && this.updateText() }, s.Text.prototype = Object.create(s.Sprite.prototype), s.Text.prototype.constructor = s.Text, s.Text.prototype.preUpdate = function () { return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore() }, s.Text.prototype.update = function () { }, s.Text.prototype.destroy = function (t) { this.texture.destroy(!0), s.Component.Destroy.prototype.destroy.call(this, t) }, s.Text.prototype.setShadow = function (t, e, i, r, n, s) { return void 0 === t && (t = 0), void 0 === e && (e = 0), void 0 === i && (i = "rgba(0, 0, 0, 1)"), void 0 === r && (r = 0), void 0 === n && (n = !0), void 0 === s && (s = !0), this.style.shadowOffsetX = t, this.style.shadowOffsetY = e, this.style.shadowColor = i, this.style.shadowBlur = r, this.style.shadowStroke = n, this.style.shadowFill = s, this.dirty = !0, this }, s.Text.prototype.setStyle = function (t, e) { void 0 === e && (e = !1); var i = Object.assign({}, t); i.font = t.font || "bold 20pt Arial", i.backgroundColor = t.backgroundColor || null, i.fill = t.fill || "black", i.align = (t.align || "left").toLowerCase(), i.boundsAlignH = (t.boundsAlignH || "left").toLowerCase(), i.boundsAlignV = (t.boundsAlignV || "top").toLowerCase(), i.stroke = t.stroke || "black", i.strokeThickness = Number(t.strokeThickness) || 0, i.wordWrap = t.wordWrap || !1, i.wordWrapWidth = t.wordWrapWidth || 100, i.maxLines = t.maxLines || 0, i.shadowOffsetX = t.shadowOffsetX || 0, i.shadowOffsetY = t.shadowOffsetY || 0, i.shadowColor = t.shadowColor || "rgba(0,0,0,0)", i.shadowBlur = t.shadowBlur || 0, i.tabs = t.tabs || 0; var r = this.fontToComponents(i.font); return i.fontStyle && (r.fontStyle = i.fontStyle), i.fontVariant && (r.fontVariant = i.fontVariant), i.fontWeight && (r.fontWeight = i.fontWeight), i.fontSize && ("number" == typeof i.fontSize && (i.fontSize = i.fontSize + "px"), r.fontSize = i.fontSize), this._fontComponents = r, i.font = this.componentsToFont(this._fontComponents), this.style = i, this.dirty = !0, e && this.updateText(), this }, s.Text.prototype.updateText = function () { this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font; var t = this.text; this.characterLimitSize > -1 && this.characterLimitSize < t.length && (t = this.text.substring(0, this.characterLimitSize) + this.characterLimitSuffix), this.style.wordWrap && (t = this.runWordWrap(this.text)); var e = t.split(this.splitRegExp), i = this.style.tabs, r = [], n = 0, s = this.determineFontProperties(this.style.font), o = e.length; this.style.maxLines > 0 && this.style.maxLines < e.length && (o = this.style.maxLines), this._charCount = 0; for (var a = 0; a < o; a++) { if (0 === i) { var h = this.style.strokeThickness + this.padding.x; this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? h += this.measureLine(e[a]) : h += this.context.measureText(e[a]).width, this.style.wordWrap && (h -= this.context.measureText(" ").width) } else { var u = e[a].split(/(?:\t)/); h = this.padding.x + this.style.strokeThickness; if (Array.isArray(i)) for (var l = 0, c = 0; c < u.length; c++) { var d = 0; d = this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.measureLine(u[c]) : Math.ceil(this.context.measureText(u[c]).width), c > 0 && (l += i[c - 1]), h = l + d } else for (c = 0; c < u.length; c++) { this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? h += this.measureLine(u[c]) : h += Math.ceil(this.context.measureText(u[c]).width), h += this.game.math.snapToCeil(h, i) - h } } r[a] = Math.ceil(h), n = Math.max(n, r[a]) } this.canvas.width = n * this._res; var p, f, g = s.fontSize + this.style.strokeThickness + this.padding.y, m = g * o, v = this._lineSpacing; for (v < 0 && Math.abs(v) > g && (v = -g), 0 !== v && (m += v > 0 ? v * e.length : v * (e.length - 1)), this.canvas.height = m * this._res, this.context.scale(this._res, this._res), navigator.isCocoonJS && this.context.clearRect(0, 0, this.canvas.width, this.canvas.height), this.style.backgroundColor && (this.context.fillStyle = this.style.backgroundColor, this.context.fillRect(0, 0, this.canvas.width, this.canvas.height)), this.context.fillStyle = this.style.fill, this.context.font = this.style.font, this.context.strokeStyle = this.style.stroke, this.context.textBaseline = "alphabetic", this.context.lineWidth = this.style.strokeThickness, this.context.lineCap = "round", this.context.lineJoin = "round", this._charCount = 0, a = 0; a < o; a++)p = this.style.strokeThickness / 2, f = this.style.strokeThickness / 2 + a * g + s.ascent, a > 0 && (f += v * a), "right" === this.style.align ? p += n - r[a] : "center" === this.style.align && (p += (n - r[a]) / 2), this.autoRound && (p = Math.round(p), f = Math.round(f)), this.colors.length > 0 || this.strokeColors.length > 0 || this.fontWeights.length > 0 || this.fontStyles.length > 0 ? this.updateLine(e[a], p, f) : (this.style.stroke && this.style.strokeThickness && (this.updateShadow(this.style.shadowStroke), 0 === i ? this.context.strokeText(e[a], p, f) : this.renderTabLine(e[a], p, f, !1)), this.style.fill && (this.updateShadow(this.style.shadowFill), 0 === i ? this.context.fillText(e[a], p, f) : this.renderTabLine(e[a], p, f, !0))); this.updateTexture(), this.dirty = !1 }, s.Text.prototype.renderTabLine = function (t, e, i, r) { var n = t.split(/(?:\t)/), s = this.style.tabs, o = 0; if (Array.isArray(s)) for (var a = 0, h = 0; h < n.length; h++)h > 0 && (a += s[h - 1]), o = e + a, r ? this.context.fillText(n[h], o, i) : this.context.strokeText(n[h], o, i); else for (h = 0; h < n.length; h++) { var u = Math.ceil(this.context.measureText(n[h]).width); o = this.game.math.snapToCeil(e, s), r ? this.context.fillText(n[h], o, i) : this.context.strokeText(n[h], o, i), e = o + u } }, s.Text.prototype.updateShadow = function (t) { t ? (this.context.shadowOffsetX = this.style.shadowOffsetX, this.context.shadowOffsetY = this.style.shadowOffsetY, this.context.shadowColor = this.style.shadowColor, this.context.shadowBlur = this.style.shadowBlur) : (this.context.shadowOffsetX = 0, this.context.shadowOffsetY = 0, this.context.shadowColor = 0, this.context.shadowBlur = 0) }, s.Text.prototype.measureLine = function (t) { for (var e = 0, i = 0; i < t.length; i++) { var r = t[i]; if (this.fontWeights.length > 0 || this.fontStyles.length > 0) { var n = this.fontToComponents(this.context.font); this.fontStyles[this._charCount] && (n.fontStyle = this.fontStyles[this._charCount]), this.fontWeights[this._charCount] && (n.fontWeight = this.fontWeights[this._charCount]), this.context.font = this.componentsToFont(n) } this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), this.updateShadow(this.style.shadowStroke)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), this.updateShadow(this.style.shadowFill)), e += this.context.measureText(r).width, this._charCount++ } return Math.ceil(e) }, s.Text.prototype.updateLine = function (t, e, i) { for (var r = 0; r < t.length; r++) { var n = t[r]; if (this.fontWeights.length > 0 || this.fontStyles.length > 0) { var s = this.fontToComponents(this.context.font); this.fontStyles[this._charCount] && (s.fontStyle = this.fontStyles[this._charCount]), this.fontWeights[this._charCount] && (s.fontWeight = this.fontWeights[this._charCount]), this.context.font = this.componentsToFont(s) } this.style.stroke && this.style.strokeThickness && (this.strokeColors[this._charCount] && (this.context.strokeStyle = this.strokeColors[this._charCount]), this.updateShadow(this.style.shadowStroke), this.context.strokeText(n, e, i)), this.style.fill && (this.colors[this._charCount] && (this.context.fillStyle = this.colors[this._charCount]), this.updateShadow(this.style.shadowFill), this.context.fillText(n, e, i)), e += this.context.measureText(n).width, this._charCount++ } }, s.Text.prototype.clearColors = function () { return this.colors = [], this.strokeColors = [], this.dirty = !0, this }, s.Text.prototype.clearFontValues = function () { return this.fontStyles = [], this.fontWeights = [], this.dirty = !0, this }, s.Text.prototype.addColor = function (t, e) { return this.colors[e] = t, this.dirty = !0, this }, s.Text.prototype.addStrokeColor = function (t, e) { return this.strokeColors[e] = t, this.dirty = !0, this }, s.Text.prototype.addFontStyle = function (t, e) { return this.fontStyles[e] = t, this.dirty = !0, this }, s.Text.prototype.addFontWeight = function (t, e) { return this.fontWeights[e] = t, this.dirty = !0, this }, s.Text.prototype.precalculateWordWrap = function (t) { return this.texture.baseTexture.resolution = this._res, this.context.font = this.style.font, this.runWordWrap(t).split(/(?:\r\n|\r|\n)/) }, s.Text.prototype.runWordWrap = function (t) { return this.useAdvancedWrap ? this.advancedWordWrap(t) : this.basicWordWrap(t) }, s.Text.prototype.advancedWordWrap = function (t) { for (var e = this.context, i = this.style.wordWrapWidth, r = "", n = t.replace(/ +/gi, " ").split(/\r?\n/gi), s = n.length, o = 0; o < s; o++) { var a = n[o], h = ""; if (a = a.replace(/^ *|\s*$/gi, ""), e.measureText(a).width < i) r += a + "\n"; else { for (var u = i, l = a.split(" "), c = 0; c < l.length; c++) { var d = l[c], p = d + " ", f = e.measureText(p).width; if (f > u) { if (0 === c) { for (var g = p; g.length && (g = g.slice(0, -1), !((f = e.measureText(g).width) <= u));); if (!g.length) throw new Error("This text's wordWrapWidth setting is less than a single character!"); var m = d.substr(g.length); l[c] = m, h += g } var v = l[c].length ? c : c + 1, y = l.slice(v).join(" ").replace(/[ \n]*$/gi, ""); n[o + 1] = y + " " + (n[o + 1] || ""), s = n.length; break } h += p, u -= f } r += h.replace(/[ \n]*$/gi, "") + "\n" } } return r = r.replace(/[\s|\n]*$/gi, "") }, s.Text.prototype.basicWordWrap = function (t) { for (var e = "", i = t.split("\n"), r = 0; r < i.length; r++) { for (var n = this.style.wordWrapWidth, s = i[r].split(" "), o = 0; o < s.length; o++) { var a = this.context.measureText(s[o]).width, h = a + this.context.measureText(" ").width; h > n ? (o > 0 && (e += "\n"), e += s[o] + " ", n = this.style.wordWrapWidth - a) : (n -= h, e += s[o] + " ") } r < i.length - 1 && (e += "\n") } return e }, s.Text.prototype.updateFont = function (t) { var e = this.componentsToFont(t); this.style.font !== e && (this.style.font = e, this.dirty = !0, this.parent && this.updateTransform()) }, s.Text.prototype.fontToComponents = function (t) { var e = t.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/); if (e) { var i = e[5].trim(); return /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i) || /['",]/.exec(i) || (i = "'" + i + "'"), { font: t, fontStyle: e[1] || "normal", fontVariant: e[2] || "normal", fontWeight: e[3] || "normal", fontSize: e[4] || "medium", fontFamily: i } } return console.warn("Phaser.Text - unparsable CSS font: " + t), { font: t } }, s.Text.prototype.componentsToFont = function (t) { var e, i = []; return (e = t.fontStyle) && "normal" !== e && i.push(e), (e = t.fontVariant) && "normal" !== e && i.push(e), (e = t.fontWeight) && "normal" !== e && i.push(e), (e = t.fontSize) && "medium" !== e && i.push(e), (e = t.fontFamily) && i.push(e), i.length || i.push(t.font), i.join(" ") }, s.Text.prototype.setText = function (t, e) { return void 0 === e && (e = !1), this.text = t.toString() || "", e ? this.updateText() : this.dirty = !0, this }, s.Text.prototype.parseList = function (t) { if (!Array.isArray(t)) return this; for (var e = "", i = 0; i < t.length; i++)Array.isArray(t[i]) ? (e += t[i].join("\t"), i < t.length - 1 && (e += "\n")) : (e += t[i], i < t.length - 1 && (e += "\t")); return this.text = e, this.dirty = !0, this }, s.Text.prototype.setTextBounds = function (t, e, i, r) { return void 0 === t ? this.textBounds = null : (this.textBounds ? this.textBounds.setTo(t, e, i, r) : this.textBounds = new s.Rectangle(t, e, i, r), this.style.wordWrapWidth > i && (this.style.wordWrapWidth = i)), this.updateTexture(), this }, s.Text.prototype.updateTexture = function () { var t = this.texture.baseTexture, e = this.texture.crop, i = this.texture.frame, r = this.canvas.width, n = this.canvas.height; if (t.width = r, t.height = n, e.width = r, e.height = n, i.width = r, i.height = n, this.texture.width = r, this.texture.height = n, this._width = r, this._height = n, this.textBounds) { var s = this.textBounds.x, o = this.textBounds.y; "right" === this.style.boundsAlignH ? s += this.textBounds.width - this.canvas.width / this.resolution : "center" === this.style.boundsAlignH && (s += this.textBounds.halfWidth - this.canvas.width / this.resolution / 2), "bottom" === this.style.boundsAlignV ? o += this.textBounds.height - this.canvas.height / this.resolution : "middle" === this.style.boundsAlignV && (o += this.textBounds.halfHeight - this.canvas.height / this.resolution / 2), this.pivot.x = -s, this.pivot.y = -o } this.renderable = 0 !== r && 0 !== n, this.texture.requiresReTint = !0, this.texture.baseTexture.dirty() }, s.Text.prototype._renderWebGL = function (t) { this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderWebGL.call(this, t) }, s.Text.prototype._renderCanvas = function (t) { this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype._renderCanvas.call(this, t) }, s.Text.prototype.determineFontProperties = function (t) { var e = s.Text.fontPropertiesCache[t]; if (!e) { e = {}; var i = s.Text.fontPropertiesCanvas, r = s.Text.fontPropertiesContext; r.font = t; var n = Math.ceil(r.measureText("|Mq").width), o = Math.ceil(r.measureText("|Mq").width), a = 2 * o; if (o = 1.4 * o | 0, i.width = n, i.height = a, r.fillStyle = "#f00", r.fillRect(0, 0, n, a), r.font = t, r.textBaseline = "alphabetic", r.fillStyle = "#000", r.fillText("|Mq", 0, o), !r.getImageData(0, 0, n, a)) return e.ascent = o, e.descent = o + 6, e.fontSize = e.ascent + e.descent, s.Text.fontPropertiesCache[t] = e, e; var h, u, l = r.getImageData(0, 0, n, a).data, c = l.length, d = 4 * n, p = 0, f = !1; for (h = 0; h < o; h++) { for (u = 0; u < d; u += 4)if (255 !== l[p + u]) { f = !0; break } if (f) break; p += d } for (e.ascent = o - h, p = c - d, f = !1, h = a; h > o; h--) { for (u = 0; u < d; u += 4)if (255 !== l[p + u]) { f = !0; break } if (f) break; p -= d } e.descent = h - o, e.descent += 6, e.fontSize = e.ascent + e.descent, s.Text.fontPropertiesCache[t] = e } return e }, s.Text.prototype.getBounds = function (t) { return this.dirty && (this.updateText(), this.dirty = !1), PIXI.Sprite.prototype.getBounds.call(this, t) }, s.Text.prototype.setCharacterLimit = function (t, e) { this.characterLimitSuffix = void 0 === e ? "" : e, this.characterLimitSize = t, this.updateText() }, Object.defineProperty(s.Text.prototype, "text", { get: function () { return this._text }, set: function (t) { t !== this._text && (this._text = t.toString() || "", this.dirty = !0, this.parent && this.updateTransform()) } }), Object.defineProperty(s.Text.prototype, "cssFont", { get: function () { return this.componentsToFont(this._fontComponents) }, set: function (t) { t = t || "bold 20pt Arial", this._fontComponents = this.fontToComponents(t), this.updateFont(this._fontComponents) } }), Object.defineProperty(s.Text.prototype, "font", { get: function () { return this._fontComponents.fontFamily }, set: function (t) { t = (t = t || "Arial").trim(), /^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(t) || /['",]/.exec(t) || (t = "'" + t + "'"), this._fontComponents.fontFamily = t, this.updateFont(this._fontComponents) } }), Object.defineProperty(s.Text.prototype, "fontSize", { get: function () { var t = this._fontComponents.fontSize; return t && /(?:^0$|px$)/.exec(t) ? parseInt(t, 10) : t }, set: function (t) { "number" == typeof (t = t || "0") && (t += "px"), this._fontComponents.fontSize = t, this.updateFont(this._fontComponents) } }), Object.defineProperty(s.Text.prototype, "fontWeight", { get: function () { return this._fontComponents.fontWeight || "normal" }, set: function (t) { t = t || "normal", this._fontComponents.fontWeight = t, this.updateFont(this._fontComponents) } }), Object.defineProperty(s.Text.prototype, "fontStyle", { get: function () { return this._fontComponents.fontStyle || "normal" }, set: function (t) { t = t || "normal", this._fontComponents.fontStyle = t, this.updateFont(this._fontComponents) } }), Object.defineProperty(s.Text.prototype, "fontVariant", { get: function () { return this._fontComponents.fontVariant || "normal" }, set: function (t) { t = t || "normal", this._fontComponents.fontVariant = t, this.updateFont(this._fontComponents) } }), Object.defineProperty(s.Text.prototype, "fill", { get: function () { return this.style.fill }, set: function (t) { t !== this.style.fill && (this.style.fill = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "align", { get: function () { return this.style.align }, set: function (t) { (t = t.toLowerCase()) !== this.style.align && (this.style.align = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "resolution", { get: function () { return this._res }, set: function (t) { t !== this._res && (this._res = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "tabs", { get: function () { return this.style.tabs }, set: function (t) { t !== this.style.tabs && (this.style.tabs = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "boundsAlignH", { get: function () { return this.style.boundsAlignH }, set: function (t) { (t = t.toLowerCase()) !== this.style.boundsAlignH && (this.style.boundsAlignH = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "boundsAlignV", { get: function () { return this.style.boundsAlignV }, set: function (t) { (t = t.toLowerCase()) !== this.style.boundsAlignV && (this.style.boundsAlignV = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "stroke", { get: function () { return this.style.stroke }, set: function (t) { t !== this.style.stroke && (this.style.stroke = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "strokeThickness", { get: function () { return this.style.strokeThickness }, set: function (t) { t !== this.style.strokeThickness && (this.style.strokeThickness = Number(t), this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "wordWrap", { get: function () { return this.style.wordWrap }, set: function (t) { t !== this.style.wordWrap && (this.style.wordWrap = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "wordWrapWidth", { get: function () { return this.style.wordWrapWidth }, set: function (t) { t !== this.style.wordWrapWidth && (this.style.wordWrapWidth = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "lineSpacing", { get: function () { return this._lineSpacing }, set: function (t) { t !== this._lineSpacing && (this._lineSpacing = parseFloat(t), this.dirty = !0, this.parent && this.updateTransform()) } }), Object.defineProperty(s.Text.prototype, "shadowOffsetX", { get: function () { return this.style.shadowOffsetX }, set: function (t) { t !== this.style.shadowOffsetX && (this.style.shadowOffsetX = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "shadowOffsetY", { get: function () { return this.style.shadowOffsetY }, set: function (t) { t !== this.style.shadowOffsetY && (this.style.shadowOffsetY = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "shadowColor", { get: function () { return this.style.shadowColor }, set: function (t) { t !== this.style.shadowColor && (this.style.shadowColor = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "shadowBlur", { get: function () { return this.style.shadowBlur }, set: function (t) { t !== this.style.shadowBlur && (this.style.shadowBlur = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "shadowStroke", { get: function () { return this.style.shadowStroke }, set: function (t) { t !== this.style.shadowStroke && (this.style.shadowStroke = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "shadowFill", { get: function () { return this.style.shadowFill }, set: function (t) { t !== this.style.shadowFill && (this.style.shadowFill = t, this.dirty = !0) } }), Object.defineProperty(s.Text.prototype, "width", { get: function () { return this.dirty && (this.updateText(), this.dirty = !1), this.scale.x * (this.texture.frame.width / this.resolution) }, set: function (t) { this.scale.x = t / this.texture.frame.width, this._width = t } }), Object.defineProperty(s.Text.prototype, "height", { get: function () { return this.dirty && (this.updateText(), this.dirty = !1), this.scale.y * (this.texture.frame.height / this.resolution) }, set: function (t) { this.scale.y = t / this.texture.frame.height, this._height = t } }), s.Text.fontPropertiesCache = {}, s.Text.fontPropertiesCanvas = document.createElement("canvas"), s.Text.fontPropertiesContext = s.Text.fontPropertiesCanvas.getContext("2d"), s.BitmapText = function (t, e, i, r, n, o, a) { e = e || 0, i = i || 0, r = r || "", n = n || "", o = o || 32, a = a || "left", PIXI.DisplayObjectContainer.call(this), this.type = s.BITMAPTEXT, this.physicsType = s.SPRITE, this.textWidth = 0, this.textHeight = 0, this.anchor = new s.Point, this._prevAnchor = new s.Point, this._glyphs = [], this._maxWidth = 0, this._text = n.toString() || "", this._data = t.cache.getBitmapFont(r), this._font = r, this._fontSize = o, this._align = a, this._tint = 16777215, this.updateText(), this.dirty = !1, s.Component.Core.init.call(this, t, e, i, "", null) }, s.BitmapText.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), s.BitmapText.prototype.constructor = s.BitmapText, s.Component.Core.install.call(s.BitmapText.prototype, ["Angle", "AutoCull", "Bounds", "Destroy", "FixedToCamera", "InputEnabled", "InWorld", "LifeSpan", "PhysicsBody", "Reset"]), s.BitmapText.prototype.preUpdatePhysics = s.Component.PhysicsBody.preUpdate, s.BitmapText.prototype.preUpdateLifeSpan = s.Component.LifeSpan.preUpdate, s.BitmapText.prototype.preUpdateInWorld = s.Component.InWorld.preUpdate, s.BitmapText.prototype.preUpdateCore = s.Component.Core.preUpdate, s.BitmapText.prototype.preUpdate = function () { return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore() }, s.BitmapText.prototype.postUpdate = function () { s.Component.PhysicsBody.postUpdate.call(this), s.Component.FixedToCamera.postUpdate.call(this), this.body && this.body.type === s.Physics.ARCADE && (this.textWidth === this.body.sourceWidth && this.textHeight === this.body.sourceHeight || this.body.setSize(this.textWidth, this.textHeight)) }, s.BitmapText.prototype.setText = function (t) { this.text = t }, s.BitmapText.prototype.scanLine = function (t, e, i) { for (var r = 0, n = 0, s = -1, o = 0, a = null, h = this._maxWidth > 0 ? this._maxWidth : null, u = [], l = 0; l < i.length; l++) { var c = l === i.length - 1; if (/(?:\r\n|\r|\n)/.test(i.charAt(l))) return { width: n, text: i.substr(0, l), end: c, chars: u }; var d, p = i.charCodeAt(l), f = t.chars[p]; void 0 === f && (p = 32, f = t.chars[p]); var g = a && f.kerning[a] ? f.kerning[a] : 0; if (/(\s)/.test(i.charAt(l)) && (s = l, o = n), d = (g + f.texture.width + f.xOffset) * e, h && n + d >= h && s > -1) return { width: o || n, text: i.substr(0, l - (l - s)), end: !1, chars: u }; n += (f.xAdvance + g) * e, u.push(r + (f.xOffset + g) * e), r += (f.xAdvance + g) * e, a = p } return { width: n, text: i, end: c, chars: u } }, s.BitmapText.prototype.cleanText = function (t, e) { void 0 === e && (e = ""); var i = this._data.font; if (!i) return ""; for (var r = t.replace(/\r\n|\n\r|\n|\r/g, "\n").split("\n"), n = 0; n < r.length; n++) { for (var s = "", o = r[n], a = 0; a < o.length; a++)s = i.chars[o.charCodeAt(a)] ? s.concat(o[a]) : s.concat(e); r[n] = s } return r.join("\n") }, s.BitmapText.prototype.updateText = function () { var t = this._data.font; if (t) { var e = this.text, i = this._fontSize / t.size, r = [], n = 0; this.textWidth = 0; do { (l = this.scanLine(t, i, e)).y = n, r.push(l), l.width > this.textWidth && (this.textWidth = l.width), n += t.lineHeight * i, e = e.substr(l.text.length + 1) } while (!1 === l.end); this.textHeight = n; for (var s = 0, o = 0, a = this.textWidth * this.anchor.x, h = this.textHeight * this.anchor.y, u = 0; u < r.length; u++) { var l = r[u]; "right" === this._align ? o = this.textWidth - l.width : "center" === this._align && (o = (this.textWidth - l.width) / 2); for (var c = 0; c < l.text.length; c++) { var d = l.text.charCodeAt(c), p = t.chars[d]; void 0 === p && (d = 32, p = t.chars[d]); var f = this._glyphs[s]; f ? f.texture = p.texture : ((f = new PIXI.Sprite(p.texture)).name = l.text[c], this._glyphs.push(f)), f.position.x = l.chars[c] + o - a, f.position.y = l.y + p.yOffset * i - h, f.scale.set(i), f.tint = this.tint, f.texture.requiresReTint = !0, f.cachedTint = 16777215, f.parent || this.addChild(f), s++ } } for (u = s; u < this._glyphs.length; u++)this.removeChild(this._glyphs[u]) } }, s.BitmapText.prototype.purgeGlyphs = function () { for (var t = this._glyphs.length, e = [], i = 0; i < this._glyphs.length; i++)this._glyphs[i].parent !== this ? this._glyphs[i].destroy() : e.push(this._glyphs[i]); return this._glyphs = [], this._glyphs = e, this.updateText(), t - e.length }, s.BitmapText.prototype.updateTransform = function () { !this.dirty && this.anchor.equals(this._prevAnchor) || (this.updateText(), this.dirty = !1, this._prevAnchor.copyFrom(this.anchor)), PIXI.DisplayObjectContainer.prototype.updateTransform.call(this) }, Object.defineProperty(s.BitmapText.prototype, "align", { get: function () { return this._align }, set: function (t) { t === this._align || "left" !== t && "center" !== t && "right" !== t || (this._align = t, this.updateText()) } }), Object.defineProperty(s.BitmapText.prototype, "tint", { get: function () { return this._tint }, set: function (t) { t !== this._tint && (this._tint = t, this.updateText()) } }), Object.defineProperty(s.BitmapText.prototype, "font", { get: function () { return this._font }, set: function (t) { t !== this._font && (this._font = t.trim(), this._data = this.game.cache.getBitmapFont(this._font), this.updateText()) } }), Object.defineProperty(s.BitmapText.prototype, "fontSize", { get: function () { return this._fontSize }, set: function (t) { (t = parseInt(t, 10)) !== this._fontSize && t > 0 && (this._fontSize = t, this.updateText()) } }), Object.defineProperty(s.BitmapText.prototype, "text", { get: function () { return this._text }, set: function (t) { t !== this._text && (this._text = t.toString() || "", this.updateText()) } }), Object.defineProperty(s.BitmapText.prototype, "maxWidth", { get: function () { return this._maxWidth }, set: function (t) { t !== this._maxWidth && (this._maxWidth = t, this.updateText()) } }), Object.defineProperty(s.BitmapText.prototype, "smoothed", { get: function () { return !this._data.base.scaleMode }, set: function (t) { this._data.base.scaleMode = t ? 0 : 1, this._data.base.dirty() } }), s.RetroFont = function (t, e, i, r, n, o, a, h, u, l) { if (!t.cache.checkImageKey(e)) return !1; void 0 !== o && null !== o || (o = t.cache.getImage(e).width / i), this.characterWidth = i, this.characterHeight = r, this.characterSpacingX = a || 0, this.characterSpacingY = h || 0, this.characterPerRow = o, this.offsetX = u || 0, this.offsetY = l || 0, this.align = "left", this.multiLine = !1, this.autoUpperCase = !0, this.customSpacingX = 0, this.customSpacingY = 0, this.fixedWidth = 0, this.fontSet = t.cache.getImage(e), this._text = "", this.grabData = [], this.frameData = new s.FrameData; for (var c = this.offsetX, d = this.offsetY, p = 0, f = 0; f < n.length; f++) { var g = this.frameData.addFrame(new s.Frame(f, c, d, this.characterWidth, this.characterHeight)); this.grabData[n.charCodeAt(f)] = g.index, ++p === this.characterPerRow ? (p = 0, c = this.offsetX, d += this.characterHeight + this.characterSpacingY) : c += this.characterWidth + this.characterSpacingX } t.cache.updateFrameData(e, this.frameData), this.stamp = new s.Image(t, 0, 0, e, 0), s.RenderTexture.call(this, t, 100, 100, "", s.scaleModes.NEAREST), this.type = s.RETROFONT }, s.RetroFont.prototype = Object.create(s.RenderTexture.prototype), s.RetroFont.prototype.constructor = s.RetroFont, s.RetroFont.ALIGN_LEFT = "left", s.RetroFont.ALIGN_RIGHT = "right", s.RetroFont.ALIGN_CENTER = "center", s.RetroFont.TEXT_SET1 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~", s.RetroFont.TEXT_SET2 = " !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ", s.RetroFont.TEXT_SET3 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ", s.RetroFont.TEXT_SET4 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789", s.RetroFont.TEXT_SET5 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789", s.RetroFont.TEXT_SET6 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ", s.RetroFont.TEXT_SET7 = "AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39", s.RetroFont.TEXT_SET8 = "0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ", s.RetroFont.TEXT_SET9 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!", s.RetroFont.TEXT_SET10 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ", s.RetroFont.TEXT_SET11 = "ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789", s.RetroFont.prototype.setFixedWidth = function (t, e) { void 0 === e && (e = "left"), this.fixedWidth = t, this.align = e }, s.RetroFont.prototype.setText = function (t, e, i, r, n, s) { this.multiLine = e || !1, this.customSpacingX = i || 0, this.customSpacingY = r || 0, this.align = n || "left", this.autoUpperCase = !s, t.length > 0 && (this.text = t) }, s.RetroFont.prototype.buildRetroFontText = function () { var t = 0, e = 0; if (this.clear(), this.multiLine) { var i = this._text.split("\n"); this.fixedWidth > 0 ? this.resize(this.fixedWidth, i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0) : this.resize(this.getLongestLine() * (this.characterWidth + this.customSpacingX), i.length * (this.characterHeight + this.customSpacingY) - this.customSpacingY, !0); for (var r = 0; r < i.length; r++)t = 0, this.align === s.RetroFont.ALIGN_RIGHT ? t = this.width - i[r].length * (this.characterWidth + this.customSpacingX) : this.align === s.RetroFont.ALIGN_CENTER && (t = this.width / 2 - i[r].length * (this.characterWidth + this.customSpacingX) / 2, t += this.customSpacingX / 2), t < 0 && (t = 0), this.pasteLine(i[r], t, e, this.customSpacingX), e += this.characterHeight + this.customSpacingY } else this.fixedWidth > 0 ? this.resize(this.fixedWidth, this.characterHeight, !0) : this.resize(this._text.length * (this.characterWidth + this.customSpacingX), this.characterHeight, !0), t = 0, this.align === s.RetroFont.ALIGN_RIGHT ? t = this.width - this._text.length * (this.characterWidth + this.customSpacingX) : this.align === s.RetroFont.ALIGN_CENTER && (t = this.width / 2 - this._text.length * (this.characterWidth + this.customSpacingX) / 2, t += this.customSpacingX / 2), t < 0 && (t = 0), this.pasteLine(this._text, t, 0, this.customSpacingX); this.requiresReTint = !0 }, s.RetroFont.prototype.pasteLine = function (t, e, i, r) { for (var n = 0; n < t.length; n++)if (" " === t.charAt(n)) e += this.characterWidth + r; else if (this.grabData[t.charCodeAt(n)] >= 0 && (this.stamp.frame = this.grabData[t.charCodeAt(n)], this.renderXY(this.stamp, e, i, !1), (e += this.characterWidth + r) > this.width)) break }, s.RetroFont.prototype.getLongestLine = function () { var t = 0; if (this._text.length > 0) for (var e = this._text.split("\n"), i = 0; i < e.length; i++)e[i].length > t && (t = e[i].length); return t }, s.RetroFont.prototype.removeUnsupportedCharacters = function (t) { for (var e = "", i = 0; i < this._text.length; i++) { var r = this._text[i], n = r.charCodeAt(0); (this.grabData[n] >= 0 || !t && "\n" === r) && (e = e.concat(r)) } return e }, s.RetroFont.prototype.updateOffset = function (t, e) { if (this.offsetX !== t || this.offsetY !== e) { for (var i = t - this.offsetX, r = e - this.offsetY, n = this.game.cache.getFrameData(this.stamp.key).getFrames(), s = n.length; s--;)n[s].x += i, n[s].y += r; this.buildRetroFontText() } }, Object.defineProperty(s.RetroFont.prototype, "text", { get: function () { return this._text }, set: function (t) { var e; (e = this.autoUpperCase ? t.toUpperCase() : t) !== this._text && (this._text = e, this.removeUnsupportedCharacters(this.multiLine), this.buildRetroFontText()) } }), Object.defineProperty(s.RetroFont.prototype, "smoothed", { get: function () { return this.stamp.smoothed }, set: function (t) { this.stamp.smoothed = t, this.buildRetroFontText() } }), s.Rope = function (t, e, i, r, n, o) { this.points = o || [], this._hasUpdateAnimation = !1, this._updateAnimationCallback = null, e = e || 0, i = i || 0, r = r || null, n = n || null, this.type = s.ROPE, PIXI.DisplayObjectContainer.call(this), this.texture = s.Cache.DEFAULT, this.uvs = new Float32Array([0, 1, 1, 1, 1, 0, 0, 1]), this.vertices = new Float32Array([0, 0, 100, 0, 100, 100, 0, 100]), this.colors = new Float32Array([1, 1, 1, 1]), this.indices = new Uint16Array([0, 1, 2, 3]), o && (this.vertices = new Float32Array(4 * o.length), this.uvs = new Float32Array(4 * o.length), this.colors = new Float32Array(2 * o.length), this.indices = new Uint16Array(2 * o.length)), this.dirty = !0, this.canvasPadding = 0, this.drawMode = s.Rope.TRIANGLE_STRIP, s.Component.Core.init.call(this, t, e, i, r, n), this.refresh() }, s.Rope.prototype = Object.create(PIXI.DisplayObjectContainer.prototype), s.Rope.prototype.constructor = s.Rope, s.Component.Core.install.call(s.Rope.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Crop", "Delta", "Destroy", "FixedToCamera", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "ScaleMinMax", "Smoothed"]), s.Rope.prototype.preUpdatePhysics = s.Component.PhysicsBody.preUpdate, s.Rope.prototype.preUpdateLifeSpan = s.Component.LifeSpan.preUpdate, s.Rope.prototype.preUpdateInWorld = s.Component.InWorld.preUpdate, s.Rope.prototype.preUpdateCore = s.Component.Core.preUpdate, s.Rope.TRIANGLE_STRIP = 0, s.Rope.TRIANGLES = 1, s.Rope.prototype.preUpdate = function () { return !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore() }, s.Rope.prototype.update = function () { this._hasUpdateAnimation && this.updateAnimation.call(this) }, s.Rope.prototype.reset = function (t, e) { return s.Component.Reset.prototype.reset.call(this, t, e), this }, s.Rope.prototype.refresh = function () { var t = this.points; if (!(t.length < 1)) { var e = this.uvs, i = this.indices, r = this.colors; this.count -= .2, e[0] = 0, e[1] = 0, e[2] = 0, e[3] = 1, r[0] = 1, r[1] = 1, i[0] = 0, i[1] = 1; for (var n, s, o = t.length, a = 1; a < o; a++)s = a / (o - 1), e[n = 4 * a] = s, e[n + 1] = 0, e[n + 2] = s, e[n + 3] = 1, r[n = 2 * a] = 1, r[n + 1] = 1, i[n = 2 * a] = n, i[n + 1] = n + 1 } }, s.Rope.prototype.updateTransform = function () { var t = this.points; if (!(t.length < 1)) { var e, i = t[0], r = { x: 0, y: 0 }; this.count -= .2; for (var n, s, o, a, h = this.vertices, u = t.length, l = 0; l < u; l++)n = t[l], s = 4 * l, e = l < t.length - 1 ? t[l + 1] : n, r.y = -(e.x - i.x), r.x = e.y - i.y, 10 * (1 - l / (u - 1)) > 1 && 1, o = Math.sqrt(r.x * r.x + r.y * r.y), a = this.texture.height / 2, r.x /= o, r.y /= o, r.x *= a, r.y *= a, h[s] = n.x + r.x, h[s + 1] = n.y + r.y, h[s + 2] = n.x - r.x, h[s + 3] = n.y - r.y, i = n; PIXI.DisplayObjectContainer.prototype.updateTransform.call(this) } }, s.Rope.prototype.setTexture = function (t) { this.texture = t }, s.Rope.prototype._renderWebGL = function (t) { !this.visible || this.alpha <= 0 || (t.spriteBatch.stop(), this._vertexBuffer || this._initWebGL(t), t.shaderManager.setShader(t.shaderManager.stripShader), this._renderStrip(t), t.spriteBatch.start()) }, s.Rope.prototype._initWebGL = function (t) { var e = t.gl; this._vertexBuffer = e.createBuffer(), this._indexBuffer = e.createBuffer(), this._uvBuffer = e.createBuffer(), this._colorBuffer = e.createBuffer(), e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), e.bufferData(e.ARRAY_BUFFER, this.vertices, e.DYNAMIC_DRAW), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW), e.bindBuffer(e.ARRAY_BUFFER, this._colorBuffer), e.bufferData(e.ARRAY_BUFFER, this.colors, e.STATIC_DRAW), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer), e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW) }, s.Rope.prototype._renderStrip = function (t) { var e = t.gl, i = t.projection, r = t.offset, n = t.shaderManager.stripShader, o = this.drawMode === s.Rope.TRIANGLE_STRIP ? e.TRIANGLE_STRIP : e.TRIANGLES; t.blendModeManager.setBlendMode(this.blendMode), e.uniformMatrix3fv(n.translationMatrix, !1, this.worldTransform.toArray(!0)), e.uniform2f(n.projectionVector, i.x, -i.y), e.uniform2f(n.offsetVector, -r.x, -r.y), e.uniform1f(n.alpha, this.worldAlpha), this.dirty ? (this.dirty = !1, e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), e.bufferData(e.ARRAY_BUFFER, this.vertices, e.STATIC_DRAW), e.vertexAttribPointer(n.aVertexPosition, 2, e.FLOAT, !1, 0, 0), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.bufferData(e.ARRAY_BUFFER, this.uvs, e.STATIC_DRAW), e.vertexAttribPointer(n.aTextureCoord, 2, e.FLOAT, !1, 0, 0), e.activeTexture(e.TEXTURE0), this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer), e.bufferData(e.ELEMENT_ARRAY_BUFFER, this.indices, e.STATIC_DRAW)) : (e.bindBuffer(e.ARRAY_BUFFER, this._vertexBuffer), e.bufferSubData(e.ARRAY_BUFFER, 0, this.vertices), e.vertexAttribPointer(n.aVertexPosition, 2, e.FLOAT, !1, 0, 0), e.bindBuffer(e.ARRAY_BUFFER, this._uvBuffer), e.vertexAttribPointer(n.aTextureCoord, 2, e.FLOAT, !1, 0, 0), e.activeTexture(e.TEXTURE0), this.texture.baseTexture._dirty[e.id] ? t.renderer.updateTexture(this.texture.baseTexture) : e.bindTexture(e.TEXTURE_2D, this.texture.baseTexture._glTextures[e.id]), e.bindBuffer(e.ELEMENT_ARRAY_BUFFER, this._indexBuffer)), e.drawElements(o, this.indices.length, e.UNSIGNED_SHORT, 0) }, s.Rope.prototype._renderCanvas = function (t) { var e = t.context, i = this.worldTransform, r = i.tx * t.resolution + t.shakeX, n = i.ty * t.resolution + t.shakeY; t.roundPixels ? e.setTransform(i.a, i.b, i.c, i.d, 0 | r, 0 | n) : e.setTransform(i.a, i.b, i.c, i.d, r, n), this.drawMode === s.Rope.TRIANGLE_STRIP ? this._renderCanvasTriangleStrip(e) : this._renderCanvasTriangles(e) }, s.Rope.prototype._renderCanvasTriangleStrip = function (t) { var e = this.vertices, i = this.uvs, r = e.length / 2; this.count++; for (var n = 0; n < r - 2; n++) { var s = 2 * n; this._renderCanvasDrawTriangle(t, e, i, s, s + 2, s + 4) } }, s.Rope.prototype._renderCanvasTriangles = function (t) { var e = this.vertices, i = this.uvs, r = this.indices, n = r.length; this.count++; for (var s = 0; s < n; s += 3) { var o = 2 * r[s], a = 2 * r[s + 1], h = 2 * r[s + 2]; this._renderCanvasDrawTriangle(t, e, i, o, a, h) } }, s.Rope.prototype._renderCanvasDrawTriangle = function (t, e, i, r, n, s) { var o = this.texture.baseTexture.source, a = this.texture.width, h = this.texture.height, u = e[r], l = e[n], c = e[s], d = e[r + 1], p = e[n + 1], f = e[s + 1], g = i[r] * a, m = i[n] * a, v = i[s] * a, y = i[r + 1] * h, x = i[n + 1] * h, _ = i[s + 1] * h; if (this.canvasPadding > 0) { var b = this.canvasPadding / this.worldTransform.a, T = this.canvasPadding / this.worldTransform.d, w = (u + l + c) / 3, S = (d + p + f) / 3, C = u - w, P = d - S, E = Math.sqrt(C * C + P * P); u = w + C / E * (E + b), d = S + P / E * (E + T), P = p - S, l = w + (C = l - w) / (E = Math.sqrt(C * C + P * P)) * (E + b), p = S + P / E * (E + T), P = f - S, c = w + (C = c - w) / (E = Math.sqrt(C * C + P * P)) * (E + b), f = S + P / E * (E + T) } t.save(), t.beginPath(), t.moveTo(u, d), t.lineTo(l, p), t.lineTo(c, f), t.closePath(), t.clip(); var A = g * x + y * v + m * _ - x * v - y * m - g * _, R = u * x + y * c + l * _ - x * c - y * l - u * _, M = g * l + u * v + m * c - l * v - u * m - g * c, L = g * x * c + y * l * v + u * m * _ - u * x * v - y * m * c - g * l * _, I = d * x + y * f + p * _ - x * f - y * p - d * _, O = g * p + d * v + m * f - p * v - d * m - g * f, D = g * x * f + y * p * v + d * m * _ - d * x * v - y * m * f - g * p * _; t.transform(R / A, I / A, M / A, O / A, L / A, D / A), t.drawImage(o, 0, 0), t.restore() }, s.Rope.prototype.renderStripFlat = function (t) { var e = this.context, i = t.vertices, r = i.length / 2; this.count++ , e.beginPath(); for (var n = 1; n < r - 2; n++) { var s = 2 * n, o = i[s], a = i[s + 2], h = i[s + 4], u = i[s + 1], l = i[s + 3], c = i[s + 5]; e.moveTo(o, u), e.lineTo(a, l), e.lineTo(h, c) } e.fillStyle = "#FF0000", e.fill(), e.closePath() }, s.Rope.prototype.getBounds = function (t) { for (var e = t || this.worldTransform, i = e.a, r = e.b, n = e.c, s = e.d, o = e.tx, a = e.ty, h = -1 / 0, u = -1 / 0, l = 1 / 0, c = 1 / 0, d = this.vertices, p = 0; p < d.length; p += 2) { var f = d[p], g = d[p + 1], m = i * f + n * g + o, v = s * g + r * f + a; l = m < l ? m : l, c = v < c ? v : c, h = m > h ? m : h, u = v > u ? v : u } if (l === -1 / 0 || u === 1 / 0) return PIXI.EmptyRectangle; var y = this._bounds; return y.x = l, y.width = h - l, y.y = c, y.height = u - c, this._currentBounds = y, y }, Object.defineProperty(s.Rope.prototype, "updateAnimation", { get: function () { return this._updateAnimation }, set: function (t) { t && "function" == typeof t ? (this._hasUpdateAnimation = !0, this._updateAnimation = t) : (this._hasUpdateAnimation = !1, this._updateAnimation = null) } }), Object.defineProperty(s.Rope.prototype, "segments", { get: function () { for (var t, e, i, r, n, o, a, h, u = [], l = 0; l < this.points.length; l++)t = 4 * l, e = this.vertices[t] * this.scale.x, i = this.vertices[t + 1] * this.scale.y, r = this.vertices[t + 4] * this.scale.x, n = this.vertices[t + 3] * this.scale.y, o = s.Math.difference(e, r), a = s.Math.difference(i, n), e += this.world.x, i += this.world.y, h = new s.Rectangle(e, i, o, a), u.push(h); return u } }), s.TileSprite = function (t, e, i, r, n, o, a) { e = e || 0, i = i || 0, r = r || 256, n = n || 256, o = o || null, a = a || null, PIXI.Sprite.call(this, new PIXI.Texture(s.Cache.DEFAULT.baseTexture), r, n), this.type = s.TILESPRITE, this.physicsType = s.SPRITE, this._scroll = new s.Point, this.tileScale = new s.Point(1, 1), this.tileScaleOffset = new s.Point(1, 1), this.tilePosition = new s.Point, this.textureDebug = !1, this.canvasBuffer = null, this.tilingTexture = null, this.tilePattern = null, this.refreshTexture = !0, this.frameWidth = 0, this.frameHeight = 0, this._width = r, this._height = n, s.Component.Core.init.call(this, t, e, i, o, a) }, s.TileSprite.prototype = Object.create(PIXI.Sprite.prototype), s.TileSprite.prototype.constructor = s.TileSprite, s.Component.Core.install.call(s.TileSprite.prototype, ["Angle", "Animation", "AutoCull", "Bounds", "BringToTop", "Destroy", "FixedToCamera", "Health", "InCamera", "InputEnabled", "InWorld", "LifeSpan", "LoadTexture", "Overlap", "PhysicsBody", "Reset", "Smoothed"]), s.TileSprite.prototype.preUpdatePhysics = s.Component.PhysicsBody.preUpdate, s.TileSprite.prototype.preUpdateLifeSpan = s.Component.LifeSpan.preUpdate, s.TileSprite.prototype.preUpdateInWorld = s.Component.InWorld.preUpdate, s.TileSprite.prototype.preUpdateCore = s.Component.Core.preUpdate, s.TileSprite.prototype.preUpdate = function () { return 0 !== this._scroll.x && (this.tilePosition.x += this._scroll.x * this.game.time.physicsElapsed), 0 !== this._scroll.y && (this.tilePosition.y += this._scroll.y * this.game.time.physicsElapsed), !!(this.preUpdatePhysics() && this.preUpdateLifeSpan() && this.preUpdateInWorld()) && this.preUpdateCore() }, s.TileSprite.prototype.autoScroll = function (t, e) { return this._scroll.set(t, e), this }, s.TileSprite.prototype.stopScroll = function () { return this._scroll.set(0, 0), this }, s.TileSprite.prototype.destroy = function (t) { s.Component.Destroy.prototype.destroy.call(this, t), PIXI.Sprite.prototype.destroy.call(this), this.canvasBuffer && (this.canvasBuffer.destroy(), this.canvasBuffer = null), this.tileScale = null, this.tileScaleOffset = null, this.tilePosition = null, this.tilingTexture && (this.tilingTexture.destroy(!0), this.tilingTexture = null) }, s.TileSprite.prototype.reset = function (t, e) { return s.Component.Reset.prototype.reset.call(this, t, e), this.tilePosition.x = 0, this.tilePosition.y = 0, this }, s.TileSprite.prototype.setTexture = function (t) { return this.texture !== t && (this.texture = t, this.refreshTexture = !0, this.cachedTint = 16777215), this }, s.TileSprite.prototype._renderWebGL = function (t) { if (this.visible && this.renderable && 0 !== this.alpha) { if (this._mask && (t.spriteBatch.stop(), t.maskManager.pushMask(this.mask, t), t.spriteBatch.start()), this._filters && (t.spriteBatch.flush(), t.filterManager.pushFilter(this._filterBlock)), this.refreshTexture) { if (this.generateTilingTexture(!0, t), !this.tilingTexture) return; this.tilingTexture.needsUpdate && (this.tilingTexture.baseTexture.textureIndex = this.texture.baseTexture.textureIndex, t.renderer.updateTexture(this.tilingTexture.baseTexture), this.tilingTexture.needsUpdate = !1) } t.spriteBatch.renderTilingSprite(this); for (var e = 0; e < this.children.length; e++)this.children[e]._renderWebGL(t); var i = !1; this._filters && (i = !0, t.spriteBatch.stop(), t.filterManager.popFilter()), this._mask && (i || t.spriteBatch.stop(), t.maskManager.popMask(this._mask, t)), i && t.spriteBatch.start() } }, s.TileSprite.prototype._renderCanvas = function (t) { if (this.visible && this.renderable && 0 !== this.alpha) { var e = t.context; this._mask && t.maskManager.pushMask(this._mask, t), e.globalAlpha = this.worldAlpha; var i = this.worldTransform, r = t.resolution, n = i.tx * r + t.shakeX, s = i.ty * r + t.shakeY; if (e.setTransform(i.a * r, i.b * r, i.c * r, i.d * r, n, s), 16777215 === this.tint || !this.texture.requiresReTint && this.cachedTint === this.tint || (this.tintedTexture = PIXI.CanvasTinter.getTintedTexture(this, this.tint), this.cachedTint = this.tint, this.texture.requiresReTint = !1, this.refreshTexture = !0), this.refreshTexture) { if (this.generateTilingTexture(!1, t), !this.tilingTexture) return; this.tilePattern = e.createPattern(this.tilingTexture.baseTexture.source, "repeat") } var o = t.currentBlendMode; this.blendMode !== t.currentBlendMode && (t.currentBlendMode = this.blendMode, e.globalCompositeOperation = PIXI.blendModesCanvas[t.currentBlendMode]); var a = this.tilePosition, h = this.tileScale; a.x %= this.tilingTexture.baseTexture.width, a.y %= this.tilingTexture.baseTexture.height, e.scale(h.x, h.y), e.translate(a.x + this.anchor.x * -this._width, a.y + this.anchor.y * -this._height), e.fillStyle = this.tilePattern, n = -a.x, s = -a.y; var u = this._width / h.x, l = this._height / h.y; t.roundPixels && (n |= 0, s |= 0, u |= 0, l |= 0), e.fillRect(n, s, u, l), e.scale(1 / h.x, 1 / h.y), e.translate(-a.x + this.anchor.x * this._width, -a.y + this.anchor.y * this._height), this._mask && t.maskManager.popMask(t); for (var c = 0; c < this.children.length; c++)this.children[c]._renderCanvas(t); o !== this.blendMode && (t.currentBlendMode = o, e.globalCompositeOperation = PIXI.blendModesCanvas[o]) } }, s.TileSprite.prototype.onTextureUpdate = function () { }, s.TileSprite.prototype.generateTilingTexture = function (t) { if (this.texture.baseTexture.hasLoaded) { var e = this.texture, i = e.frame, r = this._frame.sourceSizeW || this._frame.width, n = this._frame.sourceSizeH || this._frame.height, o = 0, a = 0; this._frame.trimmed && (o = this._frame.spriteSourceSizeX, a = this._frame.spriteSourceSizeY), t && (r = s.Math.getNextPowerOfTwo(r), n = s.Math.getNextPowerOfTwo(n)), this.canvasBuffer ? (this.canvasBuffer.resize(r, n), this.tilingTexture.baseTexture.width = r, this.tilingTexture.baseTexture.height = n, this.tilingTexture.needsUpdate = !0) : (this.canvasBuffer = new PIXI.CanvasBuffer(r, n), this.tilingTexture = PIXI.Texture.fromCanvas(this.canvasBuffer.canvas), this.tilingTexture.isTiling = !0, this.tilingTexture.needsUpdate = !0), this.textureDebug && (this.canvasBuffer.context.strokeStyle = "#00ff00", this.canvasBuffer.context.strokeRect(0, 0, r, n)); var h = e.crop.width, u = e.crop.height; h === r && u === n || (h = r, u = n); var l = this.tintedTexture ? this.tintedTexture : e.baseTexture.source; this.canvasBuffer.context.drawImage(l, e.crop.x, e.crop.y, e.crop.width, e.crop.height, o, a, h, u), this.tileScaleOffset.x = i.width / r, this.tileScaleOffset.y = i.height / n, this.refreshTexture = !1, this.tilingTexture.baseTexture._powerOf2 = !0 } }, s.TileSprite.prototype.getBounds = function () { var t = this._width, e = this._height, i = t * (1 - this.anchor.x), r = t * -this.anchor.x, n = e * (1 - this.anchor.y), s = e * -this.anchor.y, o = this.worldTransform, a = o.a, h = o.b, u = o.c, l = o.d, c = o.tx, d = o.ty, p = a * r + u * s + c, f = l * s + h * r + d, g = a * i + u * s + c, m = l * s + h * i + d, v = a * i + u * n + c, y = l * n + h * i + d, x = a * r + u * n + c, _ = l * n + h * r + d, b = -1 / 0, T = -1 / 0, w = 1 / 0, S = 1 / 0; w = x < (w = v < (w = g < (w = p < w ? p : w) ? g : w) ? v : w) ? x : w, S = _ < (S = y < (S = m < (S = f < S ? f : S) ? m : S) ? y : S) ? _ : S, b = x > (b = v > (b = g > (b = p > b ? p : b) ? g : b) ? v : b) ? x : b, T = _ > (T = y > (T = m > (T = f > T ? f : T) ? m : T) ? y : T) ? _ : T; var C = this._bounds; return C.x = w, C.width = b - w, C.y = S, C.height = T - S, this._currentBounds = C, C }, Object.defineProperty(s.TileSprite.prototype, "width", { get: function () { return this._width }, set: function (t) { this._width = t } }), Object.defineProperty(s.TileSprite.prototype, "height", { get: function () { return this._height }, set: function (t) { this._height = t } }), s.CanvasPool = { create: function (t, e, i) { var r, n = s.CanvasPool.getFirst(); if (-1 === n) { var o = { parent: t, canvas: document.createElement("canvas") }; s.CanvasPool.pool.push(o), r = o.canvas } else s.CanvasPool.pool[n].parent = t, r = s.CanvasPool.pool[n].canvas; return void 0 !== e && (r.width = e, r.height = i), r }, getFirst: function () { for (var t = s.CanvasPool.pool, e = 0; e < t.length; e++)if (!t[e].parent) return e; return -1 }, remove: function (t) { for (var e = s.CanvasPool.pool, i = 0; i < e.length; i++)e[i].parent === t && (e[i].parent = null, e[i].canvas.width = 1, e[i].canvas.height = 1) }, removeByCanvas: function (t) { for (var e = s.CanvasPool.pool, i = 0; i < e.length; i++)e[i].canvas === t && (e[i].parent = null, e[i].canvas.width = 1, e[i].canvas.height = 1) }, getTotal: function () { for (var t = s.CanvasPool.pool, e = 0, i = 0; i < t.length; i++)t[i].parent && e++; return e }, getFree: function () { for (var t = s.CanvasPool.pool, e = 0, i = 0; i < t.length; i++)t[i].parent || e++; return e }, log: function () { console.log("CanvasPool: %s used, %s free, %s total", this.getTotal(), this.getFree(), this.pool.length) } }, s.CanvasPool.pool = [], Object.defineProperty(s.CanvasPool, "length", { get: function () { return this.pool.length } }), s.Device = function () { this.deviceReadyAt = 0, this.initialized = !1, this.desktop = !1, this.iOS = !1, this.iOSVersion = 0, this.cocoonJS = !1, this.cocoonJSApp = !1, this.cordova = !1, this.node = !1, this.nodeWebkit = !1, this.electron = !1, this.ejecta = !1, this.crosswalk = !1, this.android = !1, this.chromeOS = !1, this.linux = !1, this.macOS = !1, this.windows = !1, this.windowsPhone = !1, this.canvas = !1, this.canvasBitBltShift = null, this.canHandleAlpha = !1, this.canUseMultiply = !1, this.webGL = !1, this.file = !1, this.fileSystem = !1, this.localStorage = !1, this.worker = !1, this.css3D = !1, this.pointerLock = !1, this.typedArray = !1, this.vibration = !1, this.getUserMedia = !0, this.quirksMode = !1, this.touch = !1, this.mspointer = !1, this.wheelEvent = null, this.arora = !1, this.chrome = !1, this.chromeVersion = 0, this.epiphany = !1, this.firefox = !1, this.firefoxVersion = 0, this.ie = !1, this.ieVersion = 0, this.trident = !1, this.tridentVersion = 0, this.edge = !1, this.mobileSafari = !1, this.midori = !1, this.opera = !1, this.safari = !1, this.safariVersion = 0, this.webApp = !1, this.silk = !1, this.audioData = !1, this.webAudio = !1, this.ogg = !1, this.opus = !1, this.mp3 = !1, this.wav = !1, this.m4a = !1, this.webm = !1, this.dolby = !1, this.oggVideo = !1, this.h264Video = !1, this.mp4Video = !1, this.webmVideo = !1, this.vp9Video = !1, this.hlsVideo = !1, this.iPhone = !1, this.iPhone4 = !1, this.iPad = !1, this.pixelRatio = 0, this.littleEndian = !1, this.LITTLE_ENDIAN = !1, this.support32bit = !1, this.fullscreen = !1, this.requestFullscreen = "", this.cancelFullscreen = "", this.fullscreenKeyboard = !1 }, s.Device = new s.Device, s.Device.onInitialized = new s.Signal, s.Device.whenReady = function (t, e, i) { var r = this._readyCheck; if (this.deviceReadyAt || !r) t.call(e, this); else if (r._monitor || i) r._queue = r._queue || [], r._queue.push([t, e]); else { r._monitor = r.bind(this), r._queue = r._queue || [], r._queue.push([t, e]); var n = void 0 !== window.cordova, s = navigator.isCocoonJS; "complete" === document.readyState || "interactive" === document.readyState ? window.setTimeout(r._monitor, 0) : n && !s ? document.addEventListener("deviceready", r._monitor, !1) : (document.addEventListener("DOMContentLoaded", r._monitor, !1), window.addEventListener("load", r._monitor, !1)) } }, s.Device._readyCheck = function () { var t = this._readyCheck; if (document.body) { if (!this.deviceReadyAt) { var e; for (this.deviceReadyAt = Date.now(), document.removeEventListener("deviceready", t._monitor), document.removeEventListener("DOMContentLoaded", t._monitor), window.removeEventListener("load", t._monitor), this._initialize(), this.initialized = !0, this.onInitialized.dispatch(this); e = t._queue.shift();) { var i = e[0], r = e[1]; i.call(r, this) } this._readyCheck = null, this._initialize = null, this.onInitialized = null } } else window.setTimeout(t._monitor, 20) }, s.Device._initialize = function () { var t, e, n, o = this; !function () { var t = navigator.userAgent; /Playstation Vita/.test(t) ? o.vita = !0 : /Kindle/.test(t) || /\bKF[A-Z][A-Z]+/.test(t) || /Silk.*Mobile Safari/.test(t) ? o.kindle = !0 : /Android/.test(t) ? o.android = !0 : /CrOS/.test(t) ? o.chromeOS = !0 : /iP[ao]d|iPhone/i.test(t) ? (o.iOS = !0, navigator.appVersion.match(/OS (\d+)/), o.iOSVersion = parseInt(RegExp.$1, 10)) : /Linux/.test(t) ? o.linux = !0 : /Mac OS/.test(t) ? o.macOS = !0 : /Windows/.test(t) && (o.windows = !0), (/Windows Phone/i.test(t) || /IEMobile/i.test(t)) && (o.android = !1, o.iOS = !1, o.macOS = !1, o.windows = !0, o.windowsPhone = !0); var e = /Silk/.test(t); (o.windows || o.macOS || o.linux && !e || o.chromeOS) && (o.desktop = !0), (o.windowsPhone || /Windows NT/i.test(t) && /Touch/i.test(t)) && (o.desktop = !1) }(), function () { var t = navigator.userAgent; if (/Arora/.test(t) ? o.arora = !0 : /Edge\/\d+/.test(t) ? o.edge = !0 : /Chrome\/(\d+)/.test(t) && !o.windowsPhone ? (o.chrome = !0, o.chromeVersion = parseInt(RegExp.$1, 10)) : /Epiphany/.test(t) ? o.epiphany = !0 : /Firefox\D+(\d+)/.test(t) ? (o.firefox = !0, o.firefoxVersion = parseInt(RegExp.$1, 10)) : /AppleWebKit/.test(t) && o.iOS ? o.mobileSafari = !0 : /MSIE (\d+\.\d+);/.test(t) ? (o.ie = !0, o.ieVersion = parseInt(RegExp.$1, 10)) : /Midori/.test(t) ? o.midori = !0 : /Opera/.test(t) ? o.opera = !0 : /Safari\/(\d+)/.test(t) && !o.windowsPhone ? (o.safari = !0, /Version\/(\d+)\./.test(t) && (o.safariVersion = parseInt(RegExp.$1, 10))) : /Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(t) && (o.ie = !0, o.trident = !0, o.tridentVersion = parseInt(RegExp.$1, 10), o.ieVersion = parseInt(RegExp.$3, 10)), /Silk/.test(t) && (o.silk = !0), navigator.standalone && (o.webApp = !0), void 0 !== window.cordova && (o.cordova = !0), void 0 !== i && (o.node = !0), o.node && "object" === r(i.versions) && (o.nodeWebkit = !!i.versions["node-webkit"], o.electron = !!i.versions.electron), navigator.isCocoonJS && (o.cocoonJS = !0), o.cocoonJS) try { o.cocoonJSApp = "undefined" != typeof CocoonJS } catch (t) { o.cocoonJSApp = !1 } void 0 !== window.ejecta && (o.ejecta = !0), /Crosswalk/.test(t) && (o.crosswalk = !0) }(), function () { o.audioData = !!window.Audio, o.webAudio = !(!window.AudioContext && !window.webkitAudioContext); var t = document.createElement("audio"); try { if (t.canPlayType && (t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/, "") && (o.ogg = !0), (t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/, "") || t.canPlayType("audio/opus;").replace(/^no$/, "")) && (o.opus = !0), t.canPlayType("audio/mpeg;").replace(/^no$/, "") && (o.mp3 = !0), t.canPlayType('audio/wav; codecs="1"').replace(/^no$/, "") && (o.wav = !0), (t.canPlayType("audio/x-m4a;") || t.canPlayType("audio/aac;").replace(/^no$/, "")) && (o.m4a = !0), t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/, "") && (o.webm = !0), "" !== t.canPlayType('audio/mp4;codecs="ec-3"'))) if (o.edge) o.dolby = !0; else if (o.safari && o.safariVersion >= 9 && /Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)) { var e = parseInt(RegExp.$1, 10), i = parseInt(RegExp.$2, 10); (10 === e && i >= 11 || e > 10) && (o.dolby = !0) } } catch (t) { } }(), function () { var t = document.createElement("video"); try { t.canPlayType && (t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/, "") && (o.oggVideo = !0), t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/, "") && (o.h264Video = !0, o.mp4Video = !0), t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/, "") && (o.webmVideo = !0), t.canPlayType('video/webm; codecs="vp9"').replace(/^no$/, "") && (o.vp9Video = !0), t.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/, "") && (o.hlsVideo = !0)) } catch (t) { } }(), function () { var t, e = document.createElement("p"), i = { webkitTransform: "-webkit-transform", OTransform: "-o-transform", msTransform: "-ms-transform", MozTransform: "-moz-transform", transform: "transform" }; for (var r in document.body.insertBefore(e, null), i) void 0 !== e.style[r] && (e.style[r] = "translate3d(1px,1px,1px)", t = window.getComputedStyle(e).getPropertyValue(i[r])); document.body.removeChild(e), o.css3D = void 0 !== t && t.length > 0 && "none" !== t }(), o.pixelRatio = window.devicePixelRatio || 1, o.iPhone = -1 !== navigator.userAgent.toLowerCase().indexOf("iphone"), o.iPhone4 = 2 === o.pixelRatio && o.iPhone, o.iPad = -1 !== navigator.userAgent.toLowerCase().indexOf("ipad"), "undefined" != typeof Int8Array ? o.typedArray = !0 : o.typedArray = !1, "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array && "undefined" != typeof Uint32Array && (o.littleEndian = (t = new ArrayBuffer(4), e = new Uint8Array(t), n = new Uint32Array(t), e[0] = 161, e[1] = 178, e[2] = 195, e[3] = 212, 3569595041 === n[0] || 2712847316 !== n[0] && null), o.LITTLE_ENDIAN = o.littleEndian), o.support32bit = "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8ClampedArray && "undefined" != typeof Int32Array && null !== o.littleEndian && function () { if (void 0 === Uint8ClampedArray) return !1; var t = s.CanvasPool.create(this, 1, 1).getContext("2d"); if (!t) return !1; var e = t.createImageData(1, 1); return s.CanvasPool.remove(this), e.data instanceof Uint8ClampedArray }(), navigator.vibrate = navigator.vibrate || navigator.webkitVibrate || navigator.mozVibrate || navigator.msVibrate, navigator.vibrate && (o.vibration = !0), function () { o.canvas = !!window.CanvasRenderingContext2D || o.cocoonJS; try { o.localStorage = !!localStorage.getItem } catch (t) { o.localStorage = !1 } o.file = !!(window.File && window.FileReader && window.FileList && window.Blob), o.fileSystem = !!window.requestFileSystem, o.webGL = !!window.WebGLRenderingContext, o.worker = !!window.Worker, o.pointerLock = "pointerLockElement" in document || "mozPointerLockElement" in document || "webkitPointerLockElement" in document, o.quirksMode = "CSS1Compat" !== document.compatMode, navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia || navigator.oGetUserMedia, window.URL = window.URL || window.webkitURL || window.mozURL || window.msURL, o.getUserMedia = o.getUserMedia && !!navigator.getUserMedia && !!window.URL, o.firefox && o.firefoxVersion < 21 && (o.getUserMedia = !1), !o.iOS && (o.ie || o.firefox || o.chrome) && (o.canvasBitBltShift = !0), (o.safari || o.mobileSafari) && (o.canvasBitBltShift = !1) }(), function () { var t = s.CanvasPool.create(this, 6, 1), e = t.getContext("2d"); e.fillStyle = "rgba(10, 20, 30, 0.5)", e.fillRect(0, 0, 1, 1); var i = e.getImageData(0, 0, 1, 1); if (i) { e.putImageData(i, 1, 0); var r = e.getImageData(1, 0, 1, 1); o.canHandleAlpha = r.data[0] === i.data[0] && r.data[1] === i.data[1] && r.data[2] === i.data[2] && r.data[3] === i.data[3] } e.globalCompositeOperation = "multiply", o.canUseMultiply = "multiply" === e.globalCompositeOperation, s.CanvasPool.removeByCanvas(t), PIXI.CanvasTinter.tintMethod = o.canUseMultiply ? PIXI.CanvasTinter.tintWithMultiply : PIXI.CanvasTinter.tintWithPerPixel }(), function () { for (var t = ["requestFullscreen", "requestFullScreen", "webkitRequestFullscreen", "webkitRequestFullScreen", "msRequestFullscreen", "msRequestFullScreen", "mozRequestFullScreen", "mozRequestFullscreen"], e = document.createElement("div"), i = 0; i < t.length; i++)if (e[t[i]]) { o.fullscreen = !0, o.requestFullscreen = t[i]; break } var r = ["cancelFullScreen", "exitFullscreen", "webkitCancelFullScreen", "webkitExitFullscreen", "msCancelFullScreen", "msExitFullscreen", "mozCancelFullScreen", "mozExitFullscreen"]; if (o.fullscreen) for (i = 0; i < r.length; i++)if (document[r[i]]) { o.cancelFullscreen = r[i]; break } window.Element && Element.ALLOW_KEYBOARD_INPUT && (o.fullscreenKeyboard = !0) }(), ("ontouchstart" in document.documentElement || window.navigator.maxTouchPoints && window.navigator.maxTouchPoints >= 1) && (o.touch = !0), (window.PointerEvent || window.MSPointerEvent || window.navigator.msPointerEnabled || window.navigator.pointerEnabled) && (o.mspointer = !0), o.cocoonJS || ("onwheel" in window || o.ie && "WheelEvent" in window ? o.wheelEvent = "wheel" : "onmousewheel" in window ? o.wheelEvent = "mousewheel" : o.firefox && "MouseScrollEvent" in window && (o.wheelEvent = "DOMMouseScroll")) }, s.Device.canPlayAudio = function (t) { return !("mp3" !== t || !this.mp3) || (!("ogg" !== t || !this.ogg && !this.opus) || (!("m4a" !== t || !this.m4a) || (!("opus" !== t || !this.opus) || (!("wav" !== t || !this.wav) || (!("webm" !== t || !this.webm) || !("mp4" !== t || !this.dolby)))))) }, s.Device.canPlayVideo = function (t) { return !("webm" !== t || !this.webmVideo && !this.vp9Video) || (!("mp4" !== t || !this.mp4Video && !this.h264Video) || (!("ogg" !== t && "ogv" !== t || !this.oggVideo) || !("mpeg" !== t || !this.hlsVideo))) }, s.Device.needsTouchUnlock = function () { return !!(!this.cocoonJS && (this.iOS || this.android) || window.PhaserGlobal && window.PhaserGlobal.fakeiOSTouchLock) }, s.Device.isAndroidStockBrowser = function () { var t = window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/); return t && t[1] < 537 }, s.Canvas = { create: function (t, e, i, r, n) { e = e || 256, i = i || 256; var o = n ? document.createElement("canvas") : s.CanvasPool.create(t, e, i); return "string" == typeof r && "" !== r && (o.id = r), o.width = e, o.height = i, o.style.display = "block", o }, setBackgroundColor: function (t, e) { return e = e || "rgb(0,0,0)", t.style.backgroundColor = e, t }, setTouchAction: function (t, e) { return e = e || "none", t.style.msTouchAction = e, t.style["ms-touch-action"] = e, t.style["touch-action"] = e, t }, setUserSelect: function (t, e) { return e = e || "none", t.style["-webkit-touch-callout"] = e, t.style["-webkit-user-select"] = e, t.style["-khtml-user-select"] = e, t.style["-moz-user-select"] = e, t.style["-ms-user-select"] = e, t.style["user-select"] = e, t.style["-webkit-tap-highlight-color"] = "rgba(0, 0, 0, 0)", t }, addToDOM: function (t, e, i) { var n; return void 0 === i && (i = !0), e && ("string" == typeof e ? n = document.getElementById(e) : "object" === (void 0 === e ? "undefined" : r(e)) && 1 === e.nodeType && (n = e)), n || (n = document.body), i && n.style && (n.style.overflow = "hidden"), n.appendChild(t), t }, removeFromDOM: function (t) { t.parentNode && t.parentNode.removeChild(t) }, setTransform: function (t, e, i, r, n, s, o) { return t.setTransform(r, s, o, n, e, i), t }, setSmoothingEnabled: function (t, e) { var i = s.Canvas.getSmoothingPrefix(t); return i && (t[i] = e), t }, getSmoothingPrefix: function (t) { var e = ["i", "webkitI", "msI", "mozI", "oI"]; for (var i in e) { var r = e[i] + "mageSmoothingEnabled"; if (r in t) return r } return null }, getSmoothingEnabled: function (t) { var e = s.Canvas.getSmoothingPrefix(t); if (e) return t[e] }, setImageRenderingCrisp: function (t) { for (var e = ["-webkit-optimize-contrast", "-moz-crisp-edges", "crisp-edges", "pixelated"], i = 0; i < e.length; i++)t.style["image-rendering"] = e[i]; return t.style.msInterpolationMode = "nearest-neighbor", t }, setImageRenderingBicubic: function (t) { return t.style["image-rendering"] = "auto", t.style.msInterpolationMode = "bicubic", t } }, s.RequestAnimationFrame = function (t, e) { void 0 === e && (e = !1), this.game = t, this.isRunning = !1, this.forceSetTimeOut = e; for (var i = ["ms", "moz", "webkit", "o"], r = 0; r < i.length && !window.requestAnimationFrame; r++)window.requestAnimationFrame = window[i[r] + "RequestAnimationFrame"], window.cancelAnimationFrame = window[i[r] + "CancelAnimationFrame"] || window[i[r] + "CancelRequestAnimationFrame"]; this._isSetTimeOut = !1, this._onLoop = null, this._timeOutID = null }, s.RequestAnimationFrame.prototype = { start: function () { this.isRunning = !0; var t = this; !window.requestAnimationFrame || this.forceSetTimeOut ? (this._isSetTimeOut = !0, this._onLoop = function () { return t.updateSetTimeout() }, this._timeOutID = window.setTimeout(this._onLoop, 0)) : (this._isSetTimeOut = !1, this._onLoop = function (e) { return t.updateRAF(e) }, this._timeOutID = window.requestAnimationFrame(this._onLoop)) }, updateRAF: function (t) { this.isRunning && (this.game.update(Math.floor(t)), this._timeOutID = window.requestAnimationFrame(this._onLoop)) }, updateSetTimeout: function () { this.isRunning && (this.game.update(Date.now()), this._timeOutID = window.setTimeout(this._onLoop, this.game.time.timeToCall)) }, stop: function () { this._isSetTimeOut ? clearTimeout(this._timeOutID) : window.cancelAnimationFrame(this._timeOutID), this.isRunning = !1 }, isSetTimeOut: function () { return this._isSetTimeOut }, isRAF: function () { return !1 === this._isSetTimeOut } }, s.RequestAnimationFrame.prototype.constructor = s.RequestAnimationFrame, s.Math = { PI2: 2 * Math.PI, HALF_PI: .5 * Math.PI, DEG_TO_RAD: Math.PI / 180, RAD_TO_DEG: 180 / Math.PI, degToRad: function (t) { return t * s.Math.DEG_TO_RAD }, radToDeg: function (t) { return t * s.Math.RAD_TO_DEG }, getNextPowerOfTwo: function (t) { if (t > 0 && 0 == (t & t - 1)) return t; for (var e = 1; e < t;)e <<= 1; return e }, isPowerOfTwo: function (t, e) { return t > 0 && 0 == (t & t - 1) && e > 0 && 0 == (e & e - 1) }, random: function (t, e) { if (void 0 === t && (t = 0), void 0 === e && (e = 1), t === e) return t; if (t > e) { var i = t; t = e, e = i } return Math.random() * (e - t) + t }, between: function (t, e) { if (void 0 === t && (t = 0), void 0 === e && (e = 1), t === e) return t; if (t > e) { var i = t; t = e, e = i } return t = Math.ceil(t), e = Math.floor(e), Math.floor(Math.random() * (e - t + 1)) + t }, fuzzyEqual: function (t, e, i) { return void 0 === i && (i = 1e-4), Math.abs(t - e) < i }, fuzzyLessThan: function (t, e, i) { return void 0 === i && (i = 1e-4), t < e + i }, fuzzyGreaterThan: function (t, e, i) { return void 0 === i && (i = 1e-4), t > e - i }, fuzzyCeil: function (t, e) { return void 0 === e && (e = 1e-4), Math.ceil(t - e) }, fuzzyFloor: function (t, e) { return void 0 === e && (e = 1e-4), Math.floor(t + e) }, average: function () { for (var t = 0, e = arguments.length, i = 0; i < e; i++)t += +arguments[i]; return t / e }, shear: function (t) { return t % 1 }, snapTo: function (t, e, i) { return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.round(t / e))) }, snapToFloor: function (t, e, i) { return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.floor(t / e))) }, snapToCeil: function (t, e, i) { return void 0 === i && (i = 0), 0 === e ? t : (t -= i, i + (t = e * Math.ceil(t / e))) }, roundTo: function (t, e, i) { void 0 === e && (e = 0), void 0 === i && (i = 10); var r = Math.pow(i, -e); return Math.round(t * r) / r }, floorTo: function (t, e, i) { void 0 === e && (e = 0), void 0 === i && (i = 10); var r = Math.pow(i, -e); return Math.floor(t * r) / r }, ceilTo: function (t, e, i) { void 0 === e && (e = 0), void 0 === i && (i = 10); var r = Math.pow(i, -e); return Math.ceil(t * r) / r }, rotateToAngle: function (t, e, i) { return void 0 === i && (i = .05), t === e ? t : (Math.abs(e - t) <= i || Math.abs(e - t) >= s.Math.PI2 - i ? t = e : (Math.abs(e - t) > Math.PI && (e < t ? e += s.Math.PI2 : e -= s.Math.PI2), e > t ? t += i : e < t && (t -= i)), t) }, getShortestAngle: function (t, e) { var i = e - t; return 0 === i ? 0 : i - 360 * Math.floor((i - -180) / 360) }, angleBetween: function (t, e, i, r) { return Math.atan2(r - e, i - t) }, angleBetweenY: function (t, e, i, r) { return Math.atan2(i - t, r - e) }, angleBetweenPoints: function (t, e) { return Math.atan2(e.y - t.y, e.x - t.x) }, angleBetweenPointsY: function (t, e) { return Math.atan2(e.x - t.x, e.y - t.y) }, reverseAngle: function (t) { return this.normalizeAngle(t + Math.PI, !0) }, normalizeAngle: function (t) { return (t %= 2 * Math.PI) >= 0 ? t : t + 2 * Math.PI }, maxAdd: function (t, e, i) { return Math.min(t + e, i) }, minSub: function (t, e, i) { return Math.max(t - e, i) }, wrap: function (t, e, i) { var r = i - e; if (r <= 0) return 0; var n = (t - e) % r; return n < 0 && (n += r), n + e }, wrapValue: function (t, e, i) { return ((t = Math.abs(t)) + (e = Math.abs(e))) % (i = Math.abs(i)) }, isOdd: function (t) { return !!(1 & t) }, isEven: function (t) { return !(1 & t) }, min: function () { if (1 === arguments.length && "object" === r(arguments[0])) var t = arguments[0]; else t = arguments; for (var e = 1, i = 0, n = t.length; e < n; e++)t[e] < t[i] && (i = e); return t[i] }, max: function () { if (1 === arguments.length && "object" === r(arguments[0])) var t = arguments[0]; else t = arguments; for (var e = 1, i = 0, n = t.length; e < n; e++)t[e] > t[i] && (i = e); return t[i] }, minProperty: function (t) { if (2 === arguments.length && "object" === r(arguments[1])) var e = arguments[1]; else e = arguments.slice(1); for (var i = 1, n = 0, s = e.length; i < s; i++)e[i][t] < e[n][t] && (n = i); return e[n][t] }, maxProperty: function (t) { if (2 === arguments.length && "object" === r(arguments[1])) var e = arguments[1]; else e = arguments.slice(1); for (var i = 1, n = 0, s = e.length; i < s; i++)e[i][t] > e[n][t] && (n = i); return e[n][t] }, wrapAngle: function (t, e) { return e ? this.wrap(t, -Math.PI, Math.PI) : this.wrap(t, -180, 180) }, linearInterpolation: function (t, e) { var i = t.length - 1, r = i * e, n = Math.floor(r); return e < 0 ? this.linear(t[0], t[1], r) : e > 1 ? this.linear(t[i], t[i - 1], i - r) : this.linear(t[n], t[n + 1 > i ? i : n + 1], r - n) }, bezierInterpolation: function (t, e) { for (var i = 0, r = t.length - 1, n = 0; n <= r; n++)i += Math.pow(1 - e, r - n) * Math.pow(e, n) * t[n] * this.bernstein(r, n); return i }, catmullRomInterpolation: function (t, e) { var i = t.length - 1, r = i * e, n = Math.floor(r); return t[0] === t[i] ? (e < 0 && (n = Math.floor(r = i * (1 + e))), this.catmullRom(t[(n - 1 + i) % i], t[n], t[(n + 1) % i], t[(n + 2) % i], r - n)) : e < 0 ? t[0] - (this.catmullRom(t[0], t[0], t[1], t[1], -r) - t[0]) : e > 1 ? t[i] - (this.catmullRom(t[i], t[i], t[i - 1], t[i - 1], r - i) - t[i]) : this.catmullRom(t[n ? n - 1 : 0], t[n], t[i < n + 1 ? i : n + 1], t[i < n + 2 ? i : n + 2], r - n) }, linear: function (t, e, i) { return (e - t) * i + t }, bernstein: function (t, e) { return this.factorial(t) / this.factorial(e) / this.factorial(t - e) }, factorial: function (t) { if (0 === t) return 1; for (var e = t; --t;)e *= t; return e }, catmullRom: function (t, e, i, r, n) { var s = .5 * (i - t), o = .5 * (r - e), a = n * n; return (2 * e - 2 * i + s + o) * (n * a) + (-3 * e + 3 * i - 2 * s - o) * a + s * n + e }, difference: function (t, e) { return Math.abs(t - e) }, roundAwayFromZero: function (t) { return t > 0 ? Math.ceil(t) : Math.floor(t) }, sinCosGenerator: function (t, e, i, r) { void 0 === e && (e = 1), void 0 === i && (i = 1), void 0 === r && (r = 1); for (var n = e, s = i, o = r * Math.PI / t, a = [], h = [], u = 0; u < t; u++)n += (s -= n * o) * o, a[u] = s, h[u] = n; return { sin: h, cos: a, length: t } }, hypot: function (t, e) { return Math.sqrt(t * t + e * e) }, distance: function (t, e, i, r) { var n = t - i, s = e - r; return Math.sqrt(n * n + s * s) }, distanceSq: function (t, e, i, r) { var n = t - i, s = e - r; return n * n + s * s }, distancePow: function (t, e, i, r, n) { return void 0 === n && (n = 2), Math.sqrt(Math.pow(i - t, n) + Math.pow(r - e, n)) }, clamp: function (t, e, i) { return t < e ? e : i < t ? i : t }, clampBottom: function (t, e) { return t < e ? e : t }, within: function (t, e, i) { return Math.abs(t - e) <= i }, mapLinear: function (t, e, i, r, n) { return r + (t - e) * (n - r) / (i - e) }, smoothstep: function (t, e, i) { return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * (3 - 2 * t) }, smootherstep: function (t, e, i) { return (t = Math.max(0, Math.min(1, (t - e) / (i - e)))) * t * t * (t * (6 * t - 15) + 10) }, sign: function (t) { return t < 0 ? -1 : t > 0 ? 1 : 0 }, percent: function (t, e, i) { return void 0 === i && (i = 0), t > e || i > e ? 1 : t < i || i > t ? 0 : (t - i) / e } }, s.RandomDataGenerator = function (t) { void 0 === t && (t = []), this.c = 1, this.s0 = 0, this.s1 = 0, this.s2 = 0, "string" == typeof t ? this.state(t) : this.sow(t) }, s.RandomDataGenerator.prototype = { rnd: function () { var t = 2091639 * this.s0 + 2.3283064365386963e-10 * this.c; return this.c = 0 | t, this.s0 = this.s1, this.s1 = this.s2, this.s2 = t - this.c, this.s2 }, sow: function (t) { if (this.s0 = this.hash(" "), this.s1 = this.hash(this.s0), this.s2 = this.hash(this.s1), this.c = 1, t) for (var e = 0; e < t.length && null != t[e]; e++) { var i = t[e]; this.s0 -= this.hash(i), this.s0 += ~~(this.s0 < 0), this.s1 -= this.hash(i), this.s1 += ~~(this.s1 < 0), this.s2 -= this.hash(i), this.s2 += ~~(this.s2 < 0) } }, hash: function (t) { var e, i, r; for (r = 4022871197, t = t.toString(), i = 0; i < t.length; i++)e = .02519603282416938 * (r += t.charCodeAt(i)), e -= r = e >>> 0, r = (e *= r) >>> 0, r += 4294967296 * (e -= r); return 2.3283064365386963e-10 * (r >>> 0) }, integer: function () { return 4294967296 * this.rnd.apply(this) }, frac: function () { return this.rnd.apply(this) + 1.1102230246251565e-16 * (2097152 * this.rnd.apply(this) | 0) }, real: function () { return this.integer() + this.frac() }, integerInRange: function (t, e) { return Math.floor(this.realInRange(0, e - t + 1) + t) }, between: function (t, e) { return this.integerInRange(t, e) }, realInRange: function (t, e) { return this.frac() * (e - t) + t }, normal: function () { return 1 - 2 * this.frac() }, uuid: function () { var t = "", e = ""; for (e = t = ""; t++ < 36; e += ~t % 5 | 3 * t & 4 ? (15 ^ t ? 8 ^ this.frac() * (20 ^ t ? 16 : 4) : 4).toString(16) : "-"); return e }, pick: function (t) { return t[this.integerInRange(0, t.length - 1)] }, sign: function () { return this.pick([-1, 1]) }, weightedPick: function (t) { return t[~~(Math.pow(this.frac(), 2) * (t.length - 1) + .5)] }, timestamp: function (t, e) { return this.realInRange(t || 9466848e5, e || 1577862e6) }, angle: function () { return this.integerInRange(-180, 180) }, state: function (t) { return "string" == typeof t && t.match(/^!rnd/) && (t = t.split(","), this.c = parseFloat(t[1]), this.s0 = parseFloat(t[2]), this.s1 = parseFloat(t[3]), this.s2 = parseFloat(t[4])), ["!rnd", this.c, this.s0, this.s1, this.s2].join(",") } }, s.RandomDataGenerator.prototype.constructor = s.RandomDataGenerator, s.QuadTree = function (t, e, i, r, n, s, o) { this.maxObjects = 10, this.maxLevels = 4, this.level = 0, this.bounds = {}, this.objects = [], this.nodes = [], this._empty = [], this.reset(t, e, i, r, n, s, o) }, s.QuadTree.prototype = { reset: function (t, e, i, r, n, s, o) { this.maxObjects = n || 10, this.maxLevels = s || 4, this.level = o || 0, this.bounds = { x: Math.round(t), y: Math.round(e), width: i, height: r, subWidth: Math.floor(i / 2), subHeight: Math.floor(r / 2), right: Math.round(t) + Math.floor(i / 2), bottom: Math.round(e) + Math.floor(r / 2) }, this.objects.length = 0, this.nodes.length = 0 }, populate: function (t) { t.forEach(this.populateHandler, this, !0) }, populateHandler: function (t) { t.body && t.exists && this.insert(t.body) }, split: function () { this.nodes[0] = new s.QuadTree(this.bounds.right, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[1] = new s.QuadTree(this.bounds.x, this.bounds.y, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[2] = new s.QuadTree(this.bounds.x, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1), this.nodes[3] = new s.QuadTree(this.bounds.right, this.bounds.bottom, this.bounds.subWidth, this.bounds.subHeight, this.maxObjects, this.maxLevels, this.level + 1) }, insert: function (t) { var e, i = 0; if (null == this.nodes[0] || -1 === (e = this.getIndex(t))) { if (this.objects.push(t), this.objects.length > this.maxObjects && this.level < this.maxLevels) for (null == this.nodes[0] && this.split(); i < this.objects.length;)-1 !== (e = this.getIndex(this.objects[i])) ? this.nodes[e].insert(this.objects.splice(i, 1)[0]) : i++ } else this.nodes[e].insert(t) }, getIndex: function (t) { var e = -1; return t.x < this.bounds.right && t.right < this.bounds.right ? t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 1 : t.y > this.bounds.bottom && (e = 2) : t.x > this.bounds.right && (t.y < this.bounds.bottom && t.bottom < this.bounds.bottom ? e = 0 : t.y > this.bounds.bottom && (e = 3)), e }, retrieve: function (t) { if (t instanceof s.Rectangle) var e = this.objects, i = this.getIndex(t); else { if (!t.body) return this._empty; e = this.objects, i = this.getIndex(t.body) } return this.nodes[0] && (e = -1 !== i ? e.concat(this.nodes[i].retrieve(t)) : (e = (e = (e = e.concat(this.nodes[0].retrieve(t))).concat(this.nodes[1].retrieve(t))).concat(this.nodes[2].retrieve(t))).concat(this.nodes[3].retrieve(t))), e }, clear: function () { this.objects.length = 0; for (var t = this.nodes.length; t--;)this.nodes[t].clear(), this.nodes.splice(t, 1); this.nodes.length = 0 } }, s.QuadTree.prototype.constructor = s.QuadTree, s.Net = function (t) { this.game = t }, s.Net.prototype = { getHostName: function () { return window.location && window.location.hostname ? window.location.hostname : null }, checkDomainName: function (t) { return -1 !== window.location.hostname.indexOf(t) }, updateQueryString: function (t, e, i, r) { void 0 === i && (i = !1), void 0 !== r && "" !== r || (r = window.location.href); var n = "", s = new RegExp("([?|&])" + t + "=.*?(&|#|$)(.*)", "gi"); if (s.test(r)) n = void 0 !== e && null !== e ? r.replace(s, "$1" + t + "=" + e + "$2$3") : r.replace(s, "$1$3").replace(/(&|\?)$/, ""); else if (void 0 !== e && null !== e) { var o = -1 !== r.indexOf("?") ? "&" : "?", a = r.split("#"); r = a[0] + o + t + "=" + e, a[1] && (r += "#" + a[1]), n = r } else n = r; if (!i) return n; window.location.href = n }, getQueryString: function (t) { void 0 === t && (t = ""); var e = {}, i = location.search.substring(1).split("&"); for (var r in i) { var n = i[r].split("="); if (n.length > 1) { if (t && t === this.decodeURI(n[0])) return this.decodeURI(n[1]); e[this.decodeURI(n[0])] = this.decodeURI(n[1]) } } return e }, decodeURI: function (t) { return decodeURIComponent(t.replace(/\+/g, " ")) } }, s.Net.prototype.constructor = s.Net, s.TweenManager = function (t) { this.game = t, this.frameBased = !1, this._tweens = [], this._add = [], this.easeMap = { Power0: s.Easing.Power0, Power1: s.Easing.Power1, Power2: s.Easing.Power2, Power3: s.Easing.Power3, Power4: s.Easing.Power4, Linear: s.Easing.Linear.None, Quad: s.Easing.Quadratic.Out, Cubic: s.Easing.Cubic.Out, Quart: s.Easing.Quartic.Out, Quint: s.Easing.Quintic.Out, Sine: s.Easing.Sinusoidal.Out, Expo: s.Easing.Exponential.Out, Circ: s.Easing.Circular.Out, Elastic: s.Easing.Elastic.Out, Back: s.Easing.Back.Out, Bounce: s.Easing.Bounce.Out, "Quad.easeIn": s.Easing.Quadratic.In, "Cubic.easeIn": s.Easing.Cubic.In, "Quart.easeIn": s.Easing.Quartic.In, "Quint.easeIn": s.Easing.Quintic.In, "Sine.easeIn": s.Easing.Sinusoidal.In, "Expo.easeIn": s.Easing.Exponential.In, "Circ.easeIn": s.Easing.Circular.In, "Elastic.easeIn": s.Easing.Elastic.In, "Back.easeIn": s.Easing.Back.In, "Bounce.easeIn": s.Easing.Bounce.In, "Quad.easeOut": s.Easing.Quadratic.Out, "Cubic.easeOut": s.Easing.Cubic.Out, "Quart.easeOut": s.Easing.Quartic.Out, "Quint.easeOut": s.Easing.Quintic.Out, "Sine.easeOut": s.Easing.Sinusoidal.Out, "Expo.easeOut": s.Easing.Exponential.Out, "Circ.easeOut": s.Easing.Circular.Out, "Elastic.easeOut": s.Easing.Elastic.Out, "Back.easeOut": s.Easing.Back.Out, "Bounce.easeOut": s.Easing.Bounce.Out, "Quad.easeInOut": s.Easing.Quadratic.InOut, "Cubic.easeInOut": s.Easing.Cubic.InOut, "Quart.easeInOut": s.Easing.Quartic.InOut, "Quint.easeInOut": s.Easing.Quintic.InOut, "Sine.easeInOut": s.Easing.Sinusoidal.InOut, "Expo.easeInOut": s.Easing.Exponential.InOut, "Circ.easeInOut": s.Easing.Circular.InOut, "Elastic.easeInOut": s.Easing.Elastic.InOut, "Back.easeInOut": s.Easing.Back.InOut, "Bounce.easeInOut": s.Easing.Bounce.InOut }, this.game.onPause.add(this._pauseAll, this), this.game.onResume.add(this._resumeAll, this) }, s.TweenManager.prototype = { getAll: function () { return this._tweens }, removeAll: function () { for (var t = 0; t < this._tweens.length; t++)this._tweens[t].pendingDelete = !0; this._add = [] }, removeFrom: function (t, e) { if (void 0 === e && (e = !0), Array.isArray(t)) for (i = 0, r = t.length; i < r; i++)this.removeFrom(t[i]); else if (t.type === s.GROUP && e) for (var i = 0, r = t.children.length; i < r; i++)this.removeFrom(t.children[i]); else { for (i = 0, r = this._tweens.length; i < r; i++)t === this._tweens[i].target && this.remove(this._tweens[i]); for (i = 0, r = this._add.length; i < r; i++)t === this._add[i].target && this.remove(this._add[i]) } }, add: function (t) { t._manager = this, this._add.push(t) }, create: function (t) { return new s.Tween(t, this.game, this) }, remove: function (t) { var e = this._tweens.indexOf(t); -1 !== e ? this._tweens[e].pendingDelete = !0 : -1 !== (e = this._add.indexOf(t)) && (this._add[e].pendingDelete = !0) }, update: function () { var t = this._add.length, e = this._tweens.length; if (0 === e && 0 === t) return !1; for (var i = 0; i < e;)this._tweens[i].update(this.game.time.time) ? i++ : (this._tweens.splice(i, 1), e--); return t > 0 && (this._tweens = this._tweens.concat(this._add), this._add.length = 0), !0 }, isTweening: function (t, e) { return e || (e = !1), this._tweens.some(function (i) { return i.target === t && (!e || i.isRunning && !i.pendingDelete) }) }, _pauseAll: function () { for (var t = this._tweens.length - 1; t >= 0; t--)this._tweens[t]._pause() }, _resumeAll: function () { for (var t = this._tweens.length - 1; t >= 0; t--)this._tweens[t]._resume() }, pauseAll: function () { for (var t = this._tweens.length - 1; t >= 0; t--)this._tweens[t].pause() }, resumeAll: function () { for (var t = this._tweens.length - 1; t >= 0; t--)this._tweens[t].resume(!0) } }, s.TweenManager.prototype.constructor = s.TweenManager, s.Tween = function (t, e, i) { this.game = e, this.target = t, this.manager = i, this.timeline = [], this.reverse = !1, this.timeScale = 1, this.repeatCounter = 0, this.pendingDelete = !1, this.onStart = new s.Signal, this.onLoop = new s.Signal, this.onRepeat = new s.Signal, this.onChildComplete = new s.Signal, this.onComplete = new s.Signal, this.isRunning = !1, this.current = 0, this.properties = {}, this.chainedTween = null, this.isPaused = !1, this.frameBased = i.frameBased, this._onUpdateCallback = null, this._onUpdateCallbackContext = null, this._pausedTime = 0, this._codePaused = !1, this._hasStarted = !1 }, s.Tween.updateColor = function (t) { s.Color.updateColor(t.target) }, s.Tween.prototype = { to: function (t, e, i, r, n, o, a) { return (void 0 === e || e <= 0) && (e = 1e3), void 0 !== i && null !== i || (i = s.Easing.Default), void 0 === r && (r = !1), void 0 === n && (n = 0), void 0 === o && (o = 0), void 0 === a && (a = !1), "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]), this.isRunning ? (console.warn("Phaser.Tween.to cannot be called after Tween.start"), this) : (this.timeline.push(new s.TweenData(this).to(t, e, i, n, o, a)), r && this.start(), this) }, from: function (t, e, i, r, n, o, a) { return void 0 === e && (e = 1e3), void 0 !== i && null !== i || (i = s.Easing.Default), void 0 === r && (r = !1), void 0 === n && (n = 0), void 0 === o && (o = 0), void 0 === a && (a = !1), "string" == typeof i && this.manager.easeMap[i] && (i = this.manager.easeMap[i]), this.isRunning ? (console.warn("Phaser.Tween.from cannot be called after Tween.start"), this) : (this.timeline.push(new s.TweenData(this).from(t, e, i, n, o, a)), r && this.start(), this) }, start: function (t) { if (void 0 === t && (t = 0), this.pendingDelete) return console.warn("Phaser.Tween.start cannot be called after Tween.stop"), this; if (null === this.game || null === this.target || 0 === this.timeline.length || this.isRunning) return this; for (var e = 0; e < this.timeline.length; e++)for (var i in this.timeline[e].vEnd) this.properties[i] = this.target[i] || 0, Array.isArray(this.properties[i]) || (this.properties[i] *= 1); for (e = 0; e < this.timeline.length; e++)this.timeline[e].loadValues(); return this.manager.add(this), this.isRunning = !0, (t < 0 || t > this.timeline.length - 1) && (t = 0), this.current = t, this.timeline[this.current].start(), this }, stop: function (t) { return void 0 === t && (t = !1), this.isRunning = !1, this._onUpdateCallback = null, this._onUpdateCallbackContext = null, t && (this.onComplete.dispatch(this.target, this), this._hasStarted = !1, this.chainedTween && this.chainedTween.start()), this.manager.remove(this), this }, updateTweenData: function (t, e, i) { if (0 === this.timeline.length) return this; if (void 0 === i && (i = 0), -1 === i) for (var r = 0; r < this.timeline.length; r++)this.timeline[r][t] = e; else this.timeline[i][t] = e; return this }, delay: function (t, e) { return this.updateTweenData("delay", t, e) }, repeat: function (t, e, i) { return void 0 === e && (e = 0), this.updateTweenData("repeatCounter", t, i), this.updateTweenData("repeatTotal", t, i), this.updateTweenData("repeatDelay", e, i) }, repeatDelay: function (t, e) { return this.updateTweenData("repeatDelay", t, e) }, yoyo: function (t, e, i) { return void 0 === e && (e = 0), this.updateTweenData("yoyo", t, i), this.updateTweenData("yoyoDelay", e, i) }, yoyoDelay: function (t, e) { return this.updateTweenData("yoyoDelay", t, e) }, easing: function (t, e) { return "string" == typeof t && this.manager.easeMap[t] && (t = this.manager.easeMap[t]), this.updateTweenData("easingFunction", t, e) }, interpolation: function (t, e, i) { return void 0 === e && (e = s.Math), this.updateTweenData("interpolationFunction", t, i), this.updateTweenData("interpolationContext", e, i) }, repeatAll: function (t) { return void 0 === t && (t = 0), this.repeatCounter = t, this }, chain: function () { for (var t = arguments.length; t--;)t > 0 ? arguments[t - 1].chainedTween = arguments[t] : this.chainedTween = arguments[t]; return this }, loop: function (t) { return void 0 === t && (t = !0), this.repeatCounter = t ? -1 : 0, this }, onUpdateCallback: function (t, e) { return this._onUpdateCallback = t, this._onUpdateCallbackContext = e, this }, pause: function () { this.isPaused = !0, this._codePaused = !0, this._pausedTime = this.game.time.time }, _pause: function () { this._codePaused || (this.isPaused = !0, this._pausedTime = this.game.time.time) }, resume: function () { if (this.isPaused) { this.isPaused = !1, this._codePaused = !1; for (var t = 0; t < this.timeline.length; t++)this.timeline[t].isRunning || (this.timeline[t].startTime += this.game.time.time - this._pausedTime) } }, _resume: function () { this._codePaused || this.resume() }, update: function (t) { if (this.pendingDelete || !this.target) return !1; if (this.isPaused) return !0; var e = this.timeline[this.current].update(t); if (e === s.TweenData.PENDING) return !0; if (e === s.TweenData.RUNNING) return this._hasStarted || (this.onStart.dispatch(this.target, this), this._hasStarted = !0), null !== this._onUpdateCallback && this._onUpdateCallback.call(this._onUpdateCallbackContext, this, this.timeline[this.current].value, this.timeline[this.current]), this.isRunning; if (e === s.TweenData.LOOPED) return -1 === this.timeline[this.current].repeatCounter ? this.onLoop.dispatch(this.target, this) : this.onRepeat.dispatch(this.target, this), !0; if (e === s.TweenData.COMPLETE) { var i = !1; return this.reverse ? (this.current-- , this.current < 0 && (this.current = this.timeline.length - 1, i = !0)) : (this.current++ , this.current === this.timeline.length && (this.current = 0, i = !0)), i ? -1 === this.repeatCounter ? (this.timeline[this.current].start(), this.onLoop.dispatch(this.target, this), !0) : this.repeatCounter > 0 ? (this.repeatCounter-- , this.timeline[this.current].start(), this.onRepeat.dispatch(this.target, this), !0) : (this.isRunning = !1, this.onComplete.dispatch(this.target, this), this._hasStarted = !1, this.chainedTween && this.chainedTween.start(), !1) : (this.onChildComplete.dispatch(this.target, this), this.timeline[this.current].start(), !0) } }, generateData: function (t, e) { if (null === this.game || null === this.target) return null; void 0 === t && (t = 60), void 0 === e && (e = []); for (var i = 0; i < this.timeline.length; i++)for (var r in this.timeline[i].vEnd) this.properties[r] = this.target[r] || 0, Array.isArray(this.properties[r]) || (this.properties[r] *= 1); for (i = 0; i < this.timeline.length; i++)this.timeline[i].loadValues(); for (i = 0; i < this.timeline.length; i++)e = e.concat(this.timeline[i].generateData(t)); return e } }, Object.defineProperty(s.Tween.prototype, "totalDuration", { get: function () { for (var t = 0, e = 0; e < this.timeline.length; e++)t += this.timeline[e].duration; return t } }), s.Tween.prototype.constructor = s.Tween, s.TweenData = function (t) { this.parent = t, this.game = t.game, this.vStart = {}, this.vStartCache = {}, this.vEnd = {}, this.vEndCache = {}, this.duration = 1e3, this.percent = 0, this.value = 0, this.repeatCounter = 0, this.repeatDelay = 0, this.repeatTotal = 0, this.interpolate = !1, this.yoyo = !1, this.yoyoDelay = 0, this.inReverse = !1, this.delay = 0, this.dt = 0, this.startTime = null, this.easingFunction = s.Easing.Default, this.interpolationFunction = s.Math.linearInterpolation, this.interpolationContext = s.Math, this.isRunning = !1, this.isFrom = !1 }, s.TweenData.PENDING = 0, s.TweenData.RUNNING = 1, s.TweenData.LOOPED = 2, s.TweenData.COMPLETE = 3, s.TweenData.prototype = { to: function (t, e, i, r, n, s) { return this.vEnd = t, this.duration = e, this.easingFunction = i, this.delay = r, this.repeatTotal = n, this.yoyo = s, this.isFrom = !1, this }, from: function (t, e, i, r, n, s) { return this.vEnd = t, this.duration = e, this.easingFunction = i, this.delay = r, this.repeatTotal = n, this.yoyo = s, this.isFrom = !0, this }, start: function () { if (this.startTime = this.game.time.time + this.delay, this.parent.reverse ? this.dt = this.duration : this.dt = 0, this.delay > 0 ? this.isRunning = !1 : this.isRunning = !0, this.isFrom) for (var t in this.vStartCache) this.vStart[t] = this.vEndCache[t], this.vEnd[t] = this.vStartCache[t], this.parent.target[t] = this.vStart[t]; return this.value = 0, this.repeatCounter = this.repeatTotal, this }, loadValues: function () { for (var t in this.parent.properties) { if (this.vStart[t] = this.parent.properties[t], Array.isArray(this.vEnd[t])) { if (0 === this.vEnd[t].length) continue; 0 === this.percent && (this.vEnd[t] = [this.vStart[t]].concat(this.vEnd[t])) } void 0 !== this.vEnd[t] ? ("string" == typeof this.vEnd[t] && (this.vEnd[t] = this.vStart[t] + parseFloat(this.vEnd[t], 10)), this.parent.properties[t] = this.vEnd[t]) : this.vEnd[t] = this.vStart[t], this.vStartCache[t] = this.vStart[t], this.vEndCache[t] = this.vEnd[t] } return this }, update: function (t) { if (this.isRunning) { if (t < this.startTime) return s.TweenData.RUNNING } else { if (!(t >= this.startTime)) return s.TweenData.PENDING; this.isRunning = !0 } var e = this.parent.frameBased ? this.game.time.physicsElapsedMS : this.game.time.elapsedMS; for (var i in this.parent.reverse ? (this.dt -= e * this.parent.timeScale, this.dt = Math.max(this.dt, 0)) : (this.dt += e * this.parent.timeScale, this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, this.value = this.easingFunction(this.percent), this.vEnd) { var r = this.vStart[i], n = this.vEnd[i]; Array.isArray(n) ? this.parent.target[i] = this.interpolationFunction.call(this.interpolationContext, n, this.value) : this.parent.target[i] = r + (n - r) * this.value } return !this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent ? this.repeat() : s.TweenData.RUNNING }, generateData: function (t) { this.parent.reverse ? this.dt = this.duration : this.dt = 0; var e = [], i = !1, r = 1 / t * 1e3; do { this.parent.reverse ? (this.dt -= r, this.dt = Math.max(this.dt, 0)) : (this.dt += r, this.dt = Math.min(this.dt, this.duration)), this.percent = this.dt / this.duration, this.value = this.easingFunction(this.percent); var n = {}; for (var s in this.vEnd) { var o = this.vStart[s], a = this.vEnd[s]; Array.isArray(a) ? n[s] = this.interpolationFunction.call(this.interpolationContext, a, this.value) : n[s] = o + (a - o) * this.value } e.push(n), (!this.parent.reverse && 1 === this.percent || this.parent.reverse && 0 === this.percent) && (i = !0) } while (!i); if (this.yoyo) { var h = e.slice(); h.reverse(), e = e.concat(h) } return e }, repeat: function () { if (this.yoyo) { if (this.inReverse && 0 === this.repeatCounter) { for (var t in this.vStartCache) this.vStart[t] = this.vStartCache[t], this.vEnd[t] = this.vEndCache[t]; return this.inReverse = !1, s.TweenData.COMPLETE } this.inReverse = !this.inReverse } else if (0 === this.repeatCounter) return s.TweenData.COMPLETE; if (this.inReverse) for (var t in this.vStartCache) this.vStart[t] = this.vEndCache[t], this.vEnd[t] = this.vStartCache[t]; else { for (var t in this.vStartCache) this.vStart[t] = this.vStartCache[t], this.vEnd[t] = this.vEndCache[t]; this.repeatCounter > 0 && this.repeatCounter-- } return this.startTime = this.game.time.time, this.yoyo && this.inReverse ? this.startTime += this.yoyoDelay : this.inReverse || (this.startTime += this.repeatDelay), this.parent.reverse ? this.dt = this.duration : this.dt = 0, s.TweenData.LOOPED } }, s.TweenData.prototype.constructor = s.TweenData, s.Easing = { Linear: { None: function (t) { return t } }, Quadratic: { In: function (t) { return t * t }, Out: function (t) { return t * (2 - t) }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t : -.5 * (--t * (t - 2) - 1) } }, Cubic: { In: function (t) { return t * t * t }, Out: function (t) { return --t * t * t + 1 }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2) } }, Quartic: { In: function (t) { return t * t * t * t }, Out: function (t) { return 1 - --t * t * t * t }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2) } }, Quintic: { In: function (t) { return t * t * t * t * t }, Out: function (t) { return --t * t * t * t * t + 1 }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2) } }, Sinusoidal: { In: function (t) { return 0 === t ? 0 : 1 === t ? 1 : 1 - Math.cos(t * Math.PI / 2) }, Out: function (t) { return 0 === t ? 0 : 1 === t ? 1 : Math.sin(t * Math.PI / 2) }, InOut: function (t) { return 0 === t ? 0 : 1 === t ? 1 : .5 * (1 - Math.cos(Math.PI * t)) } }, Exponential: { In: function (t) { return 0 === t ? 0 : Math.pow(1024, t - 1) }, Out: function (t) { return 1 === t ? 1 : 1 - Math.pow(2, -10 * t) }, InOut: function (t) { return 0 === t ? 0 : 1 === t ? 1 : (t *= 2) < 1 ? .5 * Math.pow(1024, t - 1) : .5 * (2 - Math.pow(2, -10 * (t - 1))) } }, Circular: { In: function (t) { return 1 - Math.sqrt(1 - t * t) }, Out: function (t) { return Math.sqrt(1 - --t * t) }, InOut: function (t) { return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1) } }, Elastic: { In: function (t) { var e, i = .1; return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), -i * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4)) }, Out: function (t) { var e, i = .1; return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), i * Math.pow(2, -10 * t) * Math.sin((t - e) * (2 * Math.PI) / .4) + 1) }, InOut: function (t) { var e, i = .1; return 0 === t ? 0 : 1 === t ? 1 : (!i || i < 1 ? (i = 1, e = .1) : e = .4 * Math.asin(1 / i) / (2 * Math.PI), (t *= 2) < 1 ? i * Math.pow(2, 10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4) * -.5 : i * Math.pow(2, -10 * (t -= 1)) * Math.sin((t - e) * (2 * Math.PI) / .4) * .5 + 1) } }, Back: { In: function (t) { var e = 1.70158; return t * t * ((e + 1) * t - e) }, Out: function (t) { var e = 1.70158; return --t * t * ((e + 1) * t + e) + 1 }, InOut: function (t) { var e = 2.5949095; return (t *= 2) < 1 ? t * t * ((e + 1) * t - e) * .5 : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2) } }, Bounce: { In: function (t) { return 1 - s.Easing.Bounce.Out(1 - t) }, Out: function (t) { return t < 1 / 2.75 ? 7.5625 * t * t : t < 2 / 2.75 ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : t < 2.5 / 2.75 ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375 }, InOut: function (t) { return t < .5 ? .5 * s.Easing.Bounce.In(2 * t) : .5 * s.Easing.Bounce.Out(2 * t - 1) + .5 } } }, s.Easing.Default = s.Easing.Linear.None, s.Easing.Power0 = s.Easing.Linear.None, s.Easing.Power1 = s.Easing.Quadratic.Out, s.Easing.Power2 = s.Easing.Cubic.Out, s.Easing.Power3 = s.Easing.Quartic.Out, s.Easing.Power4 = s.Easing.Quintic.Out, s.Time = function (t) { this.game = t, this.time = 0, this.prevTime = 0, this.now = 0, this.elapsed = 0, this.elapsedMS = 0, this.physicsElapsed = 1 / 60, this.physicsElapsedMS = 1 / 60 * 1e3, this.desiredFpsMult = 1 / 60, this._desiredFps = 60, this.suggestedFps = this.desiredFps, this.slowMotion = 1, this.advancedTiming = !1, this.frames = 0, this.updates = 0, this.renders = 0, this.fps = 0, this.ups = 0, this.rps = 0, this.fpsMin = 1e3, this.fpsMax = 0, this.msMin = 1e3, this.msMax = 0, this.pauseDuration = 0, this.timeToCall = 0, this.timeExpected = 0, this.events = new s.Timer(this.game, !1), this._frameCount = 0, this._elapsedAccumulator = 0, this._started = 0, this._timeLastSecond = 0, this._pauseStarted = 0, this._justResumed = !1, this._timers = [] }, s.Time.prototype = { boot: function () { this._started = Date.now(), this.time = Date.now(), this.events.start(), this.timeExpected = this.time }, add: function (t) { return this._timers.push(t), t }, create: function (t) { void 0 === t && (t = !0); var e = new s.Timer(this.game, t); return this._timers.push(e), e }, removeAll: function () { for (var t = 0; t < this._timers.length; t++)this._timers[t].destroy(); this._timers = [], this.events.removeAll() }, refresh: function () { var t = this.time; this.time = Date.now(), this.elapsedMS = this.time - t }, update: function (t) { var e = this.time; this.time = Date.now(), this.elapsedMS = this.time - e, this.prevTime = this.now, this.now = t, this.elapsed = this.now - this.prevTime, this.game.raf._isSetTimeOut && (this.timeToCall = Math.floor(Math.max(0, 1e3 / this._desiredFps - (this.timeExpected - t))), this.timeExpected = t + this.timeToCall), this.advancedTiming && this.updateAdvancedTiming(), this.game.paused || (this.events.update(this.time), this._timers.length && this.updateTimers()) }, updateTimers: function () { for (var t = 0, e = this._timers.length; t < e;)this._timers[t].update(this.time) ? t++ : (this._timers.splice(t, 1), e--) }, updateAdvancedTiming: function () { if (this._frameCount++ , this._elapsedAccumulator += this.elapsed, this._frameCount >= 2 * this._desiredFps && (this.suggestedFps = 5 * Math.floor(200 / (this._elapsedAccumulator / this._frameCount)), this._frameCount = 0, this._elapsedAccumulator = 0), this.msMin = Math.min(this.msMin, this.elapsed), this.msMax = Math.max(this.msMax, this.elapsed), this.frames++ , this.now > this._timeLastSecond + 1e3) { var t = this.now - this._timeLastSecond; this.fps = Math.round(1e3 * this.frames / t), this.ups = Math.round(1e3 * this.updates / t), this.rps = Math.round(1e3 * this.renders / t), this.fpsMin = Math.min(this.fpsMin, this.fps), this.fpsMax = Math.max(this.fpsMax, this.fps), this._timeLastSecond = this.now, this.frames = 0, this.updates = 0, this.renders = 0 } }, countUpdate: function () { this.advancedTiming && this.updates++ }, countRender: function () { this.advancedTiming && this.renders++ }, gamePaused: function () { this._pauseStarted = Date.now(), this.events.pause(); for (var t = this._timers.length; t--;)this._timers[t]._pause() }, gameResumed: function () { this.time = Date.now(), this.pauseDuration = this.time - this._pauseStarted, this.events.resume(); for (var t = this._timers.length; t--;)this._timers[t]._resume() }, totalElapsedSeconds: function () { return .001 * (this.time - this._started) }, elapsedSince: function (t) { return this.time - t }, elapsedSecondsSince: function (t) { return .001 * (this.time - t) }, reset: function () { this._started = this.time, this.removeAll() } }, Object.defineProperty(s.Time.prototype, "desiredFps", { get: function () { return this._desiredFps }, set: function (t) { this._desiredFps = t, this.physicsElapsed = 1 / t, this.physicsElapsedMS = 1e3 * this.physicsElapsed, this.desiredFpsMult = 1 / t } }), s.Time.prototype.constructor = s.Time, s.Timer = function (t, e) { void 0 === e && (e = !0), this.game = t, this.running = !1, this.autoDestroy = e, this.expired = !1, this.elapsed = 0, this.events = [], this.onComplete = new s.Signal, this.nextTick = 0, this.timeCap = 1e3, this.paused = !1, this._codePaused = !1, this._started = 0, this._pauseStarted = 0, this._pauseTotal = 0, this._now = Date.now(), this._len = 0, this._marked = 0, this._i = 0, this._diff = 0, this._newTick = 0 }, s.Timer.MINUTE = 6e4, s.Timer.SECOND = 1e3, s.Timer.HALF = 500, s.Timer.QUARTER = 250, s.Timer.prototype = { create: function (t, e, i, r, n, o) { var a = t = Math.round(t); 0 === this._now ? a += this.game.time.time : a += this._now; var h = new s.TimerEvent(this, t, a, i, e, r, n, o); return this.events.push(h), this.order(), this.expired = !1, h }, add: function (t, e, i) { return this.create(t, !1, 0, e, i, Array.prototype.slice.call(arguments, 3)) }, repeat: function (t, e, i, r) { return this.create(t, !1, e, i, r, Array.prototype.slice.call(arguments, 4)) }, loop: function (t, e, i) { return this.create(t, !0, 0, e, i, Array.prototype.slice.call(arguments, 3)) }, start: function (t) { if (!this.running) { this._started = this.game.time.time + (t || 0), this.running = !0; for (var e = 0; e < this.events.length; e++)this.events[e].tick = this.events[e].delay + this._started } }, stop: function (t) { this.running = !1, void 0 === t && (t = !0), t && (this.events.length = 0) }, remove: function (t) { for (var e = 0; e < this.events.length; e++)if (this.events[e] === t) return this.events[e].pendingDelete = !0, !0; return !1 }, order: function () { this.events.length > 0 && (this.events.sort(this.sortHandler), this.nextTick = this.events[0].tick) }, sortHandler: function (t, e) { return t.tick < e.tick ? -1 : t.tick > e.tick ? 1 : 0 }, clearPendingEvents: function () { for (this._i = this.events.length; this._i--;)this.events[this._i].pendingDelete && this.events.splice(this._i, 1); this._len = this.events.length, this._i = 0 }, update: function (t) { if (this.paused) return !0; if (this.elapsed = t - this._now, this._now = t, this.elapsed > this.timeCap && this.adjustEvents(t - this.elapsed), this._marked = 0, this.clearPendingEvents(), this.running && this._now >= this.nextTick && this._len > 0) { for (; this._i < this._len && this.running;) { var e = this.events[this._i]; if (!(this._now >= e.tick) || e.pendingDelete) break; this._newTick = this._now + e.delay - (this._now - e.tick), this._newTick < 0 && (this._newTick = this._now + e.delay), !0 === e.loop ? (e.tick = this._newTick, e.callback.apply(e.callbackContext, e.args)) : e.repeatCount > 0 ? (e.repeatCount-- , e.tick = this._newTick, e.callback.apply(e.callbackContext, e.args)) : (this._marked++ , e.pendingDelete = !0, e.callback.apply(e.callbackContext, e.args)), this._i++ } this.events.length > this._marked ? this.order() : (this.expired = !0, this.onComplete.dispatch(this)) } return !this.expired || !this.autoDestroy }, pause: function () { this.running && (this._codePaused = !0, this.paused || (this._pauseStarted = this.game.time.time, this.paused = !0)) }, _pause: function () { !this.paused && this.running && (this._pauseStarted = this.game.time.time, this.paused = !0) }, adjustEvents: function (t) { for (var e = 0; e < this.events.length; e++)if (!this.events[e].pendingDelete) { var i = this.events[e].tick - t; i < 0 && (i = 0), this.events[e].tick = this._now + i } var r = this.nextTick - t; this.nextTick = r < 0 ? this._now : this._now + r }, resume: function () { if (this.paused) { var t = this.game.time.time; this._pauseTotal += t - this._now, this._now = t, this.adjustEvents(this._pauseStarted), this.paused = !1, this._codePaused = !1 } }, _resume: function () { this._codePaused || this.resume() }, removeAll: function () { this.onComplete.removeAll(), this.events.length = 0, this._len = 0, this._i = 0 }, destroy: function () { this.onComplete.removeAll(), this.running = !1, this.expired = !0, this.events = [], this._len = 0, this._i = 0 } }, Object.defineProperty(s.Timer.prototype, "next", { get: function () { return this.nextTick } }), Object.defineProperty(s.Timer.prototype, "duration", { get: function () { return this.running && this.nextTick > this._now ? this.nextTick - this._now : 0 } }), Object.defineProperty(s.Timer.prototype, "length", { get: function () { return this.events.length } }), Object.defineProperty(s.Timer.prototype, "ms", { get: function () { return this.running ? this._now - this._started - this._pauseTotal : 0 } }), Object.defineProperty(s.Timer.prototype, "seconds", { get: function () { return this.running ? .001 * this.ms : 0 } }), s.Timer.prototype.constructor = s.Timer, s.TimerEvent = function (t, e, i, r, n, s, o, a) { this.timer = t, this.delay = e, this.tick = i, this.repeatCount = r - 1, this.loop = n, this.callback = s, this.callbackContext = o, this.args = a, this.pendingDelete = !1 }, s.TimerEvent.prototype.constructor = s.TimerEvent, s.AnimationManager = function (t) { this.sprite = t, this.game = t.game, this.currentFrame = null, this.currentAnim = null, this.updateIfVisible = !0, this.isLoaded = !1, this._frameData = null, this._anims = {}, this._outputFrames = [] }, s.AnimationManager.prototype = { loadFrameData: function (t, e) { if (void 0 === t) return !1; if (this.isLoaded) for (var i in this._anims) this._anims[i].updateFrameData(t); return this._frameData = t, void 0 === e || null === e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e, this.isLoaded = !0, !0 }, copyFrameData: function (t, e) { if (this._frameData = t.clone(), this.isLoaded) for (var i in this._anims) this._anims[i].updateFrameData(this._frameData); return void 0 === e || null === e ? this.frame = 0 : "string" == typeof e ? this.frameName = e : this.frame = e, this.isLoaded = !0, !0 }, add: function (t, e, i, r, n) { return e = e || [], i = i || 60, void 0 === r && (r = !1), void 0 === n && (n = !(!e || "number" != typeof e[0])), this._outputFrames = [], this._frameData.getFrameIndexes(e, n, this._outputFrames), this._anims[t] = new s.Animation(this.game, this.sprite, t, this._frameData, this._outputFrames, i, r), this.currentAnim = this._anims[t], this.sprite.tilingTexture && (this.sprite.refreshTexture = !0), this._anims[t] }, validateFrames: function (t, e) { void 0 === e && (e = !0); for (var i = 0; i < t.length; i++)if (!0 === e) { if (t[i] > this._frameData.total) return !1 } else if (!1 === this._frameData.checkFrameName(t[i])) return !1; return !0 }, play: function (t, e, i, r) { if (this._anims[t]) return this.currentAnim === this._anims[t] ? !1 === this.currentAnim.isPlaying ? (this.currentAnim.paused = !1, this.currentAnim.play(e, i, r)) : this.currentAnim : (this.currentAnim && this.currentAnim.isPlaying && this.currentAnim.stop(), this.currentAnim = this._anims[t], this.currentAnim.paused = !1, this.currentFrame = this.currentAnim.currentFrame, this.currentAnim.play(e, i, r)) }, stop: function (t, e) { void 0 === e && (e = !1), !this.currentAnim || "string" == typeof t && t !== this.currentAnim.name || this.currentAnim.stop(e) }, update: function () { return !(this.updateIfVisible && !this.sprite.visible) && (!(!this.currentAnim || !this.currentAnim.update()) && (this.currentFrame = this.currentAnim.currentFrame, !0)) }, next: function (t) { this.currentAnim && (this.currentAnim.next(t), this.currentFrame = this.currentAnim.currentFrame) }, previous: function (t) { this.currentAnim && (this.currentAnim.previous(t), this.currentFrame = this.currentAnim.currentFrame) }, getAnimation: function (t) { return "string" == typeof t && this._anims[t] ? this._anims[t] : null }, refreshFrame: function () { }, destroy: function () { var t = null; for (var t in this._anims) this._anims.hasOwnProperty(t) && this._anims[t].destroy(); this._anims = {}, this._outputFrames = [], this._frameData = null, this.currentAnim = null, this.currentFrame = null, this.sprite = null, this.game = null } }, s.AnimationManager.prototype.constructor = s.AnimationManager, Object.defineProperty(s.AnimationManager.prototype, "frameData", { get: function () { return this._frameData } }), Object.defineProperty(s.AnimationManager.prototype, "frameTotal", { get: function () { return this._frameData.total } }), Object.defineProperty(s.AnimationManager.prototype, "paused", { get: function () { return this.currentAnim.isPaused }, set: function (t) { this.currentAnim.paused = t } }), Object.defineProperty(s.AnimationManager.prototype, "name", { get: function () { if (this.currentAnim) return this.currentAnim.name } }), Object.defineProperty(s.AnimationManager.prototype, "frame", { get: function () { if (this.currentFrame) return this.currentFrame.index }, set: function (t) { var e; "number" == typeof t && this._frameData && (e = this._frameData.getFrame(t)) && (this.currentFrame = e, this.sprite.setFrame(this.currentFrame)) } }), Object.defineProperty(s.AnimationManager.prototype, "frameName", { get: function () { if (this.currentFrame) return this.currentFrame.name }, set: function (t) { var e; "string" == typeof t && this._frameData && (e = this._frameData.getFrameByName(t)) ? (this.currentFrame = e, this._frameIndex = this.currentFrame.index, this.sprite.setFrame(this.currentFrame)) : console.warn("Cannot set frameName: " + t) } }), s.Animation = function (t, e, i, r, n, o, a) { void 0 === a && (a = !1), this.game = t, this._parent = e, this._frameData = r, this.name = i, this._frames = [], this._frames = this._frames.concat(n), this.delay = 1e3 / o, this.loop = a, this.loopCount = 0, this.killOnComplete = !1, this.isFinished = !1, this.isPlaying = !1, this.isPaused = !1, this._pauseStartTime = 0, this._frameIndex = 0, this._frameDiff = 0, this._frameSkip = 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.onStart = new s.Signal, this.onUpdate = null, this.onComplete = new s.Signal, this.onLoop = new s.Signal, this.isReversed = !1, this.game.onPause.add(this.onPause, this), this.game.onResume.add(this.onResume, this) }, s.Animation.prototype = { play: function (t, e, i) { return "number" == typeof t && (this.delay = 1e3 / t), "boolean" == typeof e && (this.loop = e), void 0 !== i && (this.killOnComplete = i), this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = this.isReversed ? this._frames.length - 1 : 0, this.updateCurrentFrame(!1, !0), this._parent.events.onAnimationStart$dispatch(this._parent, this), this.onStart.dispatch(this._parent, this), this._parent.animations.currentAnim = this, this._parent.animations.currentFrame = this.currentFrame, this }, restart: function () { this.isPlaying = !0, this.isFinished = !1, this.paused = !1, this.loopCount = 0, this._timeLastFrame = this.game.time.time, this._timeNextFrame = this.game.time.time + this.delay, this._frameIndex = 0, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this._parent.setFrame(this.currentFrame), this._parent.animations.currentAnim = this, this._parent.animations.currentFrame = this.currentFrame, this.onStart.dispatch(this._parent, this) }, reverse: function () { return this.reversed = !this.reversed, this }, reverseOnce: function () { return this.onComplete.addOnce(this.reverse, this), this.reverse() }, setFrame: function (t, e) { var i; if (void 0 === e && (e = !1), "string" == typeof t) for (var r = 0; r < this._frames.length; r++)this._frameData.getFrame(this._frames[r]).name === t && (i = r); else if ("number" == typeof t) if (e) i = t; else for (r = 0; r < this._frames.length; r++)this._frames[r] === t && (i = r); if (i) { var n = this.isReversed ? -1 : 1; this._frameIndex = i - n, this._timeNextFrame = this.game.time.time, this.update() } }, stop: function (t, e) { void 0 === t && (t = !1), void 0 === e && (e = !1), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, t && (this.currentFrame = this._frameData.getFrame(this._frames[0]), this._parent.setFrame(this.currentFrame)), e && (this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this)) }, onPause: function () { this.isPlaying && (this._frameDiff = this._timeNextFrame - this.game.time.time) }, onResume: function () { this.isPlaying && (this._timeNextFrame = this.game.time.time + this._frameDiff) }, update: function () { return !this.isPaused && (!!(this.isPlaying && this.game.time.time >= this._timeNextFrame) && (this._frameSkip = 1, this._frameDiff = this.game.time.time - this._timeNextFrame, this._timeLastFrame = this.game.time.time, this._frameDiff > this.delay ? (this._frameSkip = Math.floor(this._frameDiff / this.delay), this._frameDiff -= this._frameSkip * this.delay) : this._frameDiff = 0, this._timeNextFrame = this.game.time.time + (this.delay - this._frameDiff), this.isReversed ? this._frameIndex -= this._frameSkip : this._frameIndex += this._frameSkip, !this.isReversed && this._frameIndex >= this._frames.length || this.isReversed && this._frameIndex <= -1 ? this.loop ? (this._frameIndex = Math.abs(this._frameIndex) % this._frames.length, this.isReversed && (this._frameIndex = this._frames.length - 1 - this._frameIndex), this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && this._parent.setFrame(this.currentFrame), this.loopCount++ , this._parent.events.onAnimationLoop$dispatch(this._parent, this), this.onLoop.dispatch(this._parent, this), !this.onUpdate || (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData)) : (this.complete(), !1) : this.updateCurrentFrame(!0))) }, updateCurrentFrame: function (t, e) { if (void 0 === e && (e = !1), !this._frameData) return !1; var i = this.currentFrame.index; return this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.currentFrame && (e || !e && i !== this.currentFrame.index) && this._parent.setFrame(this.currentFrame), !this.onUpdate || !t || (this.onUpdate.dispatch(this, this.currentFrame), !!this._frameData) }, next: function (t) { void 0 === t && (t = 1); var e = this._frameIndex + t; e >= this._frames.length && (this.loop ? e %= this._frames.length : e = this._frames.length - 1), e !== this._frameIndex && (this._frameIndex = e, this.updateCurrentFrame(!0)) }, previous: function (t) { void 0 === t && (t = 1); var e = this._frameIndex - t; e < 0 && (this.loop ? e = this._frames.length + e : e++), e !== this._frameIndex && (this._frameIndex = e, this.updateCurrentFrame(!0)) }, updateFrameData: function (t) { this._frameData = t, this.currentFrame = this._frameData ? this._frameData.getFrame(this._frames[this._frameIndex % this._frames.length]) : null }, destroy: function () { this._frameData && (this.game.onPause.remove(this.onPause, this), this.game.onResume.remove(this.onResume, this), this.game = null, this._parent = null, this._frames = null, this._frameData = null, this.currentFrame = null, this.isPlaying = !1, this.onStart.dispose(), this.onLoop.dispose(), this.onComplete.dispose(), this.onUpdate && this.onUpdate.dispose()) }, complete: function () { this._frameIndex = this._frames.length - 1, this.currentFrame = this._frameData.getFrame(this._frames[this._frameIndex]), this.isPlaying = !1, this.isFinished = !0, this.paused = !1, this._parent.events.onAnimationComplete$dispatch(this._parent, this), this.onComplete.dispatch(this._parent, this), this.killOnComplete && this._parent.kill() } }, s.Animation.prototype.constructor = s.Animation, Object.defineProperty(s.Animation.prototype, "paused", { get: function () { return this.isPaused }, set: function (t) { this.isPaused = t, t ? this._pauseStartTime = this.game.time.time : this.isPlaying && (this._timeNextFrame = this.game.time.time + this.delay) } }), Object.defineProperty(s.Animation.prototype, "reversed", { get: function () { return this.isReversed }, set: function (t) { this.isReversed = t } }), Object.defineProperty(s.Animation.prototype, "frameTotal", { get: function () { return this._frames.length } }), Object.defineProperty(s.Animation.prototype, "frame", { get: function () { return null !== this.currentFrame ? this.currentFrame.index : this._frameIndex }, set: function (t) { this.currentFrame = this._frameData.getFrame(this._frames[t]), null !== this.currentFrame && (this._frameIndex = t, this._parent.setFrame(this.currentFrame), this.onUpdate && this.onUpdate.dispatch(this, this.currentFrame)) } }), Object.defineProperty(s.Animation.prototype, "speed", { get: function () { return 1e3 / this.delay }, set: function (t) { t > 0 && (this.delay = 1e3 / t) } }), Object.defineProperty(s.Animation.prototype, "enableUpdate", { get: function () { return null !== this.onUpdate }, set: function (t) { t && null === this.onUpdate ? this.onUpdate = new s.Signal : t || null === this.onUpdate || (this.onUpdate.dispose(), this.onUpdate = null) } }), s.Animation.generateFrameNames = function (t, e, i, r, n) { void 0 === r && (r = ""); var o = [], a = ""; if (e < i) for (var h = e; h <= i; h++)a = t + (a = "number" == typeof n ? s.Utils.pad(h.toString(), n, "0", 1) : h.toString()) + r, o.push(a); else for (h = e; h >= i; h--)a = t + (a = "number" == typeof n ? s.Utils.pad(h.toString(), n, "0", 1) : h.toString()) + r, o.push(a); return o }, s.Frame = function (t, e, i, r, n, o) { this.index = t, this.x = e, this.y = i, this.width = r, this.height = n, 0 !== this.width && 0 !== this.height || console.warn('Phaser.Frame: Frame "' + this.name + '" has a width or height of zero'), this.name = o, this.centerX = Math.floor(r / 2), this.centerY = Math.floor(n / 2), this.distance = s.Math.distance(0, 0, r, n), this.rotated = !1, this.trimmed = !1, this.sourceSizeW = r, this.sourceSizeH = n, this.spriteSourceSizeX = 0, this.spriteSourceSizeY = 0, this.spriteSourceSizeW = 0, this.spriteSourceSizeH = 0, this.right = this.x + this.width, this.bottom = this.y + this.height }, s.Frame.prototype = { resize: function (t, e) { this.width = t, this.height = e, this.centerX = Math.floor(t / 2), this.centerY = Math.floor(e / 2), this.distance = s.Math.distance(0, 0, t, e), this.sourceSizeW = t, this.sourceSizeH = e, this.right = this.x + t, this.bottom = this.y + e }, setTrim: function (t, e, i, r, n, s, o) { this.trimmed = t, t && (this.sourceSizeW = e, this.sourceSizeH = i, this.centerX = Math.floor(e / 2), this.centerY = Math.floor(i / 2), this.spriteSourceSizeX = r, this.spriteSourceSizeY = n, this.spriteSourceSizeW = s, this.spriteSourceSizeH = o) }, clone: function () { var t = new s.Frame(this.index, this.x, this.y, this.width, this.height, this.name); for (var e in this) this.hasOwnProperty(e) && (t[e] = this[e]); return t }, getRect: function (t) { return void 0 === t ? t = new s.Rectangle(this.x, this.y, this.width, this.height) : t.setTo(this.x, this.y, this.width, this.height), t } }, s.Frame.prototype.constructor = s.Frame, s.FrameData = function () { this._frames = [], this._frameNames = [] }, s.FrameData.prototype = { addFrame: function (t) { return t.index = this._frames.length, this._frames.push(t), "" !== t.name && (this._frameNames[t.name] = t.index), t }, getFrame: function (t) { return t >= this._frames.length && (t = 0), this._frames[t] }, getFrameByName: function (t) { return "number" == typeof this._frameNames[t] ? this._frames[this._frameNames[t]] : null }, checkFrameName: function (t) { return null != this._frameNames[t] }, clone: function () { for (var t = new s.FrameData, e = 0; e < this._frames.length; e++)t._frames.push(this._frames[e].clone()); for (var i in this._frameNames) this._frameNames.hasOwnProperty(i) && t._frameNames.push(this._frameNames[i]); return t }, getFrameRange: function (t, e, i) { void 0 === i && (i = []); for (var r = t; r <= e; r++)i.push(this._frames[r]); return i }, getFrames: function (t, e, i) { if (void 0 === e && (e = !0), void 0 === i && (i = []), void 0 === t || 0 === t.length) for (var r = 0; r < this._frames.length; r++)i.push(this._frames[r]); else for (r = 0; r < t.length; r++)e ? i.push(this.getFrame(t[r])) : i.push(this.getFrameByName(t[r])); return i }, getFrameIndexes: function (t, e, i) { if (void 0 === e && (e = !0), void 0 === i && (i = []), void 0 === t || 0 === t.length) for (var r = 0; r < this._frames.length; r++)i.push(this._frames[r].index); else for (r = 0; r < t.length; r++)e && this._frames[t[r]] ? i.push(this._frames[t[r]].index) : this.getFrameByName(t[r]) && i.push(this.getFrameByName(t[r]).index); return i }, destroy: function () { this._frames = null, this._frameNames = null } }, s.FrameData.prototype.constructor = s.FrameData, Object.defineProperty(s.FrameData.prototype, "total", { get: function () { return this._frames.length } }), s.AnimationParser = { spriteSheet: function (t, e, i, r, n, o, a, h) { void 0 === n && (n = -1), void 0 === o && (o = 0), void 0 === a && (a = 0), void 0 === h && (h = 0); var u = e; if ("string" == typeof e && (u = t.cache.getImage(e)), null === u) return null; var l = u.width, c = u.height; i <= 0 && (i = Math.floor(-l / Math.min(-1, i))), r <= 0 && (r = Math.floor(-c / Math.min(-1, r))); var d = Math.floor((l - o) / (i + a)) * Math.floor((c - o) / (r + a)); if (h > d || h < -d) return console.warn("Phaser.AnimationParser.spriteSheet: skipFrames = " + h.toString() + " is larger than total sprite number " + d.toString()), null; if (h < 0 && (h = d + h), -1 !== n && (d = h + n), 0 === l || 0 === c || l < i || c < r || 0 === d) return console.warn("Phaser.AnimationParser.spriteSheet: '" + e + "'s width/height zero or width/height < given frameWidth/frameHeight"), null; for (var p = new s.FrameData, f = o, g = o, m = 0; m < d; m++)p.addFrame(new s.Frame(m, f, g, i, r, "")), (f += i + a) + i > l && (f = o, g += r + a); return p }, JSONData: function (t, e) { if (!e.frames) return console.warn("Phaser.AnimationParser.JSONData: Invalid Texture Atlas JSON given, missing 'frames' array"), void console.log(e); for (var i, r = new s.FrameData, n = e.frames, o = 0; o < n.length; o++)i = r.addFrame(new s.Frame(o, n[o].frame.x, n[o].frame.y, n[o].frame.w, n[o].frame.h, n[o].filename)), n[o].trimmed && i.setTrim(n[o].trimmed, n[o].sourceSize.w, n[o].sourceSize.h, n[o].spriteSourceSize.x, n[o].spriteSourceSize.y, n[o].spriteSourceSize.w, n[o].spriteSourceSize.h), n[o].rotated && (i.rotated = !0); return r }, JSONDataPyxel: function (t, e) { if (["layers", "tilewidth", "tileheight", "tileswide", "tileshigh"].forEach(function (t) { if (!e[t]) return console.warn('Phaser.AnimationParser.JSONDataPyxel: Invalid Pyxel Tilemap JSON given, missing "' + t + '" key.'), void console.log(e) }), 1 !== e.layers.length) return console.warn("Phaser.AnimationParser.JSONDataPyxel: Too many layers, this parser only supports flat Tilemaps."), void console.log(e); for (var i = new s.FrameData, r = e.tileheight, n = e.tilewidth, o = e.layers[0].tiles, a = 0; a < o.length; a++)i.addFrame(new s.Frame(a, o[a].x, o[a].y, n, r, "frame_" + a)).setTrim(!1); return i }, JSONDataHash: function (t, e) { if (!e.frames) return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"), void console.log(e); var i, r = new s.FrameData, n = e.frames, o = 0; for (var a in n) i = r.addFrame(new s.Frame(o, n[a].frame.x, n[a].frame.y, n[a].frame.w, n[a].frame.h, a)), n[a].trimmed && i.setTrim(n[a].trimmed, n[a].sourceSize.w, n[a].sourceSize.h, n[a].spriteSourceSize.x, n[a].spriteSourceSize.y, n[a].spriteSourceSize.w, n[a].spriteSourceSize.h), n[a].rotated && (i.rotated = !0), o++; return r }, XMLData: function (t, e) { if (e.getElementsByTagName("TextureAtlas")) { for (var i, r, n, o, a, h, u, l, c, d, p, f = new s.FrameData, g = e.getElementsByTagName("SubTexture"), m = 0; m < g.length; m++)r = (n = g[m].attributes).name.value, o = parseInt(n.x.value, 10), a = parseInt(n.y.value, 10), h = parseInt(n.width.value, 10), u = parseInt(n.height.value, 10), l = null, c = null, n.frameX && (l = Math.abs(parseInt(n.frameX.value, 10)), c = Math.abs(parseInt(n.frameY.value, 10)), d = parseInt(n.frameWidth.value, 10), p = parseInt(n.frameHeight.value, 10)), i = f.addFrame(new s.Frame(m, o, a, h, u, r)), null === l && null === c || i.setTrim(!0, h, u, l, c, d, p); return f } console.warn("Phaser.AnimationParser.XMLData: Invalid Texture Atlas XML given, missing <TextureAtlas> tag") } }, s.Cache = function (t) { this.game = t, this.autoResolveURL = !1, this._cache = { canvas: {}, image: {}, texture: {}, sound: {}, video: {}, text: {}, json: {}, xml: {}, physics: {}, tilemap: {}, binary: {}, bitmapData: {}, bitmapFont: {}, shader: {}, renderTexture: {}, compressedTexture: {} }, this._urlMap = {}, this._urlResolver = new Image, this._urlTemp = null, this.onSoundUnlock = new s.Signal, this._cacheMap = [], this._cacheMap[s.Cache.CANVAS] = this._cache.canvas, this._cacheMap[s.Cache.IMAGE] = this._cache.image, this._cacheMap[s.Cache.TEXTURE] = this._cache.texture, this._cacheMap[s.Cache.SOUND] = this._cache.sound, this._cacheMap[s.Cache.TEXT] = this._cache.text, this._cacheMap[s.Cache.PHYSICS] = this._cache.physics, this._cacheMap[s.Cache.TILEMAP] = this._cache.tilemap, this._cacheMap[s.Cache.BINARY] = this._cache.binary, this._cacheMap[s.Cache.BITMAPDATA] = this._cache.bitmapData, this._cacheMap[s.Cache.BITMAPFONT] = this._cache.bitmapFont, this._cacheMap[s.Cache.JSON] = this._cache.json, this._cacheMap[s.Cache.XML] = this._cache.xml, this._cacheMap[s.Cache.VIDEO] = this._cache.video, this._cacheMap[s.Cache.SHADER] = this._cache.shader, this._cacheMap[s.Cache.RENDER_TEXTURE] = this._cache.renderTexture, this._pendingCount = 0, this.onReady = new s.Signal, this._addImages() }, s.Cache.CANVAS = 1, s.Cache.IMAGE = 2, s.Cache.TEXTURE = 3, s.Cache.SOUND = 4, s.Cache.TEXT = 5, s.Cache.PHYSICS = 6, s.Cache.TILEMAP = 7, s.Cache.BINARY = 8, s.Cache.BITMAPDATA = 9, s.Cache.BITMAPFONT = 10, s.Cache.JSON = 11, s.Cache.XML = 12, s.Cache.VIDEO = 13, s.Cache.SHADER = 14, s.Cache.RENDER_TEXTURE = 15, s.Cache.DEFAULT = null, s.Cache.DEFAULT_KEY = "__default", s.Cache.DEFAULT_SRC = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==", s.Cache.MISSING = null, s.Cache.MISSING_KEY = "__missing", s.Cache.MISSING_SRC = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==", s.Cache.READY_TIMEOUT = 1e3, s.Cache.prototype = { addCompressedTextureMetaData: function (t, e, i, r) { this.checkImageKey(t) && this.removeImage(t); var n = i in s.LoaderParser ? s.LoaderParser[i](r) : r, o = { key: t, url: e, data: n, base: new PIXI.BaseTexture(n, null, this.game.resolution), frame: new s.Frame(0, 0, 0, n.width, n.height, t), frameData: new s.FrameData, fileFormat: i }; return o.frameData.addFrame(new s.Frame(0, 0, 0, n.width, n.height, e)), this._cache.image[t] = o, this._resolveURL(e, o), o }, addCanvas: function (t, e, i) { void 0 === i && (i = e.getContext("2d")), this._cache.canvas[t] = { canvas: e, context: i } }, addImage: function (t, e, i) { this.checkImageKey(t) && this.removeImage(t), !1 === i.complete && console.warn('Phaser.Cache.addImage: Image "' + t + "\" hasn't been retrieved yet"); var r = { key: t, url: e, data: i, base: new PIXI.BaseTexture(i, null, this.game.resolution), frame: new s.Frame(0, 0, 0, i.width, i.height, t), frameData: new s.FrameData }; return r.frameData.addFrame(new s.Frame(0, 0, 0, i.width, i.height, e)), this._cache.image[t] = r, this._resolveURL(e, r), "__default" === t ? s.Cache.DEFAULT = new PIXI.Texture(r.base) : "__missing" === t && (s.Cache.MISSING = new PIXI.Texture(r.base)), r }, addImageAsync: function (t, e, i) { var r = this, n = new Image; n.onload = function () { i.call(this, r.addImage(t, null, n)), r._removePending(), n.onload = null }, this._addPending(), n.src = e }, addDefaultImage: function () { this.addImageAsync(s.Cache.DEFAULT_KEY, s.Cache.DEFAULT_SRC, function (t) { t.base.skipRender = !0, s.Cache.DEFAULT = new PIXI.Texture(t.base) }) }, addMissingImage: function () { this.addImageAsync(s.Cache.MISSING_KEY, s.Cache.MISSING_SRC, function (t) { s.Cache.MISSING = new PIXI.Texture(t.base) }) }, addSound: function (t, e, i, r, n) { void 0 === r && (r = !0, n = !1), void 0 === n && (r = !1, n = !0); var s = !1; n && (s = !0), this._cache.sound[t] = { url: e, data: i, isDecoding: !1, decoded: s, webAudio: r, audioTag: n, locked: this.game.sound.touchLocked }, this._resolveURL(e, this._cache.sound[t]) }, addText: function (t, e, i) { this._cache.text[t] = { url: e, data: i }, this._resolveURL(e, this._cache.text[t]) }, addPhysicsData: function (t, e, i, r) { this._cache.physics[t] = { url: e, data: i, format: r }, this._resolveURL(e, this._cache.physics[t]) }, addTilemap: function (t, e, i, r) { this._cache.tilemap[t] = { url: e, data: i, format: r }, this._resolveURL(e, this._cache.tilemap[t]) }, addBinary: function (t, e) { this._cache.binary[t] = e }, addBitmapData: function (t, e, i) { return e.key = t, void 0 === i && (i = new s.FrameData).addFrame(e.textureFrame), this._cache.bitmapData[t] = { data: e, frameData: i }, e }, addBitmapFont: function (t, e, i, r, n, o, a) { var h = { url: e, data: i, font: null, base: new PIXI.BaseTexture(i, null, this.game.resolution) }; void 0 === o && (o = 0), void 0 === a && (a = 0), h.font = "json" === n ? s.LoaderParser.jsonBitmapFont(r, h.base, o, a, !1, this.game.resolution) : s.LoaderParser.xmlBitmapFont(r, h.base, o, a, !1, this.game.resolution), this._cache.bitmapFont[t] = h, this._resolveURL(e, h) }, addBitmapFontFromAtlas: function (t, e, i, r, n, o, a) { var h = this.getFrameByName(e, i); if (h) { var u, l = { font: null, base: this.getBaseTexture(e), frame: h }; void 0 === o && (o = 0), void 0 === a && (a = 0), "json" === n ? (u = this.getJSON(r), l.font = s.LoaderParser.jsonBitmapFont(u, l.base, o, a, h, this.game.resolution)) : (u = this.getXML(r), l.font = s.LoaderParser.xmlBitmapFont(u, l.base, o, a, h, this.game.resolution)), this._cache.bitmapFont[t] = l } }, addJSON: function (t, e, i) { this._cache.json[t] = { url: e, data: i }, this._resolveURL(e, this._cache.json[t]) }, addXML: function (t, e, i) { this._cache.xml[t] = { url: e, data: i }, this._resolveURL(e, this._cache.xml[t]) }, addVideo: function (t, e, i, r) { this._cache.video[t] = { url: e, data: i, isBlob: r, locked: !0 }, this._resolveURL(e, this._cache.video[t]) }, addShader: function (t, e, i) { this._cache.shader[t] = { url: e, data: i }, this._resolveURL(e, this._cache.shader[t]) }, addRenderTexture: function (t, e) { this._cache.renderTexture[t] = { texture: e, frame: new s.Frame(0, 0, 0, e.width, e.height, "", "") } }, addSpriteSheet: function (t, e, i, r, n, o, a, h, u) { void 0 === o && (o = -1), void 0 === a && (a = 0), void 0 === h && (h = 0); var l = { key: t, url: e, data: i, frameWidth: r, frameHeight: n, margin: a, spacing: h, base: new PIXI.BaseTexture(i, null, this.game.resolution), frameData: s.AnimationParser.spriteSheet(this.game, i, r, n, o, a, h, u) }; this._cache.image[t] = l, this._resolveURL(e, l) }, addTextureAtlas: function (t, e, i, r, n) { var o = { key: t, url: e, data: i, base: new PIXI.BaseTexture(i, null, this.game.resolution) }; n === s.Loader.TEXTURE_ATLAS_XML_STARLING ? o.frameData = s.AnimationParser.XMLData(this.game, r, t) : n === s.Loader.TEXTURE_ATLAS_JSON_PYXEL ? o.frameData = s.AnimationParser.JSONDataPyxel(this.game, r, t) : Array.isArray(r.frames) ? o.frameData = s.AnimationParser.JSONData(this.game, r, t) : o.frameData = s.AnimationParser.JSONDataHash(this.game, r, t), this._cache.image[t] = o, this._resolveURL(e, o) }, reloadSound: function (t) { var e = this, i = this.getSound(t); i && (i.data.src = i.url, i.data.addEventListener("canplaythrough", function () { return e.reloadSoundComplete(t) }, !1), i.data.load()) }, reloadSoundComplete: function (t) { var e = this.getSound(t); e && (e.locked = !1, this.onSoundUnlock.dispatch(t)) }, updateSound: function (t, e, i) { var r = this.getSound(t); r && (r[e] = i) }, decodedSound: function (t, e) { var i = this.getSound(t); i.data = e, i.decoded = !0, i.isDecoding = !1 }, isSoundDecoded: function (t) { var e = this.getItem(t, s.Cache.SOUND, "isSoundDecoded"); if (e) return e.decoded }, isSoundReady: function (t) { var e = this.getItem(t, s.Cache.SOUND, "isSoundDecoded"); if (e) return e.decoded && !this.game.sound.touchLocked }, checkKey: function (t, e) { return !!this._cacheMap[t][e] }, checkURL: function (t) { return !!this._urlMap[this._resolveURL(t)] }, checkCanvasKey: function (t) { return this.checkKey(s.Cache.CANVAS, t) }, checkImageKey: function (t) { return this.checkKey(s.Cache.IMAGE, t) }, checkTextureKey: function (t) { return this.checkKey(s.Cache.TEXTURE, t) }, checkSoundKey: function (t) { return this.checkKey(s.Cache.SOUND, t) }, checkTextKey: function (t) { return this.checkKey(s.Cache.TEXT, t) }, checkPhysicsKey: function (t) { return this.checkKey(s.Cache.PHYSICS, t) }, checkTilemapKey: function (t) { return this.checkKey(s.Cache.TILEMAP, t) }, checkBinaryKey: function (t) { return this.checkKey(s.Cache.BINARY, t) }, checkBitmapDataKey: function (t) { return this.checkKey(s.Cache.BITMAPDATA, t) }, checkBitmapFontKey: function (t) { return this.checkKey(s.Cache.BITMAPFONT, t) }, checkJSONKey: function (t) { return this.checkKey(s.Cache.JSON, t) }, checkXMLKey: function (t) { return this.checkKey(s.Cache.XML, t) }, checkVideoKey: function (t) { return this.checkKey(s.Cache.VIDEO, t) }, checkShaderKey: function (t) { return this.checkKey(s.Cache.SHADER, t) }, checkRenderTextureKey: function (t) { return this.checkKey(s.Cache.RENDER_TEXTURE, t) }, getItem: function (t, e, i, r) { return this.checkKey(e, t) ? void 0 === r ? this._cacheMap[e][t] : this._cacheMap[e][t][r] : (i && console.warn("Phaser.Cache." + i + ': Key "' + t + '" not found in Cache.'), null) }, getCanvas: function (t) { return this.getItem(t, s.Cache.CANVAS, "getCanvas", "canvas") }, getImage: function (t, e) { void 0 !== t && null !== t || (t = "__default"), void 0 === e && (e = !1); var i = this.getItem(t, s.Cache.IMAGE, "getImage"); return null === i && (i = this.getItem("__missing", s.Cache.IMAGE, "getImage")), e ? i : i.data }, getTextureFrame: function (t) { return this.getItem(t, s.Cache.TEXTURE, "getTextureFrame", "frame") }, getSound: function (t) { return this.getItem(t, s.Cache.SOUND, "getSound") }, getSoundData: function (t) { return this.getItem(t, s.Cache.SOUND, "getSoundData", "data") }, getText: function (t) { return this.getItem(t, s.Cache.TEXT, "getText", "data") }, getPhysicsData: function (t, e, i) { var r = this.getItem(t, s.Cache.PHYSICS, "getPhysicsData", "data"); if (null === r || void 0 === e || null === e) return r; if (r[e]) { var n = r[e]; if (!n || !i) return n; for (var o in n) if ((o = n[o]).fixtureKey === i) return o; console.warn('Phaser.Cache.getPhysicsData: Could not find given fixtureKey: "' + i + " in " + t + '"') } else console.warn('Phaser.Cache.getPhysicsData: Invalid key/object: "' + t + " / " + e + '"'); return null }, getTilemapData: function (t) { return this.getItem(t, s.Cache.TILEMAP, "getTilemapData") }, getBinary: function (t) { return this.getItem(t, s.Cache.BINARY, "getBinary") }, getBitmapData: function (t) { return this.getItem(t, s.Cache.BITMAPDATA, "getBitmapData", "data") }, getBitmapFont: function (t) { return this.getItem(t, s.Cache.BITMAPFONT, "getBitmapFont") }, getJSON: function (t, e) { var i = this.getItem(t, s.Cache.JSON, "getJSON", "data"); return i ? e ? s.Utils.extend(!0, Array.isArray(i) ? [] : {}, i) : i : null }, getXML: function (t) { return this.getItem(t, s.Cache.XML, "getXML", "data") }, getVideo: function (t) { return this.getItem(t, s.Cache.VIDEO, "getVideo") }, getShader: function (t) { return this.getItem(t, s.Cache.SHADER, "getShader", "data") }, getRenderTexture: function (t) { return this.getItem(t, s.Cache.RENDER_TEXTURE, "getRenderTexture") }, getBaseTexture: function (t, e) { return void 0 === e && (e = s.Cache.IMAGE), this.getItem(t, e, "getBaseTexture", "base") }, getFrame: function (t, e) { return void 0 === e && (e = s.Cache.IMAGE), this.getItem(t, e, "getFrame", "frame") }, getFrameCount: function (t, e) { var i = this.getFrameData(t, e); return i ? i.total : 0 }, getFrameData: function (t, e) { return void 0 === e && (e = s.Cache.IMAGE), this.getItem(t, e, "getFrameData", "frameData") }, hasFrameData: function (t, e) { return void 0 === e && (e = s.Cache.IMAGE), null !== this.getItem(t, e, "", "frameData") }, updateFrameData: function (t, e, i) { void 0 === i && (i = s.Cache.IMAGE), this._cacheMap[i][t] && (this._cacheMap[i][t].frameData = e) }, getFrameByIndex: function (t, e, i) { var r = this.getFrameData(t, i); return r ? r.getFrame(e) : null }, getFrameByName: function (t, e, i) { var r = this.getFrameData(t, i); return r ? r.getFrameByName(e) : null }, getURL: function (t) { return (t = this._resolveURL(t)) ? this._urlMap[t] : (console.warn('Phaser.Cache.getUrl: Invalid url: "' + t + '" or Cache.autoResolveURL was false'), null) }, getKeys: function (t) { void 0 === t && (t = s.Cache.IMAGE); var e = []; if (this._cacheMap[t]) for (var i in this._cacheMap[t]) "__default" !== i && "__missing" !== i && e.push(i); return e }, removeCanvas: function (t) { delete this._cache.canvas[t] }, removeImage: function (t, e) { void 0 === e && (e = !0); var i = this.getImage(t, !0); e && i.base && i.base.destroy(), delete this._cache.image[t] }, removeSound: function (t) { delete this._cache.sound[t] }, removeText: function (t) { delete this._cache.text[t] }, removePhysics: function (t) { delete this._cache.physics[t] }, removeTilemap: function (t) { delete this._cache.tilemap[t] }, removeBinary: function (t) { delete this._cache.binary[t] }, removeBitmapData: function (t) { delete this._cache.bitmapData[t] }, removeBitmapFont: function (t) { delete this._cache.bitmapFont[t] }, removeJSON: function (t) { delete this._cache.json[t] }, removeXML: function (t) { delete this._cache.xml[t] }, removeVideo: function (t) { delete this._cache.video[t] }, removeShader: function (t) { delete this._cache.shader[t] }, removeRenderTexture: function (t) { delete this._cache.renderTexture[t] }, removeSpriteSheet: function (t) { delete this._cache.spriteSheet[t] }, removeTextureAtlas: function (t) { delete this._cache.image[t] }, clearGLTextures: function () { for (var t in this._cache.image) this._cache.image[t].base._glTextures = [] }, _resolveURL: function (t, e) { return this.autoResolveURL ? (this._urlResolver.src = this.game.load.baseURL + t, this._urlTemp = this._urlResolver.src, this._urlResolver.src = "", e && (this._urlMap[this._urlTemp] = e), this._urlTemp) : null }, destroy: function () { for (var t = 0; t < this._cacheMap.length; t++) { var e = this._cacheMap[t]; for (var i in e) "__default" !== i && "__missing" !== i && (this.destroyItem(e[i]), delete e[i]) } this._urlMap = null, this._urlResolver = null, this._urlTemp = null }, destroyItem: function (t) { t.destroy ? t.destroy() : (t.base && t.base.destroy && t.base.destroy(), t.data && t.data.destroy && t.data.destroy(), t.frameData && t.frameData.destroy && t.frameData.destroy(), t.texture && t.texture.destroy && t.texture.destroy(!0)) }, _addImages: function () { this._pendingCount = 0, this.addDefaultImage(), this.addMissingImage(); var t = this, e = s.Cache.READY_TIMEOUT; s.Cache.READY_TIMEOUT > 0 ? setTimeout(function () { t.isReady || (console.warn("Phaser.Cache: Still waiting for images after %s ms.", e), t._ready()) }, s.Cache.READY_TIMEOUT) : this._ready() }, _addPending: function () { this._pendingCount += 1 }, _removePending: function () { this._pendingCount -= 1, this._checkReady() }, _checkReady: function () { this.isReady && this._ready() }, _ready: function () { this._pendingCount = 0, this.onReady.dispatch(this) } }, s.Cache.prototype.constructor = s.Cache, Object.defineProperty(s.Cache.prototype, "isReady", { get: function () { return this._pendingCount <= 0 } }), s.Loader = function (t) { this.game = t, this.cache = t.cache, this.resetLocked = !1, this.isLoading = !1, this.hasLoaded = !1, this.preloadSprite = null, this.crossOrigin = !1, this.baseURL = "", this.path = "", this.headers = { requestedWith: !1, json: "application/json", xml: "application/xml" }, this.onLoadStart = new s.Signal, this.onBeforeLoadComplete = new s.Signal, this.onLoadComplete = new s.Signal, this.onPackComplete = new s.Signal, this.onFileStart = new s.Signal, this.onFileComplete = new s.Signal, this.onFileError = new s.Signal, this.enableParallel = !0, this.maxParallelDownloads = 4, this._withSyncPointDepth = 0, this._fileList = [], this._flightQueue = [], this._processingHead = 0, this._fileLoadStarted = !1, this._totalPackCount = 0, this._totalFileCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0 }, s.Loader.TEXTURE_ATLAS_JSON_ARRAY = 0, s.Loader.TEXTURE_ATLAS_JSON_HASH = 1, s.Loader.TEXTURE_ATLAS_XML_STARLING = 2, s.Loader.PHYSICS_LIME_CORONA_JSON = 3, s.Loader.PHYSICS_PHASER_JSON = 4, s.Loader.TEXTURE_ATLAS_JSON_PYXEL = 5, s.Loader.prototype = { setPreloadSprite: function (t, e) { e = e || 0, this.preloadSprite = { sprite: t, direction: e, width: t.width, height: t.height, rect: null }, this.preloadSprite.rect = 0 === e ? new s.Rectangle(0, 0, 1, t.height) : new s.Rectangle(0, 0, t.width, 1), t.crop(this.preloadSprite.rect), t.visible = !0 }, resize: function () { this.preloadSprite && this.preloadSprite.height !== this.preloadSprite.sprite.height && (this.preloadSprite.rect.height = this.preloadSprite.sprite.height) }, checkKeyExists: function (t, e) { return this.getAssetIndex(t, e) > -1 }, getAssetIndex: function (t, e) { for (var i = -1, r = 0; r < this._fileList.length; r++) { var n = this._fileList[r]; if (n.type === t && n.key === e && (i = r, !n.loaded && !n.loading)) break } return i }, getAsset: function (t, e) { var i = this.getAssetIndex(t, e); return i > -1 && { index: i, file: this._fileList[i] } }, reset: function (t, e) { void 0 === e && (e = !1), this.resetLocked || (t && (this.preloadSprite = null), this.isLoading = !1, this._processingHead = 0, this._fileList.length = 0, this._flightQueue.length = 0, this._fileLoadStarted = !1, this._totalFileCount = 0, this._totalPackCount = 0, this._loadedPackCount = 0, this._loadedFileCount = 0, e && (this.onLoadStart.removeAll(), this.onLoadComplete.removeAll(), this.onPackComplete.removeAll(), this.onFileStart.removeAll(), this.onFileComplete.removeAll(), this.onFileError.removeAll())) }, addToFileList: function (t, e, i, r, n, s) { if (void 0 === n && (n = !1), void 0 === e || "" === e) return console.warn("Phaser.Loader: Invalid or no key given of type " + t), this; if (void 0 === i || null === i) { if (!s) return console.warn("Phaser.Loader: No URL given for file type: " + t + " key: " + e), this; i = e + s } var o = { type: t, key: e, path: this.path, url: i, syncPoint: this._withSyncPointDepth > 0, data: null, loading: !1, loaded: !1, error: !1 }; if (r) for (var a in r) o[a] = r[a]; var h = this.getAssetIndex(t, e); if (n && h > -1) { var u = this._fileList[h]; u.loading || u.loaded ? (this._fileList.push(o), this._totalFileCount++) : this._fileList[h] = o } else -1 === h && (this._fileList.push(o), this._totalFileCount++); return this }, replaceInFileList: function (t, e, i, r) { return this.addToFileList(t, e, i, r, !0) }, pack: function (t, e, i, r) { if (void 0 === e && (e = null), void 0 === i && (i = null), void 0 === r && (r = null), !e && !i) return console.warn("Phaser.Loader.pack - Both url and data are null. One must be set."), this; var n = { type: "packfile", key: t, url: e, path: this.path, syncPoint: !0, data: null, loading: !1, loaded: !1, error: !1, callbackContext: r }; i && ("string" == typeof i && (i = JSON.parse(i)), n.data = i || {}, n.loaded = !0); for (var s = 0; s < this._fileList.length + 1; s++) { var o = this._fileList[s]; if (!o || !o.loaded && !o.loading && "packfile" !== o.type) { this._fileList.splice(s, 0, n), this._totalPackCount++; break } } return this }, image: function (t, e, i) { return "object" === (void 0 === e ? "undefined" : r(e)) ? this.texture(t, e, i) : this.addToFileList("image", t, e, void 0, i, ".png") }, imageFromBitmapData: function (t, e, i) { return this.image(t, e.canvas.toDataURL("image/png"), i) }, imageFromGrid: function (t, e, i, r, n, s) { return this.imageFromBitmapData(t, this.game.create.grid(t, e, i, r, n, s, !1)) }, imageFromTexture: function (t, e, i, r, n) { return this.imageFromBitmapData(t, this.game.create.texture(t, e, i, r, n, !1)) }, texture: function (t, e, i) { if (this.game.renderType === s.WEBGL) { var r, n = this.game.renderer.extensions.compression; for (r in e) if (r.toUpperCase() in n) return this.addToFileList("texture", t, e[r], void 0, i, ".pvr") } return e.truecolor && this.addToFileList("image", t, e.truecolor, void 0, i, ".png"), this }, images: function (t, e) { if (Array.isArray(e)) for (var i = 0; i < t.length; i++)this.image(t[i], e[i]); else for (i = 0; i < t.length; i++)this.image(t[i]); return this }, text: function (t, e, i) { return this.addToFileList("text", t, e, void 0, i, ".txt") }, json: function (t, e, i) { return this.addToFileList("json", t, e, void 0, i, ".json") }, shader: function (t, e, i) { return this.addToFileList("shader", t, e, void 0, i, ".frag") }, xml: function (t, e, i) { return this.addToFileList("xml", t, e, void 0, i, ".xml") }, script: function (t, e, i, r) { return void 0 === i && (i = !1), !1 !== i && void 0 === r && (r = this), this.addToFileList("script", t, e, { syncPoint: !0, callback: i, callbackContext: r }, !1, ".js") }, binary: function (t, e, i, r) { return void 0 === i && (i = !1), !1 !== i && void 0 === r && (r = i), this.addToFileList("binary", t, e, { callback: i, callbackContext: r }, !1, ".bin") }, spritesheet: function (t, e, i, r, n, s, o, a) { return void 0 === n && (n = -1), void 0 === s && (s = 0), void 0 === o && (o = 0), void 0 === a && (a = 0), this.addToFileList("spritesheet", t, e, { frameWidth: i, frameHeight: r, frameMax: n, margin: s, spacing: o, skipFrames: a }, !1, ".png") }, audio: function (t, e, i) { return this.game.sound.noAudio ? this : (void 0 === i && (i = !0), "string" == typeof e && (e = [e]), this.addToFileList("audio", t, e, { buffer: null, autoDecode: i })) }, audioSprite: function (t, e, i, r, n) { return this.game.sound.noAudio ? this : (void 0 === i && (i = null), void 0 === r && (r = null), void 0 === n && (n = !0), this.audio(t, e, n), i ? this.json(t + "-audioatlas", i) : r ? ("string" == typeof r && (r = JSON.parse(r)), this.cache.addJSON(t + "-audioatlas", "", r)) : console.warn("Phaser.Loader.audiosprite - You must specify either a jsonURL or provide a jsonData object"), this) }, audiosprite: function (t, e, i, r, n) { return this.audioSprite(t, e, i, r, n) }, video: function (t, e, i, r) { return void 0 === i && (i = this.game.device.firefox ? "loadeddata" : "canplaythrough"), void 0 === r && (r = !1), "string" == typeof e && (e = [e]), this.addToFileList("video", t, e, { buffer: null, asBlob: r, loadEvent: i }) }, tilemap: function (t, e, i, r) { if (void 0 === e && (e = null), void 0 === i && (i = null), void 0 === r && (r = s.Tilemap.CSV), e || i || (e = r === s.Tilemap.CSV ? t + ".csv" : t + ".json"), i) { switch (r) { case s.Tilemap.CSV: break; case s.Tilemap.TILED_JSON: "string" == typeof i && (i = JSON.parse(i)) }this.cache.addTilemap(t, null, i, r) } else this.addToFileList("tilemap", t, e, { format: r }); return this }, physics: function (t, e, i, r) { return void 0 === e && (e = null), void 0 === i && (i = null), void 0 === r && (r = s.Physics.LIME_CORONA_JSON), e || i || (e = t + ".json"), i ? ("string" == typeof i && (i = JSON.parse(i)), this.cache.addPhysicsData(t, null, i, r)) : this.addToFileList("physics", t, e, { format: r }), this }, bitmapFont: function (t, e, i, r, n, s) { if (void 0 !== e && null !== e || (e = t + ".png"), void 0 === i && (i = null), void 0 === r && (r = null), null === i && null === r && (i = t + ".xml"), void 0 === n && (n = 0), void 0 === s && (s = 0), i) this.addToFileList("bitmapfont", t, e, { atlasURL: i, xSpacing: n, ySpacing: s }); else if ("string" == typeof r) { var o, a; try { o = JSON.parse(r) } catch (t) { a = this.parseXml(r) } if (!a && !o) throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given"); this.addToFileList("bitmapfont", t, e, { atlasURL: null, atlasData: o || a, atlasType: o ? "json" : "xml", xSpacing: n, ySpacing: s }) } return this }, atlasJSONArray: function (t, e, i, r) { return this.atlas(t, e, i, r, s.Loader.TEXTURE_ATLAS_JSON_ARRAY) }, atlasJSONHash: function (t, e, i, r) { return this.atlas(t, e, i, r, s.Loader.TEXTURE_ATLAS_JSON_HASH) }, atlasXML: function (t, e, i, r) { return void 0 === i && (i = null), void 0 === r && (r = null), i || r || (i = t + ".xml"), this.atlas(t, e, i, r, s.Loader.TEXTURE_ATLAS_XML_STARLING) }, atlas: function (t, e, i, r, n) { if (void 0 !== e && null !== e || (e = t + ".png"), void 0 === i && (i = null), void 0 === r && (r = null), void 0 === n && (n = s.Loader.TEXTURE_ATLAS_JSON_ARRAY), i || r || (i = n === s.Loader.TEXTURE_ATLAS_XML_STARLING ? t + ".xml" : t + ".json"), i) this.addToFileList("textureatlas", t, e, { atlasURL: i, format: n }); else { switch (n) { case s.Loader.TEXTURE_ATLAS_JSON_ARRAY: "string" == typeof r && (r = JSON.parse(r)); break; case s.Loader.TEXTURE_ATLAS_XML_STARLING: if ("string" == typeof r) { var o = this.parseXml(r); if (!o) throw new Error("Phaser.Loader. Invalid Texture Atlas XML given"); r = o } }this.addToFileList("textureatlas", t, e, { atlasURL: null, atlasData: r, format: n }) } return this }, withSyncPoint: function (t, e) { this._withSyncPointDepth++; try { t.call(e || this, this) } finally { this._withSyncPointDepth-- } return this }, addSyncPoint: function (t, e) { var i = this.getAsset(t, e); return i && (i.file.syncPoint = !0), this }, removeFile: function (t, e) { var i = this.getAsset(t, e); i && (i.loaded || i.loading || this._fileList.splice(i.index, 1)) }, removeAll: function () { this._fileList.length = 0, this._flightQueue.length = 0 }, start: function () { this.isLoading || (this.hasLoaded = !1, this.isLoading = !0, this.updateProgress(), this.processLoadQueue()) }, processLoadQueue: function () { if (!this.isLoading) return console.warn("Phaser.Loader - active loading canceled / reset"), void this.finishedLoading(!0); for (var t = 0; t < this._flightQueue.length; t++) { ((r = this._flightQueue[t]).loaded || r.error) && (this._flightQueue.splice(t, 1), t-- , r.loading = !1, r.requestUrl = null, r.requestObject = null, r.error && this.onFileError.dispatch(r.key, r), "packfile" !== r.type ? (this._loadedFileCount++ , this.onFileComplete.dispatch(this.progress, r.key, !r.error, this._loadedFileCount, this._totalFileCount)) : "packfile" === r.type && r.error && (this._loadedPackCount++ , this.onPackComplete.dispatch(r.key, !r.error, this._loadedPackCount, this._totalPackCount))) } var e = !1, i = this.enableParallel ? Math.max(1, this.maxParallelDownloads) : 1; for (t = this._processingHead; t < this._fileList.length; t++) { var r; if ("packfile" === (r = this._fileList[t]).type && !r.error && r.loaded && t === this._processingHead && (this.processPack(r), this._loadedPackCount++ , this.onPackComplete.dispatch(r.key, !r.error, this._loadedPackCount, this._totalPackCount)), r.loaded || r.error ? t === this._processingHead && (this._processingHead = t + 1) : !r.loading && this._flightQueue.length < i && ("packfile" !== r.type || r.data ? e || (this._fileLoadStarted || (this._fileLoadStarted = !0, this.onLoadStart.dispatch()), this._flightQueue.push(r), r.loading = !0, this.onFileStart.dispatch(this.progress, r.key, r.url), this.loadFile(r)) : (this._flightQueue.push(r), r.loading = !0, this.loadFile(r))), !r.loaded && r.syncPoint && (e = !0), this._flightQueue.length >= i || e && this._loadedPackCount === this._totalPackCount) break } if (this.updateProgress(), this._processingHead >= this._fileList.length) this.finishedLoading(); else if (!this._flightQueue.length) { console.warn("Phaser.Loader - aborting: processing queue empty, loading may have stalled"); var n = this; setTimeout(function () { n.finishedLoading(!0) }, 2e3) } }, finishedLoading: function (t) { this.hasLoaded || (this.hasLoaded = !0, this.isLoading = !1, t || this._fileLoadStarted || (this._fileLoadStarted = !0, this.onLoadStart.dispatch()), this.game.state.loadUpdate(), this.onBeforeLoadComplete.dispatch(), this.reset(), this.onLoadComplete.dispatch(), this.game.state && this.game.state.loadComplete()) }, asyncComplete: function (t, e) { void 0 === e && (e = ""), t.loaded = !0, t.error = !!e, e && (t.errorMessage = e, console.warn("Phaser.Loader - " + t.type + "[" + t.key + "]: " + e)), this.processLoadQueue() }, processPack: function (t) { var e = t.data[t.key]; if (e) for (var i = 0; i < e.length; i++) { var r = e[i]; switch (r.type) { case "image": this.image(r.key, r.url, r.overwrite); break; case "text": this.text(r.key, r.url, r.overwrite); break; case "json": this.json(r.key, r.url, r.overwrite); break; case "xml": this.xml(r.key, r.url, r.overwrite); break; case "script": this.script(r.key, r.url, r.callback, t.callbackContext || this); break; case "binary": this.binary(r.key, r.url, r.callback, t.callbackContext || this); break; case "spritesheet": this.spritesheet(r.key, r.url, r.frameWidth, r.frameHeight, r.frameMax, r.margin, r.spacing, r.skipFrames); break; case "video": this.video(r.key, r.urls); break; case "audio": this.audio(r.key, r.urls, r.autoDecode); break; case "audiosprite": this.audiosprite(r.key, r.urls, r.jsonURL, r.jsonData, r.autoDecode); break; case "tilemap": this.tilemap(r.key, r.url, r.data, s.Tilemap[r.format]); break; case "physics": this.physics(r.key, r.url, r.data, s.Loader[r.format]); break; case "bitmapFont": this.bitmapFont(r.key, r.textureURL, r.atlasURL, r.atlasData, r.xSpacing, r.ySpacing); break; case "atlasJSONArray": this.atlasJSONArray(r.key, r.textureURL, r.atlasURL, r.atlasData); break; case "atlasJSONHash": this.atlasJSONHash(r.key, r.textureURL, r.atlasURL, r.atlasData); break; case "atlasXML": this.atlasXML(r.key, r.textureURL, r.atlasURL, r.atlasData); break; case "atlas": this.atlas(r.key, r.textureURL, r.atlasURL, r.atlasData, s.Loader[r.format]); break; case "shader": this.shader(r.key, r.url, r.overwrite) } } else console.warn("Phaser.Loader - " + t.key + ": pack has data, but not for pack key") }, transformUrl: function (t, e) { return !!t && (t.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/) ? t : this.baseURL + e.path + t) }, loadFile: function (t) { switch (t.type) { case "packfile": this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete); break; case "image": case "spritesheet": case "textureatlas": case "bitmapfont": this.loadImageTag(t); break; case "audio": t.url = this.getAudioURL(t.url), t.url ? this.game.sound.usingWebAudio ? this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete) : this.game.sound.usingAudioTag && this.loadAudioTag(t) : this.fileError(t, null, "No supported audio URL specified or device does not have audio playback support"); break; case "video": t.url = this.getVideoURL(t.url), t.url ? t.asBlob ? this.xhrLoad(t, this.transformUrl(t.url, t), "blob", this.fileComplete) : this.loadVideoTag(t) : this.fileError(t, null, "No supported video URL specified or device does not have video playback support"); break; case "json": this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete); break; case "xml": this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.xmlLoadComplete); break; case "tilemap": t.format === s.Tilemap.TILED_JSON ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.jsonLoadComplete) : t.format === s.Tilemap.CSV ? this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.csvLoadComplete) : this.asyncComplete(t, "invalid Tilemap format: " + t.format); break; case "text": case "script": case "shader": case "physics": this.xhrLoad(t, this.transformUrl(t.url, t), "text", this.fileComplete); break; case "texture": "truecolor" === t.key.split("_").pop() ? this.loadImageTag(t) : this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete); break; case "binary": this.xhrLoad(t, this.transformUrl(t.url, t), "arraybuffer", this.fileComplete) } }, loadImageTag: function (t) { var e = this; t.data = new Image, t.data.name = t.key, this.crossOrigin && (t.data.crossOrigin = this.crossOrigin), t.data.onload = function () { t.data.onload && (t.data.onload = null, t.data.onerror = null, e.fileComplete(t)) }, t.data.onerror = function () { t.data.onload && (t.data.onload = null, t.data.onerror = null, e.fileError(t)) }, t.data.src = this.transformUrl(t.url, t), !this.game.device.firefox && t.data.complete && t.data.width && t.data.height && (t.data.onload = null, t.data.onerror = null, this.fileComplete(t)) }, loadVideoTag: function (t) { var e = this; t.data = document.createElement("video"), t.data.name = t.key, t.data.controls = !1, t.data.autoplay = !1; var i = function i() { t.data.removeEventListener(t.loadEvent, i, !1), t.data.onerror = null, t.data.canplay = !0, s.GAMES[e.game.id].load.fileComplete(t) }; t.data.onerror = function () { t.data.removeEventListener(t.loadEvent, i, !1), t.data.onerror = null, t.data.canplay = !1, e.fileError(t) }, t.data.addEventListener(t.loadEvent, i, !1), t.data.src = this.transformUrl(t.url, t), t.data.load() }, loadAudioTag: function (t) { var e = this; if (this.game.sound.touchLocked) t.data = new Audio, t.data.name = t.key, t.data.preload = "auto", t.data.src = this.transformUrl(t.url, t), this.fileComplete(t); else { t.data = new Audio, t.data.name = t.key; var i = function i() { t.data.removeEventListener("canplaythrough", i, !1), t.data.onerror = null, e.fileComplete(t) }; t.data.onerror = function () { t.data.removeEventListener("canplaythrough", i, !1), t.data.onerror = null, e.fileError(t) }, t.data.preload = "auto", t.data.src = this.transformUrl(t.url, t), t.data.addEventListener("canplaythrough", i, !1), t.data.load() } }, xhrLoad: function (t, e, i, r, n) { var s = new XMLHttpRequest; s.open("GET", e, !0), s.responseType = i, !1 !== this.headers.requestedWith && s.setRequestHeader("X-Requested-With", this.headers.requestedWith), this.headers[t.type] && s.setRequestHeader("Accept", this.headers[t.type]), n = n || this.fileError; var o = this; s.onload = function () { try { return 4 === s.readyState && s.status >= 400 && s.status <= 599 ? n.call(o, t, s) : r.call(o, t, s) } catch (e) { o.hasLoaded ? window.console && console.error(e) : o.asyncComplete(t, e.message || "Exception") } }, s.onerror = function () { try { return n.call(o, t, s) } catch (e) { o.hasLoaded ? window.console && console.error(e) : o.asyncComplete(t, e.message || "Exception") } }, t.requestObject = s, t.requestUrl = e, s.send() }, getVideoURL: function (t) { for (var e = 0; e < t.length; e++) { var i, r = t[e]; if (r.uri) { if (i = r.type, r = r.uri, this.game.device.canPlayVideo(i)) return r } else { if (0 === r.indexOf("blob:") || 0 === r.indexOf("data:")) return r; if (r.indexOf("?") >= 0 && (r = r.substr(0, r.indexOf("?"))), i = r.substr((Math.max(0, r.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(), this.game.device.canPlayVideo(i)) return t[e] } } return null }, getAudioURL: function (t) { if (this.game.sound.noAudio) return null; for (var e = 0; e < t.length; e++) { var i, r = t[e]; if (r.uri) { if (i = r.type, r = r.uri, this.game.device.canPlayAudio(i)) return r } else { if (0 === r.indexOf("blob:") || 0 === r.indexOf("data:")) return r; if (r.indexOf("?") >= 0 && (r = r.substr(0, r.indexOf("?"))), i = r.substr((Math.max(0, r.lastIndexOf(".")) || 1 / 0) + 1).toLowerCase(), this.game.device.canPlayAudio(i)) return t[e] } } return null }, fileError: function (t, e, i) { var r = "error loading asset from URL " + (t.requestUrl || this.transformUrl(t.url, t)); !i && e && (i = e.status), i && (r = r + " (" + i + ")"), this.asyncComplete(t, r) }, fileComplete: function (t, e) { var i = !0; switch (t.type) { case "packfile": var r = JSON.parse(e.responseText); t.data = r || {}; break; case "texture": var n = /\.([^.]+)$/.exec(t.url.split("?", 1)[0])[1].toLowerCase(); null !== t.data ? this.cache.addCompressedTextureMetaData(t.key, t.url, n, t.data) : this.cache.addCompressedTextureMetaData(t.key, t.url, n, e.response); break; case "image": this.cache.addImage(t.key, t.url, t.data); break; case "spritesheet": this.cache.addSpriteSheet(t.key, t.url, t.data, t.frameWidth, t.frameHeight, t.frameMax, t.margin, t.spacing, t.skipFrames); break; case "textureatlas": if (null == t.atlasURL) this.cache.addTextureAtlas(t.key, t.url, t.data, t.atlasData, t.format); else if (i = !1, t.format === s.Loader.TEXTURE_ATLAS_JSON_ARRAY || t.format === s.Loader.TEXTURE_ATLAS_JSON_HASH || t.format === s.Loader.TEXTURE_ATLAS_JSON_PYXEL) this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", this.jsonLoadComplete); else { if (t.format !== s.Loader.TEXTURE_ATLAS_XML_STARLING) throw new Error("Phaser.Loader. Invalid Texture Atlas format: " + t.format); this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", this.xmlLoadComplete) } break; case "bitmapfont": t.atlasURL ? (i = !1, this.xhrLoad(t, this.transformUrl(t.atlasURL, t), "text", function (t, e) { var i; try { i = JSON.parse(e.responseText) } catch (t) { } i ? (t.atlasType = "json", this.jsonLoadComplete(t, e)) : (t.atlasType = "xml", this.xmlLoadComplete(t, e)) })) : this.cache.addBitmapFont(t.key, t.url, t.data, t.atlasData, t.atlasType, t.xSpacing, t.ySpacing); break; case "video": if (t.asBlob) try { t.data = e.response } catch (e) { throw new Error("Phaser.Loader. Unable to parse video file as Blob: " + t.key) } this.cache.addVideo(t.key, t.url, t.data, t.asBlob); break; case "audio": this.game.sound.usingWebAudio ? (t.data = e.response, this.cache.addSound(t.key, t.url, t.data, !0, !1), t.autoDecode && this.game.sound.decode(t.key)) : this.cache.addSound(t.key, t.url, t.data, !1, !0); break; case "text": t.data = e.responseText, this.cache.addText(t.key, t.url, t.data); break; case "shader": t.data = e.responseText, this.cache.addShader(t.key, t.url, t.data); break; case "physics": r = JSON.parse(e.responseText); this.cache.addPhysicsData(t.key, t.url, r, t.format); break; case "script": t.data = document.createElement("script"), t.data.language = "javascript", t.data.type = "text/javascript", t.data.defer = !1, t.data.text = e.responseText, document.head.appendChild(t.data), t.callback && (t.data = t.callback.call(t.callbackContext, t.key, e.responseText)); break; case "binary": t.callback ? t.data = t.callback.call(t.callbackContext, t.key, e.response) : t.data = e.response, this.cache.addBinary(t.key, t.data) }i && this.asyncComplete(t) }, jsonLoadComplete: function (t, e) { var i = JSON.parse(e.responseText); "tilemap" === t.type ? this.cache.addTilemap(t.key, t.url, i, t.format) : "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, i, t.atlasType, t.xSpacing, t.ySpacing) : "json" === t.type ? this.cache.addJSON(t.key, t.url, i) : this.cache.addTextureAtlas(t.key, t.url, t.data, i, t.format), this.asyncComplete(t) }, csvLoadComplete: function (t, e) { var i = e.responseText; this.cache.addTilemap(t.key, t.url, i, t.format), this.asyncComplete(t) }, xmlLoadComplete: function (t, e) { var i = e.responseText, r = this.parseXml(i); if (!r) { var n = e.responseType || e.contentType; return console.warn("Phaser.Loader - " + t.key + ": invalid XML (" + n + ")"), void this.asyncComplete(t, "invalid XML") } "bitmapfont" === t.type ? this.cache.addBitmapFont(t.key, t.url, t.data, r, t.atlasType, t.xSpacing, t.ySpacing) : "textureatlas" === t.type ? this.cache.addTextureAtlas(t.key, t.url, t.data, r, t.format) : "xml" === t.type && this.cache.addXML(t.key, t.url, r), this.asyncComplete(t) }, parseXml: function (t) { var e; try { if (window.DOMParser) e = (new DOMParser).parseFromString(t, "text/xml"); else (e = new ActiveXObject("Microsoft.XMLDOM")).async = "false", e.loadXML(t) } catch (t) { e = null } return e && e.documentElement && !e.getElementsByTagName("parsererror").length ? e : null }, updateProgress: function () { this.preloadSprite && (0 === this.preloadSprite.direction ? this.preloadSprite.rect.width = Math.floor(this.preloadSprite.width / 100 * this.progress) : this.preloadSprite.rect.height = Math.floor(this.preloadSprite.height / 100 * this.progress), this.preloadSprite.sprite ? this.preloadSprite.sprite.updateCrop() : this.preloadSprite = null) }, totalLoadedFiles: function () { return this._loadedFileCount }, totalQueuedFiles: function () { return this._totalFileCount - this._loadedFileCount }, totalLoadedPacks: function () { return this._totalPackCount }, totalQueuedPacks: function () { return this._totalPackCount - this._loadedPackCount } }, Object.defineProperty(s.Loader.prototype, "progressFloat", { get: function () { var t = this._loadedFileCount / this._totalFileCount * 100; return s.Math.clamp(t || 0, 0, 100) } }), Object.defineProperty(s.Loader.prototype, "progress", { get: function () { return Math.round(this.progressFloat) } }), s.Loader.prototype.constructor = s.Loader, s.LoaderParser = { bitmapFont: function (t, e, i, r, n, s) { return this.xmlBitmapFont(t, e, i, r, n, s) }, xmlBitmapFont: function (t, e, i, r, n, s) { null == s && (s = 1); var o = {}, a = t.getElementsByTagName("info")[0], h = t.getElementsByTagName("common")[0]; o.font = a.getAttribute("face"), o.size = parseInt(a.getAttribute("size"), 10), o.lineHeight = parseInt(h.getAttribute("lineHeight"), 10) + r, o.chars = {}; for (var u = t.getElementsByTagName("char"), l = n ? n.x : 0, c = n ? n.y : 0, d = 0; d < u.length; d++) { var p = parseInt(u[d].getAttribute("id"), 10); o.chars[p] = { x: l + parseInt(u[d].getAttribute("x"), 10), y: c + parseInt(u[d].getAttribute("y"), 10), width: parseInt(u[d].getAttribute("width"), 10), height: parseInt(u[d].getAttribute("height"), 10), xOffset: parseInt(u[d].getAttribute("xoffset"), 10) / s, yOffset: parseInt(u[d].getAttribute("yoffset"), 10) / s, xAdvance: (parseInt(u[d].getAttribute("xadvance"), 10) + i) / s, kerning: {} } } var f = t.getElementsByTagName("kerning"); for (d = 0; d < f.length; d++) { var g = parseInt(f[d].getAttribute("first"), 10), m = parseInt(f[d].getAttribute("second"), 10), v = parseInt(f[d].getAttribute("amount"), 10) / s; o.chars[m].kerning[g] = v } return this.finalizeBitmapFont(e, o) }, jsonBitmapFont: function (t, e, i, r, n, s) { null == s && (s = 1); var o = { font: t.font.info._face, size: parseInt(t.font.info._size, 10), lineHeight: parseInt(t.font.common._lineHeight, 10) + r, chars: {} }, a = n ? n.x : 0, h = n ? n.y : 0; return t.font.chars.char.forEach(function (t) { var e = parseInt(t._id, 10); o.chars[e] = { x: a + parseInt(t._x, 10), y: h + parseInt(t._y, 10), width: parseInt(t._width, 10), height: parseInt(t._height, 10), xOffset: parseInt(t._xoffset, 10) / s, yOffset: parseInt(t._yoffset, 10) / s, xAdvance: (parseInt(t._xadvance, 10) + i) / s, kerning: {} } }), t.font.kernings && t.font.kernings.kerning && t.font.kernings.kerning.forEach(function (t) { o.chars[t._second].kerning[t._first] = parseInt(t._amount, 10) / s }), this.finalizeBitmapFont(e, o) }, finalizeBitmapFont: function (t, e) { return Object.keys(e.chars).forEach(function (i) { var r = e.chars[i]; r.texture = new PIXI.Texture(t, new s.Rectangle(r.x, r.y, r.width, r.height)) }), e }, pvr: function (t) { var e, i = new Uint32Array(t.slice(0, 52)), r = new Uint8Array(t), n = null, s = i[3] << 32 | i[2], o = 0; if (55727696 === i[0] && [0, 1, 2, 3, 6, 7, 9, 11].indexOf(s) >= 0) { switch (s >= 0 && s <= 3 ? e = "PVRTC" : s >= 7 && s <= 11 ? e = "S3TC" : 6 === s && (e = "ETC1"), s) { case 0: o = 35841; break; case 1: o = 35843; break; case 2: o = 35840; break; case 3: o = 35842; break; case 6: o = 36196; break; case 7: o = 33777; break; case 9: o = 33778; break; case 11: o = 33779; break; default: o = -1 }n = { complete: !0, fileFormat: "PVR", compressionAlgorithm: e, flags: i[1], pixelFormat: s, colorSpace: i[4], channelType: i[5], height: i[6], width: i[7], depth: i[8], numberOfSurfaces: i[9], numberOfFaces: i[10], numberOfMipmaps: i[11], metaDataSize: i[12], textureData: r.subarray(52 + i[12], r.byteLength), glExtensionFormat: o } } return n }, dds: function (t) { var e = new Uint8Array(t), i = new Uint32Array(t), r = null; return 68 === e[0] && 68 === e[1] && 83 === e[2] && 32 === e[3] && "DX10" === (r = { complete: !0, fileFormat: "DDS", compressionAlgorithm: "S3TC", size: i[1], flags: i[2], height: i[3], width: i[4], pitch: i[5], depth: i[6], mipmapCount: i[7], formatSize: i[19], formatFlag: i[19], formatFourCC: [String.fromCharCode(e[84]), String.fromCharCode(e[85]), String.fromCharCode(e[86]), String.fromCharCode(e[87])].join(""), formatBitCount: i[21], formatRBitMask: i[22], formatGBitMask: i[23], formatBBitMask: i[24], formatABitMask: i[25], caps1: i[26], caps2: i[27], caps3: i[28], caps4: i[29], reserved2: i[30], DXGIFormat: null, resourceDimension: null, miscFlag: null, arraySize: null, textureData: e.subarray(i[1] + 4, e.byteLength) }).formatFourCC && (r.DXGIFormat = i[31], r.resourceDimension = i[32], r.miscFlag = i[33], r.arraySize = i[34], r.miscFlag = i[35]), r }, ktx: function (t) { var e = new Uint8Array(t), i = new Uint32Array(t), r = null, n = 16 + i[15] / 4 | 0, s = i[n], o = i[7], a = 0; if (171 === e[0] && 75 === e[1] && 84 === e[2] && 88 === e[3] && 32 === e[4] && 49 === e[5] && 49 === e[6] && 187 === e[7] && 13 === e[8] && 10 === e[9] && 26 === e[10] && 10 === e[11] && [36196, 35840, 35841, 35842, 35843, 33776, 33777, 33778, 33779].indexOf(o) >= 0) { switch (o) { case 36196: a = "ETC1"; break; case 35840: case 35841: case 35842: case 35843: a = "PVRTC"; break; case 33776: case 33777: case 33778: case 33779: a = "S3TC" }r = { complete: !0, fileFormat: "KTX", compressionAlgorithm: a, endianness: i[3], glType: i[4], glTypeSize: i[5], glFormat: i[6], glInternalFormat: i[7], glBaseInternalFormat: i[8], width: i[9], height: i[10], pixelDepth: i[11], numberOfArrayElements: i[12], numberOfFaces: i[13], numberOfMipmapLevels: i[14], bytesOfKeyValueData: i[15], keyAndValueByteSize: i[16], imageSize: s, textureData: e.subarray(4 * (n + 1), s + 100) } } return r }, pkm: function (t) { var e = new Uint8Array(t), i = null; return 80 === e[0] && 75 === e[1] && 77 === e[2] && 32 === e[3] && (i = { complete: !0, fileFormat: "PKM", compressionAlgorithm: "ETC1", format: 65535 & (e[6] << 8 | e[7]), width: 65535 & (e[8] << 8 | e[9]), height: 65535 & (e[10] << 8 | e[11]), originalWidth: 65535 & (e[12] << 8 | e[13]), originalHeight: 65535 & (e[14] << 8 | e[15]), textureData: e.subarray(16, e.length) }), i } }, s.AudioSprite = function (t, e) { for (var i in this.game = t, this.key = e, this.config = this.game.cache.getJSON(e + "-audioatlas"), this.autoplayKey = null, this.autoplay = !1, this.sounds = {}, this.config.spritemap) { var r = this.config.spritemap[i], n = this.game.add.sound(this.key); n.addMarker(i, r.start, r.end - r.start, null, r.loop), this.sounds[i] = n } this.config.autoplay && (this.autoplayKey = this.config.autoplay, this.play(this.autoplayKey), this.autoplay = this.sounds[this.autoplayKey]) }, s.AudioSprite.prototype = { play: function (t, e) { return void 0 === e && (e = 1), this.sounds[t].play(t, null, e) }, stop: function (t) { if (t) this.sounds[t].stop(); else for (var e in this.sounds) this.sounds[e].stop() }, get: function (t) { return this.sounds[t] } }, s.AudioSprite.prototype.constructor = s.AudioSprite, s.Sound = function (t, e, i, r, n) { void 0 === i && (i = 1), void 0 === r && (r = !1), void 0 === n && (n = t.sound.connectToMaster), this.game = t, this.name = e, this.key = e, this.loop = r, this.markers = {}, this.context = null, this.autoplay = !1, this.totalDuration = 0, this.startTime = 0, this.currentTime = 0, this.duration = 0, this.durationMS = 0, this.position = 0, this.stopTime = 0, this.paused = !1, this.pausedPosition = 0, this.pausedTime = 0, this.isPlaying = !1, this.currentMarker = "", this.fadeTween = null, this.pendingPlayback = !1, this.override = !1, this.allowMultiple = !1, this.playOnce = !1, this.usingWebAudio = this.game.sound.usingWebAudio, this.usingAudioTag = this.game.sound.usingAudioTag, this.externalNode = null, this.masterGainNode = null, this.gainNode = null, this._sound = null, this._globalVolume = 1, this._markedToDelete = !1, this._removeFromSoundManager = !1, this.usingWebAudio ? (this.context = this.game.sound.context, this.masterGainNode = this.game.sound.masterGain, void 0 === this.context.createGain ? this.gainNode = this.context.createGainNode() : this.gainNode = this.context.createGain(), this.gainNode.gain.value = i, n && this.gainNode.connect(this.masterGainNode)) : this.usingAudioTag && (this.game.cache.getSound(e) && this.game.cache.isSoundReady(e) ? (this._sound = this.game.cache.getSoundData(e), this.totalDuration = 0, this._sound.duration && (this.totalDuration = this._sound.duration)) : this.game.cache.onSoundUnlock.add(this.soundHasUnlocked, this)), this.onDecoded = new s.Signal, this.onPlay = new s.Signal, this.onPause = new s.Signal, this.onResume = new s.Signal, this.onLoop = new s.Signal, this.onStop = new s.Signal, this.onMute = new s.Signal, this.onMarkerComplete = new s.Signal, this.onFadeComplete = new s.Signal, this._volume = i, this._buffer = null, this._muted = !1, this._tempMarker = 0, this._tempPosition = 0, this._tempVolume = 0, this._tempPause = 0, this._muteVolume = 0, this._tempLoop = 0, this._paused = !1, this._onDecodedEventDispatched = !1 }, s.Sound.prototype = { soundHasUnlocked: function (t) { t === this.key && (this._sound = this.game.cache.getSoundData(this.key), this.totalDuration = this._sound.duration) }, addMarker: function (t, e, i, r, n) { void 0 !== i && null !== i || (i = 1), void 0 !== r && null !== r || (r = 1), void 0 === n && (n = !1), this.markers[t] = { name: t, start: e, stop: e + i, volume: r, duration: i, durationMS: 1e3 * i, loop: n } }, removeMarker: function (t) { delete this.markers[t] }, onEndedHandler: function () { this._sound.onended = null, this.isPlaying = !1, this.currentTime = this.durationMS, this.stop(), this.playOnce && (this._markedToDelete = !0, this._removeFromSoundManager = !0), this._markedToDelete && (this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode), this._removeFromSoundManager ? this.game.sound.remove(this) : (this.markers = {}, this.context = null, this._buffer = null, this.externalNode = null, this.onDecoded.dispose(), this.onPlay.dispose(), this.onPause.dispose(), this.onResume.dispose(), this.onLoop.dispose(), this.onStop.dispose(), this.onMute.dispose(), this.onMarkerComplete.dispose())) }, update: function () { this.game.cache.checkSoundKey(this.key) ? (this.isDecoded && !this._onDecodedEventDispatched && (this.onDecoded.dispatch(this), this._onDecodedEventDispatched = !0), this.pendingPlayback && this.game.cache.isSoundReady(this.key) && (this.pendingPlayback = !1, this.play(this._tempMarker, this._tempPosition, this._tempVolume, this._tempLoop)), this.isPlaying && (this.currentTime = this.game.time.time - this.startTime, this.currentTime >= this.durationMS && (this.usingWebAudio ? this.loop ? (this.onLoop.dispatch(this), this.isPlaying = !1, "" === this.currentMarker ? (this.currentTime = 0, this.startTime = this.game.time.time, this.isPlaying = !0) : (this.onMarkerComplete.dispatch(this.currentMarker, this), this.play(this.currentMarker, 0, this.volume, !0, !0))) : "" !== this.currentMarker && this.stop() : this.loop ? (this.onLoop.dispatch(this), "" === this.currentMarker && (this.currentTime = 0, this.startTime = this.game.time.time), this.isPlaying = !1, this.play(this.currentMarker, 0, this.volume, !0, !0)) : this.stop()))) : this.destroy() }, loopFull: function (t) { return this.play(null, 0, t, !0) }, play: function (t, e, i, r, n) { if (void 0 !== t && !1 !== t && null !== t || (t = ""), void 0 === n && (n = !0), this.isPlaying && !this.allowMultiple && !n && !this.override) return this; if (this._sound && this.isPlaying && !this.allowMultiple && (this.override || n)) { if (this.usingWebAudio) { if (void 0 === this._sound.stop) this._sound.noteOff(0); else try { this._sound.stop(0) } catch (t) { } this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode) } else this.usingAudioTag && (this._sound.pause(), this._sound.currentTime = 0); this.isPlaying = !1 } if ("" === t && Object.keys(this.markers).length > 0) return this; if ("" !== t) { if (!this.markers[t]) return console.warn("Phaser.Sound.play: audio marker " + t + " doesn't exist"), this; this.currentMarker = t, this.position = this.markers[t].start, this.volume = this.markers[t].volume, this.loop = this.markers[t].loop, this.duration = this.markers[t].duration, this.durationMS = this.markers[t].durationMS, void 0 !== i && (this.volume = i), void 0 !== r && (this.loop = r), this._tempMarker = t, this._tempPosition = this.position, this._tempVolume = this.volume, this._tempLoop = this.loop } else e = e || 0, void 0 === i && (i = this._volume), void 0 === r && (r = this.loop), this.position = Math.max(0, e), this.volume = i, this.loop = r, this.duration = 0, this.durationMS = 0, this._tempMarker = t, this._tempPosition = e, this._tempVolume = i, this._tempLoop = r; return this.usingWebAudio ? this.game.cache.isSoundDecoded(this.key) ? (this._sound = this.context.createBufferSource(), this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode), this._buffer = this.game.cache.getSoundData(this.key), this._sound.buffer = this._buffer, this.loop && "" === t && (this._sound.loop = !0), this.loop || "" !== t || (this._sound.onended = this.onEndedHandler.bind(this)), this.totalDuration = this._sound.buffer.duration, 0 === this.duration && (this.duration = this.totalDuration, this.durationMS = Math.ceil(1e3 * this.totalDuration)), void 0 === this._sound.start ? this._sound.noteGrainOn(0, this.position, this.duration) : this.loop && "" === t ? this._sound.start(0, 0) : this._sound.start(0, this.position, this.duration), this.isPlaying = !0, this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : (this.pendingPlayback = !0, this.game.cache.getSound(this.key) && !1 === this.game.cache.getSound(this.key).isDecoding && this.game.sound.decode(this.key, this)) : this.game.cache.getSound(this.key) && this.game.cache.getSound(this.key).locked ? (this.game.cache.reloadSound(this.key), this.pendingPlayback = !0) : this._sound && (this.game.device.cocoonJS || 4 === this._sound.readyState) ? (this._sound.play(), this._sound.loop = this.loop, this.totalDuration = this._sound.duration, 0 === this.duration && (this.duration = this.totalDuration, this.durationMS = 1e3 * this.totalDuration), this._sound.currentTime = this.position, this._sound.muted = this._muted, this._muted || this.game.sound.mute ? this._sound.volume = 0 : this._sound.volume = this._volume, this.isPlaying = !0, this.startTime = this.game.time.time, this.currentTime = 0, this.stopTime = this.startTime + this.durationMS, this.onPlay.dispatch(this)) : this.pendingPlayback = !0, this.playOnce && (this.loop && console.warn("Phaser.Sound.play: audio clip " + this.name + " cannot be deleted while looping."), this._markedToDelete = !0, this._removeFromSoundManager = !0), this }, restart: function (t, e, i, r) { t = t || "", e = e || 0, i = i || 1, void 0 === r && (r = !1), this.play(t, e, i, r, !0) }, pause: function () { this.isPlaying && this._sound && (this.paused = !0, this.pausedPosition = this.currentTime, this.pausedTime = this.game.time.time, this._tempPause = this._sound.currentTime, this.onPause.dispatch(this), this.stop()) }, resume: function () { if (this.paused && this._sound) { if (this.usingWebAudio) { var t = Math.max(0, this.position + this.pausedPosition / 1e3); this._sound = this.context.createBufferSource(), this._sound.buffer = this._buffer, this.externalNode ? this._sound.connect(this.externalNode) : this._sound.connect(this.gainNode), "" === this.currentMarker && (this.loop ? this._sound.loop = !0 : this._sound.onended = this.onEndedHandler.bind(this)); var e = this.duration - this.pausedPosition / 1e3; void 0 === this._sound.start ? this._sound.noteGrainOn(0, t, e) : this.loop && this.game.device.chrome ? 42 === this.game.device.chromeVersion ? this._sound.start(0) : "" === this.currentMarker ? this._sound.start(0, t) : this._sound.start(0, t, e) : this._sound.start(0, t, e) } else this._sound.currentTime = this._tempPause, this._sound.play(); this.isPlaying = !0, this.paused = !1, this.startTime += this.game.time.time - this.pausedTime, this.onResume.dispatch(this) } }, stop: function () { if (this.isPlaying && this._sound) if (this.usingWebAudio) { if (void 0 === this._sound.stop) this._sound.noteOff(0); else try { this._sound.stop(0) } catch (t) { } this.externalNode ? this._sound.disconnect(this.externalNode) : this.gainNode && this._sound.disconnect(this.gainNode) } else this.usingAudioTag && (this._sound.pause(), this._sound.currentTime = 0); if (this.pendingPlayback = !1, this.isPlaying = !1, !this.paused) { var t = this.currentMarker; "" !== this.currentMarker && this.onMarkerComplete.dispatch(this.currentMarker, this), this.currentMarker = "", null !== this.fadeTween && this.fadeTween.stop(), this.onStop.dispatch(this, t) } }, fadeIn: function (t, e, i) { void 0 === e && (e = !1), void 0 === i && (i = this.currentMarker), this.paused || (this.play(i, 0, 0, e), this.fadeTo(t, 1)) }, fadeOut: function (t) { this.fadeTo(t, 0) }, fadeTo: function (t, e) { this.isPlaying && !this.paused && e !== this.volume && (void 0 === t && (t = 1e3), void 0 !== e ? (this.fadeTween = this.game.add.tween(this).to({ volume: e }, t, s.Easing.Linear.None, !0), this.fadeTween.onComplete.add(this.fadeComplete, this)) : console.warn("Phaser.Sound.fadeTo: No Volume Specified.")) }, fadeComplete: function () { this.onFadeComplete.dispatch(this, this.volume), 0 === this.volume && this.stop() }, updateGlobalVolume: function (t) { this.usingAudioTag && this._sound && (this._globalVolume = t, this._sound.volume = this._globalVolume * this._volume) }, destroy: function (t) { void 0 === t && (t = !0), this._markedToDelete = !0, this._removeFromSoundManager = t, this.stop(), t ? this.game.sound.remove(this) : (this.markers = {}, this.context = null, this._buffer = null, this.externalNode = null, this.onDecoded.dispose(), this.onPlay.dispose(), this.onPause.dispose(), this.onResume.dispose(), this.onLoop.dispose(), this.onStop.dispose(), this.onMute.dispose(), this.onMarkerComplete.dispose()) } }, s.Sound.prototype.constructor = s.Sound, Object.defineProperty(s.Sound.prototype, "isDecoding", { get: function () { return this.game.cache.getSound(this.key).isDecoding } }), Object.defineProperty(s.Sound.prototype, "isDecoded", { get: function () { return this.game.cache.isSoundDecoded(this.key) } }), Object.defineProperty(s.Sound.prototype, "mute", { get: function () { return this._muted || this.game.sound.mute }, set: function (t) { (t = t || !1) !== this._muted && (t ? (this._muted = !0, this._muteVolume = this._tempVolume, this.usingWebAudio ? this.gainNode.gain.value = 0 : this.usingAudioTag && this._sound && (this._sound.volume = 0)) : (this._muted = !1, this.usingWebAudio ? this.gainNode.gain.value = this._muteVolume : this.usingAudioTag && this._sound && (this._sound.volume = this._muteVolume)), this.onMute.dispatch(this)) } }), Object.defineProperty(s.Sound.prototype, "volume", { get: function () { return this._volume }, set: function (t) { this.usingAudioTag && (t = this.game.math.clamp(t, 0, 1)), this._muted ? this._muteVolume = t : (this._tempVolume = t, this._volume = t, this.usingWebAudio ? this.gainNode.gain.value = t : this.usingAudioTag && this._sound && (this._sound.volume = this._globalVolume * t)) } }), s.SoundManager = function (t) { this.game = t, this.onSoundDecode = new s.Signal, this.onVolumeChange = new s.Signal, this.onMute = new s.Signal, this.onUnMute = new s.Signal, this.onTouchUnlock = new s.Signal, this.context = null, this.usingWebAudio = !1, this.usingAudioTag = !1, this.noAudio = !1, this.connectToMaster = !0, this.touchLocked = !1, this.channels = 32, this.muteOnPause = !0, this._codeMuted = !1, this._muted = !1, this._unlockSource = null, this._volume = 1, this._sounds = [], this._watchList = new s.ArraySet, this._watching = !1, this._watchCallback = null, this._watchContext = null }, s.SoundManager.prototype = { boot: function () { var t = this.game.device, e = window.PhaserGlobal; if (t.iOS && !1 === t.webAudio && (this.channels = 1), e) { if (!0 === e.disableAudio) return this.noAudio = !0, void (this.touchLocked = !1); if (!0 === e.disableWebAudio) return this.usingAudioTag = !0, void (this.touchLocked = !1) } if (e && e.audioContext) this.context = e.audioContext; else if (window.AudioContext) try { this.context = new window.AudioContext } catch (t) { this.context = null, this.usingWebAudio = !1, this.touchLocked = !1 } else if (window.webkitAudioContext) try { this.context = new window.webkitAudioContext } catch (t) { this.context = null, this.usingWebAudio = !1, this.touchLocked = !1 } if (null === this.context) { if (void 0 === window.Audio) return void (this.noAudio = !0); this.usingAudioTag = !0 } else this.usingWebAudio = !0, void 0 === this.context.createGain ? this.masterGain = this.context.createGainNode() : this.masterGain = this.context.createGain(), this.masterGain.gain.value = 1, this.masterGain.connect(this.context.destination); this.noAudio || t.needsTouchUnlock() && this.setTouchLock(), this.usingWebAudio && t.chrome && t.chromeVersion <= 65 && console.log('A "GainNode.gain.value setter smoothing is deprecated" notice in Chrome is normal. <https://github.com/photonstorm/phaser-ce/issues/385>') }, setTouchLock: function () { this.noAudio || window.PhaserGlobal && !0 === window.PhaserGlobal.disableAudio || (this.game.input.addTouchLockCallback(this.unlock, this, !0), this.touchLocked = !0) }, setTouchUnlock: function () { this.touchLocked = !1, this._unlockSource = null, this.onTouchUnlock.dispatch() }, unlock: function () { if (this.noAudio || !this.touchLocked || null !== this._unlockSource) return !0; if (this.usingAudioTag) this.setTouchUnlock(); else if (this.usingWebAudio) { var t = this.context.createBuffer(1, 1, 22050); this._unlockSource = this.context.createBufferSource(), this._unlockSource.buffer = t, this._unlockSource.connect(this.context.destination), void 0 === this._unlockSource.start ? this._unlockSource.noteOn(0) : this._unlockSource.start(0), "suspended" === this._unlockSource.context.state && this._unlockSource.context.resume() } return !0 }, stopAll: function () { if (!this.noAudio) for (var t = 0; t < this._sounds.length; t++)this._sounds[t] && this._sounds[t].stop() }, pauseAll: function () { if (!this.noAudio) for (var t = 0; t < this._sounds.length; t++)this._sounds[t] && this._sounds[t].pause() }, resumeAll: function () { if (!this.noAudio) for (var t = 0; t < this._sounds.length; t++)this._sounds[t] && this._sounds[t].resume() }, decode: function (t, e) { e = e || null; var i = this.game.cache.getSoundData(t); if (i && !1 === this.game.cache.isSoundDecoded(t)) { this.game.cache.updateSound(t, "isDecoding", !0); var r = this; try { this.context.decodeAudioData(i, function (i) { i && (r.game.cache.decodedSound(t, i), r.onSoundDecode.dispatch(t, e)) }) } catch (t) { } } }, setDecodedCallback: function (t, e, i) { "string" == typeof t && (t = [t]), this._watchList.reset(); for (var r = 0; r < t.length; r++)t[r] instanceof s.Sound ? this.game.cache.isSoundDecoded(t[r].key) || this._watchList.add(t[r].key) : this.game.cache.isSoundDecoded(t[r]) || this._watchList.add(t[r]); 0 === this._watchList.total ? (this._watching = !1, e.call(i)) : (this._watching = !0, this._watchCallback = e, this._watchContext = i) }, update: function () { if (!this.noAudio) { !this.touchLocked || null === this._unlockSource || this._unlockSource.playbackState !== this._unlockSource.PLAYING_STATE && this._unlockSource.playbackState !== this._unlockSource.FINISHED_STATE || this.setTouchUnlock(); for (var t = 0; t < this._sounds.length; t++)this._sounds[t].update(); if (this._watching) { for (var e = this._watchList.first; e;)this.game.cache.isSoundDecoded(e) && this._watchList.remove(e), e = this._watchList.next; 0 === this._watchList.total && (this._watching = !1, this._watchCallback.call(this._watchContext)) } } }, add: function (t, e, i, r) { void 0 === e && (e = 1), void 0 === i && (i = !1), void 0 === r && (r = this.connectToMaster); var n = new s.Sound(this.game, t, e, i, r); return this._sounds.push(n), n }, addSprite: function (t) { return new s.AudioSprite(this.game, t) }, remove: function (t) { for (var e = this._sounds.length; e--;)if (this._sounds[e] === t) return this._sounds[e].destroy(!1), this._sounds.splice(e, 1), !0; return !1 }, removeAll: function () { this.stopAll(); for (var t = 0; t < this._sounds.length; t++)this._sounds[t] && this._sounds[t].destroy(); this._sounds.length = 0 }, removeByKey: function (t) { for (var e = this._sounds.length, i = 0; e--;)this._sounds[e].key === t && (this._sounds[e].destroy(!1), this._sounds.splice(e, 1), i++); return i }, play: function (t, e, i) { if (!this.noAudio) { var r = this.add(t, e, i); return r.play(), r } }, setMute: function () { if (!this._muted) { this._muted = !0, this.usingWebAudio && (this._muteVolume = this.masterGain.gain.value, this.masterGain.gain.value = 0); for (var t = 0; t < this._sounds.length; t++)this._sounds[t].usingAudioTag && (this._sounds[t].mute = !0); this.onMute.dispatch() } }, unsetMute: function () { if (this._muted && !this._codeMuted) { this._muted = !1, this.usingWebAudio && (this.masterGain.gain.value = this._muteVolume); for (var t = 0; t < this._sounds.length; t++)this._sounds[t].usingAudioTag && (this._sounds[t].mute = !1); this.onUnMute.dispatch() } }, destroy: function () { this.removeAll(), this.onSoundDecode.dispose(), this.context && (window.PhaserGlobal ? window.PhaserGlobal.audioContext = this.context : this.context.close && this.context.close()) } }, s.SoundManager.prototype.constructor = s.SoundManager, Object.defineProperty(s.SoundManager.prototype, "mute", { get: function () { return this._muted }, set: function (t) { if (t = t || !1) { if (this._muted) return; this._codeMuted = !0, this.setMute() } else { if (!this._muted) return; this._codeMuted = !1, this.unsetMute() } } }), Object.defineProperty(s.SoundManager.prototype, "volume", { get: function () { return this._volume }, set: function (t) { if (t < 0 ? t = 0 : t > 1 && (t = 1), this._volume !== t) { if (this._volume = t, this.usingWebAudio) this.masterGain.gain.value = t; else for (var e = 0; e < this._sounds.length; e++)this._sounds[e].usingAudioTag && this._sounds[e].updateGlobalVolume(t); this.onVolumeChange.dispatch(t) } } }), s.ScaleManager = function (t, e, i) { this.game = t, this.dom = s.DOM, this.grid = null, this.width = 0, this.height = 0, this.minWidth = null, this.maxWidth = null, this.minHeight = null, this.maxHeight = null, this.offset = new s.Point, this.forceLandscape = !1, this.forcePortrait = !1, this.incorrectOrientation = !1, this._pageAlignHorizontally = !1, this._pageAlignVertically = !1, this.onOrientationChange = new s.Signal, this.enterIncorrectOrientation = new s.Signal, this.leaveIncorrectOrientation = new s.Signal, this.hasPhaserSetFullScreen = !1, this.fullScreenTarget = null, this._createdFullScreenTarget = null, this.onFullScreenInit = new s.Signal, this.onFullScreenChange = new s.Signal, this.onFullScreenError = new s.Signal, this.screenOrientation = this.dom.getScreenOrientation(), this.scaleFactor = new s.Point(1, 1), this.scaleFactorInversed = new s.Point(1, 1), this.margin = { left: 0, top: 0, right: 0, bottom: 0, x: 0, y: 0 }, this.bounds = new s.Rectangle, this.aspectRatio = 0, this.sourceAspectRatio = 0, this.event = null, this.windowConstraints = { right: "layout", bottom: "" }, this.compatibility = { supportsFullScreen: !1, orientationFallback: null, noMargins: !1, scrollTo: null, forceMinimumDocumentHeight: !1, canExpandParent: !0, clickTrampoline: "" }, this._scaleMode = s.ScaleManager.NO_SCALE, this._fullScreenScaleMode = s.ScaleManager.NO_SCALE, this.parentIsWindow = !1, this.parentNode = null, this.parentScaleFactor = new s.Point(1, 1), this.trackParentInterval = 2e3, this.onSizeChange = new s.Signal, this.onResize = null, this.onResizeContext = null, this._pendingScaleMode = null, this._fullScreenRestore = null, this._gameSize = new s.Rectangle, this._userScaleFactor = new s.Point(1, 1), this._userScaleTrim = new s.Point(0, 0), this._lastUpdate = 0, this._updateThrottle = 0, this._updateThrottleReset = 100, this._parentBounds = new s.Rectangle, this._tempBounds = new s.Rectangle, this._lastReportedCanvasSize = new s.Rectangle, this._lastReportedGameSize = new s.Rectangle, this._booted = !1, t.config && this.parseConfig(t.config), this.setupScale(e, i) }, s.ScaleManager.EXACT_FIT = 0, s.ScaleManager.NO_SCALE = 1, s.ScaleManager.SHOW_ALL = 2, s.ScaleManager.RESIZE = 3, s.ScaleManager.USER_SCALE = 4, s.ScaleManager.MODES = ["EXACT_FIT", "NO_SCALE", "SHOW_ALL", "RESIZE", "USER_SCALE"], s.ScaleManager.prototype = { boot: function () { var t = this.compatibility; t.supportsFullScreen = this.game.device.fullscreen && !this.game.device.cocoonJS, this.game.device.iPad || this.game.device.webApp || this.game.device.desktop || (this.game.device.android && !this.game.device.chrome ? t.scrollTo = new s.Point(0, 1) : t.scrollTo = new s.Point(0, 0)), this.game.device.desktop ? (t.orientationFallback = "screen", t.clickTrampoline = "when-not-mouse") : (t.orientationFallback = "", t.clickTrampoline = ""); var e = this; this._orientationChange = function (t) { return e.orientationChange(t) }, this._windowResize = function (t) { return e.windowResize(t) }, window.addEventListener("orientationchange", this._orientationChange, !1), window.addEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (this._fullScreenChange = function (t) { return e.fullScreenChange(t) }, this._fullScreenError = function (t) { return e.fullScreenError(t) }, document.addEventListener("webkitfullscreenchange", this._fullScreenChange, !1), document.addEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.addEventListener("MSFullscreenChange", this._fullScreenChange, !1), document.addEventListener("fullscreenchange", this._fullScreenChange, !1), document.addEventListener("webkitfullscreenerror", this._fullScreenError, !1), document.addEventListener("mozfullscreenerror", this._fullScreenError, !1), document.addEventListener("MSFullscreenError", this._fullScreenError, !1), document.addEventListener("fullscreenerror", this._fullScreenError, !1)), this.game.onResume.add(this._gameResumed, this), this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.setGameSize(this.game.width, this.game.height), this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), s.FlexGrid && (this.grid = new s.FlexGrid(this, this.width, this.height)), this._booted = !0, null !== this._pendingScaleMode && (this.scaleMode = this._pendingScaleMode, this._pendingScaleMode = null) }, parseConfig: function (t) { void 0 !== t.scaleMode && (this._booted ? this.scaleMode = t.scaleMode : this._pendingScaleMode = t.scaleMode), void 0 !== t.fullScreenScaleMode && (this.fullScreenScaleMode = t.fullScreenScaleMode), t.fullScreenTarget && (this.fullScreenTarget = t.fullScreenTarget), this.pageAlignHorizontally = t.alignH || !1, this.pageAlignVertically = t.alignV || !1, t.scaleH && t.scaleV && this.setUserScale(t.scaleH, t.scaleV, t.trimH, t.trimV) }, setupScale: function (t, e) { var i, r = new s.Rectangle; "" !== this.game.parent && ("string" == typeof this.game.parent ? i = document.getElementById(this.game.parent) : this.game.parent && 1 === this.game.parent.nodeType && (i = this.game.parent)), i ? (this.parentNode = i, this.parentIsWindow = !1, this.getParentBounds(this._parentBounds, this.parentNode), r.width = this._parentBounds.width, r.height = this._parentBounds.height, this.offset.set(this._parentBounds.x, this._parentBounds.y)) : (this.parentNode = null, this.parentIsWindow = !0, r.width = this.dom.visualBounds.width, r.height = this.dom.visualBounds.height, this.offset.set(0, 0)); var n = 0, o = 0; "number" == typeof t ? n = t : (this.parentScaleFactor.x = parseInt(t, 10) / 100, n = r.width * this.parentScaleFactor.x), "number" == typeof e ? o = e : (this.parentScaleFactor.y = parseInt(e, 10) / 100, o = r.height * this.parentScaleFactor.y), n = Math.floor(n), o = Math.floor(o), this._gameSize.setTo(0, 0, n, o), this.updateDimensions(n, o, !1) }, _gameResumed: function () { this.queueUpdate(!0) }, setGameSize: function (t, e) { this._gameSize.setTo(0, 0, t, e), this.currentScaleMode !== s.ScaleManager.RESIZE && this.updateDimensions(t, e, !0), this.queueUpdate(!0) }, setUserScale: function (t, e, i, r, n, s) { this._userScaleFactor.setTo(t, e), this._userScaleTrim.setTo(0 | i, 0 | r), void 0 === n && (n = !0), void 0 === s && (s = !0), n && this.queueUpdate(s) }, setResizeCallback: function (t, e) { this.onResize = t, this.onResizeContext = e }, signalSizeChange: function () { if (!s.Rectangle.sameDimensions(this, this._lastReportedCanvasSize) || !s.Rectangle.sameDimensions(this.game, this._lastReportedGameSize)) { var t = this.width, e = this.height; this._lastReportedCanvasSize.setTo(0, 0, t, e), this._lastReportedGameSize.setTo(0, 0, this.game.width, this.game.height), this.grid && this.grid.onResize(t, e), this.onSizeChange.dispatch(this, t, e), this.currentScaleMode === s.ScaleManager.RESIZE && (this.game.state.resize(t, e), this.game.load.resize(t, e)) } }, setMinMax: function (t, e, i, r) { this.minWidth = t, this.minHeight = e, void 0 !== i && (this.maxWidth = i), void 0 !== r && (this.maxHeight = r) }, preUpdate: function () { if (!(this.game.time.time < this._lastUpdate + this._updateThrottle)) { var t = this._updateThrottle; this._updateThrottleReset = t >= 400 ? 0 : 100, this.dom.getOffset(this.game.canvas, this.offset); var e = this._parentBounds.width, i = this._parentBounds.height, r = this.getParentBounds(this._parentBounds), n = r.width !== e || r.height !== i, o = this.updateOrientationState(); (n || o) && (this.onResize && this.onResize.call(this.onResizeContext, this, r), this.updateLayout(), this.signalSizeChange()); var a = 2 * this._updateThrottle; this._updateThrottle < t && (a = Math.min(t, this._updateThrottleReset)), this._updateThrottle = s.Math.clamp(a, 25, this.trackParentInterval), this._lastUpdate = this.game.time.time } }, pauseUpdate: function () { this.preUpdate(), this._updateThrottle = this.trackParentInterval }, updateDimensions: function (t, e, i) { this.width = t * this.parentScaleFactor.x, this.height = e * this.parentScaleFactor.y, this.game.width = this.width, this.game.height = this.height, this.sourceAspectRatio = this.width / this.height, this.updateScalingAndBounds(), i && (this.game.renderer.resize(this.width, this.height), this.game.camera.setSize(this.width, this.height), this.game.world.resize(this.width, this.height)) }, updateScalingAndBounds: function () { this.scaleFactor.x = this.game.width / this.width, this.scaleFactor.y = this.game.height / this.height, this.scaleFactorInversed.x = this.width / this.game.width, this.scaleFactorInversed.y = this.height / this.game.height, this.aspectRatio = this.width / this.height, this.game.canvas && this.dom.getOffset(this.game.canvas, this.offset), this.bounds.setTo(this.offset.x, this.offset.y, this.width, this.height), this.game.input && this.game.input.scale && this.game.input.scale.setTo(this.scaleFactor.x, this.scaleFactor.y) }, forceOrientation: function (t, e) { void 0 === e && (e = !1), !0 !== t || !0 !== e ? (this.forceLandscape = t, this.forcePortrait = e, this.queueUpdate(!0)) : console.warn("Phaser.ScaleManager: forceLandscape and forcePortrait cannot both be true.") }, classifyOrientation: function (t) { return "portrait-primary" === t || "portrait-secondary" === t ? "portrait" : "landscape-primary" === t || "landscape-secondary" === t ? "landscape" : null }, updateOrientationState: function () { var t = this.screenOrientation, e = this.incorrectOrientation; this.screenOrientation = this.dom.getScreenOrientation(this.compatibility.orientationFallback), this.incorrectOrientation = this.forceLandscape && !this.isLandscape || this.forcePortrait && !this.isPortrait; var i = t !== this.screenOrientation, r = e !== this.incorrectOrientation; return r && (this.incorrectOrientation ? this.enterIncorrectOrientation.dispatch() : this.leaveIncorrectOrientation.dispatch()), (i || r) && this.onOrientationChange.dispatch(this, t, e), i || r }, orientationChange: function (t) { this.event = t, this.queueUpdate(!0) }, windowResize: function (t) { this.event = t, this.queueUpdate(!0) }, scrollTop: function () { var t = this.compatibility.scrollTo; t && window.scrollTo(t.x, t.y) }, refresh: function () { this.scrollTop(), this.queueUpdate(!0) }, updateLayout: function () { var t = this.currentScaleMode; if (t !== s.ScaleManager.RESIZE) { if (this.scrollTop(), this.compatibility.forceMinimumDocumentHeight && (document.documentElement.style.minHeight = window.innerHeight + "px"), this.incorrectOrientation ? this.setMaximum() : t === s.ScaleManager.EXACT_FIT ? this.setExactFit() : t === s.ScaleManager.SHOW_ALL ? !this.isFullScreen && this.boundingParent && this.compatibility.canExpandParent ? (this.setShowAll(!0), this.resetCanvas(), this.setShowAll()) : this.setShowAll() : t === s.ScaleManager.NO_SCALE ? (this.width = this.game.width, this.height = this.game.height) : t === s.ScaleManager.USER_SCALE && (this.width = this.game.width * this._userScaleFactor.x - this._userScaleTrim.x, this.height = this.game.height * this._userScaleFactor.y - this._userScaleTrim.y), !this.compatibility.canExpandParent && (t === s.ScaleManager.SHOW_ALL || t === s.ScaleManager.USER_SCALE)) { var e = this.getParentBounds(this._tempBounds); this.width = Math.min(this.width, e.width), this.height = Math.min(this.height, e.height) } this.width = 0 | this.width, this.height = 0 | this.height, this.reflowCanvas() } else this.reflowGame() }, getParentBounds: function (t, e) { var i = t || new s.Rectangle, r = e || this.boundingParent, n = this.dom.visualBounds, o = this.dom.layoutBounds; if (r) { var a = r.getBoundingClientRect(), h = r.offsetParent ? r.offsetParent.getBoundingClientRect() : r.getBoundingClientRect(); i.setTo(a.left - h.left, a.top - h.top, a.width, a.height); var u = this.windowConstraints; if (u.right) { var l = "layout" === u.right ? o : n; i.right = Math.min(i.right, l.width) } if (u.bottom) { l = "layout" === u.bottom ? o : n; i.bottom = Math.min(i.bottom, l.height) } } else i.setTo(0, 0, n.width, n.height); return i.setTo(Math.round(i.x), Math.round(i.y), Math.round(i.width), Math.round(i.height)), i }, align: function (t, e) { null != t && (this.pageAlignHorizontally = t), null != e && (this.pageAlignVertically = e) }, alignCanvas: function (t, e) { var i = this.getParentBounds(this._tempBounds), r = this.game.canvas, n = this.margin; if (t) { n.left = n.right = 0; var s = r.getBoundingClientRect(); if (this.width < i.width && !this.incorrectOrientation) { var o = s.left - i.x, a = i.width / 2 - this.width / 2, h = (a = Math.max(a, 0)) - o; n.left = Math.round(h) } r.style.marginLeft = n.left + "px", 0 !== n.left && (n.right = -(i.width - s.width - n.left), r.style.marginRight = n.right + "px") } if (e) { n.top = n.bottom = 0; s = r.getBoundingClientRect(); if (this.height < i.height && !this.incorrectOrientation) { o = s.top - i.y, a = i.height / 2 - this.height / 2, h = (a = Math.max(a, 0)) - o; n.top = Math.round(h) } r.style.marginTop = n.top + "px", 0 !== n.top && (n.bottom = -(i.height - s.height - n.top), r.style.marginBottom = n.bottom + "px") } n.x = n.left, n.y = n.top }, reflowGame: function () { this.resetCanvas("", ""); var t = this.getParentBounds(this._tempBounds); this.updateDimensions(t.width, t.height, !0) }, reflowCanvas: function () { this.incorrectOrientation || (this.width = s.Math.clamp(this.width, this.minWidth || 0, this.maxWidth || this.width), this.height = s.Math.clamp(this.height, this.minHeight || 0, this.maxHeight || this.height)), this.resetCanvas(), this.compatibility.noMargins || (this.isFullScreen && this._createdFullScreenTarget ? this.alignCanvas(!0, !0) : this.alignCanvas(this.pageAlignHorizontally, this.pageAlignVertically)), this.updateScalingAndBounds() }, resetCanvas: function (t, e) { void 0 === t && (t = this.width + "px"), void 0 === e && (e = this.height + "px"); var i = this.game.canvas; this.compatibility.noMargins || (i.style.marginLeft = "", i.style.marginTop = "", i.style.marginRight = "", i.style.marginBottom = ""), i.style.width = t, i.style.height = e }, queueUpdate: function (t) { t && (this._parentBounds.width = 0, this._parentBounds.height = 0), this._updateThrottle = this._updateThrottleReset }, reset: function (t) { t && this.grid && this.grid.reset() }, setMaximum: function () { this.width = this.dom.visualBounds.width, this.height = this.dom.visualBounds.height }, setShowAll: function (t) { var e, i = this.getParentBounds(this._tempBounds), r = i.width, n = i.height; e = t ? Math.max(n / this.game.height, r / this.game.width) : Math.min(n / this.game.height, r / this.game.width), this.width = Math.round(this.game.width * e), this.height = Math.round(this.game.height * e) }, setExactFit: function () { var t = this.getParentBounds(this._tempBounds); this.width = t.width, this.height = t.height, this.isFullScreen || (this.maxWidth && (this.width = Math.min(this.width, this.maxWidth)), this.maxHeight && (this.height = Math.min(this.height, this.maxHeight))) }, createFullScreenTarget: function () { var t = document.createElement("div"); return t.style.margin = "0", t.style.padding = "0", t.style.background = "#000", t }, startFullScreen: function (t, e) { if (this.isFullScreen) return !1; if (this.compatibility.supportsFullScreen) { if ("when-not-mouse" === this.compatibility.clickTrampoline) { var i = this.game.input; if (i.activePointer && i.activePointer !== i.mousePointer && (e || !1 !== e)) return void i.activePointer.addClickTrampoline("startFullScreen", this.startFullScreen, this, [t, !1]) } void 0 !== t && this.game.renderType === s.CANVAS && (this.game.stage.smoothed = t); var r = this.fullScreenTarget; r || (this.cleanupCreatedTarget(), this._createdFullScreenTarget = this.createFullScreenTarget(), r = this._createdFullScreenTarget); var n = { targetElement: r }; if (this.hasPhaserSetFullScreen = !0, this.onFullScreenInit.dispatch(this, n), this._createdFullScreenTarget) { var o = this.game.canvas; o.parentNode.insertBefore(r, o), r.appendChild(o) } return this.game.device.fullscreenKeyboard ? r[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT) : r[this.game.device.requestFullscreen](), !0 } var a = this; setTimeout(function () { a.fullScreenError() }, 10) }, stopFullScreen: function () { return !(!this.isFullScreen || !this.compatibility.supportsFullScreen) && (this.hasPhaserSetFullScreen = !1, document[this.game.device.cancelFullscreen](), !0) }, cleanupCreatedTarget: function () { var t = this._createdFullScreenTarget; if (t && t.parentNode) { var e = t.parentNode; e.insertBefore(this.game.canvas, t), e.removeChild(t) } this._createdFullScreenTarget = null }, prepScreenMode: function (t) { var e = !!this._createdFullScreenTarget, i = this._createdFullScreenTarget || this.fullScreenTarget; t ? (e || this.fullScreenScaleMode === s.ScaleManager.EXACT_FIT) && i !== this.game.canvas && (this._fullScreenRestore = { targetWidth: i.style.width, targetHeight: i.style.height }, i.style.width = "100%", i.style.height = "100%") : (this._fullScreenRestore && (i.style.width = this._fullScreenRestore.targetWidth, i.style.height = this._fullScreenRestore.targetHeight, this._fullScreenRestore = null), this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.resetCanvas()) }, fullScreenChange: function (t) { this.event = t, this.isFullScreen ? (this.prepScreenMode(!0), this.updateLayout(), this.queueUpdate(!0)) : (this.prepScreenMode(!1), this.cleanupCreatedTarget(), this.updateLayout(), this.queueUpdate(!0)), this.onFullScreenChange.dispatch(this, this.width, this.height) }, fullScreenError: function (t) { this.event = t, this.cleanupCreatedTarget(), console.warn("Phaser.ScaleManager: requestFullscreen failed or device does not support the Fullscreen API"), this.onFullScreenError.dispatch(this) }, scaleSprite: function (t, e, i, r) { if (void 0 === e && (e = this.width), void 0 === i && (i = this.height), void 0 === r && (r = !1), !t || !t.scale) return t; if (t.scale.x = 1, t.scale.y = 1, t.width <= 0 || t.height <= 0 || e <= 0 || i <= 0) return t; var n = e, s = t.height * e / t.width, o = t.width * i / t.height, a = i, h = o > e; return (h = h ? r : !r) ? (t.width = Math.floor(n), t.height = Math.floor(s)) : (t.width = Math.floor(o), t.height = Math.floor(a)), t }, destroy: function () { this.game.onResume.remove(this._gameResumed, this), window.removeEventListener("orientationchange", this._orientationChange, !1), window.removeEventListener("resize", this._windowResize, !1), this.compatibility.supportsFullScreen && (document.removeEventListener("webkitfullscreenchange", this._fullScreenChange, !1), document.removeEventListener("mozfullscreenchange", this._fullScreenChange, !1), document.removeEventListener("MSFullscreenChange", this._fullScreenChange, !1), document.removeEventListener("fullscreenchange", this._fullScreenChange, !1), document.removeEventListener("webkitfullscreenerror", this._fullScreenError, !1), document.removeEventListener("mozfullscreenerror", this._fullScreenError, !1), document.removeEventListener("MSFullscreenError", this._fullScreenError, !1), document.removeEventListener("fullscreenerror", this._fullScreenError, !1)) } }, s.ScaleManager.prototype.constructor = s.ScaleManager, Object.defineProperty(s.ScaleManager.prototype, "boundingParent", { get: function () { return this.parentIsWindow || this.isFullScreen && this.hasPhaserSetFullScreen && !this._createdFullScreenTarget ? null : this.game.canvas && this.game.canvas.parentNode || null } }), Object.defineProperty(s.ScaleManager.prototype, "scaleMode", { get: function () { return this._scaleMode }, set: function (t) { return t !== this._scaleMode && (this.isFullScreen || (this.updateDimensions(this._gameSize.width, this._gameSize.height, !0), this.queueUpdate(!0)), this._scaleMode = t), this._scaleMode } }), Object.defineProperty(s.ScaleManager.prototype, "fullScreenScaleMode", { get: function () { return this._fullScreenScaleMode }, set: function (t) { return t !== this._fullScreenScaleMode && (this.isFullScreen ? (this.prepScreenMode(!1), this._fullScreenScaleMode = t, this.prepScreenMode(!0), this.queueUpdate(!0)) : this._fullScreenScaleMode = t), this._fullScreenScaleMode } }), Object.defineProperty(s.ScaleManager.prototype, "currentScaleMode", { get: function () { return this.isFullScreen ? this._fullScreenScaleMode : this._scaleMode } }), Object.defineProperty(s.ScaleManager.prototype, "pageAlignHorizontally", { get: function () { return this._pageAlignHorizontally }, set: function (t) { t !== this._pageAlignHorizontally && (this._pageAlignHorizontally = t, this.queueUpdate(!0)) } }), Object.defineProperty(s.ScaleManager.prototype, "pageAlignVertically", { get: function () { return this._pageAlignVertically }, set: function (t) { t !== this._pageAlignVertically && (this._pageAlignVertically = t, this.queueUpdate(!0)) } }), Object.defineProperty(s.ScaleManager.prototype, "isFullScreen", { get: function () { return !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement) } }), Object.defineProperty(s.ScaleManager.prototype, "isPortrait", { get: function () { return "portrait" === this.classifyOrientation(this.screenOrientation) } }), Object.defineProperty(s.ScaleManager.prototype, "isLandscape", { get: function () { return "landscape" === this.classifyOrientation(this.screenOrientation) } }), Object.defineProperty(s.ScaleManager.prototype, "isGamePortrait", { get: function () { return this.height > this.width } }), Object.defineProperty(s.ScaleManager.prototype, "isGameLandscape", { get: function () { return this.width > this.height } }), s.Utils.Debug = function (t) { this.game = t, this.sprite = null, this.bmd = null, this.canvas = null, this.context = null, this.font = "14px Courier", this.columnWidth = 100, this.lineHeight = 16, this.lineWidth = 1, this.renderShadow = !0, this.currentColor = null, this.currentX = 0, this.currentY = 0, this.currentAlpha = 1, this.dirty = !1, this.isDisabled = !1, this._line = null, this._rect = null }, s.Utils.Debug.prototype = { boot: function () { this.game.renderType === s.CANVAS ? this.context = this.game.context : (this.bmd = new s.BitmapData(this.game, "__DEBUG", this.game.width, this.game.height, !0), this.sprite = this.game.make.image(0, 0, this.bmd), this.game.stage.addChild(this.sprite), this.game.scale.onSizeChange.add(this.resize, this), this.canvas = s.CanvasPool.create(this, this.game.width, this.game.height), this.context = this.canvas.getContext("2d")), this._line = new s.Line, this._rect = new s.Rectangle }, resize: function () { this.bmd.resize(this.game.width, this.game.height), this.canvas.width = this.game.width, this.canvas.height = this.game.height }, preUpdate: function () { this.dirty && this.sprite && (this.bmd.clear(), this.bmd.draw(this.canvas, 0, 0), this.context.clearRect(0, 0, this.game.width, this.game.height), this.dirty = !1) }, reset: function () { this.context && this.context.clearRect(0, 0, this.game.width, this.game.height), this.sprite && this.bmd.clear() }, start: function (t, e, i, r) { "number" != typeof t && (t = 0), "number" != typeof e && (e = 0), i = i || "rgb(255,255,255)", void 0 === r && (r = 0), this.currentX = t, this.currentY = e, this.currentColor = i, this.columnWidth = r, this.dirty = !0, this.context.save(), this.context.setTransform(1, 0, 0, 1, 0, 0), this.context.strokeStyle = i, this.context.fillStyle = i, this.context.font = this.font, this.context.globalAlpha = this.currentAlpha }, stop: function () { this.context.restore() }, line: function () { for (var t = this.currentX, e = 0; e < arguments.length; e++)this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(arguments[e], t + 1, this.currentY + 1), this.context.fillStyle = this.currentColor), this.context.fillText(arguments[e], t, this.currentY), t += this.columnWidth; this.currentY += this.lineHeight }, sound: function (t, e, i) { var r = this.game.sound; this.start(t, e, i), r.noAudio ? this.line("Audio is disabled") : (this.line("Volume: " + r.volume.toFixed(2) + (r.mute ? " (Mute)" : "")), this.line("Mute on pause: " + r.muteOnPause), this.line("Using: " + (r.usingWebAudio ? "Web Audio - " + r.context.state : "Audio Tag")), this.line("Touch locked: " + r.touchLocked), this.line("Sounds: " + r._sounds.length)), this.stop() }, soundInfo: function (t, e, i, r) { this.start(e, i, r), this.line("Sound: " + t.key + " Touch locked: " + t.game.sound.touchLocked), this.line("Is Ready?: " + this.game.cache.isSoundReady(t.key) + " Pending Playback: " + t.pendingPlayback), this.line("Decoded: " + t.isDecoded + " Decoding: " + t.isDecoding), this.line("Playing: " + t.isPlaying + " Loop: " + t.loop), this.line("Time: " + t.currentTime + "ms Total: " + t.totalDuration.toFixed(3) + "s"), this.line("Volume: " + t.volume.toFixed(2) + (t.mute ? " (Mute)" : "")), this.line("Using: " + (t.usingWebAudio ? "Web Audio" : "Audio Tag")), "" !== t.currentMarker && (this.line("Marker: " + t.currentMarker + " Duration: " + t.duration + " (ms: " + t.durationMS + ")"), this.line("Start: " + t.markers[t.currentMarker].start + " Stop: " + t.markers[t.currentMarker].stop), this.line("Position: " + t.position)), this.stop() }, camera: function (t, e, i) { var r = t.deadzone, n = t.target, s = t.view; r && (this._rect.setTo(s.x + r.x, s.y + r.y, r.width, r.height), this.rectangle(this._rect, e, i)), n && (this._line.setTo(s.centerX, s.centerY, n.x, n.y), this.geom(this._line, e, i), this.geom(n, e, !1, 3)) }, cameraInfo: function (t, e, i, r) { var n = t.bounds, s = t.deadzone, o = t.target, a = t.view; this.start(e, i, r), this.line("Camera (" + t.width + " x " + t.height + ")"), this.line("x: " + t.x + " y: " + t.y), this.line("Bounds: " + (n ? "x: " + n.x + " y: " + n.y + " w: " + n.width + " h: " + n.height : "none")), this.line("View: x: " + a.x + " y: " + a.y + " w: " + a.width + " h: " + a.height), this.line("Deadzone: " + (s ? "x: " + s.x + " y: " + s.y + " w: " + s.width + " h: " + s.height : s)), this.line("Total in view: " + t.totalInView), this.line("At limit: x: " + t.atLimit.x + " y: " + t.atLimit.y), this.line("Target: " + (o ? o.name || o : "none")), this.stop() }, timer: function (t, e, i, r) { this.start(e, i, r), this.line("Timer (running: " + t.running + " expired: " + t.expired + ")"), this.line("Next Tick: " + t.next + " Duration: " + t.duration), this.line("Paused: " + t.paused + " Length: " + t.length), this.stop() }, pointer: function (t, e, i, r, n) { null != t && (void 0 === e && (e = !1), i = i || "rgba(0,255,0,0.5)", r = r || "rgba(255,0,0,0.5)", !0 === e && !0 === t.isUp || (this.start(t.x, t.y - 100, n), this.context.beginPath(), this.context.arc(t.x, t.y, t.circle.radius, 0, 2 * Math.PI), t.active ? this.context.fillStyle = i : this.context.fillStyle = r, this.context.fill(), this.context.closePath(), this.context.beginPath(), this.context.moveTo(t.positionDown.x, t.positionDown.y), this.context.lineTo(t.position.x, t.position.y), this.context.lineWidth = 2, this.context.stroke(), this.context.closePath(), this.line("ID: " + t.id + " Active: " + t.active), this.line("World X: " + t.worldX + " World Y: " + t.worldY), this.line("Screen X: " + t.x + " Screen Y: " + t.y + " In: " + t.withinGame), this.line("Duration: " + t.duration + " ms"), this.line("is Down: " + t.isDown + " is Up: " + t.isUp), this.stop())) }, spriteInputInfo: function (t, e, i, r) { this.start(e, i, r), this.line("Sprite Input: (" + t.width + " x " + t.height + ")"), this.line("x: " + t.input.pointerX().toFixed(1) + " y: " + t.input.pointerY().toFixed(1)), this.line("over: " + t.input.pointerOver() + " duration: " + t.input.overDuration().toFixed(0)), this.line("down: " + t.input.pointerDown() + " duration: " + t.input.downDuration().toFixed(0)), this.line("just over: " + t.input.justOver() + " just out: " + t.input.justOut()), this.stop() }, key: function (t, e, i, r) { this.start(e, i, r, 150), this.line("Key:", t.keyCode, "isDown:", t.isDown), this.line("justDown:", t.justDown, "justUp:", t.justUp), this.line("Time Down:", t.timeDown.toFixed(0), "duration:", t.duration.toFixed(0)), this.stop() }, inputInfo: function (t, e, i) { this.start(t, e, i), this.line("Input"), this.line("X: " + this.game.input.x + " Y: " + this.game.input.y), this.line("World X: " + this.game.input.worldX + " World Y: " + this.game.input.worldY), this.line("Scale X: " + this.game.input.scale.x.toFixed(1) + " Scale Y: " + this.game.input.scale.x.toFixed(1)), this.line("Screen X: " + this.game.input.activePointer.screenX + " Screen Y: " + this.game.input.activePointer.screenY), this.stop() }, spriteBounds: function (t, e, i) { var r = t.getBounds(); r.x += this.game.camera.x, r.y += this.game.camera.y, this.rectangle(r, e, i) }, ropeSegments: function (t, e, i) { var r = this; t.segments.forEach(function (t) { r.rectangle(t, e, i) }, this) }, spriteInfo: function (t, e, i, r) { this.start(e, i, r), this.line("Sprite: " + (t.name || "") + " (" + t.width + " x " + t.height + ") anchor: " + t.anchor.x + " x " + t.anchor.y), this.line("x: " + t.x.toFixed(1) + " y: " + t.y.toFixed(1)), this.line("angle: " + t.angle.toFixed(1) + " rotation: " + t.rotation.toFixed(1)), this.line("visible: " + t.visible + " in camera: " + t.inCamera), this.line("bounds x: " + t._bounds.x.toFixed(1) + " y: " + t._bounds.y.toFixed(1) + " w: " + t._bounds.width.toFixed(1) + " h: " + t._bounds.height.toFixed(1)), this.stop() }, spriteCoords: function (t, e, i, r) { this.start(e, i, r, 100), t.name && this.line(t.name), this.line("x:", t.x.toFixed(2), "y:", t.y.toFixed(2)), this.line("pos x:", t.position.x.toFixed(2), "pos y:", t.position.y.toFixed(2)), this.line("world x:", t.world.x.toFixed(2), "world y:", t.world.y.toFixed(2)), this.stop() }, lineInfo: function (t, e, i, r) { this.start(e, i, r, 80), this.line("start.x:", t.start.x.toFixed(2), "start.y:", t.start.y.toFixed(2)), this.line("end.x:", t.end.x.toFixed(2), "end.y:", t.end.y.toFixed(2)), this.line("length:", t.length.toFixed(2), "angle:", t.angle), this.stop() }, pixel: function (t, e, i, r) { r = r || 2, this.start(), this.context.fillStyle = i, this.context.fillRect(t, e, r, r), this.stop() }, geom: function (t, e, i, r) { void 0 === i && (i = !0), void 0 === r && (r = 0), e = e || "rgba(0,255,0,0.4)", this.start(), this.context.fillStyle = e, this.context.strokeStyle = e, this.context.lineWidth = this.lineWidth, t instanceof s.Rectangle || 1 === r ? i ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height) : t instanceof s.Circle || 2 === r ? (this.context.beginPath(), this.context.arc(t.x - this.game.camera.x, t.y - this.game.camera.y, t.radius, 0, 2 * Math.PI, !1), this.context.closePath(), i ? this.context.fill() : this.context.stroke()) : t instanceof s.Point || 3 === r ? this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, 4, 4) : t instanceof s.Line || 4 === r ? (this.context.beginPath(), this.context.moveTo(t.start.x + .5 - this.game.camera.x, t.start.y + .5 - this.game.camera.y), this.context.lineTo(t.end.x + .5 - this.game.camera.x, t.end.y + .5 - this.game.camera.y), this.context.closePath(), this.context.stroke()) : (t instanceof s.Ellipse || 5 === r) && (this.context.beginPath(), this.context.ellipse(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width / 2, t.height / 2, 0, 2 * Math.PI, !1), this.context.closePath(), i ? this.context.fill() : this.context.stroke()), this.stop() }, rectangle: function (t, e, i) { void 0 === i && (i = !0), e = e || "rgba(0, 255, 0, 0.4)", this.start(), i ? (this.context.fillStyle = e, this.context.fillRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)) : (this.context.lineWidth = this.lineWidth, this.context.strokeStyle = e, this.context.strokeRect(t.x - this.game.camera.x, t.y - this.game.camera.y, t.width, t.height)), this.stop() }, text: function (t, e, i, r, n) { r = r || "rgb(255,255,255)", n = n || this.font, this.start(), this.context.font = n, this.renderShadow && (this.context.fillStyle = "rgb(0,0,0)", this.context.fillText(t, e + 1, i + 1)), this.context.fillStyle = r, this.context.fillText(t, e, i), this.stop() }, quadTree: function (t, e) { e = e || "rgba(255,0,0,0.3)", this.start(); var i = t.bounds; if (0 === t.nodes.length) { this.context.strokeStyle = e, this.context.strokeRect(i.x, i.y, i.width, i.height), this.text("size: " + t.objects.length, i.x + 4, i.y + 16, "rgb(0,200,0)", "12px Courier"), this.context.strokeStyle = "rgb(0,255,0)"; for (var r = 0; r < t.objects.length; r++)this.context.strokeRect(t.objects[r].x, t.objects[r].y, t.objects[r].width, t.objects[r].height) } else for (r = 0; r < t.nodes.length; r++)this.quadTree(t.nodes[r]); this.stop() }, body: function (t, e, i) { t.body && (this.start(), t.body.type === s.Physics.ARCADE ? s.Physics.Arcade.Body.render(this.context, t.body, e, i, this.lineWidth) : t.body.type === s.Physics.NINJA ? s.Physics.Ninja.Body.render(this.context, t.body, e, i) : t.body.type === s.Physics.BOX2D && s.Physics.Box2D.renderBody(this.context, t.body, e), this.stop()) }, bodyInfo: function (t, e, i, r) { t.body && (this.start(e, i, r, 210), t.body.type === s.Physics.ARCADE ? s.Physics.Arcade.Body.renderBodyInfo(this, t.body) : t.body.type === s.Physics.BOX2D && this.game.physics.box2d.renderBodyInfo(this, t.body), this.stop()) }, box2dWorld: function () { this.start(), this.context.translate(-this.game.camera.view.x, -this.game.camera.view.y, 0), this.game.physics.box2d.renderDebugDraw(this.context), this.stop() }, box2dBody: function (t, e) { this.start(), s.Physics.Box2D.renderBody(this.context, t, e), this.stop() }, displayList: function (t) { if (void 0 === t && (t = this.game.world), t.hasOwnProperty("renderOrderID") ? console.log("[" + t.renderOrderID + "]", t) : console.log("[]", t), t.children && t.children.length > 0) for (var e = 0; e < t.children.length; e++)this.game.debug.displayList(t.children[e]) }, renderer: function (t, e, i) { var r = this.game.renderer, n = r.renderSession; if (this.start(t, e, i), this.line((r.gl ? "WebGL" : "Canvas") + " Renderer (" + r.width + " x " + r.height + ")"), this.line("autoResize: " + r.autoResize), this.line("clearBeforeRender: " + r.clearBeforeRender), this.line("resolution: " + r.resolution), this.line("transparent: " + r.transparent), this.line("renderSession:"), r.gl) { this.line("  currentBatchedTextures: (" + r.currentBatchedTextures.length + ")"); for (var s = 0; s < r.currentBatchedTextures.length; s++)this.line("    " + r.currentBatchedTextures[s]); this.line("  drawCount: " + n.drawCount), this.line("  maxTextures: " + r.maxTextures), this.line("  maxTextureSize: " + r.maxTextureSize), this.line("  maxTextureAvailableSpace: " + n.maxTextureAvailableSpace), this.line("  roundPixels: " + n.roundPixels) } else this.line("  roundPixels: " + n.roundPixels), this.line("  scaleMode: " + (0 === n.scaleMode ? "LINEAR" : 1 === n.scaleMode ? "NEAREST" : n.scaleMode)); this.stop() }, canvasPool: function (t, e, i, r) { var n = s.CanvasPool; this.start(t, e, i, r || 100), this.line("Canvas Pool"), this.line("Used:", n.getTotal()), this.line("Free:", n.getFree()), this.line("Total:", n.length), this.stop() }, physicsGroup: function (t, e, i, r) { t.forEach(this.body, this, r, e, i) }, phaser: function (t, e, i) { this.text("Phaser v" + s.VERSION + " " + (this.game.renderType === s.WEBGL ? "WebGL" : "Canvas") + " " + (this.game.device.webAudio ? "WebAudio" : "HTML Audio"), t, e, i, this.font) }, scale: function (t, e, i) { this.start(t, e, i); var r = this.game.scale, n = r.scaleFactorInversed, o = r._parentBounds; t = " x "; this.line("Game: " + this.game.width + t + this.game.height), this.line("Canvas: " + r.width + t + r.height + " (" + n.x.toFixed(2) + t + n.y.toFixed(2) + ") [" + r.aspectRatio.toFixed(2) + "]"), this.line("Mode: " + s.ScaleManager.MODES[r.currentScaleMode] + (r.currentScaleMode === s.ScaleManager.USER_SCALE ? " (" + r._userScaleFactor.x + t + r._userScaleFactor.y + ")" : "")), this.line("Parent: " + (r.parentIsWindow ? "window" : r.parentNode) + (o.empty ? "" : " (" + o.width + t + o.height + ")")), this.line("Screen: " + r.classifyOrientation(r.screenOrientation) + (r.incorrectOrientation ? " (incorrect)" : "")), this.stop() }, loader: function (t, e, i, r) { var n = s.Utils.pad; this.start(e, i, r), t.hasLoaded ? this.line("Complete" + (t.resetLocked ? " [locked]" : "")) : t.isLoading ? this.line("Loading") : this.line("Not started"), t.hasLoaded && !t.resetLocked || (this.line("Progress: " + n(t.progress, 3) + "%"), this.line("Files: " + t._loadedFileCount + " of " + t._totalFileCount), this.line("Packs: " + t._loadedPackCount + " of " + t._loadedPackCount)), this.stop() }, destroy: function () { s.CanvasPool.remove(this) } }, s.Utils.Debug.prototype.constructor = s.Utils.Debug, s.DOM = { getOffset: function (t, e) { e = e || new s.Point; var i = t.getBoundingClientRect(), r = s.DOM.scrollY, n = s.DOM.scrollX, o = document.documentElement.clientTop, a = document.documentElement.clientLeft; return e.x = i.left + n - a, e.y = i.top + r - o, e }, getBounds: function (t, e) { return void 0 === e && (e = 0), !(!(t = t && !t.nodeType ? t[0] : t) || 1 !== t.nodeType) && this.calibrate(t.getBoundingClientRect(), e) }, calibrate: function (t, e) { e = +e || 0; var i = { width: 0, height: 0, left: 0, right: 0, top: 0, bottom: 0 }; return i.width = (i.right = t.right + e) - (i.left = t.left - e), i.height = (i.bottom = t.bottom + e) - (i.top = t.top - e), i }, getAspectRatio: function (t) { var e = (t = null == t ? this.visualBounds : 1 === t.nodeType ? this.getBounds(t) : t).width, i = t.height; return "function" == typeof e && (e = e.call(t)), "function" == typeof i && (i = i.call(t)), e / i }, inLayoutViewport: function (t, e) { var i = this.getBounds(t, e); return !!i && i.bottom >= 0 && i.right >= 0 && i.top <= this.layoutBounds.width && i.left <= this.layoutBounds.height }, getScreenOrientation: function (t) { var e = window.screen, i = e.orientation || e.mozOrientation || e.msOrientation; if (i && "string" == typeof i.type) return i.type; if ("string" == typeof i) return i; var r = "portrait-primary", n = "landscape-primary"; if ("screen" === t) return e.height > e.width ? r : n; if ("viewport" === t) return this.visualBounds.height > this.visualBounds.width ? r : n; if ("window.orientation" === t && "number" == typeof window.orientation) return 0 === window.orientation || 180 === window.orientation ? r : n; if (window.matchMedia) { if (window.matchMedia("(orientation: portrait)").matches) return r; if (window.matchMedia("(orientation: landscape)").matches) return n } return this.visualBounds.height > this.visualBounds.width ? r : n }, visualBounds: new s.Rectangle, layoutBounds: new s.Rectangle, documentBounds: new s.Rectangle }, s.Device.whenReady(function (t) { var e = window && "pageXOffset" in window ? function () { return window.pageXOffset } : function () { return document.documentElement.scrollLeft }, i = window && "pageYOffset" in window ? function () { return window.pageYOffset } : function () { return document.documentElement.scrollTop }; if (Object.defineProperty(s.DOM, "scrollX", { get: e }), Object.defineProperty(s.DOM, "scrollY", { get: i }), Object.defineProperty(s.DOM.visualBounds, "x", { get: e }), Object.defineProperty(s.DOM.visualBounds, "y", { get: i }), Object.defineProperty(s.DOM.layoutBounds, "x", { value: 0 }), Object.defineProperty(s.DOM.layoutBounds, "y", { value: 0 }), t.desktop && document.documentElement.clientWidth <= window.innerWidth && document.documentElement.clientHeight <= window.innerHeight) { var r = function () { return Math.max(window.innerWidth, document.documentElement.clientWidth) }, n = function () { return Math.max(window.innerHeight, document.documentElement.clientHeight) }; Object.defineProperty(s.DOM.visualBounds, "width", { get: r }), Object.defineProperty(s.DOM.visualBounds, "height", { get: n }), Object.defineProperty(s.DOM.layoutBounds, "width", { get: r }), Object.defineProperty(s.DOM.layoutBounds, "height", { get: n }) } else Object.defineProperty(s.DOM.visualBounds, "width", { get: function () { return window.innerWidth } }), Object.defineProperty(s.DOM.visualBounds, "height", { get: function () { return window.innerHeight } }), Object.defineProperty(s.DOM.layoutBounds, "width", { get: function () { var t = document.documentElement.clientWidth, e = window.innerWidth; return t < e ? e : t } }), Object.defineProperty(s.DOM.layoutBounds, "height", { get: function () { var t = document.documentElement.clientHeight, e = window.innerHeight; return t < e ? e : t } }); Object.defineProperty(s.DOM.documentBounds, "x", { value: 0 }), Object.defineProperty(s.DOM.documentBounds, "y", { value: 0 }), Object.defineProperty(s.DOM.documentBounds, "width", { get: function () { var t = document.documentElement; return Math.max(t.clientWidth, t.offsetWidth, t.scrollWidth) } }), Object.defineProperty(s.DOM.documentBounds, "height", { get: function () { var t = document.documentElement; return Math.max(t.clientHeight, t.offsetHeight, t.scrollHeight) } }) }, null, !0), s.ArraySet = function (t) { this.position = 0, this.list = t || [] }, s.ArraySet.prototype = { add: function (t) { return this.exists(t) || this.list.push(t), t }, getIndex: function (t) { return this.list.indexOf(t) }, getByKey: function (t, e) { for (var i = this.list.length; i--;)if (this.list[i][t] === e) return this.list[i]; return null }, exists: function (t) { return this.list.indexOf(t) > -1 }, reset: function () { this.list.length = 0 }, remove: function (t) { var e = this.list.indexOf(t); if (e > -1) return this.list.splice(e, 1), t }, setAll: function (t, e) { for (var i = this.list.length; i--;)this.list[i] && (this.list[i][t] = e) }, callAll: function (t) { for (var e = Array.prototype.slice.call(arguments, 1), i = this.list.length; i--;)this.list[i] && this.list[i][t] && this.list[i][t].apply(this.list[i], e) }, removeAll: function (t) { void 0 === t && (t = !1); for (var e = this.list.length; e--;)if (this.list[e]) { var i = this.remove(this.list[e]); t && i.destroy() } this.position = 0, this.list = [] } }, Object.defineProperty(s.ArraySet.prototype, "total", { get: function () { return this.list.length } }), Object.defineProperty(s.ArraySet.prototype, "first", { get: function () { return this.position = 0, this.list.length > 0 ? this.list[0] : null } }), Object.defineProperty(s.ArraySet.prototype, "next", { get: function () { return this.position < this.list.length ? (this.position++ , this.list[this.position]) : null } }), s.ArraySet.prototype.constructor = s.ArraySet, s.ArrayUtils = { getRandomItem: function (t, e, i) { if (null === t) return null; void 0 === e && (e = 0), void 0 === i && (i = t.length); var r = e + Math.floor(Math.random() * i); return void 0 === t[r] ? null : t[r] }, removeRandomItem: function (t, e, i) { if (null == t) return null; void 0 === e && (e = 0), void 0 === i && (i = t.length); var r = e + Math.floor(Math.random() * i); if (r < t.length) { var n = t.splice(r, 1); return void 0 === n[0] ? null : n[0] } return null }, remove: function (t, e, i) { var r = t.length; if (!(e >= r || 0 === i)) { null == i && (i = 1); for (var n = r - i, s = e; s < n; ++s)t[s] = t[s + i]; t.length = n } }, shuffle: function (t) { for (var e = t.length - 1; e > 0; e--) { var i = Math.floor(Math.random() * (e + 1)), r = t[e]; t[e] = t[i], t[i] = r } return t }, transposeMatrix: function (t) { for (var e = t.length, i = t[0].length, r = new Array(i), n = 0; n < i; n++) { r[n] = new Array(e); for (var s = e - 1; s > -1; s--)r[n][s] = t[s][n] } return r }, rotateMatrix: function (t, e) { if ("string" != typeof e && (e = (e % 360 + 360) % 360), 90 === e || -270 === e || "rotateLeft" === e) t = (t = s.ArrayUtils.transposeMatrix(t)).reverse(); else if (-90 === e || 270 === e || "rotateRight" === e) t = t.reverse(), t = s.ArrayUtils.transposeMatrix(t); else if (180 === Math.abs(e) || "rotate180" === e) { for (var i = 0; i < t.length; i++)t[i].reverse(); t = t.reverse() } return t }, findClosest: function (t, e) { if (!e.length) return NaN; if (1 === e.length || t < e[0]) return e[0]; for (var i = 1; e[i] < t;)i++; var r = e[i - 1], n = i < e.length ? e[i] : Number.POSITIVE_INFINITY; return n - t <= t - r ? n : r }, rotateRight: function (t) { var e = t.pop(); return t.unshift(e), e }, rotateLeft: function (t) { var e = t.shift(); return t.push(e), e }, numberArray: function (t, e) { void 0 !== e && null !== e || (e = t, t = 0); for (var i = [], r = t; r <= e; r++)i.push(r); return i }, numberArrayStep: function (t, e, i) { void 0 !== t && null !== t || (t = 0), void 0 !== e && null !== e || (e = t, t = 0), void 0 === i && (i = 1); for (var r = [], n = Math.max(s.Math.roundAwayFromZero((e - t) / (i || 1)), 0), o = 0; o < n; o++)r.push(t), t += i; return r } }, s.LinkedList = function () { this.next = null, this.prev = null, this.first = null, this.last = null, this.total = 0 }, s.LinkedList.prototype = { add: function (t) { return 0 === this.total && null === this.first && null === this.last ? (this.first = t, this.last = t, this.next = t, t.prev = this, this.total++ , t) : (this.last.next = t, t.prev = this.last, this.last = t, this.total++ , t) }, reset: function () { this.first = null, this.last = null, this.next = null, this.prev = null, this.total = 0 }, remove: function (t) { if (1 === this.total) return this.reset(), void (t.next = t.prev = null); t === this.first ? this.first = this.first.next : t === this.last && (this.last = this.last.prev), t.prev && (t.prev.next = t.next), t.next && (t.next.prev = t.prev), t.next = t.prev = null, null === this.first && (this.last = null), this.total-- }, callAll: function (t) { if (this.first && this.last) { var e = this.first; do { e && e[t] && e[t].call(e), e = e.next } while (e !== this.last.next) } } }, s.LinkedList.prototype.constructor = s.LinkedList, s.Create = function (t) { this.game = t, this.bmd = null, this.canvas = null, this.ctx = null, this.palettes = [{ 0: "#000", 1: "#9D9D9D", 2: "#FFF", 3: "#BE2633", 4: "#E06F8B", 5: "#493C2B", 6: "#A46422", 7: "#EB8931", 8: "#F7E26B", 9: "#2F484E", A: "#44891A", B: "#A3CE27", C: "#1B2632", D: "#005784", E: "#31A2F2", F: "#B2DCEF" }, { 0: "#000", 1: "#191028", 2: "#46af45", 3: "#a1d685", 4: "#453e78", 5: "#7664fe", 6: "#833129", 7: "#9ec2e8", 8: "#dc534b", 9: "#e18d79", A: "#d6b97b", B: "#e9d8a1", C: "#216c4b", D: "#d365c8", E: "#afaab9", F: "#f5f4eb" }, { 0: "#000", 1: "#2234d1", 2: "#0c7e45", 3: "#44aacc", 4: "#8a3622", 5: "#5c2e78", 6: "#aa5c3d", 7: "#b5b5b5", 8: "#5e606e", 9: "#4c81fb", A: "#6cd947", B: "#7be2f9", C: "#eb8a60", D: "#e23d69", E: "#ffd93f", F: "#fff" }, { 0: "#000", 1: "#fff", 2: "#8b4131", 3: "#7bbdc5", 4: "#8b41ac", 5: "#6aac41", 6: "#3931a4", 7: "#d5de73", 8: "#945a20", 9: "#5a4100", A: "#bd736a", B: "#525252", C: "#838383", D: "#acee8b", E: "#7b73de", F: "#acacac" }, { 0: "#000", 1: "#191028", 2: "#46af45", 3: "#a1d685", 4: "#453e78", 5: "#7664fe", 6: "#833129", 7: "#9ec2e8", 8: "#dc534b", 9: "#e18d79", A: "#d6b97b", B: "#e9d8a1", C: "#216c4b", D: "#d365c8", E: "#afaab9", F: "#fff" }] }, s.Create.PALETTE_ARNE = 0, s.Create.PALETTE_JMP = 1, s.Create.PALETTE_CGA = 2, s.Create.PALETTE_C64 = 3, s.Create.PALETTE_JAPANESE_MACHINE = 4, s.Create.prototype = { texture: function (t, e, i, r, n, s, o, a) { void 0 === i && (i = 8), void 0 === r && (r = i), void 0 === n && (n = 0), void 0 === s && (s = !0); var h = e[0].length * i, u = e.length * r; null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(h, u), this.bmd.clear(); for (var l = 0; l < e.length; l++)for (var c = e[l], d = 0; d < c.length; d++) { var p = c[d]; "." !== p && " " !== p && (this.ctx.fillStyle = this.palettes[n][p], this.ctx.fillRect(d * i, l * r, i, r)) } return s ? this.bmd.generateTexture(t, o, a) : this.copy() }, grid: function (t, e, i, r, n, s, o, a, h) { void 0 === o && (o = !0), null === this.bmd && (this.bmd = this.game.make.bitmapData(), this.canvas = this.bmd.canvas, this.ctx = this.bmd.context), this.bmd.resize(e, i), this.ctx.fillStyle = s; for (var u = 0; u < i; u += n)this.ctx.fillRect(0, u, e, 1); for (var l = 0; l < e; l += r)this.ctx.fillRect(l, 0, 1, i); return o ? this.bmd.generateTexture(t, a, h) : this.copy() }, copy: function (t, e, i, r, n, s, o) { return null == t && (t = this.game.make.bitmapData()), t.resize(this.bmd.width, this.bmd.height), t.draw(this.bmd, e, i, r, n, s, o) } }, s.Create.prototype.constructor = s.Create, s.FlexGrid = function (t, e, i) { this.game = t.game, this.manager = t, this.width = e, this.height = i, this.boundsCustom = new s.Rectangle(0, 0, e, i), this.boundsFluid = new s.Rectangle(0, 0, e, i), this.boundsFull = new s.Rectangle(0, 0, e, i), this.boundsNone = new s.Rectangle(0, 0, e, i), this.positionCustom = new s.Point(0, 0), this.positionFluid = new s.Point(0, 0), this.positionFull = new s.Point(0, 0), this.positionNone = new s.Point(0, 0), this.scaleCustom = new s.Point(1, 1), this.scaleFluid = new s.Point(1, 1), this.scaleFluidInversed = new s.Point(1, 1), this.scaleFull = new s.Point(1, 1), this.scaleNone = new s.Point(1, 1), this.customWidth = 0, this.customHeight = 0, this.customOffsetX = 0, this.customOffsetY = 0, this.ratioH = e / i, this.ratioV = i / e, this.multiplier = 0, this.layers = [] }, s.FlexGrid.prototype = { setSize: function (t, e) { this.width = t, this.height = e, this.ratioH = t / e, this.ratioV = e / t, this.scaleNone = new s.Point(1, 1), this.boundsNone.width = this.width, this.boundsNone.height = this.height, this.refresh() }, createCustomLayer: function (t, e, i, r) { void 0 === r && (r = !0), this.customWidth = t, this.customHeight = e, this.boundsCustom.width = t, this.boundsCustom.height = e; var n = new s.FlexLayer(this, this.positionCustom, this.boundsCustom, this.scaleCustom); return r && this.game.world.add(n), this.layers.push(n), void 0 !== i && null !== typeof i && n.addMultiple(i), n }, createFluidLayer: function (t, e) { void 0 === e && (e = !0); var i = new s.FlexLayer(this, this.positionFluid, this.boundsFluid, this.scaleFluid); return e && this.game.world.add(i), this.layers.push(i), void 0 !== t && null !== typeof t && i.addMultiple(t), i }, createFullLayer: function (t) { var e = new s.FlexLayer(this, this.positionFull, this.boundsFull, this.scaleFluid); return this.game.world.add(e), this.layers.push(e), void 0 !== t && e.addMultiple(t), e }, createFixedLayer: function (t) { var e = new s.FlexLayer(this, this.positionNone, this.boundsNone, this.scaleNone); return this.game.world.add(e), this.layers.push(e), void 0 !== t && e.addMultiple(t), e }, reset: function () { for (var t = this.layers.length; t--;)this.layers[t].persist || (this.layers[t].position = null, this.layers[t].scale = null, this.layers.slice(t, 1)) }, onResize: function (t, e) { this.ratioH = t / e, this.ratioV = e / t, this.refresh(t, e) }, refresh: function () { this.multiplier = Math.min(this.manager.height / this.height, this.manager.width / this.width), this.boundsFluid.width = Math.round(this.width * this.multiplier), this.boundsFluid.height = Math.round(this.height * this.multiplier), this.scaleFluid.set(this.boundsFluid.width / this.width, this.boundsFluid.height / this.height), this.scaleFluidInversed.set(this.width / this.boundsFluid.width, this.height / this.boundsFluid.height), this.scaleFull.set(this.boundsFull.width / this.width, this.boundsFull.height / this.height), this.boundsFull.width = Math.round(this.manager.width * this.scaleFluidInversed.x), this.boundsFull.height = Math.round(this.manager.height * this.scaleFluidInversed.y), this.boundsFluid.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), this.boundsNone.centerOn(this.manager.bounds.centerX, this.manager.bounds.centerY), this.positionFluid.set(this.boundsFluid.x, this.boundsFluid.y), this.positionNone.set(this.boundsNone.x, this.boundsNone.y) }, fitSprite: function (t) { this.manager.scaleSprite(t), t.x = this.manager.bounds.centerX, t.y = this.manager.bounds.centerY }, debug: function () { this.game.debug.text(this.boundsFluid.width + " x " + this.boundsFluid.height, this.boundsFluid.x + 4, this.boundsFluid.y + 16), this.game.debug.geom(this.boundsFluid, "rgba(255,0,0,0.9", !1) } }, s.FlexGrid.prototype.constructor = s.FlexGrid, s.FlexLayer = function (t, e, i, r) { s.Group.call(this, t.game, null, "__flexLayer" + t.game.rnd.uuid(), !1), this.manager = t.manager, this.grid = t, this.persist = !1, this.position = e, this.bounds = i, this.scale = r, this.topLeft = i.topLeft, this.topMiddle = new s.Point(i.halfWidth, 0), this.topRight = i.topRight, this.bottomLeft = i.bottomLeft, this.bottomMiddle = new s.Point(i.halfWidth, i.bottom), this.bottomRight = i.bottomRight }, s.FlexLayer.prototype = Object.create(s.Group.prototype), s.FlexLayer.prototype.constructor = s.FlexLayer, s.FlexLayer.prototype.resize = function () { }, s.FlexLayer.prototype.debug = function () { this.game.debug.text(this.bounds.width + " x " + this.bounds.height, this.bounds.x + 4, this.bounds.y + 16), this.game.debug.geom(this.bounds, "rgba(0,0,255,0.9", !1), this.game.debug.geom(this.topLeft, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topMiddle, "rgba(255,255,255,0.9"), this.game.debug.geom(this.topRight, "rgba(255,255,255,0.9") }, s.Color = { RED: 16711680, ORANGE: 16750848, YELLOW: 16776960, GREEN: 65280, AQUA: 65535, BLUE: 255, VIOLET: 16711935, WHITE: 16777215, BLACK: 0, GRAY: 6710886, packPixel: function (t, e, i, r) { return s.Device.LITTLE_ENDIAN ? (r << 24 | i << 16 | e << 8 | t) >>> 0 : (t << 24 | e << 16 | i << 8 | r) >>> 0 }, unpackPixel: function (t, e, i, r) { return void 0 !== e && null !== e || (e = s.Color.createColor()), void 0 !== i && null !== i || (i = !1), void 0 !== r && null !== r || (r = !1), s.Device.LITTLE_ENDIAN ? (e.a = (4278190080 & t) >>> 24, e.b = (16711680 & t) >>> 16, e.g = (65280 & t) >>> 8, e.r = 255 & t) : (e.r = (4278190080 & t) >>> 24, e.g = (16711680 & t) >>> 16, e.b = (65280 & t) >>> 8, e.a = 255 & t), e.color = t, e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a / 255 + ")", i && s.Color.RGBtoHSL(e.r, e.g, e.b, e), r && s.Color.RGBtoHSV(e.r, e.g, e.b, e), e }, fromRGBA: function (t, e) { return e || (e = s.Color.createColor()), e.r = (4278190080 & t) >>> 24, e.g = (16711680 & t) >>> 16, e.b = (65280 & t) >>> 8, e.a = 255 & t, e.rgba = "rgba(" + e.r + "," + e.g + "," + e.b + "," + e.a + ")", e }, toRGBA: function (t, e, i, r) { return t << 24 | e << 16 | i << 8 | r }, toABGR: function (t, e, i, r) { return (r << 24 | i << 16 | e << 8 | t) >>> 0 }, hexToRGBArray: function (t) { return [(t >> 16 & 255) / 255, (t >> 8 & 255) / 255, (255 & t) / 255] }, RGBArrayToHex: function (t) { return (255 * t[0] << 16) + (255 * t[1] << 8) + 255 * t[2] }, RGBtoHSL: function (t, e, i, r) { r || (r = s.Color.createColor(t, e, i, 1)), t /= 255, e /= 255, i /= 255; var n = Math.min(t, e, i), o = Math.max(t, e, i); if (r.h = 0, r.s = 0, r.l = (o + n) / 2, o !== n) { var a = o - n; r.s = r.l > .5 ? a / (2 - o - n) : a / (o + n), o === t ? r.h = (e - i) / a + (e < i ? 6 : 0) : o === e ? r.h = (i - t) / a + 2 : o === i && (r.h = (t - e) / a + 4), r.h /= 6 } return r }, HSLtoRGB: function (t, e, i, r) { if (r ? (r.r = i, r.g = i, r.b = i) : r = s.Color.createColor(i, i, i), 0 !== e) { var n = i < .5 ? i * (1 + e) : i + e - i * e, o = 2 * i - n; r.r = s.Color.hueToColor(o, n, t + 1 / 3), r.g = s.Color.hueToColor(o, n, t), r.b = s.Color.hueToColor(o, n, t - 1 / 3) } return r.r = Math.floor(255 * r.r | 0), r.g = Math.floor(255 * r.g | 0), r.b = Math.floor(255 * r.b | 0), s.Color.updateColor(r), r }, RGBtoHSV: function (t, e, i, r) { r || (r = s.Color.createColor(t, e, i, 255)), t /= 255, e /= 255, i /= 255; var n = Math.min(t, e, i), o = Math.max(t, e, i), a = o - n; return r.h = 0, r.s = 0 === o ? 0 : a / o, r.v = o, o !== n && (o === t ? r.h = (e - i) / a + (e < i ? 6 : 0) : o === e ? r.h = (i - t) / a + 2 : o === i && (r.h = (t - e) / a + 4), r.h /= 6), r }, HSVtoRGB: function (t, e, i, r) { var n, o, a; void 0 === r && (r = s.Color.createColor(0, 0, 0, 1, t, e, 0, i)); var h = Math.floor(6 * t), u = 6 * t - h, l = i * (1 - e), c = i * (1 - u * e), d = i * (1 - (1 - u) * e); switch (h % 6) { case 0: n = i, o = d, a = l; break; case 1: n = c, o = i, a = l; break; case 2: n = l, o = i, a = d; break; case 3: n = l, o = c, a = i; break; case 4: n = d, o = l, a = i; break; case 5: n = i, o = l, a = c }return r.r = Math.floor(255 * n), r.g = Math.floor(255 * o), r.b = Math.floor(255 * a), s.Color.updateColor(r), r }, hueToColor: function (t, e, i) { return i < 0 && (i += 1), i > 1 && (i -= 1), i < 1 / 6 ? t + 6 * (e - t) * i : i < .5 ? e : i < 2 / 3 ? t + (e - t) * (2 / 3 - i) * 6 : t }, createColor: function (t, e, i, r, n, o, a, h) { var u = { r: t || 0, g: e || 0, b: i || 0, a: r || 1, h: n || 0, s: o || 0, l: a || 0, v: h || 0, color: 0, color32: 0, rgba: "" }; return s.Color.updateColor(u) }, updateColor: function (t) { return t.rgba = "rgba(" + t.r.toFixed() + "," + t.g.toFixed() + "," + t.b.toFixed() + "," + t.a.toString() + ")", t.color = s.Color.getColor(t.r, t.g, t.b), t.color32 = s.Color.getColor32(255 * t.a, t.r, t.g, t.b), t }, getColor32: function (t, e, i, r) { return t << 24 | e << 16 | i << 8 | r }, getColor: function (t, e, i) { return t << 16 | e << 8 | i }, RGBtoString: function (t, e, i, r, n) { return void 0 === r && (r = 255), void 0 === n && (n = "#"), "#" === n ? "#" + ((1 << 24) + (t << 16) + (e << 8) + i).toString(16).slice(1) : "0x" + s.Color.componentToHex(r) + s.Color.componentToHex(t) + s.Color.componentToHex(e) + s.Color.componentToHex(i) }, hexToRGB: function (t) { var e = s.Color.hexToColor(t); if (e) return s.Color.getColor32(e.a, e.r, e.g, e.b) }, hexToColor: function (t, e) { t = t.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i, function (t, e, i, r) { return e + e + i + i + r + r }); var i = /^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t); if (i) { var r = parseInt(i[1], 16), n = parseInt(i[2], 16), o = parseInt(i[3], 16); e ? (e.r = r, e.g = n, e.b = o) : e = s.Color.createColor(r, n, o) } return e }, webToColor: function (t, e) { e || (e = s.Color.createColor()); var i = /^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(t); return i && (e.r = ~~Number(i[1]), e.g = ~~Number(i[2]), e.b = ~~Number(i[3]), e.a = void 0 !== i[4] ? Number(i[4]) : 1, s.Color.updateColor(e)), e }, valueToColor: function (t, e) { if (e || (e = s.Color.createColor()), "string" == typeof t) return 0 === t.indexOf("rgb") ? s.Color.webToColor(t, e) : (e.a = 1, s.Color.hexToColor(t, e)); if ("number" == typeof t) { var i = s.Color.getRGB(t); return e.r = i.r, e.g = i.g, e.b = i.b, e.a = i.a / 255, e } return e }, componentToHex: function (t) { var e = t.toString(16); return 1 === e.length ? "0" + e : e }, HSVColorWheel: function (t, e) { void 0 === t && (t = 1), void 0 === e && (e = 1); for (var i = [], r = 0; r <= 359; r++)i.push(s.Color.HSVtoRGB(r / 359, t, e)); return i }, HSLColorWheel: function (t, e) { void 0 === t && (t = .5), void 0 === e && (e = .5); for (var i = [], r = 0; r <= 359; r++)i.push(s.Color.HSLtoRGB(r / 359, t, e)); return i }, interpolateColor: function (t, e, i, r, n, o) { void 0 === n && (n = 255), void 0 === o && (o = 0); var a = s.Color.getRGB(t), h = s.Color.getRGB(e); if (0 === o) var u = (h.red - a.red) * r / i + a.red, l = (h.green - a.green) * r / i + a.green, c = (h.blue - a.blue) * r / i + a.blue; if (1 === o) { var d, p = s.Color.RGBtoHSV(a.r, a.g, a.b), f = s.Color.RGBtoHSV(h.r, h.g, h.b), g = f.h - p.h; if (p.h > f.h) { var m = f.h; f.h = p.h, p.h = m, g = -g, r = i - r } g > .5 && (p.h = p.h + 1, d = ((f.h - p.h) * r / i + p.h) % 1), g <= .5 && (d = (f.h - p.h) * r / i + p.h); var v = (f.s - p.s) * r / i + p.s, y = (f.v - p.v) * r / i + p.v, x = s.Color.HSVtoRGB(d, v, y, x); u = x.r, l = x.g, c = x.b } return s.Color.getColor32(n, u, l, c) }, interpolateColorWithRGB: function (t, e, i, r, n, o) { var a = s.Color.getRGB(t), h = (e - a.red) * o / n + a.red, u = (i - a.green) * o / n + a.green, l = (r - a.blue) * o / n + a.blue; return s.Color.getColor(h, u, l) }, interpolateRGB: function (t, e, i, r, n, o, a, h) { var u = (r - t) * h / a + t, l = (n - e) * h / a + e, c = (o - i) * h / a + i; return s.Color.getColor(u, l, c) }, linear: function (t, e, i) { return this.interpolateColor(t, e, 1, i) }, linearInterpolation: function (t, e) { var i = s.Math.linear(0, t.length - 1, e), r = t[Math.floor(i)], n = t[Math.ceil(i)]; return this.linear(r, n, i % 1) }, getRandomColor: function (t, e, i) { if (void 0 === t && (t = 0), void 0 === e && (e = 255), void 0 === i && (i = 255), e > 255 || t > e) return s.Color.getColor(255, 255, 255); var r = t + Math.round(Math.random() * (e - t)), n = t + Math.round(Math.random() * (e - t)), o = t + Math.round(Math.random() * (e - t)); return s.Color.getColor32(i, r, n, o) }, getRGB: function (t) { return t > 16777215 ? { alpha: t >>> 24, red: t >> 16 & 255, green: t >> 8 & 255, blue: 255 & t, a: t >>> 24, r: t >> 16 & 255, g: t >> 8 & 255, b: 255 & t } : { alpha: 255, red: t >> 16 & 255, green: t >> 8 & 255, blue: 255 & t, a: 255, r: t >> 16 & 255, g: t >> 8 & 255, b: 255 & t } }, getWebRGB: function (t) { if ("object" === (void 0 === t ? "undefined" : r(t))) return "rgba(" + t.r.toString() + "," + t.g.toString() + "," + t.b.toString() + "," + (t.a / 255).toString() + ")"; var e = s.Color.getRGB(t); return "rgba(" + e.r.toString() + "," + e.g.toString() + "," + e.b.toString() + "," + (e.a / 255).toString() + ")" }, getAlpha: function (t) { return t >>> 24 }, getAlphaFloat: function (t) { return (t >>> 24) / 255 }, getRed: function (t) { return t >> 16 & 255 }, getGreen: function (t) { return t >> 8 & 255 }, getBlue: function (t) { return 255 & t }, blendNormal: function (t) { return t }, blendLighten: function (t, e) { return e > t ? e : t }, blendDarken: function (t, e) { return e > t ? t : e }, blendMultiply: function (t, e) { return t * e / 255 }, blendAverage: function (t, e) { return (t + e) / 2 }, blendAdd: function (t, e) { return Math.min(255, t + e) }, blendSubtract: function (t, e) { return Math.max(0, t + e - 255) }, blendDifference: function (t, e) { return Math.abs(t - e) }, blendNegation: function (t, e) { return 255 - Math.abs(255 - t - e) }, blendScreen: function (t, e) { return 255 - ((255 - t) * (255 - e) >> 8) }, blendExclusion: function (t, e) { return t + e - 2 * t * e / 255 }, blendOverlay: function (t, e) { return e < 128 ? 2 * t * e / 255 : 255 - 2 * (255 - t) * (255 - e) / 255 }, blendSoftLight: function (t, e) { return e < 128 ? 2 * (64 + (t >> 1)) * (e / 255) : 255 - 2 * (255 - (64 + (t >> 1))) * (255 - e) / 255 }, blendHardLight: function (t, e) { return s.Color.blendOverlay(e, t) }, blendColorDodge: function (t, e) { return 255 === e ? e : Math.min(255, (t << 8) / (255 - e)) }, blendColorBurn: function (t, e) { return 0 === e ? e : Math.max(0, 255 - (255 - t << 8) / e) }, blendLinearDodge: function (t, e) { return s.Color.blendAdd(t, e) }, blendLinearBurn: function (t, e) { return s.Color.blendSubtract(t, e) }, blendLinearLight: function (t, e) { return e < 128 ? s.Color.blendLinearBurn(t, 2 * e) : s.Color.blendLinearDodge(t, 2 * (e - 128)) }, blendVividLight: function (t, e) { return e < 128 ? s.Color.blendColorBurn(t, 2 * e) : s.Color.blendColorDodge(t, 2 * (e - 128)) }, blendPinLight: function (t, e) { return e < 128 ? s.Color.blendDarken(t, 2 * e) : s.Color.blendLighten(t, 2 * (e - 128)) }, blendHardMix: function (t, e) { return s.Color.blendVividLight(t, e) < 128 ? 0 : 255 }, blendReflect: function (t, e) { return 255 === e ? e : Math.min(255, t * t / (255 - e)) }, blendGlow: function (t, e) { return s.Color.blendReflect(e, t) }, blendPhoenix: function (t, e) { return Math.min(t, e) - Math.max(t, e) + 255 } }, s.Physics = function (t, e) { e = e || {}, this.game = t, this.config = e, this.arcade = null, this.p2 = null, this.ninja = null, this.box2d = null, this.chipmunk = null, this.matter = null, this.parseConfig() }, s.Physics.ARCADE = 0, s.Physics.P2JS = 1, s.Physics.NINJA = 2, s.Physics.BOX2D = 3, s.Physics.CHIPMUNK = 4, s.Physics.MATTERJS = 5, s.Physics.prototype = { parseConfig: function () { this.config.hasOwnProperty("arcade") && !0 !== this.config.arcade || !s.Physics.hasOwnProperty("Arcade") || (this.arcade = new s.Physics.Arcade(this.game)), this.config.hasOwnProperty("ninja") && !0 === this.config.ninja && s.Physics.hasOwnProperty("Ninja") && (this.ninja = new s.Physics.Ninja(this.game)), this.config.hasOwnProperty("p2") && !0 === this.config.p2 && s.Physics.hasOwnProperty("P2") && (this.p2 = new s.Physics.P2(this.game, this.config)), this.config.hasOwnProperty("box2d") && !0 === this.config.box2d && s.Physics.hasOwnProperty("BOX2D") && (this.box2d = new s.Physics.BOX2D(this.game, this.config)), this.config.hasOwnProperty("matter") && !0 === this.config.matter && s.Physics.hasOwnProperty("Matter") && (this.matter = new s.Physics.Matter(this.game, this.config)) }, startSystem: function (t) { t === s.Physics.ARCADE ? this.arcade = new s.Physics.Arcade(this.game) : t === s.Physics.P2JS ? null === this.p2 ? this.p2 = new s.Physics.P2(this.game, this.config) : this.p2.reset() : t === s.Physics.NINJA ? this.ninja = new s.Physics.Ninja(this.game) : t === s.Physics.BOX2D ? null === this.box2d ? this.box2d = new s.Physics.Box2D(this.game, this.config) : this.box2d.reset() : t === s.Physics.MATTERJS && (null === this.matter ? this.matter = new s.Physics.Matter(this.game, this.config) : this.matter.reset()) }, enable: function (t, e, i) { void 0 === e && (e = s.Physics.ARCADE), void 0 === i && (i = !1), e === s.Physics.ARCADE ? this.arcade.enable(t) : e === s.Physics.P2JS && this.p2 ? this.p2.enable(t, i) : e === s.Physics.NINJA && this.ninja ? this.ninja.enableAABB(t) : e === s.Physics.BOX2D && this.box2d ? this.box2d.enable(t) : e === s.Physics.MATTERJS && this.matter ? this.matter.enable(t) : console.warn(t.key + " is attempting to enable a physics body using an unknown physics system.") }, preUpdate: function () { this.p2 && this.p2.preUpdate(), this.box2d && this.box2d.preUpdate(), this.matter && this.matter.preUpdate() }, update: function () { this.p2 && this.p2.update(), this.box2d && this.box2d.update(), this.matter && this.matter.update() }, setBoundsToWorld: function () { this.arcade && this.arcade.setBoundsToWorld(), this.ninja && this.ninja.setBoundsToWorld(), this.p2 && this.p2.setBoundsToWorld(), this.box2d && this.box2d.setBoundsToWorld(), this.matter && this.matter.setBoundsToWorld() }, clear: function () { this.p2 && this.p2.clear(), this.box2d && this.box2d.clear(), this.matter && this.matter.clear() }, reset: function () { this.p2 && this.p2.reset(), this.box2d && this.box2d.reset(), this.matter && this.matter.reset() }, destroy: function () { this.p2 && this.p2.destroy(), this.box2d && this.box2d.destroy(), this.matter && this.matter.destroy(), this.arcade = null, this.ninja = null, this.p2 = null, this.box2d = null, this.matter = null } }, s.Physics.prototype.constructor = s.Physics, s.Particles = function (t) { this.game = t, this.emitters = {}, this.ID = 0 }, s.Particles.prototype = { add: function (t) { return this.emitters[t.id] = t, t }, remove: function (t) { delete this.emitters[t.id] } }, s.Particles.prototype.constructor = s.Particles, s.Video = function (t, e, i) { if (void 0 === e && (e = null), void 0 === i && (i = null), this.game = t, this.key = e, this.width = 0, this.height = 0, this.type = s.VIDEO, this.disableTextureUpload = !1, this.touchLocked = !1, this.onPlay = new s.Signal, this.onChangeSource = new s.Signal, this.onComplete = new s.Signal, this.onAccess = new s.Signal, this.onError = new s.Signal, this.onTimeout = new s.Signal, this.onTouchUnlock = new s.Signal, this.playWhenUnlocked = !0, this.timeout = 15e3, this._timeOutID = null, this.video = null, this.videoStream = null, this.isStreaming = !1, this.retryLimit = 20, this.retry = 0, this.retryInterval = 500, this._retryID = null, this._codeMuted = !1, this._muted = !1, this._codePaused = !1, this._paused = !1, this._pending = !1, this._pendingChangeSource = !1, this._autoplay = !1, this._endCallback = null, this._playCallback = null, e && this.game.cache.checkVideoKey(e)) { var r = this.game.cache.getVideo(e); r.isBlob ? this.createVideoFromBlob(r.data) : this.video = r.data, this.width = this.video.videoWidth, this.height = this.video.videoHeight } else i && this.createVideoFromURL(i, !1); this.video && !i ? (this.baseTexture = new PIXI.BaseTexture(this.video, null, this.game.resolution), this.baseTexture.forceLoaded(this.width, this.height)) : (this.baseTexture = new PIXI.BaseTexture(s.Cache.DEFAULT.baseTexture.source, null, this.game.resolution), this.baseTexture.forceLoaded(this.width, this.height)), this.texture = new PIXI.Texture(this.baseTexture), this.textureFrame = new s.Frame(0, 0, 0, this.width, this.height, "video"), this.texture.setFrame(this.textureFrame), this.texture.valid = !1, null !== e && this.video && (this.texture.valid = this.video.canplay), this.snapshot = null, s.BitmapData && (this.snapshot = new s.BitmapData(this.game, "", this.width, this.height)), this.game.device.needsTouchUnlock() ? this.setTouchLock() : r && (r.locked = !1) }, s.Video.prototype = { connectToMediaStream: function (t, e) { return t && e && (this.video = t, this.videoStream = e, this.isStreaming = !0, this.baseTexture.source = this.video, this.updateTexture(null, this.video.videoWidth, this.video.videoHeight), this.onAccess.dispatch(this)), this }, startMediaStream: function (t, e, i) { if (void 0 === t && (t = !1), void 0 === e && (e = null), void 0 === i && (i = null), !this.game.device.getUserMedia) return this.onError.dispatch(this, "No getUserMedia"), !1; null !== this.videoStream && (this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.stop()), this.removeVideoElement(), this.video = document.createElement("video"), this.video.setAttribute("autoplay", "autoplay"), null !== e && (this.video.width = e), null !== i && (this.video.height = i), this._timeOutID = window.setTimeout(this.getUserMediaTimeout.bind(this), this.timeout); try { navigator.getUserMedia({ audio: t, video: !0 }, this.getUserMediaSuccess.bind(this), this.getUserMediaError.bind(this)) } catch (t) { this.getUserMediaError(t) } return this }, getUserMediaTimeout: function () { clearTimeout(this._timeOutID), this.onTimeout.dispatch(this) }, getUserMediaError: function (t) { clearTimeout(this._timeOutID), this.onError.dispatch(this, t) }, getUserMediaSuccess: function (t) { clearTimeout(this._timeOutID), this.videoStream = t, void 0 !== this.video.mozSrcObject ? this.video.mozSrcObject = t : this.video.src = window.URL && window.URL.createObjectURL(t) || t; var e = this; this.video.onloadeddata = function () { var t = 10; !function i() { if (t > 0) if (e.video.videoWidth > 0) { var r = e.video.videoWidth, n = e.video.videoHeight; isNaN(e.video.videoHeight) && (n = r / (4 / 3)), e.video.play(), e.isStreaming = !0, e.baseTexture.source = e.video, e.updateTexture(null, r, n), e.onAccess.dispatch(e) } else window.setTimeout(i, 500); else console.warn("Unable to connect to video stream. Webcam error?"); t-- }() } }, createVideoFromBlob: function (t) { var e = this; return this.video = document.createElement("video"), this.video.controls = !1, this.video.setAttribute("autoplay", "autoplay"), this.video.addEventListener("loadeddata", function (t) { e.updateTexture(t) }, !0), this.video.src = window.URL.createObjectURL(t), this.video.canplay = !0, this }, createVideoFromURL: function (t, e) { return void 0 === e && (e = !1), this.texture && (this.texture.valid = !1), this.video = document.createElement("video"), this.video.controls = !1, e && this.video.setAttribute("autoplay", "autoplay"), this.video.src = t, this.video.canplay = !0, this.video.load(), this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval), this.key = t, this }, updateTexture: function (t, e, i) { var r = !1; void 0 !== e && null !== e || (e = this.video.videoWidth, r = !0), void 0 !== i && null !== i || (i = this.video.videoHeight), this.width = e, this.height = i, this.baseTexture.source !== this.video && (this.baseTexture.source = this.video), this.baseTexture.forceLoaded(e, i), this.texture.frame.resize(e, i), this.texture.width = e, this.texture.height = i, this.texture.valid = !0, this.snapshot && this.snapshot.resize(e, i), r && null !== this.key && (this.onChangeSource.dispatch(this, e, i), this._autoplay && (this.video.play(), this.onPlay.dispatch(this, this.loop, this.playbackRate))) }, complete: function () { this.onComplete.dispatch(this) }, play: function (t, e) { return this._pendingChangeSource ? this : (void 0 === t && (t = !1), void 0 === e && (e = 1), this.game.sound.onMute && (this.game.sound.onMute.add(this.setMute, this), this.game.sound.onUnMute.add(this.unsetMute, this), this.game.sound.mute && this.setMute()), this.game.onPause.add(this.setPause, this), this.game.onResume.add(this.setResume, this), this._endCallback = this.complete.bind(this), this.video.addEventListener("ended", this._endCallback, !0), this.video.addEventListener("webkitendfullscreen", this._endCallback, !0), this.video.loop = t ? "loop" : "", this.video.playbackRate = e, this.touchLocked ? this._pending = !0 : (this._pending = !1, null !== this.key && (4 !== this.video.readyState ? (this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval)) : (this._playCallback = this.playHandler.bind(this), this.video.addEventListener("playing", this._playCallback, !0))), this.video.play(), this.onPlay.dispatch(this, t, e)), this) }, playHandler: function () { this.video.removeEventListener("playing", this._playCallback, !0), this.updateTexture() }, stop: function () { return this.game.sound.onMute && (this.game.sound.onMute.remove(this.setMute, this), this.game.sound.onUnMute.remove(this.unsetMute, this)), this.game.onPause.remove(this.setPause, this), this.game.onResume.remove(this.setResume, this), this.isStreaming ? (this.video.mozSrcObject ? (this.video.mozSrcObject.stop(), this.video.src = null) : (this.video.src = "", this.videoStream.active ? this.videoStream.active = !1 : this.videoStream.getTracks ? this.videoStream.getTracks().forEach(function (t) { t.stop() }) : this.videoStream.stop()), this.videoStream = null, this.isStreaming = !1) : (this.video.removeEventListener("ended", this._endCallback, !0), this.video.removeEventListener("webkitendfullscreen", this._endCallback, !0), this.video.removeEventListener("playing", this._playCallback, !0), this.touchLocked ? this._pending = !1 : this.video.pause()), this }, add: function (t) { if (Array.isArray(t)) for (var e = 0; e < t.length; e++)t[e].loadTexture && t[e].loadTexture(this); else t.loadTexture(this); return this }, addToWorld: function (t, e, i, r, n, s) { n = n || 1, s = s || 1; var o = this.game.add.image(t, e, this); return o.anchor.set(i, r), o.scale.set(n, s), o }, render: function () { !this.disableTextureUpload && this.playing && this.baseTexture.dirty() }, setMute: function () { this._muted || (this._muted = !0, this.video.muted = !0) }, unsetMute: function () { this._muted && !this._codeMuted && (this._muted = !1, this.video.muted = !1) }, setPause: function () { this._paused || this.touchLocked || (this._paused = !0, this.video.pause()) }, setResume: function () { !this._paused || this._codePaused || this.touchLocked || (this._paused = !1, this.video.ended || this.video.play()) }, changeSource: function (t, e) { return void 0 === e && (e = !0), this.texture.valid = !1, this.video.pause(), this._pendingChangeSource = !0, this.retry = this.retryLimit, this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval), this.video.src = t, this.video.load(), this._autoplay = e, e || (this.paused = !0), this }, checkVideoProgress: function () { 4 === this.video.readyState ? (this._pendingChangeSource = !1, this.updateTexture()) : (this.retry-- , this.retry > 0 ? this._retryID = window.setTimeout(this.checkVideoProgress.bind(this), this.retryInterval) : console.warn("Phaser.Video: Unable to start downloading video in time", this.isStreaming)) }, setTouchLock: function () { this.game.input.addTouchLockCallback(this.unlock, this, !0), this.touchLocked = !0 }, unlock: function () { if (this.touchLocked = !1, this.playWhenUnlocked && (this.video.play(), this.onPlay.dispatch(this, this.loop, this.playbackRate)), this.key) { var t = this.game.cache.getVideo(this.key); t && !t.isBlob && (t.locked = !1) } return this.onTouchUnlock.dispatch(this), !0 }, grab: function (t, e, i) { if (void 0 === t && (t = !1), void 0 === e && (e = 1), void 0 === i && (i = null), null !== this.snapshot) return t && this.snapshot.cls(), this.snapshot.copy(this.video, 0, 0, this.width, this.height, 0, 0, this.width, this.height, 0, 0, 0, 1, 1, e, i), this.snapshot; console.warn("Video.grab cannot run because Phaser.BitmapData is unavailable") }, removeVideoElement: function () { if (this.video) { for (this.video.parentNode && this.video.parentNode.removeChild(this.video); this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild); this.video.removeAttribute("autoplay"), this.video.removeAttribute("src"), this.video = null } }, destroy: function () { this.stop(), this.removeVideoElement(), this.touchLocked && this.game.input.touch.removeTouchLockCallback(this.unlock, this), this._retryID && window.clearTimeout(this._retryID) } }, Object.defineProperty(s.Video.prototype, "currentTime", { get: function () { return this.video ? this.video.currentTime : 0 }, set: function (t) { this.video.currentTime = t } }), Object.defineProperty(s.Video.prototype, "duration", { get: function () { return this.video ? this.video.duration : 0 } }), Object.defineProperty(s.Video.prototype, "progress", { get: function () { return this.video ? this.video.currentTime / this.video.duration : 0 } }), Object.defineProperty(s.Video.prototype, "mute", { get: function () { return this._muted }, set: function (t) { if (t = t || null) { if (this._muted) return; this._codeMuted = !0, this.setMute() } else { if (!this._muted) return; this._codeMuted = !1, this.unsetMute() } } }), Object.defineProperty(s.Video.prototype, "paused", { get: function () { return this._paused }, set: function (t) { if (t = t || null, !this.touchLocked) if (t) { if (this._paused) return; this._codePaused = !0, this.setPause() } else { if (!this._paused) return; this._codePaused = !1, this.setResume() } } }), Object.defineProperty(s.Video.prototype, "volume", { get: function () { return this.video ? this.video.volume : 1 }, set: function (t) { t < 0 ? t = 0 : t > 1 && (t = 1), this.video && (this.video.volume = t) } }), Object.defineProperty(s.Video.prototype, "playbackRate", { get: function () { return this.video ? this.video.playbackRate : 1 }, set: function (t) { this.video && (this.video.playbackRate = t) } }), Object.defineProperty(s.Video.prototype, "loop", { get: function () { return !!this.video && this.video.loop }, set: function (t) { t && this.video ? this.video.loop = "loop" : this.video && (this.video.loop = "") } }), Object.defineProperty(s.Video.prototype, "playing", { get: function () { return !!this.video && !(this.video.paused && this.video.ended) } }), s.Video.prototype.constructor = s.Video, void 0 === PIXI.blendModes && (PIXI.blendModes = s.blendModes), void 0 === PIXI.scaleModes && (PIXI.scaleModes = s.scaleModes), void 0 === PIXI.Texture.emptyTexture && (PIXI.Texture.emptyTexture = new PIXI.Texture(new PIXI.BaseTexture)), void 0 === PIXI.DisplayObject._tempMatrix && (PIXI.DisplayObject._tempMatrix = new s.Matrix), PIXI.TextureSilentFail = !0, PIXI.canUseNewCanvasBlendModes = function () { return s.Device.canUseMultiply }, void 0 !== t && t.exports && (e = t.exports = s), e.Phaser = s, s }.call(void 0) }).call(e, i("W2nU")) }, tJwI: function (t, e, i) { "use strict"; var r = i("FryR"), n = i("Qh14"); i("3i66")("keys", function () { return function (t) { return n(r(t)) } }) }, taNN: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = 180 / Math.PI; r(r.S, "Math", { degrees: function (t) { return t * n } }) }, tqSY: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.P, "String", { repeat: i("xAdt") }) }, twxM: function (t, e, i) { "use strict"; var r = i("lDLk"), n = i("DIVP"), s = i("Qh14"); t.exports = i("bUqO") ? Object.defineProperties : function (t, e) { n(t); for (var i, o = s(e), a = o.length, h = 0; a > h;)r.f(t, i = o[h++], e[i]); return t } }, u0PK: function (t, e, i) { "use strict"; var r = i("UKM+"), n = i("ydD5"), s = i("kkCw")("match"); t.exports = function (t) { var e; return r(t) && (void 0 !== (e = t[s]) ? !!e : "RegExp" == n(t)) } }, uDYd: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("XSOZ"), s = i("FryR"), o = i("zgIt"), a = [].sort, h = [1, 2, 3]; r(r.P + r.F * (o(function () { h.sort(void 0) }) || !o(function () { h.sort(null) }) || !i("NNrz")(a)), "Array", { sort: function (t) { return void 0 === t ? a.call(s(this)) : a.call(s(this), n(t)) } }) }, uEEG: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { scale: i("WY8G") }) }, uc2A: function (t, e, i) { "use strict"; var r = i("V3l/"), n = i("Ds5P"), s = i("R3AP"), o = i("2p1q"), a = i("bN1p"), h = i("IRJ3"), u = i("yYvK"), l = i("KOrd"), c = i("kkCw")("iterator"), d = !([].keys && "next" in [].keys()), p = function () { return this }; t.exports = function (t, e, i, f, g, m, v) { h(i, e, f); var y, x, _, b = function (t) { if (!d && t in C) return C[t]; switch (t) { case "keys": case "values": return function () { return new i(this, t) } }return function () { return new i(this, t) } }, T = e + " Iterator", w = "values" == g, S = !1, C = t.prototype, P = C[c] || C["@@iterator"] || g && C[g], E = P || b(g), A = g ? w ? b("entries") : E : void 0, R = "Array" == e && C.entries || P; if (R && (_ = l(R.call(new t))) !== Object.prototype && _.next && (u(_, T, !0), r || "function" == typeof _[c] || o(_, c, p)), w && P && "values" !== P.name && (S = !0, E = function () { return P.call(this) }), r && !v || !d && !S && C[c] || o(C, c, E), a[e] = E, a[T] = p, g) if (y = { values: w ? E : b("values"), keys: m ? E : b("keys"), entries: A }, v) for (x in y) x in C || s(C, x, y[x]); else n(n.P + n.F * (d || S), e, y); return y } }, ulTY: function (t, e, i) { "use strict"; var r = 0, n = Math.random(); t.exports = function (t) { return "Symbol(".concat(void 0 === t ? "" : t, ")_", (++r + n).toString(36)) } }, v2lb: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("Rz2z"), s = Math.sqrt, o = Math.acosh; r(r.S + r.F * !(o && 710 == Math.floor(o(Number.MAX_VALUE)) && o(1 / 0) == 1 / 0), "Math", { acosh: function (t) { return (t = +t) < 1 ? NaN : t > 94906265.62425156 ? Math.log(t) + Math.LN2 : n(t - 1 + s(t - 1) * s(t + 1)) } }) }, v3hU: function (t, e, i) { "use strict"; var r = i("dSUw"), n = i("QG7u"), s = i("wCso"), o = i("DIVP"), a = i("KOrd"), h = s.keys, u = s.key; s.exp({ getMetadataKeys: function (t) { return function t(e, i) { var s = h(e, i), o = a(e); if (null === o) return s; var u = t(o, i); return u.length ? s.length ? n(new r(s.concat(u))) : u : s }(o(t), arguments.length < 2 ? void 0 : u(arguments[1])) } }) }, v8VU: function (t, e, i) { "use strict"; var r = i("OzIq"), n = i("Ds5P"), s = i("41xE"), o = [].slice, a = /MSIE .\./.test(s), h = function (t) { return function (e, i) { var r = arguments.length > 2, n = !!r && o.call(arguments, 2); return t(r ? function () { ("function" == typeof e ? e : Function(e)).apply(this, n) } : e, i) } }; n(n.G + n.B + n.F * a, { setTimeout: h(r.setTimeout), setInterval: h(r.setInterval) }) }, v90c: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("IFpc"), s = i("FryR"), o = i("BbyF"), a = i("oeih"), h = i("plSV"); r(r.P, "Array", { flatten: function () { var t = arguments[0], e = s(this), i = o(e.length), r = h(e, 0); return n(r, e, e, i, 0, void 0 === t ? 1 : a(t)), r } }), i("RhFG")("flatten") }, vmSO: function (t, e, i) { "use strict"; var r = i("rFzY"), n = i("XvUs"), s = i("9vb1"), o = i("DIVP"), a = i("BbyF"), h = i("SHe9"), u = {}, l = {}, c = t.exports = function (t, e, i, c, d) { var p, f, g, m, v = d ? function () { return t } : h(t), y = r(i, c, e ? 2 : 1), x = 0; if ("function" != typeof v) throw TypeError(t + " is not iterable!"); if (s(v)) { for (p = a(t.length); p > x; x++)if ((m = e ? y(o(f = t[x])[0], f[1]) : y(t[x])) === u || m === l) return m } else for (g = v.call(t); !(f = g.next()).done;)if ((m = n(g, y, f.value, e)) === u || m === l) return m }; c.BREAK = u, c.RETURN = l }, vmSu: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("7ylX"), s = i("XSOZ"), o = i("DIVP"), a = i("UKM+"), h = i("zgIt"), u = i("ZtwE"), l = (i("OzIq").Reflect || {}).construct, c = h(function () { function t() { } return !(l(function () { }, [], t) instanceof t) }), d = !h(function () { l(function () { }) }); r(r.S + r.F * (c || d), "Reflect", { construct: function (t, e) { s(t), o(e); var i = arguments.length < 3 ? t : s(arguments[2]); if (d && !c) return l(t, e, i); if (t == i) { switch (e.length) { case 0: return new t; case 1: return new t(e[0]); case 2: return new t(e[0], e[1]); case 3: return new t(e[0], e[1], e[2]); case 4: return new t(e[0], e[1], e[2], e[3]) }var r = [null]; return r.push.apply(r, e), new (u.apply(t, r)) } var h = i.prototype, p = n(a(h) ? h : Object.prototype), f = Function.apply.call(t, p, e); return a(f) ? f : p } }) }, vnWP: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("WY8G"), s = i("g/m8"); r(r.S, "Math", { fscale: function (t, e, i, r, o) { return s(n(t, e, i, r, o)) } }) }, vsh6: function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = r.keys, o = r.key; r.exp({ getOwnMetadataKeys: function (t) { return s(n(t), arguments.length < 2 ? void 0 : o(arguments[1])) } }) }, "vu/c": function (t, e, i) { "use strict"; i("3g/S")("observable") }, w6Dh: function (t, e, i) { "use strict"; var r = i("XSOZ"); t.exports.f = function (t) { return new function (t) { var e, i; this.promise = new t(function (t, r) { if (void 0 !== e || void 0 !== i) throw TypeError("Bad Promise constructor"); e = t, i = r }), this.resolve = r(e), this.reject = r(i) }(t) } }, w6W7: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(1); r(r.P + r.F * !i("NNrz")([].map, !0), "Array", { map: function (t) { return n(this, t, arguments[1]) } }) }, wC1N: function (t, e, i) { "use strict"; var r = i("ydD5"), n = i("kkCw")("toStringTag"), s = "Arguments" == r(function () { return arguments }()); t.exports = function (t) { var e, i, o; return void 0 === t ? "Undefined" : null === t ? "Null" : "string" == typeof (i = function (t, e) { try { return t[e] } catch (t) { } }(e = Object(t), n)) ? i : s ? r(e) : "Object" == (o = r(e)) && "function" == typeof e.callee ? "Arguments" : o } }, wCso: function (t, e, i) { "use strict"; var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, n = i("MsuQ"), s = i("Ds5P"), o = i("VWgF")("metadata"), a = o.store || (o.store = new (i("ZDXm"))), h = function (t, e, i) { var r = a.get(t); if (!r) { if (!i) return; a.set(t, r = new n) } var s = r.get(e); if (!s) { if (!i) return; r.set(e, s = new n) } return s }; t.exports = { store: a, map: h, has: function (t, e, i) { var r = h(e, i, !1); return void 0 !== r && r.has(t) }, get: function (t, e, i) { var r = h(e, i, !1); return void 0 === r ? void 0 : r.get(t) }, set: function (t, e, i, r) { h(i, r, !0).set(t, e) }, keys: function (t, e) { var i = h(t, e, !1), r = []; return i && i.forEach(function (t, e) { r.push(e) }), r }, key: function (t) { return void 0 === t || "symbol" == (void 0 === t ? "undefined" : r(t)) ? t : String(t) }, exp: function (t) { s(s.S, "Reflect", t) } } }, wVdn: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("LhTa")(3); r(r.P + r.F * !i("NNrz")([].some, !0), "Array", { some: function (t) { return n(this, t, arguments[1]) } }) }, waEI: function (t, e, i) { (function (e) { t.exports = e.PIXI = i("C6IM") }).call(e, i("DuR2")) }, wnRD: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FkIZ"); r(r.P + r.F * !i("NNrz")([].reduce, !0), "Array", { reduce: function (t) { return n(this, t, arguments.length, arguments[1], !1) } }) }, wrs0: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = Math.abs; r(r.S, "Math", { hypot: function (t, e) { for (var i, r, s = 0, o = 0, a = arguments.length, h = 0; o < a;)h < (i = n(arguments[o++])) ? (s = s * (r = h / i) * r + 1, h = i) : s += i > 0 ? (r = i / h) * r : i; return h === 1 / 0 ? 1 / 0 : h * Math.sqrt(s) } }) }, x78i: function (t, e, i) { "use strict"; var r = Math.expm1; t.exports = !r || r(10) > 22025.465794806718 || r(10) < 22025.465794806718 || -2e-17 != r(-2e-17) ? function (t) { return 0 == (t = +t) ? t : t > -1e-6 && t < 1e-6 ? t + t * t / 2 : Math.exp(t) - 1 } : r }, x9zv: function (t, e, i) { "use strict"; var r = i("Y1aA"), n = i("fU25"), s = i("PHqh"), o = i("s4j0"), a = i("WBcL"), h = i("xZa+"), u = Object.getOwnPropertyDescriptor; e.f = i("bUqO") ? u : function (t, e) { if (t = s(t), e = o(e, !0), h) try { return u(t, e) } catch (t) { } if (a(t, e)) return n(!r.f.call(t, e), t[e]) } }, xAdt: function (t, e, i) { "use strict"; var r = i("oeih"), n = i("/whu"); t.exports = function (t) { var e = String(n(this)), i = "", s = r(t); if (s < 0 || s == 1 / 0) throw RangeError("Count can't be negative"); for (; s > 0; (s >>>= 1) && (e += e))1 & s && (i += e); return i } }, xCpI: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("FryR"), s = i("s4j0"), o = i("KOrd"), a = i("x9zv").f; i("bUqO") && r(r.P + i("dm6P"), "Object", { __lookupGetter__: function (t) { var e, i = n(this), r = s(t, !0); do { if (e = a(i, r)) return e.get } while (i = o(i)) } }) }, xMpm: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("bSML"); r(r.S + r.F * i("zgIt")(function () { function t() { } return !(Array.of.call(t) instanceof t) }), "Array", { of: function () { for (var t = 0, e = arguments.length, i = new ("function" == typeof this ? this : Array)(e); e > t;)n(i, t, arguments[t++]); return i.length = e, i } }) }, xONB: function (t, e, i) { "use strict"; var r = i("Ds5P"); r(r.S, "Math", { clz32: function (t) { return (t >>>= 0) ? 31 - Math.floor(Math.log(t + .5) * Math.LOG2E) : 32 } }) }, "xZa+": function (t, e, i) { "use strict"; t.exports = !i("bUqO") && !i("zgIt")(function () { return 7 != Object.defineProperty(i("jhxf")("div"), "a", { get: function () { return 7 } }).a }) }, xn9I: function (t, e, i) { "use strict"; i("Ymdd")("trimLeft", function (t) { return function () { return t(this, 1) } }, "trimStart") }, y325: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("zgIt"), s = i("/whu"), o = /"/g, a = function (t, e, i, r) { var n = String(s(t)), a = "<" + e; return "" !== i && (a += " " + i + '="' + String(r).replace(o, "&quot;") + '"'), a + ">" + n + "</" + e + ">" }; t.exports = function (t, e) { var i = {}; i[t] = e(a), r(r.P + r.F * n(function () { var e = ""[t]('"'); return e !== e.toLowerCase() || e.split('"').length > 3 }), "String", i) } }, y9m4: function (t, e, i) { "use strict"; var r, n, s, o, a = i("V3l/"), h = i("OzIq"), u = i("rFzY"), l = i("wC1N"), c = i("Ds5P"), d = i("UKM+"), p = i("XSOZ"), f = i("9GpA"), g = i("vmSO"), m = i("7O1s"), v = i("Sejc").set, y = i("g36u")(), x = i("w6Dh"), _ = i("SDXa"), b = i("41xE"), T = i("nphH"), w = h.TypeError, S = h.process, C = S && S.versions, P = C && C.v8 || "", E = h.Promise, A = "process" == l(S), R = function () { }, M = n = x.f, L = !!function () { try { var t = E.resolve(1), e = (t.constructor = {})[i("kkCw")("species")] = function (t) { t(R, R) }; return (A || "function" == typeof PromiseRejectionEvent) && t.then(R) instanceof e && 0 !== P.indexOf("6.6") && -1 === b.indexOf("Chrome/66") } catch (t) { } }(), I = function (t) { var e; return !(!d(t) || "function" != typeof (e = t.then)) && e }, O = function (t, e) { if (!t._n) { t._n = !0; var i = t._c; y(function () { for (var r = t._v, n = 1 == t._s, s = 0, o = function (e) { var i, s, o, a = n ? e.ok : e.fail, h = e.resolve, u = e.reject, l = e.domain; try { a ? (n || (2 == t._h && k(t), t._h = 1), !0 === a ? i = r : (l && l.enter(), i = a(r), l && (l.exit(), o = !0)), i === e.promise ? u(w("Promise-chain cycle")) : (s = I(i)) ? s.call(i, h, u) : h(i)) : u(r) } catch (t) { l && !o && l.exit(), u(t) } }; i.length > s;)o(i[s++]); t._c = [], t._n = !1, e && !t._h && D(t) }) } }, D = function (t) { v.call(h, function () { var e, i, r, n = t._v, s = F(t); if (s && (e = _(function () { A ? S.emit("unhandledRejection", n, t) : (i = h.onunhandledrejection) ? i({ promise: t, reason: n }) : (r = h.console) && r.error && r.error("Unhandled promise rejection", n) }), t._h = A || F(t) ? 2 : 1), t._a = void 0, s && e.e) throw e.v }) }, F = function (t) { return 1 !== t._h && 0 === (t._a || t._c).length }, k = function (t) { v.call(h, function () { var e; A ? S.emit("rejectionHandled", t) : (e = h.onrejectionhandled) && e({ promise: t, reason: t._v }) }) }, B = function (t) { var e = this; e._d || (e._d = !0, (e = e._w || e)._v = t, e._s = 2, e._a || (e._a = e._c.slice()), O(e, !0)) }, U = function t(e) { var i, r = this; if (!r._d) { r._d = !0, r = r._w || r; try { if (r === e) throw w("Promise can't be resolved itself"); (i = I(e)) ? y(function () { var n = { _w: r, _d: !1 }; try { i.call(e, u(t, n, 1), u(B, n, 1)) } catch (t) { B.call(n, t) } }) : (r._v = e, r._s = 1, O(r, !1)) } catch (t) { B.call({ _w: r, _d: !1 }, t) } } }; L || (E = function (t) { f(this, E, "Promise", "_h"), p(t), r.call(this); try { t(u(U, this, 1), u(B, this, 1)) } catch (t) { B.call(this, t) } }, (r = function (t) { this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1 }).prototype = i("A16L")(E.prototype, { then: function (t, e) { var i = M(m(this, E)); return i.ok = "function" != typeof t || t, i.fail = "function" == typeof e && e, i.domain = A ? S.domain : void 0, this._c.push(i), this._a && this._a.push(i), this._s && O(this, !1), i.promise }, catch: function (t) { return this.then(void 0, t) } }), s = function () { var t = new r; this.promise = t, this.resolve = u(U, t, 1), this.reject = u(B, t, 1) }, x.f = M = function (t) { return t === E || t === o ? new s(t) : n(t) }), c(c.G + c.W + c.F * !L, { Promise: E }), i("yYvK")(E, "Promise"), i("CEne")("Promise"), o = i("7gX0").Promise, c(c.S + c.F * !L, "Promise", { reject: function (t) { var e = M(this); return (0, e.reject)(t), e.promise } }), c(c.S + c.F * (a || !L), "Promise", { resolve: function (t) { return T(a && this === o ? E : this, t) } }), c(c.S + c.F * !(L && i("qkyc")(function (t) { E.all(t).catch(R) })), "Promise", { all: function (t) { var e = this, i = M(e), r = i.resolve, n = i.reject, s = _(function () { var i = [], s = 0, o = 1; g(t, !1, function (t) { var a = s++, h = !1; i.push(void 0), o++ , e.resolve(t).then(function (t) { h || (h = !0, i[a] = t, --o || r(i)) }, n) }), --o || r(i) }); return s.e && n(s.v), i.promise }, race: function (t) { var e = this, i = M(e), r = i.reject, n = _(function () { g(t, !1, function (t) { e.resolve(t).then(i.resolve, r) }) }); return n.e && r(n.v), i.promise } }) }, yJ2x: function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = r.key, o = r.set; r.exp({ defineMetadata: function (t, e, i, r) { o(t, e, n(i), s(r)) } }) }, yOtE: function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = r.has, o = r.key; r.exp({ hasOwnMetadata: function (t, e) { return s(t, n(e), arguments.length < 3 ? void 0 : o(arguments[2])) } }) }, yYvK: function (t, e, i) { "use strict"; var r = i("lDLk").f, n = i("WBcL"), s = i("kkCw")("toStringTag"); t.exports = function (t, e, i) { t && !n(t = i ? t : t.prototype, s) && r(t, s, { configurable: !0, value: e }) } }, ydD5: function (t, e, i) { "use strict"; var r = {}.toString; t.exports = function (t) { return r.call(t).slice(8, -1) } }, yuXV: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("OzIq").isFinite; r(r.S, "Number", { isFinite: function (t) { return "number" == typeof t && n(t) } }) }, yx1U: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("x9zv").f, s = i("DIVP"); r(r.S, "Reflect", { deleteProperty: function (t, e) { var i = n(s(t), e); return !(i && !i.configurable) && delete t[e] } }) }, zCYm: function (t, e, i) { "use strict"; var r = i("FryR"), n = i("zo/l"), s = i("BbyF"); t.exports = function (t) { for (var e = r(this), i = s(e.length), o = arguments.length, a = n(o > 1 ? arguments[1] : void 0, i), h = o > 2 ? arguments[2] : void 0, u = void 0 === h ? i : n(h, i); u > a;)e[a++] = t; return e } }, zZHq: function (t, e, i) { "use strict"; var r = i("wCso"), n = i("DIVP"), s = r.get, o = r.key; r.exp({ getOwnMetadata: function (t, e) { return s(t, n(e), arguments.length < 3 ? void 0 : o(arguments[2])) } }) }, zgIt: function (t, e, i) { "use strict"; t.exports = function (t) { try { return !!t() } catch (t) { return !0 } } }, zkX4: function (t, e, i) { "use strict"; (function (t, e) { var i = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }; !function (t) { var r, n = Object.prototype, s = n.hasOwnProperty, o = "function" == typeof Symbol ? Symbol : {}, a = o.iterator || "@@iterator", h = o.asyncIterator || "@@asyncIterator", u = o.toStringTag || "@@toStringTag", l = "object" === i(e), c = t.regeneratorRuntime; if (c) l && (e.exports = c); else { (c = t.regeneratorRuntime = l ? e.exports : {}).wrap = b; var d = "suspendedStart", p = "suspendedYield", f = "executing", g = "completed", m = {}, v = {}; v[a] = function () { return this }; var y = Object.getPrototypeOf, x = y && y(y(I([]))); x && x !== n && s.call(x, a) && (v = x); var _ = C.prototype = w.prototype = Object.create(v); S.prototype = _.constructor = C, C.constructor = S, C[u] = S.displayName = "GeneratorFunction", c.isGeneratorFunction = function (t) { var e = "function" == typeof t && t.constructor; return !!e && (e === S || "GeneratorFunction" === (e.displayName || e.name)) }, c.mark = function (t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, C) : (t.__proto__ = C, u in t || (t[u] = "GeneratorFunction")), t.prototype = Object.create(_), t }, c.awrap = function (t) { return { __await: t } }, P(E.prototype), E.prototype[h] = function () { return this }, c.AsyncIterator = E, c.async = function (t, e, i, r) { var n = new E(b(t, e, i, r)); return c.isGeneratorFunction(e) ? n : n.next().then(function (t) { return t.done ? t.value : n.next() }) }, P(_), _[u] = "Generator", _[a] = function () { return this }, _.toString = function () { return "[object Generator]" }, c.keys = function (t) { var e = []; for (var i in t) e.push(i); return e.reverse(), function i() { for (; e.length;) { var r = e.pop(); if (r in t) return i.value = r, i.done = !1, i } return i.done = !0, i } }, c.values = I, L.prototype = { constructor: L, reset: function (t) { if (this.prev = 0, this.next = 0, this.sent = this._sent = r, this.done = !1, this.delegate = null, this.method = "next", this.arg = r, this.tryEntries.forEach(M), !t) for (var e in this) "t" === e.charAt(0) && s.call(this, e) && !isNaN(+e.slice(1)) && (this[e] = r) }, stop: function () { this.done = !0; var t = this.tryEntries[0].completion; if ("throw" === t.type) throw t.arg; return this.rval }, dispatchException: function (t) { if (this.done) throw t; var e = this; function i(i, n) { return a.type = "throw", a.arg = t, e.next = i, n && (e.method = "next", e.arg = r), !!n } for (var n = this.tryEntries.length - 1; n >= 0; --n) { var o = this.tryEntries[n], a = o.completion; if ("root" === o.tryLoc) return i("end"); if (o.tryLoc <= this.prev) { var h = s.call(o, "catchLoc"), u = s.call(o, "finallyLoc"); if (h && u) { if (this.prev < o.catchLoc) return i(o.catchLoc, !0); if (this.prev < o.finallyLoc) return i(o.finallyLoc) } else if (h) { if (this.prev < o.catchLoc) return i(o.catchLoc, !0) } else { if (!u) throw new Error("try statement without catch or finally"); if (this.prev < o.finallyLoc) return i(o.finallyLoc) } } } }, abrupt: function (t, e) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var r = this.tryEntries[i]; if (r.tryLoc <= this.prev && s.call(r, "finallyLoc") && this.prev < r.finallyLoc) { var n = r; break } } n && ("break" === t || "continue" === t) && n.tryLoc <= e && e <= n.finallyLoc && (n = null); var o = n ? n.completion : {}; return o.type = t, o.arg = e, n ? (this.method = "next", this.next = n.finallyLoc, m) : this.complete(o) }, complete: function (t, e) { if ("throw" === t.type) throw t.arg; return "break" === t.type || "continue" === t.type ? this.next = t.arg : "return" === t.type ? (this.rval = this.arg = t.arg, this.method = "return", this.next = "end") : "normal" === t.type && e && (this.next = e), m }, finish: function (t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var i = this.tryEntries[e]; if (i.finallyLoc === t) return this.complete(i.completion, i.afterLoc), M(i), m } }, catch: function (t) { for (var e = this.tryEntries.length - 1; e >= 0; --e) { var i = this.tryEntries[e]; if (i.tryLoc === t) { var r = i.completion; if ("throw" === r.type) { var n = r.arg; M(i) } return n } } throw new Error("illegal catch attempt") }, delegateYield: function (t, e, i) { return this.delegate = { iterator: I(t), resultName: e, nextLoc: i }, "next" === this.method && (this.arg = r), m } } } function b(t, e, i, r) { var n = e && e.prototype instanceof w ? e : w, s = Object.create(n.prototype), o = new L(r || []); return s._invoke = function (t, e, i) { var r = d; return function (n, s) { if (r === f) throw new Error("Generator is already running"); if (r === g) { if ("throw" === n) throw s; return O() } for (i.method = n, i.arg = s; ;) { var o = i.delegate; if (o) { var a = A(o, i); if (a) { if (a === m) continue; return a } } if ("next" === i.method) i.sent = i._sent = i.arg; else if ("throw" === i.method) { if (r === d) throw r = g, i.arg; i.dispatchException(i.arg) } else "return" === i.method && i.abrupt("return", i.arg); r = f; var h = T(t, e, i); if ("normal" === h.type) { if (r = i.done ? g : p, h.arg === m) continue; return { value: h.arg, done: i.done } } "throw" === h.type && (r = g, i.method = "throw", i.arg = h.arg) } } }(t, i, o), s } function T(t, e, i) { try { return { type: "normal", arg: t.call(e, i) } } catch (t) { return { type: "throw", arg: t } } } function w() { } function S() { } function C() { } function P(t) { ["next", "throw", "return"].forEach(function (e) { t[e] = function (t) { return this._invoke(e, t) } }) } function E(e) { function r(t, n, o, a) { var h = T(e[t], e, n); if ("throw" !== h.type) { var u = h.arg, l = u.value; return l && "object" === (void 0 === l ? "undefined" : i(l)) && s.call(l, "__await") ? Promise.resolve(l.__await).then(function (t) { r("next", t, o, a) }, function (t) { r("throw", t, o, a) }) : Promise.resolve(l).then(function (t) { u.value = t, o(u) }, a) } a(h.arg) } var n; "object" === i(t.process) && t.process.domain && (r = t.process.domain.bind(r)), this._invoke = function (t, e) { function i() { return new Promise(function (i, n) { r(t, e, i, n) }) } return n = n ? n.then(i, i) : i() } } function A(t, e) { var i = t.iterator[e.method]; if (i === r) { if (e.delegate = null, "throw" === e.method) { if (t.iterator.return && (e.method = "return", e.arg = r, A(t, e), "throw" === e.method)) return m; e.method = "throw", e.arg = new TypeError("The iterator does not provide a 'throw' method") } return m } var n = T(i, t.iterator, e.arg); if ("throw" === n.type) return e.method = "throw", e.arg = n.arg, e.delegate = null, m; var s = n.arg; return s ? s.done ? (e[t.resultName] = s.value, e.next = t.nextLoc, "return" !== e.method && (e.method = "next", e.arg = r), e.delegate = null, m) : s : (e.method = "throw", e.arg = new TypeError("iterator result is not an object"), e.delegate = null, m) } function R(t) { var e = { tryLoc: t[0] }; 1 in t && (e.catchLoc = t[1]), 2 in t && (e.finallyLoc = t[2], e.afterLoc = t[3]), this.tryEntries.push(e) } function M(t) { var e = t.completion || {}; e.type = "normal", delete e.arg, t.completion = e } function L(t) { this.tryEntries = [{ tryLoc: "root" }], t.forEach(R, this), this.reset(!0) } function I(t) { if (t) { var e = t[a]; if (e) return e.call(t); if ("function" == typeof t.next) return t; if (!isNaN(t.length)) { var i = -1, n = function e() { for (; ++i < t.length;)if (s.call(t, i)) return e.value = t[i], e.done = !1, e; return e.value = r, e.done = !0, e }; return n.next = n } } return { next: O } } function O() { return { value: r, done: !0 } } }("object" === (void 0 === t ? "undefined" : i(t)) ? t : "object" === ("undefined" == typeof window ? "undefined" : i(window)) ? window : "object" === ("undefined" == typeof self ? "undefined" : i(self)) ? self : void 0) }).call(e, i("DuR2"), i("3IRH")(t)) }, zmx7: function (t, e, i) { "use strict"; var r = i("Ds5P"), n = i("YUr7"), s = i("PHqh"), o = i("x9zv"), a = i("bSML"); r(r.S, "Object", { getOwnPropertyDescriptors: function (t) { for (var e, i, r = s(t), h = o.f, u = n(r), l = {}, c = 0; u.length > c;)void 0 !== (i = h(r, e = u[c++])) && a(l, e, i); return l } }) }, "zo/l": function (t, e, i) { "use strict"; var r = i("oeih"), n = Math.max, s = Math.min; t.exports = function (t, e) { return (t = r(t)) < 0 ? n(t + e, 0) : s(t, e) } }, "zq/X": function (t, e, i) { "use strict"; var r = i("UKM+"); t.exports = function (t, e) { if (!r(t) || t._t !== e) throw TypeError("Incompatible receiver, " + e + " required!"); return t } } });